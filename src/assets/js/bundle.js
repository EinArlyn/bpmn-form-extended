(()=>{"use strict";var e,v={},b={};function a(e){var n=b[e];if(void 0!==n)return n.exports;var r=b[e]={exports:{}};return v[e](r,r.exports,a),r.exports}a.m=v,e=[],a.O=(n,r,c,o)=>{if(!r){var u=1/0;for(f=0;f<e.length;f++){for(var[r,c,o]=e[f],s=!0,t=0;t<r.length;t++)(!1&o||u>=o)&&Object.keys(a.O).every(d=>a.O[d](r[t]))?r.splice(t--,1):(s=!1,o<u&&(u=o));if(s){e.splice(f--,1);var l=c();void 0!==l&&(n=l)}}return n}o=o||0;for(var f=e.length;f>0&&e[f-1][2]>o;f--)e[f]=e[f-1];e[f]=[r,c,o]},a.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return a.d(n,{a:n}),n},a.d=(e,n)=>{for(var r in n)a.o(n,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},a.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{var e={121:0};a.O.j=c=>0===e[c];var n=(c,o)=>{var t,l,[f,u,s]=o,_=0;if(f.some(p=>0!==e[p])){for(t in u)a.o(u,t)&&(a.m[t]=u[t]);if(s)var i=s(a)}for(c&&c(o);_<f.length;_++)a.o(e,l=f[_])&&e[l]&&e[l][0](),e[l]=0;return a.O(i)},r=self.webpackChunk_winconf_webcomponent=self.webpackChunk_winconf_webcomponent||[];r.forEach(n.bind(null,0)),r.push=n.bind(null,r.push.bind(r))})()})();(self.webpackChunk_winconf_webcomponent=self.webpackChunk_winconf_webcomponent||[]).push([[792],{716:(Tt,Wt,it)=>{var xe;!function(ve,Te,Ne,Pe){"use strict";var A,le=["","webkit","Moz","MS","ms","o"],Oe=Te.createElement("div"),te="function",z=Math.round,F=Math.abs,D=Date.now;function g(b,T,k){return setTimeout(P(b,k),T)}function _(b,T,k){return!!Array.isArray(b)&&(E(b,k[T],k),!0)}function E(b,T,k){var Y;if(b)if(b.forEach)b.forEach(T,k);else if(b.length!==Pe)for(Y=0;Y<b.length;)T.call(k,b[Y],Y,b),Y++;else for(Y in b)b.hasOwnProperty(Y)&&T.call(k,b[Y],Y,b)}function y(b,T,k){var Y="DEPRECATED METHOD: "+T+"\n"+k+" AT \n";return function(){var he=new Error("get-stack-trace"),Ie=he&&he.stack?he.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",ot=ve.console&&(ve.console.warn||ve.console.log);return ot&&ot.call(ve.console,Y,Ie),b.apply(this,arguments)}}A="function"!=typeof Object.assign?function(T){if(T===Pe||null===T)throw new TypeError("Cannot convert undefined or null to object");for(var k=Object(T),Y=1;Y<arguments.length;Y++){var he=arguments[Y];if(he!==Pe&&null!==he)for(var Ie in he)he.hasOwnProperty(Ie)&&(k[Ie]=he[Ie])}return k}:Object.assign;var x=y(function(T,k,Y){for(var he=Object.keys(k),Ie=0;Ie<he.length;)(!Y||Y&&T[he[Ie]]===Pe)&&(T[he[Ie]]=k[he[Ie]]),Ie++;return T},"extend","Use `assign`."),M=y(function(T,k){return x(T,k,!0)},"merge","Use `assign`.");function w(b,T,k){var he,Y=T.prototype;(he=b.prototype=Object.create(Y)).constructor=b,he._super=Y,k&&A(he,k)}function P(b,T){return function(){return b.apply(T,arguments)}}function j(b,T){return typeof b==te?b.apply(T&&T[0]||Pe,T):b}function Z(b,T){return b===Pe?T:b}function $(b,T,k){E(ie(T),function(Y){b.addEventListener(Y,k,!1)})}function N(b,T,k){E(ie(T),function(Y){b.removeEventListener(Y,k,!1)})}function B(b,T){for(;b;){if(b==T)return!0;b=b.parentNode}return!1}function U(b,T){return b.indexOf(T)>-1}function ie(b){return b.trim().split(/\s+/g)}function W(b,T,k){if(b.indexOf&&!k)return b.indexOf(T);for(var Y=0;Y<b.length;){if(k&&b[Y][k]==T||!k&&b[Y]===T)return Y;Y++}return-1}function ut(b){return Array.prototype.slice.call(b,0)}function V(b,T,k){for(var Y=[],he=[],Ie=0;Ie<b.length;){var ot=T?b[Ie][T]:b[Ie];W(he,ot)<0&&Y.push(b[Ie]),he[Ie]=ot,Ie++}return k&&(Y=T?Y.sort(function(fn,In){return fn[T]>In[T]}):Y.sort()),Y}function O(b,T){for(var k,Y,he=T[0].toUpperCase()+T.slice(1),Ie=0;Ie<le.length;){if((Y=(k=le[Ie])?k+he:T)in b)return Y;Ie++}return Pe}var K=1;function J(b){var T=b.ownerDocument||b;return T.defaultView||T.parentWindow||ve}var fe="ontouchstart"in ve,S=O(ve,"PointerEvent")!==Pe,Q=fe&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),re="touch",Ye="mouse",qt=25,xt=1,St=4,yn=8,cs=1,Pt=2,ls=4,Nr=8,lr=16,Xt=Pt|ls,ur=Nr|lr,ac=Xt|ur,cc=["x","y"],Ai=["clientX","clientY"];function xn(b,T){var k=this;this.manager=b,this.callback=T,this.element=b.element,this.target=b.options.inputTarget,this.domHandler=function(Y){j(b.options.enable,[b])&&k.handler(Y)},this.init()}function xo(b,T,k){var Y=k.pointers.length,he=k.changedPointers.length,Ie=T&xt&&Y-he==0,ot=T&(St|yn)&&Y-he==0;k.isFirst=!!Ie,k.isFinal=!!ot,Ie&&(b.session={}),k.eventType=T,function tp(b,T){var k=b.session,Y=T.pointers,he=Y.length;k.firstInput||(k.firstInput=Po(T)),he>1&&!k.firstMultiple?k.firstMultiple=Po(T):1===he&&(k.firstMultiple=!1);var Ie=k.firstInput,ot=k.firstMultiple,dn=ot?ot.center:Ie.center,fn=T.center=hr(Y);T.timeStamp=D(),T.deltaTime=T.timeStamp-Ie.timeStamp,T.angle=lc(dn,fn),T.distance=us(dn,fn),function np(b,T){var k=T.center,Y=b.offsetDelta||{},he=b.prevDelta||{},Ie=b.prevInput||{};(T.eventType===xt||Ie.eventType===St)&&(he=b.prevDelta={x:Ie.deltaX||0,y:Ie.deltaY||0},Y=b.offsetDelta={x:k.x,y:k.y}),T.deltaX=he.x+(k.x-Y.x),T.deltaY=he.y+(k.y-Y.y)}(k,T),T.offsetDirection=Su(T.deltaX,T.deltaY);var In=Ls(T.deltaTime,T.deltaX,T.deltaY);T.overallVelocityX=In.x,T.overallVelocityY=In.y,T.overallVelocity=F(In.x)>F(In.y)?In.x:In.y,T.scale=ot?function rp(b,T){return us(T[0],T[1],Ai)/us(b[0],b[1],Ai)}(ot.pointers,Y):1,T.rotation=ot?function uc(b,T){return lc(T[1],T[0],Ai)+lc(b[1],b[0],Ai)}(ot.pointers,Y):0,T.maxPointers=k.prevInput?T.pointers.length>k.prevInput.maxPointers?T.pointers.length:k.prevInput.maxPointers:T.pointers.length,function ip(b,T){var he,Ie,ot,dn,k=b.lastInterval||T,Y=T.timeStamp-k.timeStamp;if(T.eventType!=yn&&(Y>qt||k.velocity===Pe)){var fn=T.deltaX-k.deltaX,In=T.deltaY-k.deltaY,fi=Ls(Y,fn,In);Ie=fi.x,ot=fi.y,he=F(fi.x)>F(fi.y)?fi.x:fi.y,dn=Su(fn,In),b.lastInterval=T}else he=k.velocity,Ie=k.velocityX,ot=k.velocityY,dn=k.direction;T.velocity=he,T.velocityX=Ie,T.velocityY=ot,T.direction=dn}(k,T);var fi=b.element;B(T.srcEvent.target,fi)&&(fi=T.srcEvent.target),T.target=fi}(b,k),b.emit("hammer.input",k),b.recognize(k),b.session.prevInput=k}function Po(b){for(var T=[],k=0;k<b.pointers.length;)T[k]={clientX:z(b.pointers[k].clientX),clientY:z(b.pointers[k].clientY)},k++;return{timeStamp:D(),pointers:T,center:hr(T),deltaX:b.deltaX,deltaY:b.deltaY}}function hr(b){var T=b.length;if(1===T)return{x:z(b[0].clientX),y:z(b[0].clientY)};for(var k=0,Y=0,he=0;he<T;)k+=b[he].clientX,Y+=b[he].clientY,he++;return{x:z(k/T),y:z(Y/T)}}function Ls(b,T,k){return{x:T/b||0,y:k/b||0}}function Su(b,T){return b===T?cs:F(b)>=F(T)?b<0?Pt:ls:T<0?Nr:lr}function us(b,T,k){k||(k=cc);var Y=T[k[0]]-b[k[0]],he=T[k[1]]-b[k[1]];return Math.sqrt(Y*Y+he*he)}function lc(b,T,k){return k||(k=cc),180*Math.atan2(T[k[1]]-b[k[1]],T[k[0]]-b[k[0]])/Math.PI}xn.prototype={handler:function(){},init:function(){this.evEl&&$(this.element,this.evEl,this.domHandler),this.evTarget&&$(this.target,this.evTarget,this.domHandler),this.evWin&&$(J(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&N(this.element,this.evEl,this.domHandler),this.evTarget&&N(this.target,this.evTarget,this.domHandler),this.evWin&&N(J(this.element),this.evWin,this.domHandler)}};var hc={mousedown:xt,mousemove:2,mouseup:St},Oo="mousedown",sp="mousemove mouseup";function hs(){this.evEl=Oo,this.evWin=sp,this.pressed=!1,xn.apply(this,arguments)}w(hs,xn,{handler:function(T){var k=hc[T.type];k&xt&&0===T.button&&(this.pressed=!0),2&k&&1!==T.which&&(k=St),this.pressed&&(k&St&&(this.pressed=!1),this.callback(this.manager,k,{pointers:[T],changedPointers:[T],pointerType:Ye,srcEvent:T}))}});var op={pointerdown:xt,pointermove:2,pointerup:St,pointercancel:yn,pointerout:yn},dc={2:re,3:"pen",4:Ye,5:"kinect"},kr="pointerdown",Cu="pointermove pointerup pointercancel";function Ro(){this.evEl=kr,this.evWin=Cu,xn.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ve.MSPointerEvent&&!ve.PointerEvent&&(kr="MSPointerDown",Cu="MSPointerMove MSPointerUp MSPointerCancel"),w(Ro,xn,{handler:function(T){var k=this.store,Y=!1,he=T.type.toLowerCase().replace("ms",""),Ie=op[he],ot=dc[T.pointerType]||T.pointerType,dn=ot==re,fn=W(k,T.pointerId,"pointerId");Ie&xt&&(0===T.button||dn)?fn<0&&(k.push(T),fn=k.length-1):Ie&(St|yn)&&(Y=!0),!(fn<0)&&(k[fn]=T,this.callback(this.manager,Ie,{pointers:k,changedPointers:[T],pointerType:ot,srcEvent:T}),Y&&k.splice(fn,1))}});var sn={touchstart:xt,touchmove:2,touchend:St,touchcancel:yn};function Tu(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,xn.apply(this,arguments)}function cp(b,T){var k=ut(b.touches),Y=ut(b.changedTouches);return T&(St|yn)&&(k=V(k.concat(Y),"identifier",!0)),[k,Y]}w(Tu,xn,{handler:function(T){var k=sn[T.type];if(k===xt&&(this.started=!0),this.started){var Y=cp.call(this,T,k);k&(St|yn)&&Y[0].length-Y[1].length==0&&(this.started=!1),this.callback(this.manager,k,{pointers:Y[0],changedPointers:Y[1],pointerType:re,srcEvent:T})}}});var Ot={touchstart:xt,touchmove:2,touchend:St,touchcancel:yn},Iu="touchstart touchmove touchend touchcancel";function Hi(){this.evTarget=Iu,this.targetIds={},xn.apply(this,arguments)}function lp(b,T){var k=ut(b.touches),Y=this.targetIds;if(T&(2|xt)&&1===k.length)return Y[k[0].identifier]=!0,[k,k];var he,Ie,ot=ut(b.changedTouches),dn=[],fn=this.target;if(Ie=k.filter(function(In){return B(In.target,fn)}),T===xt)for(he=0;he<Ie.length;)Y[Ie[he].identifier]=!0,he++;for(he=0;he<ot.length;)Y[ot[he].identifier]&&dn.push(ot[he]),T&(St|yn)&&delete Y[ot[he].identifier],he++;return dn.length?[V(Ie.concat(dn),"identifier",!0),dn]:void 0}w(Hi,xn,{handler:function(T){var k=Ot[T.type],Y=lp.call(this,T,k);Y&&this.callback(this.manager,k,{pointers:Y[0],changedPointers:Y[1],pointerType:re,srcEvent:T})}});var Pn=2500;function fc(){xn.apply(this,arguments);var b=P(this.handler,this);this.touch=new Hi(this.manager,b),this.mouse=new hs(this.manager,b),this.primaryTouch=null,this.lastTouches=[]}function ii(b,T){b&xt?(this.primaryTouch=T.changedPointers[0].identifier,Au.call(this,T)):b&(St|yn)&&Au.call(this,T)}function Au(b){var T=b.changedPointers[0];if(T.identifier===this.primaryTouch){var k={x:T.clientX,y:T.clientY};this.lastTouches.push(k);var Y=this.lastTouches;setTimeout(function(){var Ie=Y.indexOf(k);Ie>-1&&Y.splice(Ie,1)},Pn)}}function Fs(b){for(var T=b.srcEvent.clientX,k=b.srcEvent.clientY,Y=0;Y<this.lastTouches.length;Y++){var he=this.lastTouches[Y],Ie=Math.abs(T-he.x),ot=Math.abs(k-he.y);if(Ie<=25&&ot<=25)return!0}return!1}w(fc,xn,{handler:function(T,k,Y){var Ie=Y.pointerType==Ye;if(!(Ie&&Y.sourceCapabilities&&Y.sourceCapabilities.firesTouchEvents)){if(Y.pointerType==re)ii.call(this,k,Y);else if(Ie&&Fs.call(this,Y))return;this.callback(T,k,Y)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var pc=O(Oe.style,"touchAction"),gc=pc!==Pe,_c="compute",mc="manipulation",Lr="none",ko="pan-x",Be="pan-y",yc=function xu(){if(!gc)return!1;var b={},T=ve.CSS&&ve.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(k){b[k]=!T||ve.CSS.supports("touch-action",k)}),b}();function vc(b,T){this.manager=b,this.set(T)}vc.prototype={set:function(b){b==_c&&(b=this.compute()),gc&&this.manager.element.style&&yc[b]&&(this.manager.element.style[pc]=b),this.actions=b.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var b=[];return E(this.manager.recognizers,function(T){j(T.options.enable,[T])&&(b=b.concat(T.getTouchAction()))}),function Mu(b){if(U(b,Lr))return Lr;var T=U(b,ko),k=U(b,Be);return T&&k?Lr:T||k?T?ko:Be:U(b,mc)?mc:"auto"}(b.join(" "))},preventDefaults:function(b){var T=b.srcEvent,k=b.offsetDirection;if(!this.manager.session.prevented){var Y=this.actions,he=U(Y,Lr)&&!yc[Lr],Ie=U(Y,Be)&&!yc[Be],ot=U(Y,ko)&&!yc[ko];if(he&&1===b.pointers.length&&b.distance<2&&b.deltaTime<250)return;return ot&&Ie||!(he||Ie&&k&Xt||ot&&k&ur)?void 0:this.preventSrc(T)}T.preventDefault()},preventSrc:function(b){this.manager.session.prevented=!0,b.preventDefault()}};var Lo=1;function $i(b){this.options=A({},this.defaults,b||{}),this.id=function X(){return K++}(),this.manager=null,this.options.enable=Z(this.options.enable,!0),this.state=Lo,this.simultaneous={},this.requireFail=[]}function Pu(b){return 16&b?"cancel":8&b?"end":4&b?"move":2&b?"start":""}function up(b){return b==lr?"down":b==Nr?"up":b==Pt?"left":b==ls?"right":""}function Fo(b,T){var k=T.manager;return k?k.get(b):b}function Kn(){$i.apply(this,arguments)}function ds(){Kn.apply(this,arguments),this.pX=null,this.pY=null}function wc(){Kn.apply(this,arguments)}function Ec(){$i.apply(this,arguments),this._timer=null,this._input=null}function bc(){Kn.apply(this,arguments)}function Ou(){Kn.apply(this,arguments)}function Sc(){$i.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Br(b,T){return(T=T||{}).recognizers=Z(T.recognizers,Br.defaults.preset),new Ru(b,T)}function Ru(b,T){this.options=A({},Br.defaults,T||{}),this.options.inputTarget=this.options.inputTarget||b,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=b,this.input=function bu(b){return new(b.options.inputClass||(S?Ro:Q?Hi:fe?fc:hs))(b,xo)}(this),this.touchAction=new vc(this,this.options.touchAction),Nu(this,!0),E(this.options.recognizers,function(k){var Y=this.add(new k[0](k[1]));k[2]&&Y.recognizeWith(k[2]),k[3]&&Y.requireFailure(k[3])},this)}function Nu(b,T){var Y,k=b.element;k.style&&(E(b.options.cssProps,function(he,Ie){Y=O(k.style,Ie),T?(b.oldCssProps[Y]=k.style[Y],k.style[Y]=he):k.style[Y]=b.oldCssProps[Y]||""}),T||(b.oldCssProps={}))}$i.prototype={defaults:{},set:function(b){return A(this.options,b),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(b){if(_(b,"recognizeWith",this))return this;var T=this.simultaneous;return T[(b=Fo(b,this)).id]||(T[b.id]=b,b.recognizeWith(this)),this},dropRecognizeWith:function(b){return _(b,"dropRecognizeWith",this)||(b=Fo(b,this),delete this.simultaneous[b.id]),this},requireFailure:function(b){if(_(b,"requireFailure",this))return this;var T=this.requireFail;return-1===W(T,b=Fo(b,this))&&(T.push(b),b.requireFailure(this)),this},dropRequireFailure:function(b){if(_(b,"dropRequireFailure",this))return this;b=Fo(b,this);var T=W(this.requireFail,b);return T>-1&&this.requireFail.splice(T,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(b){return!!this.simultaneous[b.id]},emit:function(b){var T=this,k=this.state;function Y(he){T.manager.emit(he,b)}k<8&&Y(T.options.event+Pu(k)),Y(T.options.event),b.additionalEvent&&Y(b.additionalEvent),k>=8&&Y(T.options.event+Pu(k))},tryEmit:function(b){if(this.canEmit())return this.emit(b);this.state=32},canEmit:function(){for(var b=0;b<this.requireFail.length;){if(!(this.requireFail[b].state&(32|Lo)))return!1;b++}return!0},recognize:function(b){var T=A({},b);if(!j(this.options.enable,[this,T]))return this.reset(),void(this.state=32);56&this.state&&(this.state=Lo),this.state=this.process(T),30&this.state&&this.tryEmit(T)},process:function(b){},getTouchAction:function(){},reset:function(){}},w(Kn,$i,{defaults:{pointers:1},attrTest:function(b){var T=this.options.pointers;return 0===T||b.pointers.length===T},process:function(b){var T=this.state,k=b.eventType,Y=6&T,he=this.attrTest(b);return Y&&(k&yn||!he)?16|T:Y||he?k&St?8|T:2&T?4|T:2:32}}),w(ds,Kn,{defaults:{event:"pan",threshold:10,pointers:1,direction:ac},getTouchAction:function(){var b=this.options.direction,T=[];return b&Xt&&T.push(Be),b&ur&&T.push(ko),T},directionTest:function(b){var T=this.options,k=!0,Y=b.distance,he=b.direction,Ie=b.deltaX,ot=b.deltaY;return he&T.direction||(T.direction&Xt?(he=0===Ie?cs:Ie<0?Pt:ls,k=Ie!=this.pX,Y=Math.abs(b.deltaX)):(he=0===ot?cs:ot<0?Nr:lr,k=ot!=this.pY,Y=Math.abs(b.deltaY))),b.direction=he,k&&Y>T.threshold&&he&T.direction},attrTest:function(b){return Kn.prototype.attrTest.call(this,b)&&(2&this.state||!(2&this.state)&&this.directionTest(b))},emit:function(b){this.pX=b.deltaX,this.pY=b.deltaY;var T=up(b.direction);T&&(b.additionalEvent=this.options.event+T),this._super.emit.call(this,b)}}),w(wc,Kn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Lr]},attrTest:function(b){return this._super.attrTest.call(this,b)&&(Math.abs(b.scale-1)>this.options.threshold||2&this.state)},emit:function(b){1!==b.scale&&(b.additionalEvent=this.options.event+(b.scale<1?"in":"out")),this._super.emit.call(this,b)}}),w(Ec,$i,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(b){var T=this.options,k=b.pointers.length===T.pointers,Y=b.distance<T.threshold,he=b.deltaTime>T.time;if(this._input=b,!Y||!k||b.eventType&(St|yn)&&!he)this.reset();else if(b.eventType&xt)this.reset(),this._timer=g(function(){this.state=8,this.tryEmit()},T.time,this);else if(b.eventType&St)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(b){8===this.state&&(b&&b.eventType&St?this.manager.emit(this.options.event+"up",b):(this._input.timeStamp=D(),this.manager.emit(this.options.event,this._input)))}}),w(bc,Kn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Lr]},attrTest:function(b){return this._super.attrTest.call(this,b)&&(Math.abs(b.rotation)>this.options.threshold||2&this.state)}}),w(Ou,Kn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Xt|ur,pointers:1},getTouchAction:function(){return ds.prototype.getTouchAction.call(this)},attrTest:function(b){var k,T=this.options.direction;return T&(Xt|ur)?k=b.overallVelocity:T&Xt?k=b.overallVelocityX:T&ur&&(k=b.overallVelocityY),this._super.attrTest.call(this,b)&&T&b.offsetDirection&&b.distance>this.options.threshold&&b.maxPointers==this.options.pointers&&F(k)>this.options.velocity&&b.eventType&St},emit:function(b){var T=up(b.offsetDirection);T&&this.manager.emit(this.options.event+T,b),this.manager.emit(this.options.event,b)}}),w(Sc,$i,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[mc]},process:function(b){var T=this.options,k=b.pointers.length===T.pointers,Y=b.distance<T.threshold,he=b.deltaTime<T.time;if(this.reset(),b.eventType&xt&&0===this.count)return this.failTimeout();if(Y&&he&&k){if(b.eventType!=St)return this.failTimeout();var Ie=!this.pTime||b.timeStamp-this.pTime<T.interval,ot=!this.pCenter||us(this.pCenter,b.center)<T.posThreshold;if(this.pTime=b.timeStamp,this.pCenter=b.center,ot&&Ie?this.count+=1:this.count=1,this._input=b,0==this.count%T.taps)return this.hasRequireFailures()?(this._timer=g(function(){this.state=8,this.tryEmit()},T.interval,this),2):8}return 32},failTimeout:function(){return this._timer=g(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Br.VERSION="2.0.7",Br.defaults={domEvents:!1,touchAction:_c,enable:!0,inputTarget:null,inputClass:null,preset:[[bc,{enable:!1}],[wc,{enable:!1},["rotate"]],[Ou,{direction:Xt}],[ds,{direction:Xt},["swipe"]],[Sc],[Sc,{event:"doubletap",taps:2},["tap"]],[Ec]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ru.prototype={set:function(b){return A(this.options,b),b.touchAction&&this.touchAction.update(),b.inputTarget&&(this.input.destroy(),this.input.target=b.inputTarget,this.input.init()),this},stop:function(b){this.session.stopped=b?2:1},recognize:function(b){var T=this.session;if(!T.stopped){this.touchAction.preventDefaults(b);var k,Y=this.recognizers,he=T.curRecognizer;(!he||he&&8&he.state)&&(he=T.curRecognizer=null);for(var Ie=0;Ie<Y.length;)k=Y[Ie],2===T.stopped||he&&k!=he&&!k.canRecognizeWith(he)?k.reset():k.recognize(b),!he&&14&k.state&&(he=T.curRecognizer=k),Ie++}},get:function(b){if(b instanceof $i)return b;for(var T=this.recognizers,k=0;k<T.length;k++)if(T[k].options.event==b)return T[k];return null},add:function(b){if(_(b,"add",this))return this;var T=this.get(b.options.event);return T&&this.remove(T),this.recognizers.push(b),b.manager=this,this.touchAction.update(),b},remove:function(b){if(_(b,"remove",this))return this;if(b=this.get(b)){var T=this.recognizers,k=W(T,b);-1!==k&&(T.splice(k,1),this.touchAction.update())}return this},on:function(b,T){if(b!==Pe&&T!==Pe){var k=this.handlers;return E(ie(b),function(Y){k[Y]=k[Y]||[],k[Y].push(T)}),this}},off:function(b,T){if(b!==Pe){var k=this.handlers;return E(ie(b),function(Y){T?k[Y]&&k[Y].splice(W(k[Y],T),1):delete k[Y]}),this}},emit:function(b,T){this.options.domEvents&&function fp(b,T){var k=Te.createEvent("Event");k.initEvent(b,!0,!0),k.gesture=T,T.target.dispatchEvent(k)}(b,T);var k=this.handlers[b]&&this.handlers[b].slice();if(k&&k.length){T.type=b,T.preventDefault=function(){T.srcEvent.preventDefault()};for(var Y=0;Y<k.length;)k[Y](T),Y++}},destroy:function(){this.element&&Nu(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},A(Br,{INPUT_START:xt,INPUT_MOVE:2,INPUT_END:St,INPUT_CANCEL:yn,STATE_POSSIBLE:Lo,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:cs,DIRECTION_LEFT:Pt,DIRECTION_RIGHT:ls,DIRECTION_UP:Nr,DIRECTION_DOWN:lr,DIRECTION_HORIZONTAL:Xt,DIRECTION_VERTICAL:ur,DIRECTION_ALL:ac,Manager:Ru,Input:xn,TouchAction:vc,TouchInput:Hi,MouseInput:hs,PointerEventInput:Ro,TouchMouseInput:fc,SingleTouchInput:Tu,Recognizer:$i,AttrRecognizer:Kn,Tap:Sc,Pan:ds,Swipe:Ou,Pinch:wc,Rotate:bc,Press:Ec,on:$,off:N,each:E,merge:M,extend:x,assign:A,inherit:w,bindFn:P,prefixed:O}),(typeof ve<"u"?ve:typeof self<"u"?self:{}).Hammer=Br,(xe=function(){return Br}.call(Wt,it,Wt,Tt))!==Pe&&(Tt.exports=xe)}(window,document)},222:(Tt,Wt,it)=>{"use strict";var xe,ve;xe=[it(405),it(7),it(975)],void 0!==(ve=function(Ne,Pe,le){return function Te(Ne,Pe,le){var Oe=function(te,z){return Ne.js_beautify(te,z)};return Oe.js=Ne.js_beautify,Oe.css=Pe.css_beautify,Oe.html=le.html_beautify,Oe.js_beautify=Ne.js_beautify,Oe.css_beautify=Pe.css_beautify,Oe.html_beautify=le.html_beautify,Oe}(Ne,Pe,le)}.apply(Wt,xe))&&(Tt.exports=ve)},7:(Tt,Wt)=>{var xe;!function(){var ve;!function(){"use strict";var Ne=[,,function(te){function z(g){this.__parent=g,this.__character_count=0,this.__indent_count=-1,this.__alignment_count=0,this.__wrap_point_index=0,this.__wrap_point_character_count=0,this.__wrap_point_indent_count=-1,this.__wrap_point_alignment_count=0,this.__items=[]}function F(g,_){this.__cache=[""],this.__indent_size=g.indent_size,this.__indent_string=g.indent_char,g.indent_with_tabs||(this.__indent_string=new Array(g.indent_size+1).join(g.indent_char)),_=_||"",g.indent_level>0&&(_=new Array(g.indent_level+1).join(this.__indent_string)),this.__base_string=_,this.__base_string_length=_.length}function D(g,_){this.__indent_cache=new F(g,_),this.raw=!1,this._end_with_newline=g.end_with_newline,this.indent_size=g.indent_size,this.wrap_line_length=g.wrap_line_length,this.indent_empty_lines=g.indent_empty_lines,this.__lines=[],this.previous_line=null,this.current_line=null,this.next_line=new z(this),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1,this.__add_outputline()}z.prototype.clone_empty=function(){var g=new z(this.__parent);return g.set_indent(this.__indent_count,this.__alignment_count),g},z.prototype.item=function(g){return g<0?this.__items[this.__items.length+g]:this.__items[g]},z.prototype.has_match=function(g){for(var _=this.__items.length-1;_>=0;_--)if(this.__items[_].match(g))return!0;return!1},z.prototype.set_indent=function(g,_){this.is_empty()&&(this.__indent_count=g||0,this.__alignment_count=_||0,this.__character_count=this.__parent.get_indent_size(this.__indent_count,this.__alignment_count))},z.prototype._set_wrap_point=function(){this.__parent.wrap_line_length&&(this.__wrap_point_index=this.__items.length,this.__wrap_point_character_count=this.__character_count,this.__wrap_point_indent_count=this.__parent.next_line.__indent_count,this.__wrap_point_alignment_count=this.__parent.next_line.__alignment_count)},z.prototype._should_wrap=function(){return this.__wrap_point_index&&this.__character_count>this.__parent.wrap_line_length&&this.__wrap_point_character_count>this.__parent.next_line.__character_count},z.prototype._allow_wrap=function(){if(this._should_wrap()){this.__parent.add_new_line();var g=this.__parent.current_line;return g.set_indent(this.__wrap_point_indent_count,this.__wrap_point_alignment_count),g.__items=this.__items.slice(this.__wrap_point_index),this.__items=this.__items.slice(0,this.__wrap_point_index),g.__character_count+=this.__character_count-this.__wrap_point_character_count,this.__character_count=this.__wrap_point_character_count," "===g.__items[0]&&(g.__items.splice(0,1),g.__character_count-=1),!0}return!1},z.prototype.is_empty=function(){return 0===this.__items.length},z.prototype.last=function(){return this.is_empty()?null:this.__items[this.__items.length-1]},z.prototype.push=function(g){this.__items.push(g);var _=g.lastIndexOf("\n");-1!==_?this.__character_count=g.length-_:this.__character_count+=g.length},z.prototype.pop=function(){var g=null;return this.is_empty()||(g=this.__items.pop(),this.__character_count-=g.length),g},z.prototype._remove_indent=function(){this.__indent_count>0&&(this.__indent_count-=1,this.__character_count-=this.__parent.indent_size)},z.prototype._remove_wrap_indent=function(){this.__wrap_point_indent_count>0&&(this.__wrap_point_indent_count-=1)},z.prototype.trim=function(){for(;" "===this.last();)this.__items.pop(),this.__character_count-=1},z.prototype.toString=function(){var g="";return this.is_empty()?this.__parent.indent_empty_lines&&(g=this.__parent.get_indent_string(this.__indent_count)):(g=this.__parent.get_indent_string(this.__indent_count,this.__alignment_count),g+=this.__items.join("")),g},F.prototype.get_indent_size=function(g,_){var E=this.__base_string_length;return g<0&&(E=0),(E+=g*this.__indent_size)+(_||0)},F.prototype.get_indent_string=function(g,_){var E=this.__base_string;return _=_||0,g<0&&(g=0,E=""),this.__ensure_cache(_+=g*this.__indent_size),E+this.__cache[_]},F.prototype.__ensure_cache=function(g){for(;g>=this.__cache.length;)this.__add_column()},F.prototype.__add_column=function(){var g=this.__cache.length,_=0,E="";this.__indent_size&&g>=this.__indent_size&&(g-=(_=Math.floor(g/this.__indent_size))*this.__indent_size,E=new Array(_+1).join(this.__indent_string)),g&&(E+=new Array(g+1).join(" ")),this.__cache.push(E)},D.prototype.__add_outputline=function(){this.previous_line=this.current_line,this.current_line=this.next_line.clone_empty(),this.__lines.push(this.current_line)},D.prototype.get_line_number=function(){return this.__lines.length},D.prototype.get_indent_string=function(g,_){return this.__indent_cache.get_indent_string(g,_)},D.prototype.get_indent_size=function(g,_){return this.__indent_cache.get_indent_size(g,_)},D.prototype.is_empty=function(){return!this.previous_line&&this.current_line.is_empty()},D.prototype.add_new_line=function(g){return!(this.is_empty()||!g&&this.just_added_newline()||(this.raw||this.__add_outputline(),0))},D.prototype.get_code=function(g){this.trim(!0);var _=this.current_line.pop();_&&("\n"===_[_.length-1]&&(_=_.replace(/\n+$/g,"")),this.current_line.push(_)),this._end_with_newline&&this.__add_outputline();var E=this.__lines.join("\n");return"\n"!==g&&(E=E.replace(/[\n]/g,g)),E},D.prototype.set_wrap_point=function(){this.current_line._set_wrap_point()},D.prototype.set_indent=function(g,_){return this.next_line.set_indent(g=g||0,_=_||0),this.__lines.length>1?(this.current_line.set_indent(g,_),!0):(this.current_line.set_indent(),!1)},D.prototype.add_raw_token=function(g){for(var _=0;_<g.newlines;_++)this.__add_outputline();this.current_line.set_indent(-1),this.current_line.push(g.whitespace_before),this.current_line.push(g.text),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1},D.prototype.add_token=function(g){this.__add_space_before_token(),this.current_line.push(g),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=this.current_line._allow_wrap()},D.prototype.__add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&(this.non_breaking_space||this.set_wrap_point(),this.current_line.push(" "))},D.prototype.remove_indent=function(g){for(var _=this.__lines.length;g<_;)this.__lines[g]._remove_indent(),g++;this.current_line._remove_wrap_indent()},D.prototype.trim=function(g){for(g=void 0!==g&&g,this.current_line.trim();g&&this.__lines.length>1&&this.current_line.is_empty();)this.__lines.pop(),this.current_line=this.__lines[this.__lines.length-1],this.current_line.trim();this.previous_line=this.__lines.length>1?this.__lines[this.__lines.length-2]:null},D.prototype.just_added_newline=function(){return this.current_line.is_empty()},D.prototype.just_added_blankline=function(){return this.is_empty()||this.current_line.is_empty()&&this.previous_line.is_empty()},D.prototype.ensure_empty_line_above=function(g,_){for(var E=this.__lines.length-2;E>=0;){var y=this.__lines[E];if(y.is_empty())break;if(0!==y.item(0).indexOf(g)&&y.item(-1)!==_){this.__lines.splice(E+1,0,new z(this)),this.previous_line=this.__lines[this.__lines.length-2];break}E--}},te.exports.Output=D},,,,function(te){function z(g,_){this.raw_options=F(g,_),this.disabled=this._get_boolean("disabled"),this.eol=this._get_characters("eol","auto"),this.end_with_newline=this._get_boolean("end_with_newline"),this.indent_size=this._get_number("indent_size",4),this.indent_char=this._get_characters("indent_char"," "),this.indent_level=this._get_number("indent_level"),this.preserve_newlines=this._get_boolean("preserve_newlines",!0),this.max_preserve_newlines=this._get_number("max_preserve_newlines",32786),this.preserve_newlines||(this.max_preserve_newlines=0),this.indent_with_tabs=this._get_boolean("indent_with_tabs","\t"===this.indent_char),this.indent_with_tabs&&(this.indent_char="\t",1===this.indent_size&&(this.indent_size=4)),this.wrap_line_length=this._get_number("wrap_line_length",this._get_number("max_char")),this.indent_empty_lines=this._get_boolean("indent_empty_lines"),this.templating=this._get_selection_list("templating",["auto","none","angular","django","erb","handlebars","php","smarty"],["auto"])}function F(g,_){var y,E={};for(y in g=D(g))y!==_&&(E[y]=g[y]);if(_&&g[_])for(y in g[_])E[y]=g[_][y];return E}function D(g){var E,_={};for(E in g)_[E.replace(/-/g,"_")]=g[E];return _}z.prototype._get_array=function(g,_){var E=this.raw_options[g],y=_||[];return"object"==typeof E?null!==E&&"function"==typeof E.concat&&(y=E.concat()):"string"==typeof E&&(y=E.split(/[^a-zA-Z0-9_\/\-]+/)),y},z.prototype._get_boolean=function(g,_){var E=this.raw_options[g];return void 0===E?!!_:!!E},z.prototype._get_characters=function(g,_){var E=this.raw_options[g],y=_||"";return"string"==typeof E&&(y=E.replace(/\\r/,"\r").replace(/\\n/,"\n").replace(/\\t/,"\t")),y},z.prototype._get_number=function(g,_){var E=this.raw_options[g];_=parseInt(_,10),isNaN(_)&&(_=0);var y=parseInt(E,10);return isNaN(y)&&(y=_),y},z.prototype._get_selection=function(g,_,E){var y=this._get_selection_list(g,_,E);if(1!==y.length)throw new Error("Invalid Option Value: The option '"+g+"' can only be one of the following values:\n"+_+"\nYou passed in: '"+this.raw_options[g]+"'");return y[0]},z.prototype._get_selection_list=function(g,_,E){if(!_||0===_.length)throw new Error("Selection list cannot be empty.");if(!this._is_valid_selection(E=E||[_[0]],_))throw new Error("Invalid Default Value!");var y=this._get_array(g,E);if(!this._is_valid_selection(y,_))throw new Error("Invalid Option Value: The option '"+g+"' can contain only the following values:\n"+_+"\nYou passed in: '"+this.raw_options[g]+"'");return y},z.prototype._is_valid_selection=function(g,_){return g.length&&_.length&&!g.some(function(E){return-1===_.indexOf(E)})},te.exports.Options=z,te.exports.normalizeOpts=D,te.exports.mergeOpts=F},,function(te){var z=RegExp.prototype.hasOwnProperty("sticky");function F(D){this.__input=D||"",this.__input_length=this.__input.length,this.__position=0}F.prototype.restart=function(){this.__position=0},F.prototype.back=function(){this.__position>0&&(this.__position-=1)},F.prototype.hasNext=function(){return this.__position<this.__input_length},F.prototype.next=function(){var D=null;return this.hasNext()&&(D=this.__input.charAt(this.__position),this.__position+=1),D},F.prototype.peek=function(D){var g=null;return D=D||0,(D+=this.__position)>=0&&D<this.__input_length&&(g=this.__input.charAt(D)),g},F.prototype.__match=function(D,g){D.lastIndex=g;var _=D.exec(this.__input);return _&&!(z&&D.sticky)&&_.index!==g&&(_=null),_},F.prototype.test=function(D,g){return g=g||0,(g+=this.__position)>=0&&g<this.__input_length&&!!this.__match(D,g)},F.prototype.testChar=function(D,g){var _=this.peek(g);return D.lastIndex=0,null!==_&&D.test(_)},F.prototype.match=function(D){var g=this.__match(D,this.__position);return g?this.__position+=g[0].length:g=null,g},F.prototype.read=function(D,g,_){var y,E="";return D&&(y=this.match(D))&&(E+=y[0]),g&&(y||!D)&&(E+=this.readUntil(g,_)),E},F.prototype.readUntil=function(D,g){var _,E=this.__position;D.lastIndex=this.__position;var y=D.exec(this.__input);return y?(E=y.index,g&&(E+=y[0].length)):E=this.__input_length,_=this.__input.substring(this.__position,E),this.__position=E,_},F.prototype.readUntilAfter=function(D){return this.readUntil(D,!0)},F.prototype.get_regexp=function(D,g){var _=null,E="g";return g&&z&&(E="y"),"string"==typeof D&&""!==D?_=new RegExp(D,E):D&&(_=new RegExp(D.source,E)),_},F.prototype.get_literal_regexp=function(D){return RegExp(D.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))},F.prototype.peekUntilAfter=function(D){var g=this.__position,_=this.readUntilAfter(D);return this.__position=g,_},F.prototype.lookBack=function(D){var g=this.__position-1;return g>=D.length&&this.__input.substring(g-D.length,g).toLowerCase()===D},te.exports.InputScanner=F},,,,,function(te){function z(F,D){F="string"==typeof F?F:F.source,D="string"==typeof D?D:D.source,this.__directives_block_pattern=new RegExp(F+/ beautify( \w+[:]\w+)+ /.source+D,"g"),this.__directive_pattern=/ (\w+)[:](\w+)/g,this.__directives_end_ignore_pattern=new RegExp(F+/\sbeautify\signore:end\s/.source+D,"g")}z.prototype.get_directives=function(F){if(!F.match(this.__directives_block_pattern))return null;var D={};this.__directive_pattern.lastIndex=0;for(var g=this.__directive_pattern.exec(F);g;)D[g[1]]=g[2],g=this.__directive_pattern.exec(F);return D},z.prototype.readIgnored=function(F){return F.readUntilAfter(this.__directives_end_ignore_pattern)},te.exports.Directives=z},,function(te,z,F){var D=F(16).Beautifier,g=F(17).Options;te.exports=function _(E,y){return new D(E,y).beautify()},te.exports.defaultOptions=function(){return new g}},function(te,z,F){var D=F(17).Options,g=F(2).Output,_=F(8).InputScanner,y=new(0,F(13).Directives)(/\/\*/,/\*\//),A=/\r\n|[\r\n]/,x=/\r\n|[\r\n]/g,M=/\s/,w=/(?:\s|\n)+/g,P=/\/\*(?:[\s\S]*?)((?:\*\/)|$)/g,j=/\/\/(?:[^\n\r\u2028\u2029]*)/g;function Z($,N){this._source_text=$||"",this._options=new D(N),this._ch=null,this._input=null,this.NESTED_AT_RULE={page:!0,"font-face":!0,keyframes:!0,media:!0,supports:!0,document:!0},this.CONDITIONAL_GROUP_RULE={media:!0,supports:!0,document:!0},this.NON_SEMICOLON_NEWLINE_PROPERTY=["grid-template-areas","grid-template"]}Z.prototype.eatString=function($){var N="";for(this._ch=this._input.next();this._ch;){if(N+=this._ch,"\\"===this._ch)N+=this._input.next();else if(-1!==$.indexOf(this._ch)||"\n"===this._ch)break;this._ch=this._input.next()}return N},Z.prototype.eatWhitespace=function($){for(var N=M.test(this._input.peek()),B=0;M.test(this._input.peek());)this._ch=this._input.next(),$&&"\n"===this._ch&&(0===B||B<this._options.max_preserve_newlines)&&(B++,this._output.add_new_line(!0));return N},Z.prototype.foundNestedPseudoClass=function(){for(var $=0,N=1,B=this._input.peek(N);B;){if("{"===B)return!0;if("("===B)$+=1;else if(")"===B){if(0===$)return!1;$-=1}else if(";"===B||"}"===B)return!1;N++,B=this._input.peek(N)}return!1},Z.prototype.print_string=function($){this._output.set_indent(this._indentLevel),this._output.non_breaking_space=!0,this._output.add_token($)},Z.prototype.preserveSingleSpace=function($){$&&(this._output.space_before_token=!0)},Z.prototype.indent=function(){this._indentLevel++},Z.prototype.outdent=function(){this._indentLevel>0&&this._indentLevel--},Z.prototype.beautify=function(){if(this._options.disabled)return this._source_text;var $=this._source_text,N=this._options.eol;"auto"===N&&(N="\n",$&&A.test($||"")&&(N=$.match(A)[0]));var B=($=$.replace(x,"\n")).match(/^[\t ]*/)[0];this._output=new g(this._options,B),this._input=new _($),this._indentLevel=0,this._nestedLevel=0,this._ch=null;for(var q,fe,U=0,ie=!1,W=!1,ut=!1,V=!1,O=!1,K=this._ch,X=!1;q=""!==this._input.read(w),fe=K,this._ch=this._input.next(),"\\"===this._ch&&this._input.hasNext()&&(this._ch+=this._input.next()),K=this._ch,this._ch;)if("/"===this._ch&&"*"===this._input.peek()){this._output.add_new_line(),this._input.back();var S=this._input.read(P),Q=y.get_directives(S);Q&&"start"===Q.ignore&&(S+=y.readIgnored(this._input)),this.print_string(S),this.eatWhitespace(!0),this._output.add_new_line()}else if("/"===this._ch&&"/"===this._input.peek())this._output.space_before_token=!0,this._input.back(),this.print_string(this._input.read(j)),this.eatWhitespace(!0);else if("$"===this._ch){this.preserveSingleSpace(q),this.print_string(this._ch);var re=this._input.peekUntilAfter(/[: ,;{}()[\]\/='"]/g);re.match(/[ :]$/)&&(re=this.eatString(": ").replace(/\s+$/,""),this.print_string(re),this._output.space_before_token=!0),0===U&&-1!==re.indexOf(":")&&(W=!0,this.indent())}else if("@"===this._ch)if(this.preserveSingleSpace(q),"{"===this._input.peek())this.print_string(this._ch+this.eatString("}"));else{this.print_string(this._ch);var ke=this._input.peekUntilAfter(/[: ,;{}()[\]\/='"]/g);ke.match(/[ :]$/)&&(ke=this.eatString(": ").replace(/\s+$/,""),this.print_string(ke),this._output.space_before_token=!0),0===U&&-1!==ke.indexOf(":")?(W=!0,this.indent()):ke in this.NESTED_AT_RULE?(this._nestedLevel+=1,ke in this.CONDITIONAL_GROUP_RULE&&(ut=!0)):0===U&&!W&&(V=!0)}else if("#"===this._ch&&"{"===this._input.peek())this.preserveSingleSpace(q),this.print_string(this._ch+this.eatString("}"));else if("{"===this._ch)W&&(W=!1,this.outdent()),V=!1,ut?(ut=!1,ie=this._indentLevel>=this._nestedLevel):ie=this._indentLevel>=this._nestedLevel-1,this._options.newline_between_rules&&ie&&this._output.previous_line&&"{"!==this._output.previous_line.item(-1)&&this._output.ensure_empty_line_above("/",","),this._output.space_before_token=!0,"expand"===this._options.brace_style?(this._output.add_new_line(),this.print_string(this._ch),this.indent(),this._output.set_indent(this._indentLevel)):("("===fe?this._output.space_before_token=!1:","!==fe&&this.indent(),this.print_string(this._ch)),this.eatWhitespace(!0),this._output.add_new_line();else if("}"===this._ch)this.outdent(),this._output.add_new_line(),"{"===fe&&this._output.trim(!0),W&&(this.outdent(),W=!1),this.print_string(this._ch),ie=!1,this._nestedLevel&&this._nestedLevel--,this.eatWhitespace(!0),this._output.add_new_line(),this._options.newline_between_rules&&!this._output.just_added_blankline()&&"}"!==this._input.peek()&&this._output.add_new_line(!0),")"===this._input.peek()&&(this._output.trim(!0),"expand"===this._options.brace_style&&this._output.add_new_line(!0));else if(":"===this._ch){for(var Ye=0;Ye<this.NON_SEMICOLON_NEWLINE_PROPERTY.length;Ye++)if(this._input.lookBack(this.NON_SEMICOLON_NEWLINE_PROPERTY[Ye])){X=!0;break}!ie&&!ut||this._input.lookBack("&")||this.foundNestedPseudoClass()||this._input.lookBack("(")||V||0!==U?(this._input.lookBack(" ")&&(this._output.space_before_token=!0),":"===this._input.peek()?(this._ch=this._input.next(),this.print_string("::")):this.print_string(":")):(this.print_string(":"),W||(W=!0,this._output.space_before_token=!0,this.eatWhitespace(!0),this.indent()))}else if('"'===this._ch||"'"===this._ch)this.preserveSingleSpace('"'===fe||"'"===fe||q),this.print_string(this._ch+this.eatString(this._ch)),this.eatWhitespace(!0);else if(";"===this._ch)X=!1,0===U?(W&&(this.outdent(),W=!1),V=!1,this.print_string(this._ch),this.eatWhitespace(!0),"/"!==this._input.peek()&&this._output.add_new_line()):(this.print_string(this._ch),this.eatWhitespace(!0),this._output.space_before_token=!0);else if("("===this._ch)if(this._input.lookBack("url"))this.print_string(this._ch),this.eatWhitespace(),U++,this.indent(),this._ch=this._input.next(),")"===this._ch||'"'===this._ch||"'"===this._ch?this._input.back():this._ch&&(this.print_string(this._ch+this.eatString(")")),U&&(U--,this.outdent()));else{var qt=!1;this._input.lookBack("with")&&(qt=!0),this.preserveSingleSpace(q||qt),this.print_string(this._ch),W&&"$"===fe&&this._options.selector_separator_newline?(this._output.add_new_line(),O=!0):(this.eatWhitespace(),U++,this.indent())}else")"===this._ch?(U&&(U--,this.outdent()),O&&";"===this._input.peek()&&this._options.selector_separator_newline&&(O=!1,this.outdent(),this._output.add_new_line()),this.print_string(this._ch)):","===this._ch?(this.print_string(this._ch),this.eatWhitespace(!0),!this._options.selector_separator_newline||W&&!O||0!==U||V?this._output.space_before_token=!0:this._output.add_new_line()):">"!==this._ch&&"+"!==this._ch&&"~"!==this._ch||W||0!==U?"]"===this._ch?this.print_string(this._ch):"["===this._ch?(this.preserveSingleSpace(q),this.print_string(this._ch)):"="===this._ch?(this.eatWhitespace(),this.print_string("="),M.test(this._ch)&&(this._ch="")):"!"!==this._ch||this._input.lookBack("\\")?(this.preserveSingleSpace('"'===fe||"'"===fe||q),this.print_string(this._ch),!this._output.just_added_newline()&&"\n"===this._input.peek()&&X&&this._output.add_new_line()):(this._output.space_before_token=!0,this.print_string(this._ch)):this._options.space_around_combinator?(this._output.space_before_token=!0,this.print_string(this._ch),this._output.space_before_token=!0):(this.print_string(this._ch),this.eatWhitespace(),this._ch&&M.test(this._ch)&&(this._ch=""));return this._output.get_code(N)},te.exports.Beautifier=Z},function(te,z,F){var D=F(6).Options;function g(_){D.call(this,_,"css"),this.selector_separator_newline=this._get_boolean("selector_separator_newline",!0),this.newline_between_rules=this._get_boolean("newline_between_rules",!0);var E=this._get_boolean("space_around_selector_separator");this.space_around_combinator=this._get_boolean("space_around_combinator")||E;var y=this._get_selection_list("brace_style",["collapse","expand","end-expand","none","preserve-inline"]);this.brace_style="collapse";for(var A=0;A<y.length;A++)this.brace_style="expand"!==y[A]?"collapse":y[A]}g.prototype=new D,te.exports.Options=g}],Pe={},Oe=function le(te){var z=Pe[te];if(void 0!==z)return z.exports;var F=Pe[te]={exports:{}};return Ne[te](F,F.exports,le),F.exports}(15);ve=Oe}();var Te=ve;void 0!==(xe=function(){return{css_beautify:Te}}.apply(Wt,[]))&&(Tt.exports=xe)}()},975:(Tt,Wt,it)=>{var xe,ve;!function(){var Te;!function(){"use strict";var Oe=[,,function(D){function g(y){this.__parent=y,this.__character_count=0,this.__indent_count=-1,this.__alignment_count=0,this.__wrap_point_index=0,this.__wrap_point_character_count=0,this.__wrap_point_indent_count=-1,this.__wrap_point_alignment_count=0,this.__items=[]}function _(y,A){this.__cache=[""],this.__indent_size=y.indent_size,this.__indent_string=y.indent_char,y.indent_with_tabs||(this.__indent_string=new Array(y.indent_size+1).join(y.indent_char)),A=A||"",y.indent_level>0&&(A=new Array(y.indent_level+1).join(this.__indent_string)),this.__base_string=A,this.__base_string_length=A.length}function E(y,A){this.__indent_cache=new _(y,A),this.raw=!1,this._end_with_newline=y.end_with_newline,this.indent_size=y.indent_size,this.wrap_line_length=y.wrap_line_length,this.indent_empty_lines=y.indent_empty_lines,this.__lines=[],this.previous_line=null,this.current_line=null,this.next_line=new g(this),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1,this.__add_outputline()}g.prototype.clone_empty=function(){var y=new g(this.__parent);return y.set_indent(this.__indent_count,this.__alignment_count),y},g.prototype.item=function(y){return y<0?this.__items[this.__items.length+y]:this.__items[y]},g.prototype.has_match=function(y){for(var A=this.__items.length-1;A>=0;A--)if(this.__items[A].match(y))return!0;return!1},g.prototype.set_indent=function(y,A){this.is_empty()&&(this.__indent_count=y||0,this.__alignment_count=A||0,this.__character_count=this.__parent.get_indent_size(this.__indent_count,this.__alignment_count))},g.prototype._set_wrap_point=function(){this.__parent.wrap_line_length&&(this.__wrap_point_index=this.__items.length,this.__wrap_point_character_count=this.__character_count,this.__wrap_point_indent_count=this.__parent.next_line.__indent_count,this.__wrap_point_alignment_count=this.__parent.next_line.__alignment_count)},g.prototype._should_wrap=function(){return this.__wrap_point_index&&this.__character_count>this.__parent.wrap_line_length&&this.__wrap_point_character_count>this.__parent.next_line.__character_count},g.prototype._allow_wrap=function(){if(this._should_wrap()){this.__parent.add_new_line();var y=this.__parent.current_line;return y.set_indent(this.__wrap_point_indent_count,this.__wrap_point_alignment_count),y.__items=this.__items.slice(this.__wrap_point_index),this.__items=this.__items.slice(0,this.__wrap_point_index),y.__character_count+=this.__character_count-this.__wrap_point_character_count,this.__character_count=this.__wrap_point_character_count," "===y.__items[0]&&(y.__items.splice(0,1),y.__character_count-=1),!0}return!1},g.prototype.is_empty=function(){return 0===this.__items.length},g.prototype.last=function(){return this.is_empty()?null:this.__items[this.__items.length-1]},g.prototype.push=function(y){this.__items.push(y);var A=y.lastIndexOf("\n");-1!==A?this.__character_count=y.length-A:this.__character_count+=y.length},g.prototype.pop=function(){var y=null;return this.is_empty()||(y=this.__items.pop(),this.__character_count-=y.length),y},g.prototype._remove_indent=function(){this.__indent_count>0&&(this.__indent_count-=1,this.__character_count-=this.__parent.indent_size)},g.prototype._remove_wrap_indent=function(){this.__wrap_point_indent_count>0&&(this.__wrap_point_indent_count-=1)},g.prototype.trim=function(){for(;" "===this.last();)this.__items.pop(),this.__character_count-=1},g.prototype.toString=function(){var y="";return this.is_empty()?this.__parent.indent_empty_lines&&(y=this.__parent.get_indent_string(this.__indent_count)):(y=this.__parent.get_indent_string(this.__indent_count,this.__alignment_count),y+=this.__items.join("")),y},_.prototype.get_indent_size=function(y,A){var x=this.__base_string_length;return y<0&&(x=0),(x+=y*this.__indent_size)+(A||0)},_.prototype.get_indent_string=function(y,A){var x=this.__base_string;return A=A||0,y<0&&(y=0,x=""),this.__ensure_cache(A+=y*this.__indent_size),x+this.__cache[A]},_.prototype.__ensure_cache=function(y){for(;y>=this.__cache.length;)this.__add_column()},_.prototype.__add_column=function(){var y=this.__cache.length,A=0,x="";this.__indent_size&&y>=this.__indent_size&&(y-=(A=Math.floor(y/this.__indent_size))*this.__indent_size,x=new Array(A+1).join(this.__indent_string)),y&&(x+=new Array(y+1).join(" ")),this.__cache.push(x)},E.prototype.__add_outputline=function(){this.previous_line=this.current_line,this.current_line=this.next_line.clone_empty(),this.__lines.push(this.current_line)},E.prototype.get_line_number=function(){return this.__lines.length},E.prototype.get_indent_string=function(y,A){return this.__indent_cache.get_indent_string(y,A)},E.prototype.get_indent_size=function(y,A){return this.__indent_cache.get_indent_size(y,A)},E.prototype.is_empty=function(){return!this.previous_line&&this.current_line.is_empty()},E.prototype.add_new_line=function(y){return!(this.is_empty()||!y&&this.just_added_newline()||(this.raw||this.__add_outputline(),0))},E.prototype.get_code=function(y){this.trim(!0);var A=this.current_line.pop();A&&("\n"===A[A.length-1]&&(A=A.replace(/\n+$/g,"")),this.current_line.push(A)),this._end_with_newline&&this.__add_outputline();var x=this.__lines.join("\n");return"\n"!==y&&(x=x.replace(/[\n]/g,y)),x},E.prototype.set_wrap_point=function(){this.current_line._set_wrap_point()},E.prototype.set_indent=function(y,A){return this.next_line.set_indent(y=y||0,A=A||0),this.__lines.length>1?(this.current_line.set_indent(y,A),!0):(this.current_line.set_indent(),!1)},E.prototype.add_raw_token=function(y){for(var A=0;A<y.newlines;A++)this.__add_outputline();this.current_line.set_indent(-1),this.current_line.push(y.whitespace_before),this.current_line.push(y.text),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1},E.prototype.add_token=function(y){this.__add_space_before_token(),this.current_line.push(y),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=this.current_line._allow_wrap()},E.prototype.__add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&(this.non_breaking_space||this.set_wrap_point(),this.current_line.push(" "))},E.prototype.remove_indent=function(y){for(var A=this.__lines.length;y<A;)this.__lines[y]._remove_indent(),y++;this.current_line._remove_wrap_indent()},E.prototype.trim=function(y){for(y=void 0!==y&&y,this.current_line.trim();y&&this.__lines.length>1&&this.current_line.is_empty();)this.__lines.pop(),this.current_line=this.__lines[this.__lines.length-1],this.current_line.trim();this.previous_line=this.__lines.length>1?this.__lines[this.__lines.length-2]:null},E.prototype.just_added_newline=function(){return this.current_line.is_empty()},E.prototype.just_added_blankline=function(){return this.is_empty()||this.current_line.is_empty()&&this.previous_line.is_empty()},E.prototype.ensure_empty_line_above=function(y,A){for(var x=this.__lines.length-2;x>=0;){var M=this.__lines[x];if(M.is_empty())break;if(0!==M.item(0).indexOf(y)&&M.item(-1)!==A){this.__lines.splice(x+1,0,new g(this)),this.previous_line=this.__lines[this.__lines.length-2];break}x--}},D.exports.Output=E},function(D){D.exports.Token=function g(_,E,y,A){this.type=_,this.text=E,this.comments_before=null,this.newlines=y||0,this.whitespace_before=A||"",this.parent=null,this.next=null,this.previous=null,this.opened=null,this.closed=null,this.directives=null}},,,function(D){function g(y,A){this.raw_options=_(y,A),this.disabled=this._get_boolean("disabled"),this.eol=this._get_characters("eol","auto"),this.end_with_newline=this._get_boolean("end_with_newline"),this.indent_size=this._get_number("indent_size",4),this.indent_char=this._get_characters("indent_char"," "),this.indent_level=this._get_number("indent_level"),this.preserve_newlines=this._get_boolean("preserve_newlines",!0),this.max_preserve_newlines=this._get_number("max_preserve_newlines",32786),this.preserve_newlines||(this.max_preserve_newlines=0),this.indent_with_tabs=this._get_boolean("indent_with_tabs","\t"===this.indent_char),this.indent_with_tabs&&(this.indent_char="\t",1===this.indent_size&&(this.indent_size=4)),this.wrap_line_length=this._get_number("wrap_line_length",this._get_number("max_char")),this.indent_empty_lines=this._get_boolean("indent_empty_lines"),this.templating=this._get_selection_list("templating",["auto","none","angular","django","erb","handlebars","php","smarty"],["auto"])}function _(y,A){var M,x={};for(M in y=E(y))M!==A&&(x[M]=y[M]);if(A&&y[A])for(M in y[A])x[M]=y[A][M];return x}function E(y){var x,A={};for(x in y)A[x.replace(/-/g,"_")]=y[x];return A}g.prototype._get_array=function(y,A){var x=this.raw_options[y],M=A||[];return"object"==typeof x?null!==x&&"function"==typeof x.concat&&(M=x.concat()):"string"==typeof x&&(M=x.split(/[^a-zA-Z0-9_\/\-]+/)),M},g.prototype._get_boolean=function(y,A){var x=this.raw_options[y];return void 0===x?!!A:!!x},g.prototype._get_characters=function(y,A){var x=this.raw_options[y],M=A||"";return"string"==typeof x&&(M=x.replace(/\\r/,"\r").replace(/\\n/,"\n").replace(/\\t/,"\t")),M},g.prototype._get_number=function(y,A){var x=this.raw_options[y];A=parseInt(A,10),isNaN(A)&&(A=0);var M=parseInt(x,10);return isNaN(M)&&(M=A),M},g.prototype._get_selection=function(y,A,x){var M=this._get_selection_list(y,A,x);if(1!==M.length)throw new Error("Invalid Option Value: The option '"+y+"' can only be one of the following values:\n"+A+"\nYou passed in: '"+this.raw_options[y]+"'");return M[0]},g.prototype._get_selection_list=function(y,A,x){if(!A||0===A.length)throw new Error("Selection list cannot be empty.");if(!this._is_valid_selection(x=x||[A[0]],A))throw new Error("Invalid Default Value!");var M=this._get_array(y,x);if(!this._is_valid_selection(M,A))throw new Error("Invalid Option Value: The option '"+y+"' can contain only the following values:\n"+A+"\nYou passed in: '"+this.raw_options[y]+"'");return M},g.prototype._is_valid_selection=function(y,A){return y.length&&A.length&&!y.some(function(x){return-1===A.indexOf(x)})},D.exports.Options=g,D.exports.normalizeOpts=E,D.exports.mergeOpts=_},,function(D){var g=RegExp.prototype.hasOwnProperty("sticky");function _(E){this.__input=E||"",this.__input_length=this.__input.length,this.__position=0}_.prototype.restart=function(){this.__position=0},_.prototype.back=function(){this.__position>0&&(this.__position-=1)},_.prototype.hasNext=function(){return this.__position<this.__input_length},_.prototype.next=function(){var E=null;return this.hasNext()&&(E=this.__input.charAt(this.__position),this.__position+=1),E},_.prototype.peek=function(E){var y=null;return E=E||0,(E+=this.__position)>=0&&E<this.__input_length&&(y=this.__input.charAt(E)),y},_.prototype.__match=function(E,y){E.lastIndex=y;var A=E.exec(this.__input);return A&&!(g&&E.sticky)&&A.index!==y&&(A=null),A},_.prototype.test=function(E,y){return y=y||0,(y+=this.__position)>=0&&y<this.__input_length&&!!this.__match(E,y)},_.prototype.testChar=function(E,y){var A=this.peek(y);return E.lastIndex=0,null!==A&&E.test(A)},_.prototype.match=function(E){var y=this.__match(E,this.__position);return y?this.__position+=y[0].length:y=null,y},_.prototype.read=function(E,y,A){var M,x="";return E&&(M=this.match(E))&&(x+=M[0]),y&&(M||!E)&&(x+=this.readUntil(y,A)),x},_.prototype.readUntil=function(E,y){var A,x=this.__position;E.lastIndex=this.__position;var M=E.exec(this.__input);return M?(x=M.index,y&&(x+=M[0].length)):x=this.__input_length,A=this.__input.substring(this.__position,x),this.__position=x,A},_.prototype.readUntilAfter=function(E){return this.readUntil(E,!0)},_.prototype.get_regexp=function(E,y){var A=null,x="g";return y&&g&&(x="y"),"string"==typeof E&&""!==E?A=new RegExp(E,x):E&&(A=new RegExp(E.source,x)),A},_.prototype.get_literal_regexp=function(E){return RegExp(E.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))},_.prototype.peekUntilAfter=function(E){var y=this.__position,A=this.readUntilAfter(E);return this.__position=y,A},_.prototype.lookBack=function(E){var y=this.__position-1;return y>=E.length&&this.__input.substring(y-E.length,y).toLowerCase()===E},D.exports.InputScanner=_},function(D,g,_){var E=_(8).InputScanner,y=_(3).Token,A=_(10).TokenStream,x=_(11).WhitespacePattern,M={START:"TK_START",RAW:"TK_RAW",EOF:"TK_EOF"},w=function(P,j){this._input=new E(P),this._options=j||{},this.__tokens=null,this._patterns={},this._patterns.whitespace=new x(this._input)};w.prototype.tokenize=function(){this._input.restart(),this.__tokens=new A,this._reset();for(var P,j=new y(M.START,""),Z=null,$=[],N=new A;j.type!==M.EOF;){for(P=this._get_next_token(j,Z);this._is_comment(P);)N.add(P),P=this._get_next_token(j,Z);N.isEmpty()||(P.comments_before=N,N=new A),P.parent=Z,this._is_opening(P)?($.push(Z),Z=P):Z&&this._is_closing(P,Z)&&(P.opened=Z,Z.closed=P,Z=$.pop(),P.parent=Z),P.previous=j,j.next=P,this.__tokens.add(P),j=P}return this.__tokens},w.prototype._is_first_token=function(){return this.__tokens.isEmpty()},w.prototype._reset=function(){},w.prototype._get_next_token=function(P,j){this._readWhitespace();var Z=this._input.read(/.+/g);return Z?this._create_token(M.RAW,Z):this._create_token(M.EOF,"")},w.prototype._is_comment=function(P){return!1},w.prototype._is_opening=function(P){return!1},w.prototype._is_closing=function(P,j){return!1},w.prototype._create_token=function(P,j){return new y(P,j,this._patterns.whitespace.newline_count,this._patterns.whitespace.whitespace_before_token)},w.prototype._readWhitespace=function(){return this._patterns.whitespace.read()},D.exports.Tokenizer=w,D.exports.TOKEN=M},function(D){function g(_){this.__tokens=[],this.__tokens_length=this.__tokens.length,this.__position=0,this.__parent_token=_}g.prototype.restart=function(){this.__position=0},g.prototype.isEmpty=function(){return 0===this.__tokens_length},g.prototype.hasNext=function(){return this.__position<this.__tokens_length},g.prototype.next=function(){var _=null;return this.hasNext()&&(_=this.__tokens[this.__position],this.__position+=1),_},g.prototype.peek=function(_){var E=null;return _=_||0,(_+=this.__position)>=0&&_<this.__tokens_length&&(E=this.__tokens[_]),E},g.prototype.add=function(_){this.__parent_token&&(_.parent=this.__parent_token),this.__tokens.push(_),this.__tokens_length+=1},D.exports.TokenStream=g},function(D,g,_){var E=_(12).Pattern;function y(A,x){E.call(this,A,x),x?this._line_regexp=this._input.get_regexp(x._line_regexp):this.__set_whitespace_patterns("",""),this.newline_count=0,this.whitespace_before_token=""}(y.prototype=new E).__set_whitespace_patterns=function(A,x){this._match_pattern=this._input.get_regexp("["+(A+="\\t ")+(x+="\\n\\r")+"]+",!0),this._newline_regexp=this._input.get_regexp("\\r\\n|["+x+"]")},y.prototype.read=function(){this.newline_count=0,this.whitespace_before_token="";var A=this._input.read(this._match_pattern);if(" "===A)this.whitespace_before_token=" ";else if(A){var x=this.__split(this._newline_regexp,A);this.newline_count=x.length-1,this.whitespace_before_token=x[this.newline_count]}return A},y.prototype.matching=function(A,x){var M=this._create();return M.__set_whitespace_patterns(A,x),M._update(),M},y.prototype._create=function(){return new y(this._input,this)},y.prototype.__split=function(A,x){A.lastIndex=0;for(var M=0,w=[],P=A.exec(x);P;)w.push(x.substring(M,P.index)),M=P.index+P[0].length,P=A.exec(x);return w.push(M<x.length?x.substring(M,x.length):""),w},D.exports.WhitespacePattern=y},function(D){function g(_,E){this._input=_,this._starting_pattern=null,this._match_pattern=null,this._until_pattern=null,this._until_after=!1,E&&(this._starting_pattern=this._input.get_regexp(E._starting_pattern,!0),this._match_pattern=this._input.get_regexp(E._match_pattern,!0),this._until_pattern=this._input.get_regexp(E._until_pattern),this._until_after=E._until_after)}g.prototype.read=function(){var _=this._input.read(this._starting_pattern);return(!this._starting_pattern||_)&&(_+=this._input.read(this._match_pattern,this._until_pattern,this._until_after)),_},g.prototype.read_match=function(){return this._input.match(this._match_pattern)},g.prototype.until_after=function(_){var E=this._create();return E._until_after=!0,E._until_pattern=this._input.get_regexp(_),E._update(),E},g.prototype.until=function(_){var E=this._create();return E._until_after=!1,E._until_pattern=this._input.get_regexp(_),E._update(),E},g.prototype.starting_with=function(_){var E=this._create();return E._starting_pattern=this._input.get_regexp(_,!0),E._update(),E},g.prototype.matching=function(_){var E=this._create();return E._match_pattern=this._input.get_regexp(_,!0),E._update(),E},g.prototype._create=function(){return new g(this._input,this)},g.prototype._update=function(){},D.exports.Pattern=g},function(D){function g(_,E){_="string"==typeof _?_:_.source,E="string"==typeof E?E:E.source,this.__directives_block_pattern=new RegExp(_+/ beautify( \w+[:]\w+)+ /.source+E,"g"),this.__directive_pattern=/ (\w+)[:](\w+)/g,this.__directives_end_ignore_pattern=new RegExp(_+/\sbeautify\signore:end\s/.source+E,"g")}g.prototype.get_directives=function(_){if(!_.match(this.__directives_block_pattern))return null;var E={};this.__directive_pattern.lastIndex=0;for(var y=this.__directive_pattern.exec(_);y;)E[y[1]]=y[2],y=this.__directive_pattern.exec(_);return E},g.prototype.readIgnored=function(_){return _.readUntilAfter(this.__directives_end_ignore_pattern)},D.exports.Directives=g},function(D,g,_){var E=_(12).Pattern,y={django:!1,erb:!1,handlebars:!1,php:!1,smarty:!1,angular:!1};function A(x,M){E.call(this,x,M),this.__template_pattern=null,this._disabled=Object.assign({},y),this._excluded=Object.assign({},y),M&&(this.__template_pattern=this._input.get_regexp(M.__template_pattern),this._excluded=Object.assign(this._excluded,M._excluded),this._disabled=Object.assign(this._disabled,M._disabled));var w=new E(x);this.__patterns={handlebars_comment:w.starting_with(/{{!--/).until_after(/--}}/),handlebars_unescaped:w.starting_with(/{{{/).until_after(/}}}/),handlebars:w.starting_with(/{{/).until_after(/}}/),php:w.starting_with(/<\?(?:[= ]|php)/).until_after(/\?>/),erb:w.starting_with(/<%[^%]/).until_after(/[^%]%>/),django:w.starting_with(/{%/).until_after(/%}/),django_value:w.starting_with(/{{/).until_after(/}}/),django_comment:w.starting_with(/{#/).until_after(/#}/),smarty:w.starting_with(/{(?=[^}{\s\n])/).until_after(/[^\s\n]}/),smarty_comment:w.starting_with(/{\*/).until_after(/\*}/),smarty_literal:w.starting_with(/{literal}/).until_after(/{\/literal}/)}}(A.prototype=new E)._create=function(){return new A(this._input,this)},A.prototype._update=function(){this.__set_templated_pattern()},A.prototype.disable=function(x){var M=this._create();return M._disabled[x]=!0,M._update(),M},A.prototype.read_options=function(x){var M=this._create();for(var w in y)M._disabled[w]=-1===x.templating.indexOf(w);return M._update(),M},A.prototype.exclude=function(x){var M=this._create();return M._excluded[x]=!0,M._update(),M},A.prototype.read=function(){var x="";x=this._match_pattern?this._input.read(this._starting_pattern):this._input.read(this._starting_pattern,this.__template_pattern);for(var M=this._read_template();M;)x+=M+=this._match_pattern?this._input.read(this._match_pattern):this._input.readUntil(this.__template_pattern),M=this._read_template();return this._until_after&&(x+=this._input.readUntilAfter(this._until_pattern)),x},A.prototype.__set_templated_pattern=function(){var x=[];this._disabled.php||x.push(this.__patterns.php._starting_pattern.source),this._disabled.handlebars||x.push(this.__patterns.handlebars._starting_pattern.source),this._disabled.erb||x.push(this.__patterns.erb._starting_pattern.source),this._disabled.django||(x.push(this.__patterns.django._starting_pattern.source),x.push(this.__patterns.django_value._starting_pattern.source),x.push(this.__patterns.django_comment._starting_pattern.source)),this._disabled.smarty||x.push(this.__patterns.smarty._starting_pattern.source),this._until_pattern&&x.push(this._until_pattern.source),this.__template_pattern=this._input.get_regexp("(?:"+x.join("|")+")")},A.prototype._read_template=function(){var x="",M=this._input.peek();if("<"===M){var w=this._input.peek(1);!this._disabled.php&&!this._excluded.php&&"?"===w&&(x=x||this.__patterns.php.read()),!this._disabled.erb&&!this._excluded.erb&&"%"===w&&(x=x||this.__patterns.erb.read())}else"{"===M&&(!this._disabled.handlebars&&!this._excluded.handlebars&&(x=(x=(x=x||this.__patterns.handlebars_comment.read())||this.__patterns.handlebars_unescaped.read())||this.__patterns.handlebars.read()),this._disabled.django||(!this._excluded.django&&!this._excluded.handlebars&&(x=x||this.__patterns.django_value.read()),this._excluded.django||(x=(x=x||this.__patterns.django_comment.read())||this.__patterns.django.read())),this._disabled.smarty||this._disabled.django&&this._disabled.handlebars&&(x=(x=(x=x||this.__patterns.smarty_comment.read())||this.__patterns.smarty_literal.read())||this.__patterns.smarty.read()));return x},D.exports.TemplatablePattern=A},,,,function(D,g,_){var E=_(19).Beautifier,y=_(20).Options;D.exports=function A(x,M,w,P){return new E(x,M,w,P).beautify()},D.exports.defaultOptions=function(){return new y}},function(D,g,_){var E=_(20).Options,y=_(2).Output,A=_(21).Tokenizer,x=_(21).TOKEN,M=/\r\n|[\r\n]/,w=/\r\n|[\r\n]/g,P=function(V,O){this.indent_level=0,this.alignment_size=0,this.max_preserve_newlines=V.max_preserve_newlines,this.preserve_newlines=V.preserve_newlines,this._output=new y(V,O)};P.prototype.current_line_has_match=function(V){return this._output.current_line.has_match(V)},P.prototype.set_space_before_token=function(V,O){this._output.space_before_token=V,this._output.non_breaking_space=O},P.prototype.set_wrap_point=function(){this._output.set_indent(this.indent_level,this.alignment_size),this._output.set_wrap_point()},P.prototype.add_raw_token=function(V){this._output.add_raw_token(V)},P.prototype.print_preserved_newlines=function(V){var O=0;V.type!==x.TEXT&&V.previous.type!==x.TEXT&&(O=V.newlines?1:0),this.preserve_newlines&&(O=V.newlines<this.max_preserve_newlines+1?V.newlines:this.max_preserve_newlines+1);for(var K=0;K<O;K++)this.print_newline(K>0);return 0!==O},P.prototype.traverse_whitespace=function(V){return!(!V.whitespace_before&&!V.newlines||(this.print_preserved_newlines(V)||(this._output.space_before_token=!0),0))},P.prototype.previous_token_wrapped=function(){return this._output.previous_token_wrapped},P.prototype.print_newline=function(V){this._output.add_new_line(V)},P.prototype.print_token=function(V){V.text&&(this._output.set_indent(this.indent_level,this.alignment_size),this._output.add_token(V.text))},P.prototype.indent=function(){this.indent_level++},P.prototype.deindent=function(){this.indent_level>0&&(this.indent_level--,this._output.set_indent(this.indent_level,this.alignment_size))},P.prototype.get_full_indent=function(V){return(V=this.indent_level+(V||0))<1?"":this._output.get_indent_string(V)};function $(V,O){return-1!==O.indexOf(V)}function N(V,O,K){this.parent=V||null,this.tag=O?O.tag_name:"",this.indent_level=K||0,this.parser_token=O||null}function B(V){this._printer=V,this._current_frame=null}function U(V,O,K,X){this._source_text=V||"",O=O||{},this._js_beautify=K,this._css_beautify=X,this._tag_stack=null;var J=new E(O,"html");this._options=J,this._is_wrap_attributes_force="force"===this._options.wrap_attributes.substr(0,5),this._is_wrap_attributes_force_expand_multiline="force-expand-multiline"===this._options.wrap_attributes,this._is_wrap_attributes_force_aligned="force-aligned"===this._options.wrap_attributes,this._is_wrap_attributes_aligned_multiple="aligned-multiple"===this._options.wrap_attributes,this._is_wrap_attributes_preserve="preserve"===this._options.wrap_attributes.substr(0,8),this._is_wrap_attributes_preserve_aligned="preserve-aligned"===this._options.wrap_attributes}B.prototype.get_parser_token=function(){return this._current_frame?this._current_frame.parser_token:null},B.prototype.record_tag=function(V){var O=new N(this._current_frame,V,this._printer.indent_level);this._current_frame=O},B.prototype._try_pop_frame=function(V){var O=null;return V&&(O=V.parser_token,this._printer.indent_level=V.indent_level,this._current_frame=V.parent),O},B.prototype._get_frame=function(V,O){for(var K=this._current_frame;K&&-1===V.indexOf(K.tag);){if(O&&-1!==O.indexOf(K.tag)){K=null;break}K=K.parent}return K},B.prototype.try_pop=function(V,O){var K=this._get_frame([V],O);return this._try_pop_frame(K)},B.prototype.indent_to_tag=function(V){var O=this._get_frame(V);O&&(this._printer.indent_level=O.indent_level)},U.prototype.beautify=function(){if(this._options.disabled)return this._source_text;var V=this._source_text,O=this._options.eol;"auto"===this._options.eol&&(O="\n",V&&M.test(V)&&(O=V.match(M)[0]));var K=(V=V.replace(w,"\n")).match(/^[\t ]*/)[0],X={text:"",type:""},J=new ie,q=new P(this._options,K),fe=new A(V,this._options).tokenize();this._tag_stack=new B(q);for(var S=null,Q=fe.next();Q.type!==x.EOF;)Q.type===x.TAG_OPEN||Q.type===x.COMMENT?J=S=this._handle_tag_open(q,Q,J,X,fe):Q.type===x.ATTRIBUTE||Q.type===x.EQUALS||Q.type===x.VALUE||Q.type===x.TEXT&&!J.tag_complete?S=this._handle_inside_tag(q,Q,J,X):Q.type===x.TAG_CLOSE?S=this._handle_tag_close(q,Q,J):Q.type===x.TEXT?S=this._handle_text(q,Q,J):Q.type===x.CONTROL_FLOW_OPEN?S=this._handle_control_flow_open(q,Q):Q.type===x.CONTROL_FLOW_CLOSE?S=this._handle_control_flow_close(q,Q):q.add_raw_token(Q),X=S,Q=fe.next();return q._output.get_code(O)},U.prototype._handle_control_flow_open=function(V,O){var K={text:O.text,type:O.type};return V.set_space_before_token(O.newlines||""!==O.whitespace_before,!0),O.newlines?V.print_preserved_newlines(O):V.set_space_before_token(O.newlines||""!==O.whitespace_before,!0),V.print_token(O),V.indent(),K},U.prototype._handle_control_flow_close=function(V,O){var K={text:O.text,type:O.type};return V.deindent(),O.newlines?V.print_preserved_newlines(O):V.set_space_before_token(O.newlines||""!==O.whitespace_before,!0),V.print_token(O),K},U.prototype._handle_tag_close=function(V,O,K){var X={text:O.text,type:O.type};return V.alignment_size=0,K.tag_complete=!0,V.set_space_before_token(O.newlines||""!==O.whitespace_before,!0),K.is_unformatted?V.add_raw_token(O):("<"===K.tag_start_char&&(V.set_space_before_token("/"===O.text[0],!0),this._is_wrap_attributes_force_expand_multiline&&K.has_wrapped_attrs&&V.print_newline(!1)),V.print_token(O)),K.indent_content&&!(K.is_unformatted||K.is_content_unformatted)&&(V.indent(),K.indent_content=!1),!K.is_inline_element&&!(K.is_unformatted||K.is_content_unformatted)&&V.set_wrap_point(),X},U.prototype._handle_inside_tag=function(V,O,K,X){var J=K.has_wrapped_attrs,q={text:O.text,type:O.type};return V.set_space_before_token(O.newlines||""!==O.whitespace_before,!0),K.is_unformatted?V.add_raw_token(O):"{"===K.tag_start_char&&O.type===x.TEXT?V.print_preserved_newlines(O)?(O.newlines=0,V.add_raw_token(O)):V.print_token(O):(O.type===x.ATTRIBUTE?V.set_space_before_token(!0):(O.type===x.EQUALS||O.type===x.VALUE&&O.previous.type===x.EQUALS)&&V.set_space_before_token(!1),O.type===x.ATTRIBUTE&&"<"===K.tag_start_char&&((this._is_wrap_attributes_preserve||this._is_wrap_attributes_preserve_aligned)&&(V.traverse_whitespace(O),J=J||0!==O.newlines),this._is_wrap_attributes_force&&K.attr_count>=this._options.wrap_attributes_min_attrs&&(X.type!==x.TAG_OPEN||this._is_wrap_attributes_force_expand_multiline)&&(V.print_newline(!1),J=!0)),V.print_token(O),J=J||V.previous_token_wrapped(),K.has_wrapped_attrs=J),q},U.prototype._handle_text=function(V,O,K){var X={text:O.text,type:"TK_CONTENT"};return K.custom_beautifier_name?this._print_custom_beatifier_text(V,O,K):K.is_unformatted||K.is_content_unformatted?V.add_raw_token(O):(V.traverse_whitespace(O),V.print_token(O)),X},U.prototype._print_custom_beatifier_text=function(V,O,K){var X=this;if(""!==O.text){var q,J=O.text,fe=1,S="",Q="";"javascript"===K.custom_beautifier_name&&"function"==typeof this._js_beautify?q=this._js_beautify:"css"===K.custom_beautifier_name&&"function"==typeof this._css_beautify?q=this._css_beautify:"html"===K.custom_beautifier_name&&(q=function(xt,Vn){return new U(xt,Vn,X._js_beautify,X._css_beautify).beautify()}),"keep"===this._options.indent_scripts?fe=0:"separate"===this._options.indent_scripts&&(fe=-V.indent_level);var re=V.get_full_indent(fe);if(J=J.replace(/\n[ \t]*$/,""),"html"!==K.custom_beautifier_name&&"<"===J[0]&&J.match(/^(<!--|<!\[CDATA\[)/)){var ke=/^(<!--[^\n]*|<!\[CDATA\[)(\n?)([ \t\n]*)([\s\S]*)(-->|]]>)$/.exec(J);if(!ke)return void V.add_raw_token(O);S=re+ke[1]+"\n",ke[5]&&(Q=re+ke[5]),J=(J=ke[4]).replace(/\n[ \t]*$/,""),(ke[2]||-1!==ke[3].indexOf("\n"))&&(ke=ke[3].match(/[ \t]+$/))&&(O.whitespace_before=ke[0])}if(J)if(q){var Ye=function(){this.eol="\n"};Ye.prototype=this._options.raw_options,J=q(re+J,new Ye)}else{var qt=O.whitespace_before;qt&&(J=J.replace(new RegExp("\n("+qt+")?","g"),"\n")),J=re+J.replace(/\n/g,"\n"+re)}S&&(J=J?S+J+"\n"+Q:S+Q),V.print_newline(!1),J&&(O.text=J,O.whitespace_before="",O.newlines=0,V.add_raw_token(O),V.print_newline(!0))}},U.prototype._handle_tag_open=function(V,O,K,X,J){var q=this._get_tag_open_token(O);if(!K.is_unformatted&&!K.is_content_unformatted||K.is_empty_element||O.type!==x.TAG_OPEN||q.is_start_tag?(V.traverse_whitespace(O),this._set_tag_position(V,O,q,K,X),q.is_inline_element||V.set_wrap_point(),V.print_token(O)):(V.add_raw_token(O),q.start_tag_token=this._tag_stack.try_pop(q.tag_name)),q.is_start_tag&&this._is_wrap_attributes_force){var S,fe=0;do{(S=J.peek(fe)).type===x.ATTRIBUTE&&(q.attr_count+=1),fe+=1}while(S.type!==x.EOF&&S.type!==x.TAG_CLOSE)}return(this._is_wrap_attributes_force_aligned||this._is_wrap_attributes_aligned_multiple||this._is_wrap_attributes_preserve_aligned)&&(q.alignment_size=O.text.length+1),!q.tag_complete&&!q.is_unformatted&&(V.alignment_size=q.alignment_size),q};var ie=function(V,O){if(this.parent=V||null,this.text="",this.type="TK_TAG_OPEN",this.tag_name="",this.is_inline_element=!1,this.is_unformatted=!1,this.is_content_unformatted=!1,this.is_empty_element=!1,this.is_start_tag=!1,this.is_end_tag=!1,this.indent_content=!1,this.multiline_content=!1,this.custom_beautifier_name=null,this.start_tag_token=null,this.attr_count=0,this.has_wrapped_attrs=!1,this.alignment_size=0,this.tag_complete=!1,this.tag_start_char="",this.tag_check="",O){var K;this.tag_start_char=O.text[0],this.text=O.text,"<"===this.tag_start_char?(K=O.text.match(/^<([^\s>]*)/),this.tag_check=K?K[1]:""):(K=O.text.match(/^{{~?(?:[\^]|#\*?)?([^\s}]+)/),this.tag_check=K?K[1]:"",(O.text.startsWith("{{#>")||O.text.startsWith("{{~#>"))&&">"===this.tag_check[0]&&(this.tag_check=">"===this.tag_check&&null!==O.next?O.next.text.split(" ")[0]:O.text.split(">")[1])),this.tag_check=this.tag_check.toLowerCase(),O.type===x.COMMENT&&(this.tag_complete=!0),this.is_start_tag="/"!==this.tag_check.charAt(0),this.tag_name=this.is_start_tag?this.tag_check:this.tag_check.substr(1),this.is_end_tag=!this.is_start_tag||O.closed&&"/>"===O.closed.text;var X=2;"{"===this.tag_start_char&&this.text.length>=3&&"~"===this.text.charAt(2)&&(X=3),this.is_end_tag=this.is_end_tag||"{"===this.tag_start_char&&(this.text.length<3||/[^#\^]/.test(this.text.charAt(X)))}else this.tag_complete=!0};U.prototype._get_tag_open_token=function(V){var O=new ie(this._tag_stack.get_parser_token(),V);return O.alignment_size=this._options.wrap_attributes_indent_size,O.is_end_tag=O.is_end_tag||$(O.tag_check,this._options.void_elements),O.is_empty_element=O.tag_complete||O.is_start_tag&&O.is_end_tag,O.is_unformatted=!O.tag_complete&&$(O.tag_check,this._options.unformatted),O.is_content_unformatted=!O.is_empty_element&&$(O.tag_check,this._options.content_unformatted),O.is_inline_element=$(O.tag_name,this._options.inline)||this._options.inline_custom_elements&&O.tag_name.includes("-")||"{"===O.tag_start_char,O},U.prototype._set_tag_position=function(V,O,K,X,J){if(K.is_empty_element||(K.is_end_tag?K.start_tag_token=this._tag_stack.try_pop(K.tag_name):(this._do_optional_end_element(K)&&(K.is_inline_element||V.print_newline(!1)),this._tag_stack.record_tag(K),("script"===K.tag_name||"style"===K.tag_name)&&!(K.is_unformatted||K.is_content_unformatted)&&(K.custom_beautifier_name=function(V,O){var K=null,X=null;return O.closed?("script"===V?K="text/javascript":"style"===V&&(K="text/css"),K=function(V){for(var O=null,K=V.next;K.type!==x.EOF&&V.closed!==K;){if(K.type===x.ATTRIBUTE&&"type"===K.text){K.next&&K.next.type===x.EQUALS&&K.next.next&&K.next.next.type===x.VALUE&&(O=K.next.next.text);break}K=K.next}return O}(O)||K,K.search("text/css")>-1?X="css":K.search(/module|((text|application|dojo)\/(x-)?(javascript|ecmascript|jscript|livescript|(ld\+)?json|method|aspect))/)>-1?X="javascript":K.search(/(text|application|dojo)\/(x-)?(html)/)>-1?X="html":K.search(/test\/null/)>-1&&(X="null"),X):null}(K.tag_check,O)))),$(K.tag_check,this._options.extra_liners)&&(V.print_newline(!1),V._output.just_added_blankline()||V.print_newline(!0)),K.is_empty_element)"{"===K.tag_start_char&&"else"===K.tag_check&&(this._tag_stack.indent_to_tag(["if","unless","each"]),K.indent_content=!0,V.current_line_has_match(/{{#if/)||V.print_newline(!1)),"!--"===K.tag_name&&J.type===x.TAG_CLOSE&&X.is_end_tag&&-1===K.text.indexOf("\n")||(K.is_inline_element||K.is_unformatted||V.print_newline(!1),this._calcluate_parent_multiline(V,K));else if(K.is_end_tag){var fe=!1;fe=(fe=K.start_tag_token&&K.start_tag_token.multiline_content)||!K.is_inline_element&&!(X.is_inline_element||X.is_unformatted)&&!(J.type===x.TAG_CLOSE&&K.start_tag_token===X)&&"TK_CONTENT"!==J.type,(K.is_content_unformatted||K.is_unformatted)&&(fe=!1),fe&&V.print_newline(!1)}else K.indent_content=!K.custom_beautifier_name,"<"===K.tag_start_char&&("html"===K.tag_name?K.indent_content=this._options.indent_inner_html:"head"===K.tag_name?K.indent_content=this._options.indent_head_inner_html:"body"===K.tag_name&&(K.indent_content=this._options.indent_body_inner_html)),!(K.is_inline_element||K.is_unformatted)&&("TK_CONTENT"!==J.type||K.is_content_unformatted)&&V.print_newline(!1),this._calcluate_parent_multiline(V,K)},U.prototype._calcluate_parent_multiline=function(V,O){O.parent&&V._output.just_added_newline()&&(!O.is_inline_element&&!O.is_unformatted||!O.parent.is_inline_element)&&(O.parent.multiline_content=!0)};var W=["address","article","aside","blockquote","details","div","dl","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","main","menu","nav","ol","p","pre","section","table","ul"],ut=["a","audio","del","ins","map","noscript","video"];U.prototype._do_optional_end_element=function(V){var O=null;if(!V.is_empty_element&&V.is_start_tag&&V.parent){if("body"===V.tag_name)O=O||this._tag_stack.try_pop("head");else if("li"===V.tag_name)O=O||this._tag_stack.try_pop("li",["ol","ul","menu"]);else if("dd"===V.tag_name||"dt"===V.tag_name)O=(O=O||this._tag_stack.try_pop("dt",["dl"]))||this._tag_stack.try_pop("dd",["dl"]);else if("p"===V.parent.tag_name&&-1!==W.indexOf(V.tag_name)){var K=V.parent.parent;(!K||-1===ut.indexOf(K.tag_name))&&(O=O||this._tag_stack.try_pop("p"))}else"rp"===V.tag_name||"rt"===V.tag_name?O=(O=O||this._tag_stack.try_pop("rt",["ruby","rtc"]))||this._tag_stack.try_pop("rp",["ruby","rtc"]):"optgroup"===V.tag_name?O=O||this._tag_stack.try_pop("optgroup",["select"]):"option"===V.tag_name?O=O||this._tag_stack.try_pop("option",["select","datalist","optgroup"]):"colgroup"===V.tag_name?O=O||this._tag_stack.try_pop("caption",["table"]):"thead"===V.tag_name?O=(O=O||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]):"tbody"===V.tag_name||"tfoot"===V.tag_name?O=(O=(O=(O=O||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]))||this._tag_stack.try_pop("thead",["table"]))||this._tag_stack.try_pop("tbody",["table"]):"tr"===V.tag_name?O=(O=(O=O||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]))||this._tag_stack.try_pop("tr",["table","thead","tbody","tfoot"]):("th"===V.tag_name||"td"===V.tag_name)&&(O=(O=O||this._tag_stack.try_pop("td",["table","thead","tbody","tfoot","tr"]))||this._tag_stack.try_pop("th",["table","thead","tbody","tfoot","tr"]));return V.parent=this._tag_stack.get_parser_token(),O}},D.exports.Beautifier=U},function(D,g,_){var E=_(6).Options;function y(A){E.call(this,A,"html"),1===this.templating.length&&"auto"===this.templating[0]&&(this.templating=["django","erb","handlebars","php"]),this.indent_inner_html=this._get_boolean("indent_inner_html"),this.indent_body_inner_html=this._get_boolean("indent_body_inner_html",!0),this.indent_head_inner_html=this._get_boolean("indent_head_inner_html",!0),this.indent_handlebars=this._get_boolean("indent_handlebars",!0),this.wrap_attributes=this._get_selection("wrap_attributes",["auto","force","force-aligned","force-expand-multiline","aligned-multiple","preserve","preserve-aligned"]),this.wrap_attributes_min_attrs=this._get_number("wrap_attributes_min_attrs",2),this.wrap_attributes_indent_size=this._get_number("wrap_attributes_indent_size",this.indent_size),this.extra_liners=this._get_array("extra_liners",["head","body","/html"]),this.inline=this._get_array("inline",["a","abbr","area","audio","b","bdi","bdo","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","meter","noscript","object","output","progress","q","ruby","s","samp","select","small","span","strong","sub","sup","svg","template","textarea","time","u","var","video","wbr","text","acronym","big","strike","tt"]),this.inline_custom_elements=this._get_boolean("inline_custom_elements",!0),this.void_elements=this._get_array("void_elements",["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","!doctype","?xml","basefont","isindex"]),this.unformatted=this._get_array("unformatted",[]),this.content_unformatted=this._get_array("content_unformatted",["pre","textarea"]),this.unformatted_content_delimiter=this._get_characters("unformatted_content_delimiter"),this.indent_scripts=this._get_selection("indent_scripts",["normal","keep","separate"])}y.prototype=new E,D.exports.Options=y},function(D,g,_){var E=_(9).Tokenizer,y=_(9).TOKEN,A=_(13).Directives,x=_(14).TemplatablePattern,M=_(12).Pattern,w={TAG_OPEN:"TK_TAG_OPEN",TAG_CLOSE:"TK_TAG_CLOSE",CONTROL_FLOW_OPEN:"TK_CONTROL_FLOW_OPEN",CONTROL_FLOW_CLOSE:"TK_CONTROL_FLOW_CLOSE",ATTRIBUTE:"TK_ATTRIBUTE",EQUALS:"TK_EQUALS",VALUE:"TK_VALUE",COMMENT:"TK_COMMENT",TEXT:"TK_TEXT",UNKNOWN:"TK_UNKNOWN",START:y.START,RAW:y.RAW,EOF:y.EOF},P=new A(/<\!--/,/-->/),j=function(Z,$){E.call(this,Z,$),this._current_tag_name="";var N=new x(this._input).read_options(this._options),B=new M(this._input);if(this.__patterns={word:N.until(/[\n\r\t <]/),word_control_flow_close_excluded:N.until(/[\n\r\t <}]/),single_quote:N.until_after(/'/),double_quote:N.until_after(/"/),attribute:N.until(/[\n\r\t =>]|\/>/),element_name:N.until(/[\n\r\t >\/]/),angular_control_flow_start:B.matching(/\@[a-zA-Z]+[^({]*[({]/),handlebars_comment:B.starting_with(/{{!--/).until_after(/--}}/),handlebars:B.starting_with(/{{/).until_after(/}}/),handlebars_open:B.until(/[\n\r\t }]/),handlebars_raw_close:B.until(/}}/),comment:B.starting_with(/<!--/).until_after(/-->/),cdata:B.starting_with(/<!\[CDATA\[/).until_after(/]]>/),conditional_comment:B.starting_with(/<!\[/).until_after(/]>/),processing:B.starting_with(/<\?/).until_after(/\?>/)},this._options.indent_handlebars&&(this.__patterns.word=this.__patterns.word.exclude("handlebars"),this.__patterns.word_control_flow_close_excluded=this.__patterns.word_control_flow_close_excluded.exclude("handlebars")),this._unformatted_content_delimiter=null,this._options.unformatted_content_delimiter){var U=this._input.get_literal_regexp(this._options.unformatted_content_delimiter);this.__patterns.unformatted_content_delimiter=B.matching(U).until_after(U)}};(j.prototype=new E)._is_comment=function(Z){return!1},j.prototype._is_opening=function(Z){return Z.type===w.TAG_OPEN||Z.type===w.CONTROL_FLOW_OPEN},j.prototype._is_closing=function(Z,$){return Z.type===w.TAG_CLOSE&&$&&((">"===Z.text||"/>"===Z.text)&&"<"===$.text[0]||"}}"===Z.text&&"{"===$.text[0]&&"{"===$.text[1])||Z.type===w.CONTROL_FLOW_CLOSE&&"}"===Z.text&&$.text.endsWith("{")},j.prototype._reset=function(){this._current_tag_name=""},j.prototype._get_next_token=function(Z,$){var N=null;this._readWhitespace();var B=this._input.peek();return null===B?this._create_token(w.EOF,""):N=(N=(N=(N=(N=(N=(N=(N=(N=(N=N||this._read_open_handlebars(B,$))||this._read_attribute(B,Z,$))||this._read_close(B,$))||this._read_control_flows(B,$))||this._read_raw_content(B,Z,$))||this._read_content_word(B,$))||this._read_comment_or_cdata(B))||this._read_processing(B))||this._read_open(B,$))||this._create_token(w.UNKNOWN,this._input.next())},j.prototype._read_comment_or_cdata=function(Z){var $=null,N=null,B=null;return"<"===Z&&("!"===this._input.peek(1)&&((N=this.__patterns.comment.read())?(B=P.get_directives(N))&&"start"===B.ignore&&(N+=P.readIgnored(this._input)):N=this.__patterns.cdata.read()),N&&(($=this._create_token(w.COMMENT,N)).directives=B)),$},j.prototype._read_processing=function(Z){var $=null,N=null;if("<"===Z){var U=this._input.peek(1);("!"===U||"?"===U)&&(N=(N=this.__patterns.conditional_comment.read())||this.__patterns.processing.read()),N&&(($=this._create_token(w.COMMENT,N)).directives=null)}return $},j.prototype._read_open=function(Z,$){var N=null,B=null;return(!$||$.type===w.CONTROL_FLOW_OPEN)&&"<"===Z&&(N=this._input.next(),"/"===this._input.peek()&&(N+=this._input.next()),N+=this.__patterns.element_name.read(),B=this._create_token(w.TAG_OPEN,N)),B},j.prototype._read_open_handlebars=function(Z,$){var N=null,B=null;return(!$||$.type===w.CONTROL_FLOW_OPEN)&&this._options.indent_handlebars&&"{"===Z&&"{"===this._input.peek(1)&&("!"===this._input.peek(2)?(N=(N=this.__patterns.handlebars_comment.read())||this.__patterns.handlebars.read(),B=this._create_token(w.COMMENT,N)):(N=this.__patterns.handlebars_open.read(),B=this._create_token(w.TAG_OPEN,N))),B},j.prototype._read_control_flows=function(Z,$){var N="",B=null;if(!this._options.templating.includes("angular")||!this._options.indent_handlebars)return B;if("@"===Z){if(""===(N=this.__patterns.angular_control_flow_start.read()))return B;for(var U=N.endsWith("(")?1:0,ie=0;!N.endsWith("{")||U!==ie;){var W=this._input.next();if(null===W)break;"("===W?U++:")"===W&&ie++,N+=W}B=this._create_token(w.CONTROL_FLOW_OPEN,N)}else"}"===Z&&$&&$.type===w.CONTROL_FLOW_OPEN&&(N=this._input.next(),B=this._create_token(w.CONTROL_FLOW_CLOSE,N));return B},j.prototype._read_close=function(Z,$){var N=null,B=null;return $&&$.type===w.TAG_OPEN&&("<"===$.text[0]&&(">"===Z||"/"===Z&&">"===this._input.peek(1))?(N=this._input.next(),"/"===Z&&(N+=this._input.next()),B=this._create_token(w.TAG_CLOSE,N)):"{"===$.text[0]&&"}"===Z&&"}"===this._input.peek(1)&&(this._input.next(),this._input.next(),B=this._create_token(w.TAG_CLOSE,"}}"))),B},j.prototype._read_attribute=function(Z,$,N){var B=null,U="";if(N&&"<"===N.text[0])if("="===Z)B=this._create_token(w.EQUALS,this._input.next());else if('"'===Z||"'"===Z){var ie=this._input.next();ie+='"'===Z?this.__patterns.double_quote.read():this.__patterns.single_quote.read(),B=this._create_token(w.VALUE,ie)}else(U=this.__patterns.attribute.read())&&(B=this._create_token($.type===w.EQUALS?w.VALUE:w.ATTRIBUTE,U));return B},j.prototype._is_content_unformatted=function(Z){return-1===this._options.void_elements.indexOf(Z)&&(-1!==this._options.content_unformatted.indexOf(Z)||-1!==this._options.unformatted.indexOf(Z))},j.prototype._read_raw_content=function(Z,$,N){var B="";if(N&&"{"===N.text[0])B=this.__patterns.handlebars_raw_close.read();else if($.type===w.TAG_CLOSE&&"<"===$.opened.text[0]&&"/"!==$.text[0]){var U=$.opened.text.substr(1).toLowerCase();if("script"===U||"style"===U){var ie=this._read_comment_or_cdata(Z);if(ie)return ie.type=w.TEXT,ie;B=this._input.readUntil(new RegExp("</"+U+"[\\n\\r\\t ]*?>","ig"))}else this._is_content_unformatted(U)&&(B=this._input.readUntil(new RegExp("</"+U+"[\\n\\r\\t ]*?>","ig")))}return B?this._create_token(w.TEXT,B):null},j.prototype._read_content_word=function(Z,$){var N="";if(this._options.unformatted_content_delimiter&&Z===this._options.unformatted_content_delimiter[0]&&(N=this.__patterns.unformatted_content_delimiter.read()),N||(N=$&&$.type===w.CONTROL_FLOW_OPEN?this.__patterns.word_control_flow_close_excluded.read():this.__patterns.word.read()),N)return this._create_token(w.TEXT,N)},D.exports.Tokenizer=j,D.exports.TOKEN=w}],te={},F=function z(D){var g=te[D];if(void 0!==g)return g.exports;var _=te[D]={exports:{}};return Oe[D](_,_.exports,z),_.exports}(18);Te=F}();var Ne=Te;xe=[it,it(405),it(7)],void 0!==(ve=function(Oe){var te=it(405),z=it(7);return{html_beautify:function(F,D){return Ne(F,D,te.js_beautify,z.css_beautify)}}}.apply(Wt,xe))&&(Tt.exports=ve)}()},405:(Tt,Wt)=>{var xe;!function(){var ve;!function(){"use strict";var Ne=[function(te,z,F){var D=F(1).Beautifier,g=F(5).Options;te.exports=function _(E,y){return new D(E,y).beautify()},te.exports.defaultOptions=function(){return new g}},function(te,z,F){var D=F(2).Output,g=F(3).Token,_=F(4),E=F(5).Options,y=F(7).Tokenizer,A=F(7).line_starters,x=F(7).positionable_operators,M=F(7).TOKEN;function w(S,Q){return-1!==Q.indexOf(S)}function P(S){return S.replace(/^\s+/g,"")}function Z(S,Q){return S&&S.type===M.RESERVED&&S.text===Q}function $(S,Q){return S&&S.type===M.RESERVED&&w(S.text,Q)}var N=["case","return","do","if","throw","else","await","break","continue","async"],U=function j(S){for(var Q={},re=0;re<S.length;re++)Q[S[re].replace(/-/g,"_")]=S[re];return Q}(["before-newline","after-newline","preserve-newline"]),ie=[U.before_newline,U.preserve_newline];function ut(S,Q){Q.multiline_frame||"ForInitializer"===Q.mode||"Conditional"===Q.mode||S.remove_indent(Q.start_line_index)}function O(S){return"ArrayLiteral"===S}function K(S){return w(S,["Expression","ForInitializer","Conditional"])}function q(S,Q){Q=Q||{},this._source_text=S||"",this._output=null,this._tokens=null,this._last_last_text=null,this._flags=null,this._previous_flags=null,this._flag_store=null,this._options=new E(Q)}q.prototype.create_flags=function(S,Q){var re=0;return S&&(re=S.indentation_level,!this._output.just_added_newline()&&S.line_indent_level>re&&(re=S.line_indent_level)),{mode:Q,parent:S,last_token:S?S.last_token:new g(M.START_BLOCK,""),last_word:S?S.last_word:"",declaration_statement:!1,declaration_assignment:!1,multiline_frame:!1,inline_frame:!1,if_block:!1,else_block:!1,class_start_block:!1,do_block:!1,do_while:!1,import_block:!1,in_case_statement:!1,in_case:!1,case_body:!1,case_block:!1,indentation_level:re,alignment:0,line_indent_level:S?S.line_indent_level:re,start_line_index:this._output.get_line_number(),ternary_depth:0}},q.prototype._reset=function(S){var Q=S.match(/^[\t ]*/)[0];this._last_last_text="",this._output=new D(this._options,Q),this._output.raw=this._options.test_output_raw,this._flag_store=[],this.set_mode("BlockStatement");var re=new y(S,this._options);return this._tokens=re.tokenize(),S},q.prototype.beautify=function(){if(this._options.disabled)return this._source_text;var Q=this._reset(this._source_text),re=this._options.eol;"auto"===this._options.eol&&(re="\n",Q&&_.lineBreak.test(Q||"")&&(re=Q.match(_.lineBreak)[0]));for(var ke=this._tokens.next();ke;)this.handle_token(ke),this._last_last_text=this._flags.last_token.text,this._flags.last_token=ke,ke=this._tokens.next();return this._output.get_code(re)},q.prototype.handle_token=function(S,Q){S.type===M.START_EXPR?this.handle_start_expr(S):S.type===M.END_EXPR?this.handle_end_expr(S):S.type===M.START_BLOCK?this.handle_start_block(S):S.type===M.END_BLOCK?this.handle_end_block(S):S.type===M.WORD||S.type===M.RESERVED?this.handle_word(S):S.type===M.SEMICOLON?this.handle_semicolon(S):S.type===M.STRING?this.handle_string(S):S.type===M.EQUALS?this.handle_equals(S):S.type===M.OPERATOR?this.handle_operator(S):S.type===M.COMMA?this.handle_comma(S):S.type===M.BLOCK_COMMENT?this.handle_block_comment(S,Q):S.type===M.COMMENT?this.handle_comment(S,Q):S.type===M.DOT?this.handle_dot(S):S.type===M.EOF?this.handle_eof(S):this.handle_unknown(S,Q)},q.prototype.handle_whitespace_and_comments=function(S,Q){var re=S.newlines,ke=this._options.keep_array_indentation&&O(this._flags.mode);if(S.comments_before)for(var Ye=S.comments_before.next();Ye;)this.handle_whitespace_and_comments(Ye,Q),this.handle_token(Ye,Q),Ye=S.comments_before.next();if(ke)for(var Yt=0;Yt<re;Yt+=1)this.print_newline(Yt>0,Q);else if(this._options.max_preserve_newlines&&re>this._options.max_preserve_newlines&&(re=this._options.max_preserve_newlines),this._options.preserve_newlines&&re>1){this.print_newline(!1,Q);for(var qt=1;qt<re;qt+=1)this.print_newline(!0,Q)}};var fe=["async","break","continue","return","throw","yield"];q.prototype.allow_wrap_or_preserved_newline=function(S,Q){if(Q=void 0!==Q&&Q,!this._output.just_added_newline()){var re=this._options.preserve_newlines&&S.newlines||Q;if(w(this._flags.last_token.text,x)||w(S.text,x)){var Ye=w(this._flags.last_token.text,x)&&w(this._options.operator_position,ie)||w(S.text,x);re=re&&Ye}if(re)this.print_newline(!1,!0);else if(this._options.wrap_line_length){if($(this._flags.last_token,fe))return;this._output.set_wrap_point()}}},q.prototype.print_newline=function(S,Q){if(!Q&&";"!==this._flags.last_token.text&&","!==this._flags.last_token.text&&"="!==this._flags.last_token.text&&(this._flags.last_token.type!==M.OPERATOR||"--"===this._flags.last_token.text||"++"===this._flags.last_token.text))for(var re=this._tokens.peek();!("Statement"!==this._flags.mode||this._flags.if_block&&Z(re,"else")||this._flags.do_block);)this.restore_mode();this._output.add_new_line(S)&&(this._flags.multiline_frame=!0)},q.prototype.print_token_line_indentation=function(S){this._output.just_added_newline()&&(this._options.keep_array_indentation&&S.newlines&&("["===S.text||O(this._flags.mode))?(this._output.current_line.set_indent(-1),this._output.current_line.push(S.whitespace_before),this._output.space_before_token=!1):this._output.set_indent(this._flags.indentation_level,this._flags.alignment)&&(this._flags.line_indent_level=this._flags.indentation_level))},q.prototype.print_token=function(S){if(this._output.raw)this._output.add_raw_token(S);else{if(this._options.comma_first&&S.previous&&S.previous.type===M.COMMA&&this._output.just_added_newline()&&","===this._output.previous_line.last()){var Q=this._output.previous_line.pop();this._output.previous_line.is_empty()&&(this._output.previous_line.push(Q),this._output.trim(!0),this._output.current_line.pop(),this._output.trim()),this.print_token_line_indentation(S),this._output.add_token(","),this._output.space_before_token=!0}this.print_token_line_indentation(S),this._output.non_breaking_space=!0,this._output.add_token(S.text),this._output.previous_token_wrapped&&(this._flags.multiline_frame=!0)}},q.prototype.indent=function(){this._flags.indentation_level+=1,this._output.set_indent(this._flags.indentation_level,this._flags.alignment)},q.prototype.deindent=function(){this._flags.indentation_level>0&&(!this._flags.parent||this._flags.indentation_level>this._flags.parent.indentation_level)&&(this._flags.indentation_level-=1,this._output.set_indent(this._flags.indentation_level,this._flags.alignment))},q.prototype.set_mode=function(S){this._flags?(this._flag_store.push(this._flags),this._previous_flags=this._flags):this._previous_flags=this.create_flags(null,S),this._flags=this.create_flags(this._previous_flags,S),this._output.set_indent(this._flags.indentation_level,this._flags.alignment)},q.prototype.restore_mode=function(){this._flag_store.length>0&&(this._previous_flags=this._flags,this._flags=this._flag_store.pop(),"Statement"===this._previous_flags.mode&&ut(this._output,this._previous_flags),this._output.set_indent(this._flags.indentation_level,this._flags.alignment))},q.prototype.start_of_object_property=function(){return"ObjectLiteral"===this._flags.parent.mode&&"Statement"===this._flags.mode&&(":"===this._flags.last_token.text&&0===this._flags.ternary_depth||$(this._flags.last_token,["get","set"]))},q.prototype.start_of_statement=function(S){var Q=!1;return!!(Q=(Q=(Q=(Q=(Q=(Q=(Q=Q||$(this._flags.last_token,["var","let","const"])&&S.type===M.WORD)||Z(this._flags.last_token,"do"))||!("ObjectLiteral"===this._flags.parent.mode&&"Statement"===this._flags.mode)&&$(this._flags.last_token,fe)&&!S.newlines)||Z(this._flags.last_token,"else")&&!(Z(S,"if")&&!S.comments_before))||this._flags.last_token.type===M.END_EXPR&&("ForInitializer"===this._previous_flags.mode||"Conditional"===this._previous_flags.mode))||this._flags.last_token.type===M.WORD&&"BlockStatement"===this._flags.mode&&!this._flags.in_case&&!("--"===S.text||"++"===S.text)&&"function"!==this._last_last_text&&S.type!==M.WORD&&S.type!==M.RESERVED)||"ObjectLiteral"===this._flags.mode&&(":"===this._flags.last_token.text&&0===this._flags.ternary_depth||$(this._flags.last_token,["get","set"])))&&(this.set_mode("Statement"),this.indent(),this.handle_whitespace_and_comments(S,!0),this.start_of_object_property()||this.allow_wrap_or_preserved_newline(S,$(S,["do","for","if","while"])),!0)},q.prototype.handle_start_expr=function(S){this.start_of_statement(S)||this.handle_whitespace_and_comments(S);var Q="Expression";if("["===S.text){if(this._flags.last_token.type===M.WORD||")"===this._flags.last_token.text)return $(this._flags.last_token,A)&&(this._output.space_before_token=!0),this.print_token(S),this.set_mode(Q),this.indent(),void(this._options.space_in_paren&&(this._output.space_before_token=!0));Q="ArrayLiteral",O(this._flags.mode)&&("["===this._flags.last_token.text||","===this._flags.last_token.text&&("]"===this._last_last_text||"}"===this._last_last_text))&&(this._options.keep_array_indentation||this.print_newline()),w(this._flags.last_token.type,[M.START_EXPR,M.END_EXPR,M.WORD,M.OPERATOR,M.DOT])||(this._output.space_before_token=!0)}else{if(this._flags.last_token.type===M.RESERVED)"for"===this._flags.last_token.text?(this._output.space_before_token=this._options.space_before_conditional,Q="ForInitializer"):w(this._flags.last_token.text,["if","while","switch"])?(this._output.space_before_token=this._options.space_before_conditional,Q="Conditional"):w(this._flags.last_word,["await","async"])?this._output.space_before_token=!0:"import"===this._flags.last_token.text&&""===S.whitespace_before?this._output.space_before_token=!1:(w(this._flags.last_token.text,A)||"catch"===this._flags.last_token.text)&&(this._output.space_before_token=!0);else if(this._flags.last_token.type===M.EQUALS||this._flags.last_token.type===M.OPERATOR)this.start_of_object_property()||this.allow_wrap_or_preserved_newline(S);else if(this._flags.last_token.type===M.WORD){this._output.space_before_token=!1;var re=this._tokens.peek(-3);if(this._options.space_after_named_function&&re){var ke=this._tokens.peek(-4);$(re,["async","function"])||"*"===re.text&&$(ke,["async","function"])?this._output.space_before_token=!0:"ObjectLiteral"===this._flags.mode?("{"===re.text||","===re.text||"*"===re.text&&("{"===ke.text||","===ke.text))&&(this._output.space_before_token=!0):this._flags.parent&&this._flags.parent.class_start_block&&(this._output.space_before_token=!0)}}else this.allow_wrap_or_preserved_newline(S);(this._flags.last_token.type===M.RESERVED&&("function"===this._flags.last_word||"typeof"===this._flags.last_word)||"*"===this._flags.last_token.text&&(w(this._last_last_text,["function","yield"])||"ObjectLiteral"===this._flags.mode&&w(this._last_last_text,["{",","])))&&(this._output.space_before_token=this._options.space_after_anon_function)}";"===this._flags.last_token.text||this._flags.last_token.type===M.START_BLOCK?this.print_newline():(this._flags.last_token.type===M.END_EXPR||this._flags.last_token.type===M.START_EXPR||this._flags.last_token.type===M.END_BLOCK||"."===this._flags.last_token.text||this._flags.last_token.type===M.COMMA)&&this.allow_wrap_or_preserved_newline(S,S.newlines),this.print_token(S),this.set_mode(Q),this._options.space_in_paren&&(this._output.space_before_token=!0),this.indent()},q.prototype.handle_end_expr=function(S){for(;"Statement"===this._flags.mode;)this.restore_mode();this.handle_whitespace_and_comments(S),this._flags.multiline_frame&&this.allow_wrap_or_preserved_newline(S,"]"===S.text&&O(this._flags.mode)&&!this._options.keep_array_indentation),this._options.space_in_paren&&(this._flags.last_token.type!==M.START_EXPR||this._options.space_in_empty_paren?this._output.space_before_token=!0:(this._output.trim(),this._output.space_before_token=!1)),this.deindent(),this.print_token(S),this.restore_mode(),ut(this._output,this._previous_flags),this._flags.do_while&&"Conditional"===this._previous_flags.mode&&(this._previous_flags.mode="Expression",this._flags.do_block=!1,this._flags.do_while=!1)},q.prototype.handle_start_block=function(S){this.handle_whitespace_and_comments(S);var Q=this._tokens.peek(),re=this._tokens.peek(1);"switch"===this._flags.last_word&&this._flags.last_token.type===M.END_EXPR?(this.set_mode("BlockStatement"),this._flags.in_case_statement=!0):this._flags.case_body?this.set_mode("BlockStatement"):re&&(w(re.text,[":",","])&&w(Q.type,[M.STRING,M.WORD,M.RESERVED])||w(Q.text,["get","set","..."])&&w(re.type,[M.WORD,M.RESERVED]))?w(this._last_last_text,["class","interface"])&&!w(re.text,[":",","])?this.set_mode("BlockStatement"):this.set_mode("ObjectLiteral"):this._flags.last_token.type===M.OPERATOR&&"=>"===this._flags.last_token.text?this.set_mode("BlockStatement"):w(this._flags.last_token.type,[M.EQUALS,M.START_EXPR,M.COMMA,M.OPERATOR])||$(this._flags.last_token,["return","throw","import","default"])?this.set_mode("ObjectLiteral"):this.set_mode("BlockStatement"),this._flags.last_token&&$(this._flags.last_token.previous,["class","extends"])&&(this._flags.class_start_block=!0);var ke=!Q.comments_before&&"}"===Q.text,Ye=ke&&"function"===this._flags.last_word&&this._flags.last_token.type===M.END_EXPR;if(this._options.brace_preserve_inline){var Yt=0,qt=null;this._flags.inline_frame=!0;do{if((qt=this._tokens.peek((Yt+=1)-1)).newlines){this._flags.inline_frame=!1;break}}while(qt.type!==M.EOF&&(qt.type!==M.END_BLOCK||qt.opened!==S))}("expand"===this._options.brace_style||"none"===this._options.brace_style&&S.newlines)&&!this._flags.inline_frame?this._flags.last_token.type!==M.OPERATOR&&(Ye||this._flags.last_token.type===M.EQUALS||$(this._flags.last_token,N)&&"else"!==this._flags.last_token.text)?this._output.space_before_token=!0:this.print_newline(!1,!0):(O(this._previous_flags.mode)&&(this._flags.last_token.type===M.START_EXPR||this._flags.last_token.type===M.COMMA)&&((this._flags.last_token.type===M.COMMA||this._options.space_in_paren)&&(this._output.space_before_token=!0),(this._flags.last_token.type===M.COMMA||this._flags.last_token.type===M.START_EXPR&&this._flags.inline_frame)&&(this.allow_wrap_or_preserved_newline(S),this._previous_flags.multiline_frame=this._previous_flags.multiline_frame||this._flags.multiline_frame,this._flags.multiline_frame=!1)),this._flags.last_token.type!==M.OPERATOR&&this._flags.last_token.type!==M.START_EXPR&&(w(this._flags.last_token.type,[M.START_BLOCK,M.SEMICOLON])&&!this._flags.inline_frame?this.print_newline():this._output.space_before_token=!0)),this.print_token(S),this.indent(),!ke&&(!this._options.brace_preserve_inline||!this._flags.inline_frame)&&this.print_newline()},q.prototype.handle_end_block=function(S){for(this.handle_whitespace_and_comments(S);"Statement"===this._flags.mode;)this.restore_mode();var Q=this._flags.last_token.type===M.START_BLOCK;this._flags.inline_frame&&!Q?this._output.space_before_token=!0:"expand"===this._options.brace_style?Q||this.print_newline():Q||(O(this._flags.mode)&&this._options.keep_array_indentation?(this._options.keep_array_indentation=!1,this.print_newline(),this._options.keep_array_indentation=!0):this.print_newline()),this.restore_mode(),this.print_token(S)},q.prototype.handle_word=function(S){if(S.type===M.RESERVED&&(w(S.text,["set","get"])&&"ObjectLiteral"!==this._flags.mode||"import"===S.text&&w(this._tokens.peek().text,["(","."])||w(S.text,["as","from"])&&!this._flags.import_block||"ObjectLiteral"===this._flags.mode&&":"===this._tokens.peek().text)&&(S.type=M.WORD),this.start_of_statement(S)?$(this._flags.last_token,["var","let","const"])&&S.type===M.WORD&&(this._flags.declaration_statement=!0):!S.newlines||K(this._flags.mode)||this._flags.last_token.type===M.OPERATOR&&"--"!==this._flags.last_token.text&&"++"!==this._flags.last_token.text||this._flags.last_token.type===M.EQUALS||!this._options.preserve_newlines&&$(this._flags.last_token,["var","let","const","set","get"])?this.handle_whitespace_and_comments(S):(this.handle_whitespace_and_comments(S),this.print_newline()),this._flags.do_block&&!this._flags.do_while){if(Z(S,"while"))return this._output.space_before_token=!0,this.print_token(S),this._output.space_before_token=!0,void(this._flags.do_while=!0);this.print_newline(),this._flags.do_block=!1}if(this._flags.if_block)if(!this._flags.else_block&&Z(S,"else"))this._flags.else_block=!0;else{for(;"Statement"===this._flags.mode;)this.restore_mode();this._flags.if_block=!1,this._flags.else_block=!1}if(this._flags.in_case_statement&&$(S,["case","default"]))return this.print_newline(),!this._flags.case_block&&(this._flags.case_body||this._options.jslint_happy)&&this.deindent(),this._flags.case_body=!1,this.print_token(S),void(this._flags.in_case=!0);if((this._flags.last_token.type===M.COMMA||this._flags.last_token.type===M.START_EXPR||this._flags.last_token.type===M.EQUALS||this._flags.last_token.type===M.OPERATOR)&&!this.start_of_object_property()&&!(w(this._flags.last_token.text,["+","-"])&&":"===this._last_last_text&&"ObjectLiteral"===this._flags.parent.mode)&&this.allow_wrap_or_preserved_newline(S),Z(S,"function"))return(w(this._flags.last_token.text,["}",";"])||this._output.just_added_newline()&&!(w(this._flags.last_token.text,["(","[","{",":","=",","])||this._flags.last_token.type===M.OPERATOR))&&!this._output.just_added_blankline()&&!S.comments_before&&(this.print_newline(),this.print_newline(!0)),this._flags.last_token.type===M.RESERVED||this._flags.last_token.type===M.WORD?$(this._flags.last_token,["get","set","new","export"])||$(this._flags.last_token,fe)||Z(this._flags.last_token,"default")&&"export"===this._last_last_text||"declare"===this._flags.last_token.text?this._output.space_before_token=!0:this.print_newline():this._flags.last_token.type===M.OPERATOR||"="===this._flags.last_token.text?this._output.space_before_token=!0:!this._flags.multiline_frame&&(K(this._flags.mode)||O(this._flags.mode))||this.print_newline(),this.print_token(S),void(this._flags.last_word=S.text);var re="NONE";this._flags.last_token.type===M.END_BLOCK?this._previous_flags.inline_frame?re="SPACE":$(S,["else","catch","finally","from"])?"expand"===this._options.brace_style||"end-expand"===this._options.brace_style||"none"===this._options.brace_style&&S.newlines?re="NEWLINE":(re="SPACE",this._output.space_before_token=!0):re="NEWLINE":this._flags.last_token.type===M.SEMICOLON&&"BlockStatement"===this._flags.mode?re="NEWLINE":this._flags.last_token.type===M.SEMICOLON&&K(this._flags.mode)?re="SPACE":this._flags.last_token.type===M.STRING?re="NEWLINE":this._flags.last_token.type===M.RESERVED||this._flags.last_token.type===M.WORD||"*"===this._flags.last_token.text&&(w(this._last_last_text,["function","yield"])||"ObjectLiteral"===this._flags.mode&&w(this._last_last_text,["{",","]))?re="SPACE":this._flags.last_token.type===M.START_BLOCK?re=this._flags.inline_frame?"SPACE":"NEWLINE":this._flags.last_token.type===M.END_EXPR&&(this._output.space_before_token=!0,re="NEWLINE"),$(S,A)&&")"!==this._flags.last_token.text&&(re=this._flags.inline_frame||"else"===this._flags.last_token.text||"export"===this._flags.last_token.text?"SPACE":"NEWLINE"),$(S,["else","catch","finally"])?(this._flags.last_token.type!==M.END_BLOCK||"BlockStatement"!==this._previous_flags.mode||"expand"===this._options.brace_style||"end-expand"===this._options.brace_style||"none"===this._options.brace_style&&S.newlines)&&!this._flags.inline_frame?this.print_newline():(this._output.trim(!0),"}"!==this._output.current_line.last()&&this.print_newline(),this._output.space_before_token=!0):"NEWLINE"===re?$(this._flags.last_token,N)||"declare"===this._flags.last_token.text&&$(S,["var","let","const"])?this._output.space_before_token=!0:this._flags.last_token.type!==M.END_EXPR?(this._flags.last_token.type!==M.START_EXPR||!$(S,["var","let","const"]))&&":"!==this._flags.last_token.text&&(Z(S,"if")&&Z(S.previous,"else")?this._output.space_before_token=!0:this.print_newline()):$(S,A)&&")"!==this._flags.last_token.text&&this.print_newline():this._flags.multiline_frame&&O(this._flags.mode)&&","===this._flags.last_token.text&&"}"===this._last_last_text?this.print_newline():"SPACE"===re&&(this._output.space_before_token=!0),S.previous&&(S.previous.type===M.WORD||S.previous.type===M.RESERVED)&&(this._output.space_before_token=!0),this.print_token(S),this._flags.last_word=S.text,S.type===M.RESERVED&&("do"===S.text?this._flags.do_block=!0:"if"===S.text?this._flags.if_block=!0:"import"===S.text?this._flags.import_block=!0:this._flags.import_block&&Z(S,"from")&&(this._flags.import_block=!1))},q.prototype.handle_semicolon=function(S){this.start_of_statement(S)?this._output.space_before_token=!1:this.handle_whitespace_and_comments(S);for(var Q=this._tokens.peek();!("Statement"!==this._flags.mode||this._flags.if_block&&Z(Q,"else")||this._flags.do_block);)this.restore_mode();this._flags.import_block&&(this._flags.import_block=!1),this.print_token(S)},q.prototype.handle_string=function(S){S.text.startsWith("`")&&0===S.newlines&&""===S.whitespace_before&&(")"===S.previous.text||this._flags.last_token.type===M.WORD)||(this.start_of_statement(S)?this._output.space_before_token=!0:(this.handle_whitespace_and_comments(S),this._flags.last_token.type===M.RESERVED||this._flags.last_token.type===M.WORD||this._flags.inline_frame?this._output.space_before_token=!0:this._flags.last_token.type===M.COMMA||this._flags.last_token.type===M.START_EXPR||this._flags.last_token.type===M.EQUALS||this._flags.last_token.type===M.OPERATOR?this.start_of_object_property()||this.allow_wrap_or_preserved_newline(S):!S.text.startsWith("`")||this._flags.last_token.type!==M.END_EXPR||"]"!==S.previous.text&&")"!==S.previous.text||0!==S.newlines?this.print_newline():this._output.space_before_token=!0)),this.print_token(S)},q.prototype.handle_equals=function(S){this.start_of_statement(S)||this.handle_whitespace_and_comments(S),this._flags.declaration_statement&&(this._flags.declaration_assignment=!0),this._output.space_before_token=!0,this.print_token(S),this._output.space_before_token=!0},q.prototype.handle_comma=function(S){this.handle_whitespace_and_comments(S,!0),this.print_token(S),this._output.space_before_token=!0,this._flags.declaration_statement?(K(this._flags.parent.mode)&&(this._flags.declaration_assignment=!1),this._flags.declaration_assignment?(this._flags.declaration_assignment=!1,this.print_newline(!1,!0)):this._options.comma_first&&this.allow_wrap_or_preserved_newline(S)):"ObjectLiteral"===this._flags.mode||"Statement"===this._flags.mode&&"ObjectLiteral"===this._flags.parent.mode?("Statement"===this._flags.mode&&this.restore_mode(),this._flags.inline_frame||this.print_newline()):this._options.comma_first&&this.allow_wrap_or_preserved_newline(S)},q.prototype.handle_operator=function(S){var Q="*"===S.text&&($(this._flags.last_token,["function","yield"])||w(this._flags.last_token.type,[M.START_BLOCK,M.COMMA,M.END_BLOCK,M.SEMICOLON])),re=w(S.text,["-","+"])&&(w(this._flags.last_token.type,[M.START_BLOCK,M.START_EXPR,M.EQUALS,M.OPERATOR])||w(this._flags.last_token.text,A)||","===this._flags.last_token.text);if(this.start_of_statement(S)||this.handle_whitespace_and_comments(S,!Q),"*"!==S.text||this._flags.last_token.type!==M.DOT)if("::"!==S.text)if(w(S.text,["-","+"])&&this.start_of_object_property())this.print_token(S);else{if(this._flags.last_token.type===M.OPERATOR&&w(this._options.operator_position,ie)&&this.allow_wrap_or_preserved_newline(S),":"===S.text&&this._flags.in_case)return this.print_token(S),this._flags.in_case=!1,this._flags.case_body=!0,void(this._tokens.peek().type!==M.START_BLOCK?(this.indent(),this.print_newline(),this._flags.case_block=!1):(this._flags.case_block=!0,this._output.space_before_token=!0));var Ye=!0,Yt=!0,qt=!1;if(":"===S.text?0===this._flags.ternary_depth?Ye=!1:(this._flags.ternary_depth-=1,qt=!0):"?"===S.text&&(this._flags.ternary_depth+=1),!re&&!Q&&this._options.preserve_newlines&&w(S.text,x)){var xt=":"===S.text,Vn=xt&&qt,St=xt&&!qt;switch(this._options.operator_position){case U.before_newline:return this._output.space_before_token=!St,this.print_token(S),(!xt||Vn)&&this.allow_wrap_or_preserved_newline(S),void(this._output.space_before_token=!0);case U.after_newline:return this._output.space_before_token=!0,!xt||Vn?this._tokens.peek().newlines?this.print_newline(!1,!0):this.allow_wrap_or_preserved_newline(S):this._output.space_before_token=!1,this.print_token(S),void(this._output.space_before_token=!0);case U.preserve_newline:return St||this.allow_wrap_or_preserved_newline(S),Ye=!(this._output.just_added_newline()||St),this._output.space_before_token=Ye,this.print_token(S),void(this._output.space_before_token=!0)}}if(Q){this.allow_wrap_or_preserved_newline(S),Ye=!1;var yn=this._tokens.peek();Yt=yn&&w(yn.type,[M.WORD,M.RESERVED])}else if("..."===S.text)this.allow_wrap_or_preserved_newline(S),Ye=this._flags.last_token.type===M.START_BLOCK,Yt=!1;else if(w(S.text,["--","++","!","~"])||re){if((this._flags.last_token.type===M.COMMA||this._flags.last_token.type===M.START_EXPR)&&this.allow_wrap_or_preserved_newline(S),Ye=!1,Yt=!1,S.newlines&&("--"===S.text||"++"===S.text||"~"===S.text)){var cs=$(this._flags.last_token,N)&&S.newlines;cs&&(this._previous_flags.if_block||this._previous_flags.else_block)&&this.restore_mode(),this.print_newline(cs,!0)}";"===this._flags.last_token.text&&K(this._flags.mode)&&(Ye=!0),this._flags.last_token.type===M.RESERVED?Ye=!0:this._flags.last_token.type===M.END_EXPR?Ye=!("]"===this._flags.last_token.text&&("--"===S.text||"++"===S.text)):this._flags.last_token.type===M.OPERATOR&&(Ye=w(S.text,["--","-","++","+"])&&w(this._flags.last_token.text,["--","-","++","+"]),w(S.text,["+","-"])&&w(this._flags.last_token.text,["--","++"])&&(Yt=!0)),("BlockStatement"===this._flags.mode&&!this._flags.inline_frame||"Statement"===this._flags.mode)&&("{"===this._flags.last_token.text||";"===this._flags.last_token.text)&&this.print_newline()}this._output.space_before_token=this._output.space_before_token||Ye,this.print_token(S),this._output.space_before_token=Yt}else this.print_token(S);else this.print_token(S)},q.prototype.handle_block_comment=function(S,Q){return this._output.raw?(this._output.add_raw_token(S),void(S.directives&&"end"===S.directives.preserve&&(this._output.raw=this._options.test_output_raw))):S.directives?(this.print_newline(!1,Q),this.print_token(S),"start"===S.directives.preserve&&(this._output.raw=!0),void this.print_newline(!1,!0)):_.newline.test(S.text)||S.newlines?void this.print_block_commment(S,Q):(this._output.space_before_token=!0,this.print_token(S),void(this._output.space_before_token=!0))},q.prototype.print_block_commment=function(S,Q){var ke,re=function V(S){for(var Q=[],re=(S=S.replace(_.allLineBreaks,"\n")).indexOf("\n");-1!==re;)Q.push(S.substring(0,re)),re=(S=S.substring(re+1)).indexOf("\n");return S.length&&Q.push(S),Q}(S.text),Ye=!1,Yt=!1,qt=S.whitespace_before,xt=qt.length;if(this.print_newline(!1,Q),this.print_token_line_indentation(S),this._output.add_token(re[0]),this.print_newline(!1,Q),re.length>1){for(Ye=function X(S,Q){for(var re=0;re<S.length;re++)if(S[re].trim().charAt(0)!==Q)return!1;return!0}(re=re.slice(1),"*"),Yt=function J(S,Q){for(var Ye,re=0,ke=S.length;re<ke;re++)if((Ye=S[re])&&0!==Ye.indexOf(Q))return!1;return!0}(re,qt),Ye&&(this._flags.alignment=1),ke=0;ke<re.length;ke++)Ye?(this.print_token_line_indentation(S),this._output.add_token(P(re[ke]))):Yt&&re[ke]?(this.print_token_line_indentation(S),this._output.add_token(re[ke].substring(xt))):(this._output.current_line.set_indent(-1),this._output.add_token(re[ke])),this.print_newline(!1,Q);this._flags.alignment=0}},q.prototype.handle_comment=function(S,Q){S.newlines?this.print_newline(!1,Q):this._output.trim(!0),this._output.space_before_token=!0,this.print_token(S),this.print_newline(!1,Q)},q.prototype.handle_dot=function(S){this.start_of_statement(S)||this.handle_whitespace_and_comments(S,!0),this._flags.last_token.text.match("^[0-9]+$")&&(this._output.space_before_token=!0),$(this._flags.last_token,N)?this._output.space_before_token=!1:this.allow_wrap_or_preserved_newline(S,")"===this._flags.last_token.text&&this._options.break_chained_methods),this._options.unindent_chained_methods&&this._output.just_added_newline()&&this.deindent(),this.print_token(S)},q.prototype.handle_unknown=function(S,Q){this.print_token(S),"\n"===S.text[S.text.length-1]&&this.print_newline(!1,Q)},q.prototype.handle_eof=function(S){for(;"Statement"===this._flags.mode;)this.restore_mode();this.handle_whitespace_and_comments(S)},te.exports.Beautifier=q},function(te){function z(g){this.__parent=g,this.__character_count=0,this.__indent_count=-1,this.__alignment_count=0,this.__wrap_point_index=0,this.__wrap_point_character_count=0,this.__wrap_point_indent_count=-1,this.__wrap_point_alignment_count=0,this.__items=[]}function F(g,_){this.__cache=[""],this.__indent_size=g.indent_size,this.__indent_string=g.indent_char,g.indent_with_tabs||(this.__indent_string=new Array(g.indent_size+1).join(g.indent_char)),_=_||"",g.indent_level>0&&(_=new Array(g.indent_level+1).join(this.__indent_string)),this.__base_string=_,this.__base_string_length=_.length}function D(g,_){this.__indent_cache=new F(g,_),this.raw=!1,this._end_with_newline=g.end_with_newline,this.indent_size=g.indent_size,this.wrap_line_length=g.wrap_line_length,this.indent_empty_lines=g.indent_empty_lines,this.__lines=[],this.previous_line=null,this.current_line=null,this.next_line=new z(this),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1,this.__add_outputline()}z.prototype.clone_empty=function(){var g=new z(this.__parent);return g.set_indent(this.__indent_count,this.__alignment_count),g},z.prototype.item=function(g){return g<0?this.__items[this.__items.length+g]:this.__items[g]},z.prototype.has_match=function(g){for(var _=this.__items.length-1;_>=0;_--)if(this.__items[_].match(g))return!0;return!1},z.prototype.set_indent=function(g,_){this.is_empty()&&(this.__indent_count=g||0,this.__alignment_count=_||0,this.__character_count=this.__parent.get_indent_size(this.__indent_count,this.__alignment_count))},z.prototype._set_wrap_point=function(){this.__parent.wrap_line_length&&(this.__wrap_point_index=this.__items.length,this.__wrap_point_character_count=this.__character_count,this.__wrap_point_indent_count=this.__parent.next_line.__indent_count,this.__wrap_point_alignment_count=this.__parent.next_line.__alignment_count)},z.prototype._should_wrap=function(){return this.__wrap_point_index&&this.__character_count>this.__parent.wrap_line_length&&this.__wrap_point_character_count>this.__parent.next_line.__character_count},z.prototype._allow_wrap=function(){if(this._should_wrap()){this.__parent.add_new_line();var g=this.__parent.current_line;return g.set_indent(this.__wrap_point_indent_count,this.__wrap_point_alignment_count),g.__items=this.__items.slice(this.__wrap_point_index),this.__items=this.__items.slice(0,this.__wrap_point_index),g.__character_count+=this.__character_count-this.__wrap_point_character_count,this.__character_count=this.__wrap_point_character_count," "===g.__items[0]&&(g.__items.splice(0,1),g.__character_count-=1),!0}return!1},z.prototype.is_empty=function(){return 0===this.__items.length},z.prototype.last=function(){return this.is_empty()?null:this.__items[this.__items.length-1]},z.prototype.push=function(g){this.__items.push(g);var _=g.lastIndexOf("\n");-1!==_?this.__character_count=g.length-_:this.__character_count+=g.length},z.prototype.pop=function(){var g=null;return this.is_empty()||(g=this.__items.pop(),this.__character_count-=g.length),g},z.prototype._remove_indent=function(){this.__indent_count>0&&(this.__indent_count-=1,this.__character_count-=this.__parent.indent_size)},z.prototype._remove_wrap_indent=function(){this.__wrap_point_indent_count>0&&(this.__wrap_point_indent_count-=1)},z.prototype.trim=function(){for(;" "===this.last();)this.__items.pop(),this.__character_count-=1},z.prototype.toString=function(){var g="";return this.is_empty()?this.__parent.indent_empty_lines&&(g=this.__parent.get_indent_string(this.__indent_count)):(g=this.__parent.get_indent_string(this.__indent_count,this.__alignment_count),g+=this.__items.join("")),g},F.prototype.get_indent_size=function(g,_){var E=this.__base_string_length;return g<0&&(E=0),(E+=g*this.__indent_size)+(_||0)},F.prototype.get_indent_string=function(g,_){var E=this.__base_string;return _=_||0,g<0&&(g=0,E=""),this.__ensure_cache(_+=g*this.__indent_size),E+this.__cache[_]},F.prototype.__ensure_cache=function(g){for(;g>=this.__cache.length;)this.__add_column()},F.prototype.__add_column=function(){var g=this.__cache.length,_=0,E="";this.__indent_size&&g>=this.__indent_size&&(g-=(_=Math.floor(g/this.__indent_size))*this.__indent_size,E=new Array(_+1).join(this.__indent_string)),g&&(E+=new Array(g+1).join(" ")),this.__cache.push(E)},D.prototype.__add_outputline=function(){this.previous_line=this.current_line,this.current_line=this.next_line.clone_empty(),this.__lines.push(this.current_line)},D.prototype.get_line_number=function(){return this.__lines.length},D.prototype.get_indent_string=function(g,_){return this.__indent_cache.get_indent_string(g,_)},D.prototype.get_indent_size=function(g,_){return this.__indent_cache.get_indent_size(g,_)},D.prototype.is_empty=function(){return!this.previous_line&&this.current_line.is_empty()},D.prototype.add_new_line=function(g){return!(this.is_empty()||!g&&this.just_added_newline()||(this.raw||this.__add_outputline(),0))},D.prototype.get_code=function(g){this.trim(!0);var _=this.current_line.pop();_&&("\n"===_[_.length-1]&&(_=_.replace(/\n+$/g,"")),this.current_line.push(_)),this._end_with_newline&&this.__add_outputline();var E=this.__lines.join("\n");return"\n"!==g&&(E=E.replace(/[\n]/g,g)),E},D.prototype.set_wrap_point=function(){this.current_line._set_wrap_point()},D.prototype.set_indent=function(g,_){return this.next_line.set_indent(g=g||0,_=_||0),this.__lines.length>1?(this.current_line.set_indent(g,_),!0):(this.current_line.set_indent(),!1)},D.prototype.add_raw_token=function(g){for(var _=0;_<g.newlines;_++)this.__add_outputline();this.current_line.set_indent(-1),this.current_line.push(g.whitespace_before),this.current_line.push(g.text),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1},D.prototype.add_token=function(g){this.__add_space_before_token(),this.current_line.push(g),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=this.current_line._allow_wrap()},D.prototype.__add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&(this.non_breaking_space||this.set_wrap_point(),this.current_line.push(" "))},D.prototype.remove_indent=function(g){for(var _=this.__lines.length;g<_;)this.__lines[g]._remove_indent(),g++;this.current_line._remove_wrap_indent()},D.prototype.trim=function(g){for(g=void 0!==g&&g,this.current_line.trim();g&&this.__lines.length>1&&this.current_line.is_empty();)this.__lines.pop(),this.current_line=this.__lines[this.__lines.length-1],this.current_line.trim();this.previous_line=this.__lines.length>1?this.__lines[this.__lines.length-2]:null},D.prototype.just_added_newline=function(){return this.current_line.is_empty()},D.prototype.just_added_blankline=function(){return this.is_empty()||this.current_line.is_empty()&&this.previous_line.is_empty()},D.prototype.ensure_empty_line_above=function(g,_){for(var E=this.__lines.length-2;E>=0;){var y=this.__lines[E];if(y.is_empty())break;if(0!==y.item(0).indexOf(g)&&y.item(-1)!==_){this.__lines.splice(E+1,0,new z(this)),this.previous_line=this.__lines[this.__lines.length-2];break}E--}},te.exports.Output=D},function(te){te.exports.Token=function z(F,D,g,_){this.type=F,this.text=D,this.comments_before=null,this.newlines=g||0,this.whitespace_before=_||"",this.parent=null,this.next=null,this.previous=null,this.opened=null,this.closed=null,this.directives=null}},function(te,z){var D="\\x24\\x30-\\x39\\x41-\\x5a\\x5f\\x61-\\x7a",g="\\xaa\\xb5\\xba\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u02c1\\u02c6-\\u02d1\\u02e0-\\u02e4\\u02ec\\u02ee\\u0370-\\u0374\\u0376\\u0377\\u037a-\\u037d\\u0386\\u0388-\\u038a\\u038c\\u038e-\\u03a1\\u03a3-\\u03f5\\u03f7-\\u0481\\u048a-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05d0-\\u05ea\\u05f0-\\u05f2\\u0620-\\u064a\\u066e\\u066f\\u0671-\\u06d3\\u06d5\\u06e5\\u06e6\\u06ee\\u06ef\\u06fa-\\u06fc\\u06ff\\u0710\\u0712-\\u072f\\u074d-\\u07a5\\u07b1\\u07ca-\\u07ea\\u07f4\\u07f5\\u07fa\\u0800-\\u0815\\u081a\\u0824\\u0828\\u0840-\\u0858\\u08a0\\u08a2-\\u08ac\\u0904-\\u0939\\u093d\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097f\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bd\\u09ce\\u09dc\\u09dd\\u09df-\\u09e1\\u09f0\\u09f1\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a59-\\u0a5c\\u0a5e\\u0a72-\\u0a74\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abd\\u0ad0\\u0ae0\\u0ae1\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3d\\u0b5c\\u0b5d\\u0b5f-\\u0b61\\u0b71\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bd0\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c33\\u0c35-\\u0c39\\u0c3d\\u0c58\\u0c59\\u0c60\\u0c61\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbd\\u0cde\\u0ce0\\u0ce1\\u0cf1\\u0cf2\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d\\u0d4e\\u0d60\\u0d61\\u0d7a-\\u0d7f\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0e01-\\u0e30\\u0e32\\u0e33\\u0e40-\\u0e46\\u0e81\\u0e82\\u0e84\\u0e87\\u0e88\\u0e8a\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5\\u0ea7\\u0eaa\\u0eab\\u0ead-\\u0eb0\\u0eb2\\u0eb3\\u0ebd\\u0ec0-\\u0ec4\\u0ec6\\u0edc-\\u0edf\\u0f00\\u0f40-\\u0f47\\u0f49-\\u0f6c\\u0f88-\\u0f8c\\u1000-\\u102a\\u103f\\u1050-\\u1055\\u105a-\\u105d\\u1061\\u1065\\u1066\\u106e-\\u1070\\u1075-\\u1081\\u108e\\u10a0-\\u10c5\\u10c7\\u10cd\\u10d0-\\u10fa\\u10fc-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u1380-\\u138f\\u13a0-\\u13f4\\u1401-\\u166c\\u166f-\\u167f\\u1681-\\u169a\\u16a0-\\u16ea\\u16ee-\\u16f0\\u1700-\\u170c\\u170e-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176c\\u176e-\\u1770\\u1780-\\u17b3\\u17d7\\u17dc\\u1820-\\u1877\\u1880-\\u18a8\\u18aa\\u18b0-\\u18f5\\u1900-\\u191c\\u1950-\\u196d\\u1970-\\u1974\\u1980-\\u19ab\\u19c1-\\u19c7\\u1a00-\\u1a16\\u1a20-\\u1a54\\u1aa7\\u1b05-\\u1b33\\u1b45-\\u1b4b\\u1b83-\\u1ba0\\u1bae\\u1baf\\u1bba-\\u1be5\\u1c00-\\u1c23\\u1c4d-\\u1c4f\\u1c5a-\\u1c7d\\u1ce9-\\u1cec\\u1cee-\\u1cf1\\u1cf5\\u1cf6\\u1d00-\\u1dbf\\u1e00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59\\u1f5b\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fbc\\u1fbe\\u1fc2-\\u1fc4\\u1fc6-\\u1fcc\\u1fd0-\\u1fd3\\u1fd6-\\u1fdb\\u1fe0-\\u1fec\\u1ff2-\\u1ff4\\u1ff6-\\u1ffc\\u2071\\u207f\\u2090-\\u209c\\u2102\\u2107\\u210a-\\u2113\\u2115\\u2119-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u212d\\u212f-\\u2139\\u213c-\\u213f\\u2145-\\u2149\\u214e\\u2160-\\u2188\\u2c00-\\u2c2e\\u2c30-\\u2c5e\\u2c60-\\u2ce4\\u2ceb-\\u2cee\\u2cf2\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\u2d30-\\u2d67\\u2d6f\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\u2e2f\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303c\\u3041-\\u3096\\u309d-\\u309f\\u30a1-\\u30fa\\u30fc-\\u30ff\\u3105-\\u312d\\u3131-\\u318e\\u31a0-\\u31ba\\u31f0-\\u31ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\ua000-\\ua48c\\ua4d0-\\ua4fd\\ua500-\\ua60c\\ua610-\\ua61f\\ua62a\\ua62b\\ua640-\\ua66e\\ua67f-\\ua697\\ua6a0-\\ua6ef\\ua717-\\ua71f\\ua722-\\ua788\\ua78b-\\ua78e\\ua790-\\ua793\\ua7a0-\\ua7aa\\ua7f8-\\ua801\\ua803-\\ua805\\ua807-\\ua80a\\ua80c-\\ua822\\ua840-\\ua873\\ua882-\\ua8b3\\ua8f2-\\ua8f7\\ua8fb\\ua90a-\\ua925\\ua930-\\ua946\\ua960-\\ua97c\\ua984-\\ua9b2\\ua9cf\\uaa00-\\uaa28\\uaa40-\\uaa42\\uaa44-\\uaa4b\\uaa60-\\uaa76\\uaa7a\\uaa80-\\uaaaf\\uaab1\\uaab5\\uaab6\\uaab9-\\uaabd\\uaac0\\uaac2\\uaadb-\\uaadd\\uaae0-\\uaaea\\uaaf2-\\uaaf4\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e\\uabc0-\\uabe2\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uf900-\\ufa6d\\ufa70-\\ufad9\\ufb00-\\ufb06\\ufb13-\\ufb17\\ufb1d\\ufb1f-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc",_="\\u0300-\\u036f\\u0483-\\u0487\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u0620-\\u0649\\u0672-\\u06d3\\u06e7-\\u06e8\\u06fb-\\u06fc\\u0730-\\u074a\\u0800-\\u0814\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0840-\\u0857\\u08e4-\\u08fe\\u0900-\\u0903\\u093a-\\u093c\\u093e-\\u094f\\u0951-\\u0957\\u0962-\\u0963\\u0966-\\u096f\\u0981-\\u0983\\u09bc\\u09be-\\u09c4\\u09c7\\u09c8\\u09d7\\u09df-\\u09e0\\u0a01-\\u0a03\\u0a3c\\u0a3e-\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a66-\\u0a71\\u0a75\\u0a81-\\u0a83\\u0abc\\u0abe-\\u0ac5\\u0ac7-\\u0ac9\\u0acb-\\u0acd\\u0ae2-\\u0ae3\\u0ae6-\\u0aef\\u0b01-\\u0b03\\u0b3c\\u0b3e-\\u0b44\\u0b47\\u0b48\\u0b4b-\\u0b4d\\u0b56\\u0b57\\u0b5f-\\u0b60\\u0b66-\\u0b6f\\u0b82\\u0bbe-\\u0bc2\\u0bc6-\\u0bc8\\u0bca-\\u0bcd\\u0bd7\\u0be6-\\u0bef\\u0c01-\\u0c03\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62-\\u0c63\\u0c66-\\u0c6f\\u0c82\\u0c83\\u0cbc\\u0cbe-\\u0cc4\\u0cc6-\\u0cc8\\u0cca-\\u0ccd\\u0cd5\\u0cd6\\u0ce2-\\u0ce3\\u0ce6-\\u0cef\\u0d02\\u0d03\\u0d46-\\u0d48\\u0d57\\u0d62-\\u0d63\\u0d66-\\u0d6f\\u0d82\\u0d83\\u0dca\\u0dcf-\\u0dd4\\u0dd6\\u0dd8-\\u0ddf\\u0df2\\u0df3\\u0e34-\\u0e3a\\u0e40-\\u0e45\\u0e50-\\u0e59\\u0eb4-\\u0eb9\\u0ec8-\\u0ecd\\u0ed0-\\u0ed9\\u0f18\\u0f19\\u0f20-\\u0f29\\u0f35\\u0f37\\u0f39\\u0f41-\\u0f47\\u0f71-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u1000-\\u1029\\u1040-\\u1049\\u1067-\\u106d\\u1071-\\u1074\\u1082-\\u108d\\u108f-\\u109d\\u135d-\\u135f\\u170e-\\u1710\\u1720-\\u1730\\u1740-\\u1750\\u1772\\u1773\\u1780-\\u17b2\\u17dd\\u17e0-\\u17e9\\u180b-\\u180d\\u1810-\\u1819\\u1920-\\u192b\\u1930-\\u193b\\u1951-\\u196d\\u19b0-\\u19c0\\u19c8-\\u19c9\\u19d0-\\u19d9\\u1a00-\\u1a15\\u1a20-\\u1a53\\u1a60-\\u1a7c\\u1a7f-\\u1a89\\u1a90-\\u1a99\\u1b46-\\u1b4b\\u1b50-\\u1b59\\u1b6b-\\u1b73\\u1bb0-\\u1bb9\\u1be6-\\u1bf3\\u1c00-\\u1c22\\u1c40-\\u1c49\\u1c5b-\\u1c7d\\u1cd0-\\u1cd2\\u1d00-\\u1dbe\\u1e01-\\u1f15\\u200c\\u200d\\u203f\\u2040\\u2054\\u20d0-\\u20dc\\u20e1\\u20e5-\\u20f0\\u2d81-\\u2d96\\u2de0-\\u2dff\\u3021-\\u3028\\u3099\\u309a\\ua640-\\ua66d\\ua674-\\ua67d\\ua69f\\ua6f0-\\ua6f1\\ua7f8-\\ua800\\ua806\\ua80b\\ua823-\\ua827\\ua880-\\ua881\\ua8b4-\\ua8c4\\ua8d0-\\ua8d9\\ua8f3-\\ua8f7\\ua900-\\ua909\\ua926-\\ua92d\\ua930-\\ua945\\ua980-\\ua983\\ua9b3-\\ua9c0\\uaa00-\\uaa27\\uaa40-\\uaa41\\uaa4c-\\uaa4d\\uaa50-\\uaa59\\uaa7b\\uaae0-\\uaae9\\uaaf2-\\uaaf3\\uabc0-\\uabe1\\uabec\\uabed\\uabf0-\\uabf9\\ufb20-\\ufb28\\ufe00-\\ufe0f\\ufe20-\\ufe26\\ufe33\\ufe34\\ufe4d-\\ufe4f\\uff10-\\uff19\\uff3f",E="\\\\u[0-9a-fA-F]{4}|\\\\u\\{[0-9a-fA-F]+\\}",y="(?:"+E+"|[\\x23\\x24\\x40\\x41-\\x5a\\x5f\\x61-\\x7a"+g+"])";z.identifier=new RegExp(y+"(?:"+E+"|["+D+g+_+"])*","g"),z.identifierStart=new RegExp(y),z.identifierMatch=new RegExp("(?:"+E+"|["+D+g+_+"])+"),z.newline=/[\n\r\u2028\u2029]/,z.lineBreak=new RegExp("\r\n|"+z.newline.source),z.allLineBreaks=new RegExp(z.lineBreak.source,"g")},function(te,z,F){var D=F(6).Options,g=["before-newline","after-newline","preserve-newline"];function _(E){D.call(this,E,"js");var y=this.raw_options.brace_style||null;"expand-strict"===y?this.raw_options.brace_style="expand":"collapse-preserve-inline"===y?this.raw_options.brace_style="collapse,preserve-inline":void 0!==this.raw_options.braces_on_own_line&&(this.raw_options.brace_style=this.raw_options.braces_on_own_line?"expand":"collapse");var A=this._get_selection_list("brace_style",["collapse","expand","end-expand","none","preserve-inline"]);this.brace_preserve_inline=!1,this.brace_style="collapse";for(var x=0;x<A.length;x++)"preserve-inline"===A[x]?this.brace_preserve_inline=!0:this.brace_style=A[x];this.unindent_chained_methods=this._get_boolean("unindent_chained_methods"),this.break_chained_methods=this._get_boolean("break_chained_methods"),this.space_in_paren=this._get_boolean("space_in_paren"),this.space_in_empty_paren=this._get_boolean("space_in_empty_paren"),this.jslint_happy=this._get_boolean("jslint_happy"),this.space_after_anon_function=this._get_boolean("space_after_anon_function"),this.space_after_named_function=this._get_boolean("space_after_named_function"),this.keep_array_indentation=this._get_boolean("keep_array_indentation"),this.space_before_conditional=this._get_boolean("space_before_conditional",!0),this.unescape_strings=this._get_boolean("unescape_strings"),this.e4x=this._get_boolean("e4x"),this.comma_first=this._get_boolean("comma_first"),this.operator_position=this._get_selection("operator_position",g),this.test_output_raw=this._get_boolean("test_output_raw"),this.jslint_happy&&(this.space_after_anon_function=!0)}_.prototype=new D,te.exports.Options=_},function(te){function z(g,_){this.raw_options=F(g,_),this.disabled=this._get_boolean("disabled"),this.eol=this._get_characters("eol","auto"),this.end_with_newline=this._get_boolean("end_with_newline"),this.indent_size=this._get_number("indent_size",4),this.indent_char=this._get_characters("indent_char"," "),this.indent_level=this._get_number("indent_level"),this.preserve_newlines=this._get_boolean("preserve_newlines",!0),this.max_preserve_newlines=this._get_number("max_preserve_newlines",32786),this.preserve_newlines||(this.max_preserve_newlines=0),this.indent_with_tabs=this._get_boolean("indent_with_tabs","\t"===this.indent_char),this.indent_with_tabs&&(this.indent_char="\t",1===this.indent_size&&(this.indent_size=4)),this.wrap_line_length=this._get_number("wrap_line_length",this._get_number("max_char")),this.indent_empty_lines=this._get_boolean("indent_empty_lines"),this.templating=this._get_selection_list("templating",["auto","none","angular","django","erb","handlebars","php","smarty"],["auto"])}function F(g,_){var y,E={};for(y in g=D(g))y!==_&&(E[y]=g[y]);if(_&&g[_])for(y in g[_])E[y]=g[_][y];return E}function D(g){var E,_={};for(E in g)_[E.replace(/-/g,"_")]=g[E];return _}z.prototype._get_array=function(g,_){var E=this.raw_options[g],y=_||[];return"object"==typeof E?null!==E&&"function"==typeof E.concat&&(y=E.concat()):"string"==typeof E&&(y=E.split(/[^a-zA-Z0-9_\/\-]+/)),y},z.prototype._get_boolean=function(g,_){var E=this.raw_options[g];return void 0===E?!!_:!!E},z.prototype._get_characters=function(g,_){var E=this.raw_options[g],y=_||"";return"string"==typeof E&&(y=E.replace(/\\r/,"\r").replace(/\\n/,"\n").replace(/\\t/,"\t")),y},z.prototype._get_number=function(g,_){var E=this.raw_options[g];_=parseInt(_,10),isNaN(_)&&(_=0);var y=parseInt(E,10);return isNaN(y)&&(y=_),y},z.prototype._get_selection=function(g,_,E){var y=this._get_selection_list(g,_,E);if(1!==y.length)throw new Error("Invalid Option Value: The option '"+g+"' can only be one of the following values:\n"+_+"\nYou passed in: '"+this.raw_options[g]+"'");return y[0]},z.prototype._get_selection_list=function(g,_,E){if(!_||0===_.length)throw new Error("Selection list cannot be empty.");if(!this._is_valid_selection(E=E||[_[0]],_))throw new Error("Invalid Default Value!");var y=this._get_array(g,E);if(!this._is_valid_selection(y,_))throw new Error("Invalid Option Value: The option '"+g+"' can contain only the following values:\n"+_+"\nYou passed in: '"+this.raw_options[g]+"'");return y},z.prototype._is_valid_selection=function(g,_){return g.length&&_.length&&!g.some(function(E){return-1===_.indexOf(E)})},te.exports.Options=z,te.exports.normalizeOpts=D,te.exports.mergeOpts=F},function(te,z,F){var D=F(8).InputScanner,g=F(9).Tokenizer,_=F(9).TOKEN,E=F(13).Directives,y=F(4),A=F(12).Pattern,x=F(14).TemplatablePattern;function M(X,J){return-1!==J.indexOf(X)}var w={START_EXPR:"TK_START_EXPR",END_EXPR:"TK_END_EXPR",START_BLOCK:"TK_START_BLOCK",END_BLOCK:"TK_END_BLOCK",WORD:"TK_WORD",RESERVED:"TK_RESERVED",SEMICOLON:"TK_SEMICOLON",STRING:"TK_STRING",EQUALS:"TK_EQUALS",OPERATOR:"TK_OPERATOR",COMMA:"TK_COMMA",BLOCK_COMMENT:"TK_BLOCK_COMMENT",COMMENT:"TK_COMMENT",DOT:"TK_DOT",UNKNOWN:"TK_UNKNOWN",START:_.START,RAW:_.RAW,EOF:_.EOF},P=new E(/\/\*/,/\*\//),j=/0[xX][0123456789abcdefABCDEF_]*n?|0[oO][01234567_]*n?|0[bB][01_]*n?|\d[\d_]*n|(?:\.\d[\d_]*|\d[\d_]*\.?[\d_]*)(?:[eE][+-]?[\d_]+)?/,Z=/[0-9]/,$=/[^\d\.]/,N=">>> === !== &&= ??= ||= << && >= ** != == <= >> || ?? |> < / - + > : & % ? ^ | *".split(" "),B=">>>= ... >>= <<= === >>> !== **= &&= ??= ||= => ^= :: /= << <= == && -= >= >> != -- += ** || ?? ++ %= &= *= |= |> = ! ? > < : / ^ - + * & % ~ |";B=(B="\\?\\.(?!\\d) "+(B=B.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&"))).replace(/ /g,"|");var V,U=new RegExp(B),ie="continue,try,throw,return,var,let,const,if,switch,case,default,for,while,break,function,import,export".split(","),W=ie.concat(["do","in","of","else","get","set","new","catch","finally","typeof","yield","async","await","from","as","class","extends"]),ut=new RegExp("^(?:"+W.join("|")+")$"),O=function(X,J){g.call(this,X,J),this._patterns.whitespace=this._patterns.whitespace.matching(/\u00A0\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff/.source,/\u2028\u2029/.source);var q=new A(this._input),fe=new x(this._input).read_options(this._options);this.__patterns={template:fe,identifier:fe.starting_with(y.identifier).matching(y.identifierMatch),number:q.matching(j),punct:q.matching(U),comment:q.starting_with(/\/\//).until(/[\n\r\u2028\u2029]/),block_comment:q.starting_with(/\/\*/).until_after(/\*\//),html_comment_start:q.matching(/<!--/),html_comment_end:q.matching(/-->/),include:q.starting_with(/#include/).until_after(y.lineBreak),shebang:q.starting_with(/#!/).until_after(y.lineBreak),xml:q.matching(/[\s\S]*?<(\/?)([-a-zA-Z:0-9_.]+|{[^}]+?}|!\[CDATA\[[^\]]*?\]\]|)(\s*{[^}]+?}|\s+[-a-zA-Z:0-9_.]+|\s+[-a-zA-Z:0-9_.]+\s*=\s*('[^']*'|"[^"]*"|{([^{}]|{[^}]+?})+?}))*\s*(\/?)\s*>/),single_quote:fe.until(/['\\\n\r\u2028\u2029]/),double_quote:fe.until(/["\\\n\r\u2028\u2029]/),template_text:fe.until(/[`\\$]/),template_expression:fe.until(/[`}\\]/)}};(O.prototype=new g)._is_comment=function(X){return X.type===w.COMMENT||X.type===w.BLOCK_COMMENT||X.type===w.UNKNOWN},O.prototype._is_opening=function(X){return X.type===w.START_BLOCK||X.type===w.START_EXPR},O.prototype._is_closing=function(X,J){return(X.type===w.END_BLOCK||X.type===w.END_EXPR)&&J&&("]"===X.text&&"["===J.text||")"===X.text&&"("===J.text||"}"===X.text&&"{"===J.text)},O.prototype._reset=function(){V=!1},O.prototype._get_next_token=function(X,J){var q=null;this._readWhitespace();var fe=this._input.peek();return null===fe?this._create_token(w.EOF,""):q=(q=(q=(q=(q=(q=(q=(q=(q=(q=q||this._read_non_javascript(fe))||this._read_string(fe))||this._read_pair(fe,this._input.peek(1)))||this._read_word(X))||this._read_singles(fe))||this._read_comment(fe))||this._read_regexp(fe,X))||this._read_xml(fe,X))||this._read_punctuation())||this._create_token(w.UNKNOWN,this._input.next())},O.prototype._read_word=function(X){var J;return""!==(J=this.__patterns.identifier.read())?(J=J.replace(y.allLineBreaks,"\n"),X.type!==w.DOT&&(X.type!==w.RESERVED||"set"!==X.text&&"get"!==X.text)&&ut.test(J)?this._create_token("in"!==J&&"of"!==J||X.type!==w.WORD&&X.type!==w.STRING?w.RESERVED:w.OPERATOR,J):this._create_token(w.WORD,J)):""!==(J=this.__patterns.number.read())?this._create_token(w.WORD,J):void 0},O.prototype._read_singles=function(X){var J=null;return"("===X||"["===X?J=this._create_token(w.START_EXPR,X):")"===X||"]"===X?J=this._create_token(w.END_EXPR,X):"{"===X?J=this._create_token(w.START_BLOCK,X):"}"===X?J=this._create_token(w.END_BLOCK,X):";"===X?J=this._create_token(w.SEMICOLON,X):"."===X&&$.test(this._input.peek(1))?J=this._create_token(w.DOT,X):","===X&&(J=this._create_token(w.COMMA,X)),J&&this._input.next(),J},O.prototype._read_pair=function(X,J){var q=null;return"#"===X&&"{"===J&&(q=this._create_token(w.START_BLOCK,X+J)),q&&(this._input.next(),this._input.next()),q},O.prototype._read_punctuation=function(){var X=this.__patterns.punct.read();if(""!==X)return this._create_token("="===X?w.EQUALS:"?."===X?w.DOT:w.OPERATOR,X)},O.prototype._read_non_javascript=function(X){var J="";if("#"===X){if(this._is_first_token()&&(J=this.__patterns.shebang.read()))return this._create_token(w.UNKNOWN,J.trim()+"\n");if(J=this.__patterns.include.read())return this._create_token(w.UNKNOWN,J.trim()+"\n");X=this._input.next();var q="#";if(this._input.hasNext()&&this._input.testChar(Z)){do{q+=X=this._input.next()}while(this._input.hasNext()&&"#"!==X&&"="!==X);return"#"===X||("["===this._input.peek()&&"]"===this._input.peek(1)?(q+="[]",this._input.next(),this._input.next()):"{"===this._input.peek()&&"}"===this._input.peek(1)&&(q+="{}",this._input.next(),this._input.next())),this._create_token(w.WORD,q)}this._input.back()}else if("<"===X&&this._is_first_token()){if(J=this.__patterns.html_comment_start.read()){for(;this._input.hasNext()&&!this._input.testChar(y.newline);)J+=this._input.next();return V=!0,this._create_token(w.COMMENT,J)}}else if(V&&"-"===X&&(J=this.__patterns.html_comment_end.read()))return V=!1,this._create_token(w.COMMENT,J);return null},O.prototype._read_comment=function(X){var J=null;if("/"===X){var q="";if("*"===this._input.peek(1)){q=this.__patterns.block_comment.read();var fe=P.get_directives(q);fe&&"start"===fe.ignore&&(q+=P.readIgnored(this._input)),q=q.replace(y.allLineBreaks,"\n"),(J=this._create_token(w.BLOCK_COMMENT,q)).directives=fe}else"/"===this._input.peek(1)&&(q=this.__patterns.comment.read(),J=this._create_token(w.COMMENT,q))}return J},O.prototype._read_string=function(X){if("`"===X||"'"===X||'"'===X){var J=this._input.next();return this.has_char_escapes=!1,J+="`"===X?this._read_string_recursive("`",!0,"${"):this._read_string_recursive(X),this.has_char_escapes&&this._options.unescape_strings&&(J=function K(X){for(var J="",q=0,fe=new D(X),S=null;fe.hasNext();)if((S=fe.match(/([\s]|[^\\]|\\\\)+/g))&&(J+=S[0]),"\\"===fe.peek()){if(fe.next(),"x"===fe.peek())S=fe.match(/x([0-9A-Fa-f]{2})/g);else{if("u"!==fe.peek()){J+="\\",fe.hasNext()&&(J+=fe.next());continue}(S=fe.match(/u([0-9A-Fa-f]{4})/g))||(S=fe.match(/u\{([0-9A-Fa-f]+)\}/g))}if(!S||(q=parseInt(S[1],16))>126&&q<=255&&0===S[0].indexOf("x"))return X;J+=q>=0&&q<32||q>1114111?"\\"+S[0]:34===q||39===q||92===q?"\\"+String.fromCharCode(q):String.fromCharCode(q)}return J}(J)),this._input.peek()===X&&(J+=this._input.next()),J=J.replace(y.allLineBreaks,"\n"),this._create_token(w.STRING,J)}return null},O.prototype._allow_regexp_or_xml=function(X){return X.type===w.RESERVED&&M(X.text,["return","case","throw","else","do","typeof","yield"])||X.type===w.END_EXPR&&")"===X.text&&X.opened.previous.type===w.RESERVED&&M(X.opened.previous.text,["if","while","for"])||M(X.type,[w.COMMENT,w.START_EXPR,w.START_BLOCK,w.START,w.END_BLOCK,w.OPERATOR,w.EQUALS,w.EOF,w.SEMICOLON,w.COMMA])},O.prototype._read_regexp=function(X,J){if("/"===X&&this._allow_regexp_or_xml(J)){for(var q=this._input.next(),fe=!1,S=!1;this._input.hasNext()&&(fe||S||this._input.peek()!==X)&&!this._input.testChar(y.newline);)q+=this._input.peek(),fe?fe=!1:(fe="\\"===this._input.peek(),"["===this._input.peek()?S=!0:"]"===this._input.peek()&&(S=!1)),this._input.next();return this._input.peek()===X&&(q+=this._input.next(),q+=this._input.read(y.identifier)),this._create_token(w.STRING,q)}return null},O.prototype._read_xml=function(X,J){if(this._options.e4x&&"<"===X&&this._allow_regexp_or_xml(J)){var q="",fe=this.__patterns.xml.read_match();if(fe){for(var S=fe[2].replace(/^{\s+/,"{").replace(/\s+}$/,"}"),Q=0===S.indexOf("{"),re=0;fe;){var ke=!!fe[1],Ye=fe[2];if(!(fe[fe.length-1]||"![CDATA["===Ye.slice(0,8))&&(Ye===S||Q&&Ye.replace(/^{\s+/,"{").replace(/\s+}$/,"}"))&&(ke?--re:++re),q+=fe[0],re<=0)break;fe=this.__patterns.xml.read_match()}return fe||(q+=this._input.match(/[\s\S]*/g)[0]),q=q.replace(y.allLineBreaks,"\n"),this._create_token(w.STRING,q)}}return null},O.prototype._read_string_recursive=function(X,J,q){var fe,S;"'"===X?S=this.__patterns.single_quote:'"'===X?S=this.__patterns.double_quote:"`"===X?S=this.__patterns.template_text:"}"===X&&(S=this.__patterns.template_expression);for(var Q=S.read(),re="";this._input.hasNext();){if((re=this._input.next())===X||!J&&y.newline.test(re)){this._input.back();break}"\\"===re&&this._input.hasNext()?("x"===(fe=this._input.peek())||"u"===fe?this.has_char_escapes=!0:"\r"===fe&&"\n"===this._input.peek(1)&&this._input.next(),re+=this._input.next()):q&&("${"===q&&"$"===re&&"{"===this._input.peek()&&(re+=this._input.next()),q===re&&(re+="`"===X?this._read_string_recursive("}",J,"`"):this._read_string_recursive("`",J,"${"),this._input.hasNext()&&(re+=this._input.next()))),Q+=re+=S.read()}return Q},te.exports.Tokenizer=O,te.exports.TOKEN=w,te.exports.positionable_operators=N.slice(),te.exports.line_starters=ie.slice()},function(te){var z=RegExp.prototype.hasOwnProperty("sticky");function F(D){this.__input=D||"",this.__input_length=this.__input.length,this.__position=0}F.prototype.restart=function(){this.__position=0},F.prototype.back=function(){this.__position>0&&(this.__position-=1)},F.prototype.hasNext=function(){return this.__position<this.__input_length},F.prototype.next=function(){var D=null;return this.hasNext()&&(D=this.__input.charAt(this.__position),this.__position+=1),D},F.prototype.peek=function(D){var g=null;return D=D||0,(D+=this.__position)>=0&&D<this.__input_length&&(g=this.__input.charAt(D)),g},F.prototype.__match=function(D,g){D.lastIndex=g;var _=D.exec(this.__input);return _&&!(z&&D.sticky)&&_.index!==g&&(_=null),_},F.prototype.test=function(D,g){return g=g||0,(g+=this.__position)>=0&&g<this.__input_length&&!!this.__match(D,g)},F.prototype.testChar=function(D,g){var _=this.peek(g);return D.lastIndex=0,null!==_&&D.test(_)},F.prototype.match=function(D){var g=this.__match(D,this.__position);return g?this.__position+=g[0].length:g=null,g},F.prototype.read=function(D,g,_){var y,E="";return D&&(y=this.match(D))&&(E+=y[0]),g&&(y||!D)&&(E+=this.readUntil(g,_)),E},F.prototype.readUntil=function(D,g){var _,E=this.__position;D.lastIndex=this.__position;var y=D.exec(this.__input);return y?(E=y.index,g&&(E+=y[0].length)):E=this.__input_length,_=this.__input.substring(this.__position,E),this.__position=E,_},F.prototype.readUntilAfter=function(D){return this.readUntil(D,!0)},F.prototype.get_regexp=function(D,g){var _=null,E="g";return g&&z&&(E="y"),"string"==typeof D&&""!==D?_=new RegExp(D,E):D&&(_=new RegExp(D.source,E)),_},F.prototype.get_literal_regexp=function(D){return RegExp(D.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))},F.prototype.peekUntilAfter=function(D){var g=this.__position,_=this.readUntilAfter(D);return this.__position=g,_},F.prototype.lookBack=function(D){var g=this.__position-1;return g>=D.length&&this.__input.substring(g-D.length,g).toLowerCase()===D},te.exports.InputScanner=F},function(te,z,F){var D=F(8).InputScanner,g=F(3).Token,_=F(10).TokenStream,E=F(11).WhitespacePattern,y={START:"TK_START",RAW:"TK_RAW",EOF:"TK_EOF"},A=function(x,M){this._input=new D(x),this._options=M||{},this.__tokens=null,this._patterns={},this._patterns.whitespace=new E(this._input)};A.prototype.tokenize=function(){this._input.restart(),this.__tokens=new _,this._reset();for(var x,M=new g(y.START,""),w=null,P=[],j=new _;M.type!==y.EOF;){for(x=this._get_next_token(M,w);this._is_comment(x);)j.add(x),x=this._get_next_token(M,w);j.isEmpty()||(x.comments_before=j,j=new _),x.parent=w,this._is_opening(x)?(P.push(w),w=x):w&&this._is_closing(x,w)&&(x.opened=w,w.closed=x,w=P.pop(),x.parent=w),x.previous=M,M.next=x,this.__tokens.add(x),M=x}return this.__tokens},A.prototype._is_first_token=function(){return this.__tokens.isEmpty()},A.prototype._reset=function(){},A.prototype._get_next_token=function(x,M){this._readWhitespace();var w=this._input.read(/.+/g);return w?this._create_token(y.RAW,w):this._create_token(y.EOF,"")},A.prototype._is_comment=function(x){return!1},A.prototype._is_opening=function(x){return!1},A.prototype._is_closing=function(x,M){return!1},A.prototype._create_token=function(x,M){return new g(x,M,this._patterns.whitespace.newline_count,this._patterns.whitespace.whitespace_before_token)},A.prototype._readWhitespace=function(){return this._patterns.whitespace.read()},te.exports.Tokenizer=A,te.exports.TOKEN=y},function(te){function z(F){this.__tokens=[],this.__tokens_length=this.__tokens.length,this.__position=0,this.__parent_token=F}z.prototype.restart=function(){this.__position=0},z.prototype.isEmpty=function(){return 0===this.__tokens_length},z.prototype.hasNext=function(){return this.__position<this.__tokens_length},z.prototype.next=function(){var F=null;return this.hasNext()&&(F=this.__tokens[this.__position],this.__position+=1),F},z.prototype.peek=function(F){var D=null;return F=F||0,(F+=this.__position)>=0&&F<this.__tokens_length&&(D=this.__tokens[F]),D},z.prototype.add=function(F){this.__parent_token&&(F.parent=this.__parent_token),this.__tokens.push(F),this.__tokens_length+=1},te.exports.TokenStream=z},function(te,z,F){var D=F(12).Pattern;function g(_,E){D.call(this,_,E),E?this._line_regexp=this._input.get_regexp(E._line_regexp):this.__set_whitespace_patterns("",""),this.newline_count=0,this.whitespace_before_token=""}(g.prototype=new D).__set_whitespace_patterns=function(_,E){this._match_pattern=this._input.get_regexp("["+(_+="\\t ")+(E+="\\n\\r")+"]+",!0),this._newline_regexp=this._input.get_regexp("\\r\\n|["+E+"]")},g.prototype.read=function(){this.newline_count=0,this.whitespace_before_token="";var _=this._input.read(this._match_pattern);if(" "===_)this.whitespace_before_token=" ";else if(_){var E=this.__split(this._newline_regexp,_);this.newline_count=E.length-1,this.whitespace_before_token=E[this.newline_count]}return _},g.prototype.matching=function(_,E){var y=this._create();return y.__set_whitespace_patterns(_,E),y._update(),y},g.prototype._create=function(){return new g(this._input,this)},g.prototype.__split=function(_,E){_.lastIndex=0;for(var y=0,A=[],x=_.exec(E);x;)A.push(E.substring(y,x.index)),y=x.index+x[0].length,x=_.exec(E);return A.push(y<E.length?E.substring(y,E.length):""),A},te.exports.WhitespacePattern=g},function(te){function z(F,D){this._input=F,this._starting_pattern=null,this._match_pattern=null,this._until_pattern=null,this._until_after=!1,D&&(this._starting_pattern=this._input.get_regexp(D._starting_pattern,!0),this._match_pattern=this._input.get_regexp(D._match_pattern,!0),this._until_pattern=this._input.get_regexp(D._until_pattern),this._until_after=D._until_after)}z.prototype.read=function(){var F=this._input.read(this._starting_pattern);return(!this._starting_pattern||F)&&(F+=this._input.read(this._match_pattern,this._until_pattern,this._until_after)),F},z.prototype.read_match=function(){return this._input.match(this._match_pattern)},z.prototype.until_after=function(F){var D=this._create();return D._until_after=!0,D._until_pattern=this._input.get_regexp(F),D._update(),D},z.prototype.until=function(F){var D=this._create();return D._until_after=!1,D._until_pattern=this._input.get_regexp(F),D._update(),D},z.prototype.starting_with=function(F){var D=this._create();return D._starting_pattern=this._input.get_regexp(F,!0),D._update(),D},z.prototype.matching=function(F){var D=this._create();return D._match_pattern=this._input.get_regexp(F,!0),D._update(),D},z.prototype._create=function(){return new z(this._input,this)},z.prototype._update=function(){},te.exports.Pattern=z},function(te){function z(F,D){F="string"==typeof F?F:F.source,D="string"==typeof D?D:D.source,this.__directives_block_pattern=new RegExp(F+/ beautify( \w+[:]\w+)+ /.source+D,"g"),this.__directive_pattern=/ (\w+)[:](\w+)/g,this.__directives_end_ignore_pattern=new RegExp(F+/\sbeautify\signore:end\s/.source+D,"g")}z.prototype.get_directives=function(F){if(!F.match(this.__directives_block_pattern))return null;var D={};this.__directive_pattern.lastIndex=0;for(var g=this.__directive_pattern.exec(F);g;)D[g[1]]=g[2],g=this.__directive_pattern.exec(F);return D},z.prototype.readIgnored=function(F){return F.readUntilAfter(this.__directives_end_ignore_pattern)},te.exports.Directives=z},function(te,z,F){var D=F(12).Pattern,g={django:!1,erb:!1,handlebars:!1,php:!1,smarty:!1,angular:!1};function _(E,y){D.call(this,E,y),this.__template_pattern=null,this._disabled=Object.assign({},g),this._excluded=Object.assign({},g),y&&(this.__template_pattern=this._input.get_regexp(y.__template_pattern),this._excluded=Object.assign(this._excluded,y._excluded),this._disabled=Object.assign(this._disabled,y._disabled));var A=new D(E);this.__patterns={handlebars_comment:A.starting_with(/{{!--/).until_after(/--}}/),handlebars_unescaped:A.starting_with(/{{{/).until_after(/}}}/),handlebars:A.starting_with(/{{/).until_after(/}}/),php:A.starting_with(/<\?(?:[= ]|php)/).until_after(/\?>/),erb:A.starting_with(/<%[^%]/).until_after(/[^%]%>/),django:A.starting_with(/{%/).until_after(/%}/),django_value:A.starting_with(/{{/).until_after(/}}/),django_comment:A.starting_with(/{#/).until_after(/#}/),smarty:A.starting_with(/{(?=[^}{\s\n])/).until_after(/[^\s\n]}/),smarty_comment:A.starting_with(/{\*/).until_after(/\*}/),smarty_literal:A.starting_with(/{literal}/).until_after(/{\/literal}/)}}(_.prototype=new D)._create=function(){return new _(this._input,this)},_.prototype._update=function(){this.__set_templated_pattern()},_.prototype.disable=function(E){var y=this._create();return y._disabled[E]=!0,y._update(),y},_.prototype.read_options=function(E){var y=this._create();for(var A in g)y._disabled[A]=-1===E.templating.indexOf(A);return y._update(),y},_.prototype.exclude=function(E){var y=this._create();return y._excluded[E]=!0,y._update(),y},_.prototype.read=function(){var E="";E=this._match_pattern?this._input.read(this._starting_pattern):this._input.read(this._starting_pattern,this.__template_pattern);for(var y=this._read_template();y;)E+=y+=this._match_pattern?this._input.read(this._match_pattern):this._input.readUntil(this.__template_pattern),y=this._read_template();return this._until_after&&(E+=this._input.readUntilAfter(this._until_pattern)),E},_.prototype.__set_templated_pattern=function(){var E=[];this._disabled.php||E.push(this.__patterns.php._starting_pattern.source),this._disabled.handlebars||E.push(this.__patterns.handlebars._starting_pattern.source),this._disabled.erb||E.push(this.__patterns.erb._starting_pattern.source),this._disabled.django||(E.push(this.__patterns.django._starting_pattern.source),E.push(this.__patterns.django_value._starting_pattern.source),E.push(this.__patterns.django_comment._starting_pattern.source)),this._disabled.smarty||E.push(this.__patterns.smarty._starting_pattern.source),this._until_pattern&&E.push(this._until_pattern.source),this.__template_pattern=this._input.get_regexp("(?:"+E.join("|")+")")},_.prototype._read_template=function(){var E="",y=this._input.peek();if("<"===y){var A=this._input.peek(1);!this._disabled.php&&!this._excluded.php&&"?"===A&&(E=E||this.__patterns.php.read()),!this._disabled.erb&&!this._excluded.erb&&"%"===A&&(E=E||this.__patterns.erb.read())}else"{"===y&&(!this._disabled.handlebars&&!this._excluded.handlebars&&(E=(E=(E=E||this.__patterns.handlebars_comment.read())||this.__patterns.handlebars_unescaped.read())||this.__patterns.handlebars.read()),this._disabled.django||(!this._excluded.django&&!this._excluded.handlebars&&(E=E||this.__patterns.django_value.read()),this._excluded.django||(E=(E=E||this.__patterns.django_comment.read())||this.__patterns.django.read())),this._disabled.smarty||this._disabled.django&&this._disabled.handlebars&&(E=(E=(E=E||this.__patterns.smarty_comment.read())||this.__patterns.smarty_literal.read())||this.__patterns.smarty.read()));return E},te.exports.TemplatablePattern=_}],Pe={},Oe=function le(te){var z=Pe[te];if(void 0!==z)return z.exports;var F=Pe[te]={exports:{}};return Ne[te](F,F.exports,le),F.exports}(0);ve=Oe}();var Te=ve;void 0!==(xe=function(){return{js_beautify:Te}}.apply(Wt,[]))&&(Tt.exports=xe)}()},25:(Tt,Wt,it)=>{"use strict";var xe=it(307),ve=it(387),Te=it(357),Ne=it(496),le=11102230246251565e-32,Oe=(3+16*le)*le,te=(7+56*le)*le;function z(w,P,j,Z){return function(N,B,U){var ie=w(w(P(B[1],U[0]),P(-U[1],B[0])),w(P(N[1],B[0]),P(-B[1],N[0]))),W=w(P(N[1],U[0]),P(-U[1],N[0])),ut=Z(ie,W);return ut[ut.length-1]}}function F(w,P,j,Z){return function(N,B,U,ie){var W=w(w(j(w(P(U[1],ie[0]),P(-ie[1],U[0])),B[2]),w(j(w(P(B[1],ie[0]),P(-ie[1],B[0])),-U[2]),j(w(P(B[1],U[0]),P(-U[1],B[0])),ie[2]))),w(j(w(P(B[1],ie[0]),P(-ie[1],B[0])),N[2]),w(j(w(P(N[1],ie[0]),P(-ie[1],N[0])),-B[2]),j(w(P(N[1],B[0]),P(-B[1],N[0])),ie[2])))),ut=w(w(j(w(P(U[1],ie[0]),P(-ie[1],U[0])),N[2]),w(j(w(P(N[1],ie[0]),P(-ie[1],N[0])),-U[2]),j(w(P(N[1],U[0]),P(-U[1],N[0])),ie[2]))),w(j(w(P(B[1],U[0]),P(-U[1],B[0])),N[2]),w(j(w(P(N[1],U[0]),P(-U[1],N[0])),-B[2]),j(w(P(N[1],B[0]),P(-B[1],N[0])),U[2])))),V=Z(W,ut);return V[V.length-1]}}function D(w,P,j,Z){return function(N,B,U,ie,W){var ut=w(w(w(j(w(j(w(P(ie[1],W[0]),P(-W[1],ie[0])),U[2]),w(j(w(P(U[1],W[0]),P(-W[1],U[0])),-ie[2]),j(w(P(U[1],ie[0]),P(-ie[1],U[0])),W[2]))),B[3]),w(j(w(j(w(P(ie[1],W[0]),P(-W[1],ie[0])),B[2]),w(j(w(P(B[1],W[0]),P(-W[1],B[0])),-ie[2]),j(w(P(B[1],ie[0]),P(-ie[1],B[0])),W[2]))),-U[3]),j(w(j(w(P(U[1],W[0]),P(-W[1],U[0])),B[2]),w(j(w(P(B[1],W[0]),P(-W[1],B[0])),-U[2]),j(w(P(B[1],U[0]),P(-U[1],B[0])),W[2]))),ie[3]))),w(j(w(j(w(P(U[1],ie[0]),P(-ie[1],U[0])),B[2]),w(j(w(P(B[1],ie[0]),P(-ie[1],B[0])),-U[2]),j(w(P(B[1],U[0]),P(-U[1],B[0])),ie[2]))),-W[3]),w(j(w(j(w(P(ie[1],W[0]),P(-W[1],ie[0])),B[2]),w(j(w(P(B[1],W[0]),P(-W[1],B[0])),-ie[2]),j(w(P(B[1],ie[0]),P(-ie[1],B[0])),W[2]))),N[3]),j(w(j(w(P(ie[1],W[0]),P(-W[1],ie[0])),N[2]),w(j(w(P(N[1],W[0]),P(-W[1],N[0])),-ie[2]),j(w(P(N[1],ie[0]),P(-ie[1],N[0])),W[2]))),-B[3])))),w(w(j(w(j(w(P(B[1],W[0]),P(-W[1],B[0])),N[2]),w(j(w(P(N[1],W[0]),P(-W[1],N[0])),-B[2]),j(w(P(N[1],B[0]),P(-B[1],N[0])),W[2]))),ie[3]),w(j(w(j(w(P(B[1],ie[0]),P(-ie[1],B[0])),N[2]),w(j(w(P(N[1],ie[0]),P(-ie[1],N[0])),-B[2]),j(w(P(N[1],B[0]),P(-B[1],N[0])),ie[2]))),-W[3]),j(w(j(w(P(U[1],ie[0]),P(-ie[1],U[0])),B[2]),w(j(w(P(B[1],ie[0]),P(-ie[1],B[0])),-U[2]),j(w(P(B[1],U[0]),P(-U[1],B[0])),ie[2]))),N[3]))),w(j(w(j(w(P(U[1],ie[0]),P(-ie[1],U[0])),N[2]),w(j(w(P(N[1],ie[0]),P(-ie[1],N[0])),-U[2]),j(w(P(N[1],U[0]),P(-U[1],N[0])),ie[2]))),-B[3]),w(j(w(j(w(P(B[1],ie[0]),P(-ie[1],B[0])),N[2]),w(j(w(P(N[1],ie[0]),P(-ie[1],N[0])),-B[2]),j(w(P(N[1],B[0]),P(-B[1],N[0])),ie[2]))),U[3]),j(w(j(w(P(B[1],U[0]),P(-U[1],B[0])),N[2]),w(j(w(P(N[1],U[0]),P(-U[1],N[0])),-B[2]),j(w(P(N[1],B[0]),P(-B[1],N[0])),U[2]))),-ie[3]))))),V=w(w(w(j(w(j(w(P(ie[1],W[0]),P(-W[1],ie[0])),U[2]),w(j(w(P(U[1],W[0]),P(-W[1],U[0])),-ie[2]),j(w(P(U[1],ie[0]),P(-ie[1],U[0])),W[2]))),N[3]),j(w(j(w(P(ie[1],W[0]),P(-W[1],ie[0])),N[2]),w(j(w(P(N[1],W[0]),P(-W[1],N[0])),-ie[2]),j(w(P(N[1],ie[0]),P(-ie[1],N[0])),W[2]))),-U[3])),w(j(w(j(w(P(U[1],W[0]),P(-W[1],U[0])),N[2]),w(j(w(P(N[1],W[0]),P(-W[1],N[0])),-U[2]),j(w(P(N[1],U[0]),P(-U[1],N[0])),W[2]))),ie[3]),j(w(j(w(P(U[1],ie[0]),P(-ie[1],U[0])),N[2]),w(j(w(P(N[1],ie[0]),P(-ie[1],N[0])),-U[2]),j(w(P(N[1],U[0]),P(-U[1],N[0])),ie[2]))),-W[3]))),w(w(j(w(j(w(P(U[1],W[0]),P(-W[1],U[0])),B[2]),w(j(w(P(B[1],W[0]),P(-W[1],B[0])),-U[2]),j(w(P(B[1],U[0]),P(-U[1],B[0])),W[2]))),N[3]),j(w(j(w(P(U[1],W[0]),P(-W[1],U[0])),N[2]),w(j(w(P(N[1],W[0]),P(-W[1],N[0])),-U[2]),j(w(P(N[1],U[0]),P(-U[1],N[0])),W[2]))),-B[3])),w(j(w(j(w(P(B[1],W[0]),P(-W[1],B[0])),N[2]),w(j(w(P(N[1],W[0]),P(-W[1],N[0])),-B[2]),j(w(P(N[1],B[0]),P(-B[1],N[0])),W[2]))),U[3]),j(w(j(w(P(B[1],U[0]),P(-U[1],B[0])),N[2]),w(j(w(P(N[1],U[0]),P(-U[1],N[0])),-B[2]),j(w(P(N[1],B[0]),P(-B[1],N[0])),U[2]))),-W[3])))),O=Z(ut,V);return O[O.length-1]}}function g(w){return(3===w?z:4===w?F:D)(ve,xe,Te,Ne)}var _=g(3),E=g(4),y=[function(){return 0},function(){return 0},function(P,j){return j[0]-P[0]},function(P,j,Z){var U,$=(P[1]-Z[1])*(j[0]-Z[0]),N=(P[0]-Z[0])*(j[1]-Z[1]),B=$-N;if($>0){if(N<=0)return B;U=$+N}else{if(!($<0))return B;if(N>=0)return B;U=-($+N)}var ie=Oe*U;return B>=ie||B<=-ie?B:_(P,j,Z)},function(P,j,Z,$){var N=P[0]-$[0],B=j[0]-$[0],U=Z[0]-$[0],ie=P[1]-$[1],W=j[1]-$[1],ut=Z[1]-$[1],V=P[2]-$[2],O=j[2]-$[2],K=Z[2]-$[2],X=B*ut,J=U*W,q=U*ie,fe=N*ut,S=N*W,Q=B*ie,re=V*(X-J)+O*(q-fe)+K*(S-Q),ke=(Math.abs(X)+Math.abs(J))*Math.abs(V)+(Math.abs(q)+Math.abs(fe))*Math.abs(O)+(Math.abs(S)+Math.abs(Q))*Math.abs(K),Ye=te*ke;return re>Ye||-re>Ye?re:E(P,j,Z,$)}];function A(w){var P=y[w.length];return P||(P=y[w.length]=g(w.length)),P.apply(void 0,w)}function x(w,P,j,Z,$,N,B){return function(ie,W,ut,V,O){switch(arguments.length){case 0:case 1:return 0;case 2:return Z(ie,W);case 3:return $(ie,W,ut);case 4:return N(ie,W,ut,V);case 5:return B(ie,W,ut,V,O)}for(var K=new Array(arguments.length),X=0;X<arguments.length;++X)K[X]=arguments[X];return w(K)}}!function M(){for(;y.length<=5;)y.push(g(y.length));Tt.exports=x.apply(void 0,[A].concat(y));for(var w=0;w<=5;++w)Tt.exports[w]=y[w]}()},38:(Tt,Wt,it)=>{Tt.exports=function ve(Te,Ne){for(var Pe=Ne[0],le=Ne[1],Oe=Te.length,te=1,z=Oe,F=0,D=Oe-1;F<z;D=F++){var g=Te[F],_=Te[D],E=g[1],y=_[1];if(y<E){if(y<le&&le<E){if(0===(A=xe(g,_,Ne)))return 0;te^=0<A|0}else if(le===E&&E<Te[(F+1)%Oe][1]){if(0===(A=xe(g,_,Ne)))return 0;te^=0<A|0}}else if(E<y){if(E<le&&le<y){if(0===(A=xe(g,_,Ne)))return 0;te^=A<0|0}else if(le===E&&Te[(F+1)%Oe][1]<E){var A;if(0===(A=xe(g,_,Ne)))return 0;te^=A<0|0}}else if(le===E){var w=Math.min(g[0],_[0]),P=Math.max(g[0],_[0]);if(0===F){for(;D>0;){var j=(D+Oe-1)%Oe;if((Z=Te[j])[1]!==le)break;var $=Z[0];w=Math.min(w,$),P=Math.max(P,$),D=j}if(0===D)return w<=Pe&&Pe<=P?0:1;z=D+1}for(var N=Te[(D+Oe-1)%Oe][1];F+1<z;){var Z;if((Z=Te[F+1])[1]!==le)break;$=Z[0],w=Math.min(w,$),P=Math.max(P,$),F+=1}if(w<=Pe&&Pe<=P)return 0;Pe<w&&N<le!=Te[(F+1)%Oe][1]<le&&(te^=1)}}return 2*te-1};var xe=it(25)},357:(Tt,Wt,it)=>{"use strict";var xe=it(307),ve=it(595);Tt.exports=function Te(Ne,Pe){var le=Ne.length;if(1===le){var Oe=xe(Ne[0],Pe);return Oe[0]?Oe:[Oe[1]]}var te=new Array(2*le),z=[.1,.1],F=[.1,.1],D=0;xe(Ne[0],Pe,z),z[0]&&(te[D++]=z[0]);for(var g=1;g<le;++g){xe(Ne[g],Pe,F),ve(z[1],F[0],z),z[0]&&(te[D++]=z[0]);var E=F[1],y=z[1],A=E+y,M=y-(A-E);z[1]=A,M&&(te[D++]=M)}return z[1]&&(te[D++]=z[1]),0===D&&(te[D++]=0),te.length=D,te}},496:Tt=>{"use strict";Tt.exports=function it(xe,ve){var Te=0|xe.length,Ne=0|ve.length;if(1===Te&&1===Ne)return function Wt(xe,ve){var Te=xe+ve,Ne=Te-xe,te=xe-(Te-Ne)+(ve-Ne);return te?[te,Te]:[Te]}(xe[0],-ve[0]);var y,A,le=new Array(Te+Ne),Oe=0,te=0,z=0,F=Math.abs,D=xe[te],g=F(D),_=-ve[z],E=F(_);g<E?(A=D,(te+=1)<Te&&(g=F(D=xe[te]))):(A=_,(z+=1)<Ne&&(E=F(_=-ve[z]))),te<Te&&g<E||z>=Ne?(y=D,(te+=1)<Te&&(g=F(D=xe[te]))):(y=_,(z+=1)<Ne&&(E=F(_=-ve[z])));for(var Z,$,x=y+A,M=x-y,w=A-M,P=w,j=x;te<Te&&z<Ne;)g<E?(y=D,(te+=1)<Te&&(g=F(D=xe[te]))):(y=_,(z+=1)<Ne&&(E=F(_=-ve[z]))),(w=(A=P)-(M=(x=y+A)-y))&&(le[Oe++]=w),P=j-((Z=j+x)-($=Z-j))+(x-$),j=Z;for(;te<Te;)(w=(A=P)-(M=(x=(y=D)+A)-y))&&(le[Oe++]=w),P=j-((Z=j+x)-($=Z-j))+(x-$),j=Z,(te+=1)<Te&&(D=xe[te]);for(;z<Ne;)(w=(A=P)-(M=(x=(y=_)+A)-y))&&(le[Oe++]=w),P=j-((Z=j+x)-($=Z-j))+(x-$),j=Z,(z+=1)<Ne&&(_=-ve[z]);return P&&(le[Oe++]=P),j&&(le[Oe++]=j),Oe||(le[Oe++]=0),le.length=Oe,le}},387:Tt=>{"use strict";Tt.exports=function it(xe,ve){var Te=0|xe.length,Ne=0|ve.length;if(1===Te&&1===Ne)return function Wt(xe,ve){var Te=xe+ve,Ne=Te-xe,te=xe-(Te-Ne)+(ve-Ne);return te?[te,Te]:[Te]}(xe[0],ve[0]);var y,A,le=new Array(Te+Ne),Oe=0,te=0,z=0,F=Math.abs,D=xe[te],g=F(D),_=ve[z],E=F(_);g<E?(A=D,(te+=1)<Te&&(g=F(D=xe[te]))):(A=_,(z+=1)<Ne&&(E=F(_=ve[z]))),te<Te&&g<E||z>=Ne?(y=D,(te+=1)<Te&&(g=F(D=xe[te]))):(y=_,(z+=1)<Ne&&(E=F(_=ve[z])));for(var Z,$,x=y+A,M=x-y,w=A-M,P=w,j=x;te<Te&&z<Ne;)g<E?(y=D,(te+=1)<Te&&(g=F(D=xe[te]))):(y=_,(z+=1)<Ne&&(E=F(_=ve[z]))),(w=(A=P)-(M=(x=y+A)-y))&&(le[Oe++]=w),P=j-((Z=j+x)-($=Z-j))+(x-$),j=Z;for(;te<Te;)(w=(A=P)-(M=(x=(y=D)+A)-y))&&(le[Oe++]=w),P=j-((Z=j+x)-($=Z-j))+(x-$),j=Z,(te+=1)<Te&&(D=xe[te]);for(;z<Ne;)(w=(A=P)-(M=(x=(y=_)+A)-y))&&(le[Oe++]=w),P=j-((Z=j+x)-($=Z-j))+(x-$),j=Z,(z+=1)<Ne&&(_=ve[z]);return P&&(le[Oe++]=P),j&&(le[Oe++]=j),Oe||(le[Oe++]=0),le.length=Oe,le}},307:Tt=>{"use strict";Tt.exports=function it(xe,ve,Te){var Ne=xe*ve,Pe=Wt*xe,Oe=Pe-(Pe-xe),te=xe-Oe,z=Wt*ve,D=z-(z-ve),g=ve-D,A=te*g-(Ne-Oe*D-te*D-Oe*g);return Te?(Te[0]=A,Te[1]=Ne,Te):[A,Ne]};var Wt=+(Math.pow(2,27)+1)},595:Tt=>{"use strict";Tt.exports=function Wt(it,xe,ve){var Te=it+xe,Ne=Te-it,le=xe-Ne,Oe=it-(Te-Ne);return ve?(ve[0]=Oe+le,ve[1]=Te,ve):[Oe+le,Te]}},501:(Tt,Wt,it)=>{"use strict";function xe(n,e){return Object.is(n,e)}let ve=null,Te=!1,Ne=1;const Pe=Symbol("SIGNAL");function le(n){const e=ve;return ve=n,e}const F={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function D(n){if(Te)throw new Error("");if(null===ve)return;ve.consumerOnSignalRead(n);const e=ve.nextProducerIndex++;N(ve),e<ve.producerNode.length&&ve.producerNode[e]!==n&&$(ve)&&Z(ve.producerNode[e],ve.producerIndexOfThis[e]),ve.producerNode[e]!==n&&(ve.producerNode[e]=n,ve.producerIndexOfThis[e]=$(ve)?j(n,ve,e):0),ve.producerLastReadVersion[e]=n.version}function _(n){if((!$(n)||n.dirty)&&(n.dirty||n.lastCleanEpoch!==Ne)){if(!n.producerMustRecompute(n)&&!w(n))return n.dirty=!1,void(n.lastCleanEpoch=Ne);n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Ne}}function E(n){if(void 0===n.liveConsumerNode)return;const e=Te;Te=!0;try{for(const t of n.liveConsumerNode)t.dirty||A(t)}finally{Te=e}}function y(){return!1!==ve?.consumerAllowSignalWrites}function A(n){n.dirty=!0,E(n),n.consumerMarkedDirty?.(n)}function x(n){return n&&(n.nextProducerIndex=0),le(n)}function M(n,e){if(le(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if($(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Z(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function w(n){N(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(_(t),i!==t.version))return!0}return!1}function P(n){if(N(n),$(n))for(let e=0;e<n.producerNode.length;e++)Z(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function j(n,e,t){if(B(n),0===n.liveConsumerNode.length&&U(n))for(let i=0;i<n.producerNode.length;i++)n.producerIndexOfThis[i]=j(n.producerNode[i],n,i);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function Z(n,e){if(B(n),1===n.liveConsumerNode.length&&U(n))for(let i=0;i<n.producerNode.length;i++)Z(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];N(r),r.producerIndexOfThis[i]=e}}function $(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function N(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function B(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function U(n){return void 0!==n.producerNode}const W=Symbol("UNSET"),ut=Symbol("COMPUTING"),V=Symbol("ERRORED"),O={...F,value:W,dirty:!0,error:null,equal:xe,producerMustRecompute:n=>n.value===W||n.value===ut,producerRecomputeValue(n){if(n.value===ut)throw new Error("Detected cycle in computations.");const e=n.value;n.value=ut;const t=x(n);let i;try{i=n.computation()}catch(r){i=V,n.error=r}finally{M(n,t)}e!==W&&e!==V&&i!==V&&n.equal(e,i)?n.value=e:(n.value=i,n.version++)}};let X=function K(){throw new Error};function J(){X()}let fe=null;function ke(n,e){y()||J(),n.equal(n.value,e)||(n.value=e,function xt(n){n.version++,function g(){Ne++}(),E(n),fe?.()}(n))}const qt={...F,equal:xe,value:void 0};const St=()=>{},yn={...F,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{null!==n.schedule&&n.schedule(n.ref)},hasRun:!1,cleanupFn:St};function Pt(n){return"function"==typeof n}function ls(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Nr=ls(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function lr(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Xt{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(Pt(i))try{i()}catch(s){e=s instanceof Nr?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{cc(s)}catch(o){e=e??[],o instanceof Nr?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Nr(e)}}add(e){var t;if(e&&e!==this)if(this.closed)cc(e);else{if(e instanceof Xt){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&lr(t,e)}remove(e){const{_finalizers:t}=this;t&&lr(t,e),e instanceof Xt&&e._removeParent(this)}}Xt.EMPTY=(()=>{const n=new Xt;return n.closed=!0,n})();const ur=Xt.EMPTY;function ac(n){return n instanceof Xt||n&&"closed"in n&&Pt(n.remove)&&Pt(n.add)&&Pt(n.unsubscribe)}function cc(n){Pt(n)?n():n.unsubscribe()}const Ai={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},xn={setTimeout(n,e,...t){const{delegate:i}=xn;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=xn;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function bu(n){xn.setTimeout(()=>{const{onUnhandledError:e}=Ai;if(!e)throw n;e(n)})}function xo(){}const tp=Po("C",void 0,void 0);function Po(n,e,t){return{kind:n,value:e,error:t}}let hr=null;function Ls(n){if(Ai.useDeprecatedSynchronousErrorHandling){const e=!hr;if(e&&(hr={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=hr;if(hr=null,t)throw i}}else n()}class us extends Xt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,ac(e)&&e.add(this)):this.destination=op}static create(e,t,i){return new hc(e,t,i)}next(e){this.isStopped?hs(function ip(n){return Po("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?hs(function np(n){return Po("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?hs(tp,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const lc=Function.prototype.bind;function uc(n,e){return lc.call(n,e)}class rp{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Oo(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Oo(i)}else Oo(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Oo(t)}}}class hc extends us{constructor(e,t,i){let r;if(super(),Pt(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&Ai.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&uc(e.next,s),error:e.error&&uc(e.error,s),complete:e.complete&&uc(e.complete,s)}):r=e}this.destination=new rp(r)}}function Oo(n){Ai.useDeprecatedSynchronousErrorHandling?function Su(n){Ai.useDeprecatedSynchronousErrorHandling&&hr&&(hr.errorThrown=!0,hr.error=n)}(n):bu(n)}function hs(n,e){const{onStoppedNotification:t}=Ai;t&&xn.setTimeout(()=>t(n,e))}const op={closed:!0,next:xo,error:function sp(n){throw n},complete:xo},dc="function"==typeof Symbol&&Symbol.observable||"@@observable";function kr(n){return n}let sn=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function Tu(n){return n&&n instanceof us||function ap(n){return n&&Pt(n.next)&&Pt(n.error)&&Pt(n.complete)}(n)&&ac(n)}(t)?t:new hc(t,i,r);return Ls(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=Du(i))((r,s)=>{const o=new hc({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[dc](){return this}pipe(...t){return function Ro(n){return 0===n.length?kr:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}(t)(this)}toPromise(t){return new(t=Du(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function Du(n){var e;return null!==(e=n??Ai.Promise)&&void 0!==e?e:Promise}const cp=ls(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ot=(()=>{class n extends sn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Iu(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new cp}next(t){Ls(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Ls(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Ls(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?ur:(this.currentObservers=null,s.push(t),new Xt(()=>{this.currentObservers=null,lr(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new sn;return t.source=this,t}}return n.create=(e,t)=>new Iu(e,t),n})();class Iu extends Ot{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:ur}}class Hi extends Ot{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function Pn(n){return e=>{if(function lp(n){return Pt(n?.lift)}(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function hn(n,e,t,i,r){return new fc(n,e,t,i,r)}class fc extends us{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function ii(n,e){return Pn((t,i)=>{let r=0;t.subscribe(hn(i,s=>{i.next(n.call(e,s,r++))}))})}typeof navigator<"u"&&navigator,typeof navigator<"u"&&!/Opera/.test(navigator.userAgent)&&navigator,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||navigator),typeof navigator<"u"&&!/Opera|WebKit/.test(navigator.userAgent)&&navigator,typeof navigator<"u"&&navigator;class oe extends Error{constructor(e,t){super(function Bo(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function jr(n){return{toString:n}.toString()}const Kt=globalThis;function It(n){for(let e in n)if(n[e]===It)return e;throw Error("Could not find renamed property on target object.")}function vn(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(vn).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function wp(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const LO=It({__forward_ref__:It});function Ep(n){return n.__forward_ref__=Ep,n.toString=function(){return vn(this())},n}function qe(n){return function ju(n){return"function"==typeof n&&n.hasOwnProperty(LO)&&n.__forward_ref__===Ep}(n)?n():n}function He(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Ho(n){return{providers:n.providers||[],imports:n.imports||[]}}function Vu(n){return Yw(n,Uu)||Yw(n,Xw)}function Yw(n,e){return n.hasOwnProperty(e)?n[e]:null}function zu(n){return n&&(n.hasOwnProperty(bp)||n.hasOwnProperty(zO))?n[bp]:null}const Uu=It({\u0275prov:It}),bp=It({\u0275inj:It}),Xw=It({ngInjectableDef:It}),zO=It({ngInjectorDef:It});class ye{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=He({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Ip(n){return n&&!!n.\u0275providers}const Cc=It({\u0275cmp:It}),Ap=It({\u0275dir:It}),Mp=It({\u0275pipe:It}),Vr=It({\u0275fac:It}),Dc=It({__NG_ELEMENT_ID__:It}),Jw=It({__NG_ENV_ID__:It});function Je(n){return"string"==typeof n?n:null==n?"":String(n)}function xp(n,e){throw new oe(-201,!1)}var ct=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ct||{});let Pp;function e0(){return Pp}function si(n){const e=Pp;return Pp=n,e}function t0(n,e,t){const i=Vu(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&ct.Optional?null:void 0!==e?e:void xp()}const Tc={},Op="__NG_DI_FLAG__",Hu="ngTempTokenPath",qO=/\n/gm,n0="__source";let Go;function gs(n){const e=Go;return Go=n,e}function XO(n,e=ct.Default){if(void 0===Go)throw new oe(-203,!1);return null===Go?t0(n,void 0,e):Go.get(n,e&ct.Optional?null:void 0,e)}function Le(n,e=ct.Default){return(e0()||XO)(qe(n),e)}function be(n,e=ct.Default){return Le(n,Gu(e))}function Gu(n){return typeof n>"u"||"number"==typeof n?n:(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Rp(n){const e=[];for(let t=0;t<n.length;t++){const i=qe(n[t]);if(Array.isArray(i)){if(0===i.length)throw new oe(900,!1);let r,s=ct.Default;for(let o=0;o<i.length;o++){const a=i[o],c=ZO(a);"number"==typeof c?-1===c?r=a.token:s|=c:r=a}e.push(Le(r,s))}else e.push(Le(i))}return e}function ZO(n){return n[Op]}function Vs(n,e){return n.hasOwnProperty(Vr)?n[Vr]:null}function $o(n,e){n.forEach(t=>Array.isArray(t)?$o(t,e):e(t))}function s0(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function $u(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}const fr={},dt=[],Mi=new ye(""),c0=new ye("",-1),Bp=new ye("");class qu{get(e,t=Tc){if(t===Tc){const i=new Error(`NullInjectorError: No provider for ${vn(e)}!`);throw i.name="NullInjectorError",i}return t}}var Ku=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(Ku||{}),Wi=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Wi||{}),_s=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(_s||{});function rR(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function jp(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];u0(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function l0(n){return 3===n||4===n||6===n}function u0(n){return 64===n.charCodeAt(0)}function Ac(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||h0(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function h0(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const d0="ng-template";function sR(n,e,t,i){let r=0;if(i){for(;r<e.length&&"string"==typeof e[r];r+=2)if("class"===e[r]&&-1!==rR(e[r+1].toLowerCase(),t,0))return!0}else if(Vp(n))return!1;if(r=e.indexOf(1,r),r>-1){let s;for(;++r<e.length&&"string"==typeof(s=e[r]);)if(s.toLowerCase()===t)return!0}return!1}function Vp(n){return 4===n.type&&n.value!==d0}function oR(n,e,t){return e===(4!==n.type||t?n.value:d0)}function aR(n,e,t){let i=4;const r=n.attrs,s=null!==r?function uR(n){for(let e=0;e<n.length;e++)if(l0(n[e]))return e;return n.length}(r):0;let o=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!o)if(4&i){if(i=2|1&i,""!==c&&!oR(n,c,t)||""===c&&1===e.length){if(qi(i))return!1;o=!0}}else if(8&i){if(null===r||!sR(n,r,c,t)){if(qi(i))return!1;o=!0}}else{const l=e[++a],u=cR(c,r,Vp(n),t);if(-1===u){if(qi(i))return!1;o=!0;continue}if(""!==l){let h;if(h=u>s?"":r[u+1].toLowerCase(),2&i&&l!==h){if(qi(i))return!1;o=!0}}}}else{if(!o&&!qi(i)&&!qi(c))return!1;if(o&&qi(c))continue;o=!1,i=c|1&i}}return qi(i)||o}function qi(n){return!(1&n)}function cR(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function hR(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function f0(n,e,t=!1){for(let i=0;i<e.length;i++)if(aR(n,e[i],t))return!0;return!1}function p0(n,e){return n?":not("+e.trim()+")":e}function fR(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!qi(o)&&(e+=p0(s,r),r=""),i=o,s=s||!qi(i);t++}return""!==r&&(e+=p0(s,r)),e}function zp(n){return jr(()=>{const e=_0(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Ku.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Wi.Emulated,styles:n.styles||dt,_:null,schemas:n.schemas||null,tView:null,id:""};m0(t);const i=n.dependencies;return t.directiveDefs=Yu(i,!1),t.pipeDefs=Yu(i,!0),t.id=function vR(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)|0;return e+=2147483648,"c"+e}(t),t})}function _R(n){return at(n)||wn(n)}function mR(n){return null!==n}function Mc(n){return jr(()=>({type:n.type,bootstrap:n.bootstrap||dt,declarations:n.declarations||dt,imports:n.imports||dt,exports:n.exports||dt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function g0(n,e){if(null==n)return fr;const t={};for(const i in n)if(n.hasOwnProperty(i)){const r=n[i];let s,o,a=_s.None;Array.isArray(r)?(a=r[0],s=r[1],o=r[2]??s):(s=r,o=r),e?(t[s]=a!==_s.None?[i,a]:i,e[s]=o):t[s]=i}return t}function xi(n){return jr(()=>{const e=_0(n);return m0(e),e})}function at(n){return n[Cc]||null}function wn(n){return n[Ap]||null}function On(n){return n[Mp]||null}function _0(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||fr,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||dt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:g0(n.inputs,e),outputs:g0(n.outputs),debugInfo:null}}function m0(n){n.features?.forEach(e=>e(n))}function Yu(n,e){if(!n)return null;const t=e?On:_R;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(mR)}function y0(...n){return{\u0275providers:Up(0,n),\u0275fromNgModule:!0}}function Up(n,...e){const t=[],i=new Set;let r;const s=o=>{t.push(o)};return $o(e,o=>{const a=o;Zu(a,s,[],i)&&(r||=[],r.push(a))}),void 0!==r&&v0(r,s),t}function v0(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];Hp(r,s=>{e(s,i)})}}function Zu(n,e,t,i){if(!(n=qe(n)))return!1;let r=null,s=zu(n);const o=!s&&at(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const c=n.ngModule;if(s=zu(c),!s)return!1;r=c}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const c="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of c)Zu(l,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;i.add(r);try{$o(s.imports,u=>{Zu(u,e,t,i)&&(l||=[],l.push(u))})}finally{}void 0!==l&&v0(l,e)}if(!a){const l=Vs(r)||(()=>new r);e({provide:r,useFactory:l,deps:dt},r),e({provide:Bp,useValue:r,multi:!0},r),e({provide:Mi,useValue:()=>Le(r),multi:!0},r)}const c=s.providers;if(null!=c&&!a){const l=n;Hp(c,u=>{e(u,l)})}}}return r!==n&&void 0!==n.providers}function Hp(n,e){for(let t of n)Ip(t)&&(t=t.\u0275providers),Array.isArray(t)?Hp(t,e):e(t)}const wR=It({provide:String,useValue:It});function Gp(n){return null!==n&&"object"==typeof n&&wR in n}function Us(n){return"function"==typeof n}const $p=new ye(""),Qu={},bR={};let Wp;function Ju(){return void 0===Wp&&(Wp=new qu),Wp}class Ki{}class qo extends Ki{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Kp(e,o=>this.processProvider(o)),this.records.set(c0,Ko(void 0,this)),r.has("environment")&&this.records.set(Ki,Ko(void 0,this));const s=this.records.get($p);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Bp,dt,ct.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;const e=le(null);try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),le(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=gs(this),i=si(void 0);try{return e()}finally{gs(t),si(i)}}get(e,t=Tc,i=ct.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(Jw))return e[Jw](this);i=Gu(i);const s=gs(this),o=si(void 0);try{if(!(i&ct.SkipSelf)){let c=this.records.get(e);if(void 0===c){const l=function IR(n){return"function"==typeof n||"object"==typeof n&&n instanceof ye}(e)&&Vu(e);c=l&&this.injectableDefInScope(l)?Ko(qp(e),Qu):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(i&ct.Self?Ju():this.parent).get(e,t=i&ct.Optional&&t===Tc?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[Hu]=a[Hu]||[]).unshift(vn(e)),s)throw a;return function QO(n,e,t,i){const r=n[Hu];throw e[n0]&&r.unshift(e[n0]),n.message=function JO(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=vn(e);if(Array.isArray(e))r=e.map(vn).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):vn(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(qO,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Hu]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{si(o),gs(s)}}resolveInjectorInitializers(){const e=le(null),t=gs(this),i=si(void 0);try{const s=this.get(Mi,dt,ct.Self);for(const o of s)o()}finally{gs(t),si(i),le(e)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(vn(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new oe(205,!1)}processProvider(e){let t=Us(e=qe(e))?e:qe(e&&e.provide);const i=function CR(n){return Gp(n)?Ko(void 0,n.useValue):Ko(function b0(n,e,t){let i;if(Us(n)){const r=qe(n);return Vs(r)||qp(r)}if(Gp(n))i=()=>qe(n.useValue);else if(function E0(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Rp(n.deps||[]));else if(function w0(n){return!(!n||!n.useExisting)}(n))i=()=>Le(qe(n.useExisting));else{const r=qe(n&&(n.useClass||n.provide));if(!function DR(n){return!!n.deps}(n))return Vs(r)||qp(r);i=()=>new r(...Rp(n.deps))}return i}(n),Qu)}(e);if(!Us(e)&&!0===e.multi){let r=this.records.get(t);r||(r=Ko(void 0,Qu,!0),r.factory=()=>Rp(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){const i=le(null);try{return t.value===Qu&&(t.value=bR,t.value=t.factory()),"object"==typeof t.value&&t.value&&function TR(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{le(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;const t=qe(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function qp(n){const e=Vu(n),t=null!==e?e.factory:Vs(n);if(null!==t)return t;if(n instanceof ye)throw new oe(204,!1);if(n instanceof Function)return function SR(n){if(n.length>0)throw new oe(204,!1);const t=function VO(n){return n&&(n[Uu]||n[Xw])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new oe(204,!1)}function Ko(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Kp(n,e){for(const t of n)Array.isArray(t)?Kp(t,e):t&&Ip(t)?Kp(t.\u0275providers,e):e(t)}function S0(){return void 0!==e0()||null!=function YO(){return Go}()}function xc(n){if(!S0())throw new oe(-203,!1)}const Zt=0,ge=1,Ue=2,pn=3,Yi=4,Rn=5,Yn=6,Xo=7,Vt=8,gn=9,pr=10,Xe=11,Oc=12,D0=13,Zo=14,Qt=15,Hs=16,Qo=17,zr=18,Jo=19,T0=20,ms=21,th=22,Pi=23,Fe=25,Xp=1,gr=7,ea=9,on=10;var ih=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(ih||{});function bn(n){return Array.isArray(n)&&"object"==typeof n[Xp]}function Un(n){return Array.isArray(n)&&!0===n[Xp]}function Zp(n){return!!(4&n.flags)}function Gs(n){return n.componentOffset>-1}function rh(n){return!(1&~n.flags)}function Xi(n){return!!n.template}function Nc(n){return!!(512&n[Ue])}class P0{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function O0(n,e,t,i){null!==e?e.applyValueToInputSignal(e,i):n[t]=i}function kc(){return R0}function R0(n){return n.type.prototype.ngOnChanges&&(n.setInput=VR),jR}function jR(){const n=k0(this),e=n?.current;if(e){const t=n.previous;if(t===fr)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function VR(n,e,t,i,r){const s=this.declaredInputs[i],o=k0(n)||function zR(n,e){return n[N0]=e}(n,{previous:fr,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new P0(l&&l.currentValue,t,c===fr),O0(n,e,r,t)}kc.ngInherit=!0;const N0="__ngSimpleChanges__";function k0(n){return n[N0]||null}const _r=function(n,e,t){};function ft(n){for(;Array.isArray(n);)n=n[Zt];return n}function Xn(n,e){return ft(e[n.index])}function Fc(n,e){return n.data[e]}function mi(n,e){const t=e[n];return bn(t)?t:t[Zt]}function ng(n){return!(128&~n[Ue])}function Oi(n,e){return null==e?null:n[e]}function B0(n){n[Qo]=0}function j0(n){1024&n[Ue]||(n[Ue]|=1024,ng(n)&&oh(n))}function sh(n){return!!(9216&n[Ue]||n[Pi]?.dirty)}function ig(n){n[pr].changeDetectionScheduler?.notify(8),64&n[Ue]&&(n[Ue]|=1024),sh(n)&&oh(n)}function oh(n){n[pr].changeDetectionScheduler?.notify(0);let e=Ur(n);for(;null!==e&&!(8192&e[Ue])&&(e[Ue]|=8192,ng(e));)e=Ur(e)}function ah(n,e){if(!(256&~n[Ue]))throw new oe(911,!1);null===n[ms]&&(n[ms]=[]),n[ms].push(e)}function Ur(n){const e=n[pn];return Un(e)?e[pn]:e}const Ze={lFrame:eE(null),bindingsEnabled:!0,skipHydrationRootTNode:null};let z0=!1;function U0(){return Ze.bindingsEnabled}function ee(){return Ze.lFrame.lView}function st(){return Ze.lFrame.tView}function At(){let n=$0();for(;null!==n&&64===n.type;)n=n.parent;return n}function $0(){return Ze.lFrame.currentTNode}function Zi(n,e){const t=Ze.lFrame;t.currentTNode=n,t.isParent=e}function og(){return Ze.lFrame.isParent}function K0(){return z0}function Y0(n){z0=n}function Qi(){return Ze.lFrame.bindingIndex++}function tN(n,e){const t=Ze.lFrame;t.bindingIndex=t.bindingRootIndex=n,cg(e)}function cg(n){Ze.lFrame.currentDirectiveIndex=n}function ug(){return Ze.lFrame.currentQueryIndex}function lh(n){Ze.lFrame.currentQueryIndex=n}function iN(n){const e=n[ge];return 2===e.type?e.declTNode:1===e.type?n[Rn]:null}function Q0(n,e,t){if(t&ct.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&ct.Host||(r=iN(s),null===r||(s=s[Zo],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Ze.lFrame=J0();return i.currentTNode=e,i.lView=n,!0}function hg(n){const e=J0(),t=n[ge];Ze.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function J0(){const n=Ze.lFrame,e=null===n?null:n.child;return null===e?eE(n):e}function eE(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function tE(){const n=Ze.lFrame;return Ze.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const nE=tE;function dg(){const n=tE();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Nn(){return Ze.lFrame.selectedIndex}function qs(n){Ze.lFrame.selectedIndex=n}let rE=!0;function jc(){return rE}function mr(n){rE=n}function uh(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),null!=u&&(n.destroyHooks??=[]).push(t,u)}}function hh(n,e,t){sE(n,e,3,t)}function dh(n,e,t,i){(3&n[Ue])===t&&sE(n,e,t,i)}function fg(n,e){let t=n[Ue];(3&t)===e&&(t&=16383,t+=1,n[Ue]=t)}function sE(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let c=void 0!==i?65535&n[Qo]:0;c<o;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=i&&a>=i)break}else e[c]<0&&(n[Qo]+=65536),(a<s||-1==s)&&(uN(n,t,e,c),n[Qo]=(4294901760&n[Qo])+c+2),c++}function oE(n,e){_r(4,n,e);const t=le(null);try{e.call(n)}finally{le(t),_r(5,n,e)}}function uN(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];r?n[Ue]>>14<n[Qo]>>16&&(3&n[Ue])===e&&(n[Ue]+=16384,oE(a,s)):oE(a,s)}const ta=-1;class Vc{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}const gg={};class Ks{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=Gu(i);const r=this.injector.get(e,gg,i);return r!==gg||t===gg?r:this.parentInjector.get(e,t,i)}}function _g(n){return n!==ta}function zc(n){return 32767&n}function Uc(n,e){let t=function pN(n){return n>>16}(n),i=e;for(;t>0;)i=i[Zo],t--;return i}let mg=!0;function fh(n){const e=mg;return mg=n,e}const cE=255,lE=5;let _N=0;const yr={};function ph(n,e){const t=uE(n,e);if(-1!==t)return t;const i=e[ge];i.firstCreatePass&&(n.injectorIndex=e.length,yg(i.data,n),yg(e,null),yg(i.blueprint,null));const r=gh(n,e),s=n.injectorIndex;if(_g(r)){const o=zc(r),a=Uc(r,e),c=a[ge].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=r,s}function yg(n,e){n.push(0,0,0,0,0,0,0,0,e)}function uE(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function gh(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=yE(r),null===i)return ta;if(t++,r=r[Zo],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return ta}function vg(n,e,t){!function mN(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Dc)&&(i=t[Dc]),null==i&&(i=t[Dc]=_N++);const r=i&cE;e.data[n+(r>>lE)]|=1<<r}(n,e,t)}function hE(n,e,t){if(t&ct.Optional||void 0!==n)return n;xp()}function dE(n,e,t,i){if(t&ct.Optional&&void 0===i&&(i=null),!(t&(ct.Self|ct.Host))){const r=n[gn],s=si(void 0);try{return r?r.get(e,i,t&ct.Optional):t0(e,i,t&ct.Optional)}finally{si(s)}}return hE(i,0,t)}function fE(n,e,t,i=ct.Default,r){if(null!==n){if(2048&e[Ue]&&!(i&ct.Self)){const o=function bN(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[Ue]&&!(512&o[Ue]);){const a=pE(s,o,t,i|ct.Self,yr);if(a!==yr)return a;let c=s.parent;if(!c){const l=o[T0];if(l){const u=l.get(t,yr,i);if(u!==yr)return u}c=yE(o),o=o[Zo]}s=c}return r}(n,e,t,i,yr);if(o!==yr)return o}const s=pE(n,e,t,i,yr);if(s!==yr)return s}return dE(e,t,i,r)}function pE(n,e,t,i,r){const s=function wN(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Dc)?n[Dc]:void 0;return"number"==typeof e?e>=0?e&cE:EN:e}(t);if("function"==typeof s){if(!Q0(e,n,i))return i&ct.Host?hE(r,0,i):dE(e,t,i,r);try{let o;if(o=s(i),null!=o||i&ct.Optional)return o;xp()}finally{nE()}}else if("number"==typeof s){let o=null,a=uE(n,e),c=ta,l=i&ct.Host?e[Qt][Rn]:null;for((-1===a||i&ct.SkipSelf)&&(c=-1===a?gh(n,e):e[a+8],c!==ta&&_E(i,!1)?(o=e[ge],a=zc(c),e=Uc(c,e)):a=-1);-1!==a;){const u=e[ge];if(gE(s,a,u.data)){const h=vN(a,e,t,o,i,l);if(h!==yr)return h}c=e[a+8],c!==ta&&_E(i,e[ge].data[a+8]===l)&&gE(s,a,e)?(o=u,a=zc(c),e=Uc(c,e)):a=-1}}return r}function vN(n,e,t,i,r,s){const o=e[ge],a=o.data[n+8],u=_h(a,o,t,null==i?Gs(a)&&mg:i!=o&&!!(3&a.type),r&ct.Host&&s===a);return null!==u?Ys(e,o,u,a):yr}function _h(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,c=n.directiveStart,u=s>>20,d=r?a+u:n.directiveEnd;for(let p=i?a:a+u;p<d;p++){const f=o[p];if(p<c&&t===f||p>=c&&f.type===t)return p}if(r){const p=o[c];if(p&&Xi(p)&&p.type===t)return c}return null}function Ys(n,e,t,i){let r=n[t];const s=e.data;if(function hN(n){return n instanceof Vc}(r)){const o=r;o.resolving&&function GO(n,e){throw e&&e.join(" > "),new oe(-200,n)}(function vt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Je(n)}(s[t]));const a=fh(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?si(o.injectImpl):null;Q0(n,i,ct.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function lN(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=R0(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==l&&si(l),fh(a),o.resolving=!1,nE()}}return r}function gE(n,e,t){return!!(t[e+(n>>lE)]&1<<n)}function _E(n,e){return!(n&ct.Self||n&ct.Host&&e)}class Sn{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return fE(this._tNode,this._lView,e,Gu(i),t)}}function EN(){return new Sn(At(),ee())}function yE(n){const e=n[ge],t=e.type;return 2===t?e.declTNode:1===t?n[Rn]:null}function SE(n,e=null,t=null,i){const r=function CE(n,e=null,t=null,i,r=new Set){const s=[t||dt,y0(n)];return i=i||("object"==typeof n?void 0:vn(n)),new qo(s,e||Ju(),i||null,r)}(n,e,t,i);return r.resolveInjectorInitializers(),r}class kn{static{this.THROW_IF_NOT_FOUND=Tc}static{this.NULL=new qu}static create(e,t){if(Array.isArray(e))return SE({name:""},t,e,"");{const i=e.name??"";return SE({name:i},e.parent,e.providers,i)}}static{this.\u0275prov=He({token:kn,providedIn:"any",factory:()=>Le(c0)})}static{this.__NG_ELEMENT_ID__=-1}}new ye("").__NG_ELEMENT_ID__=n=>{const e=At();if(null===e)throw new oe(204,!1);if(2&e.type)return e.value;if(n&ct.Optional)return null;throw new oe(204,!1)};function bg(n){return n.ngOriginalError}const TE=!0;let Ji=(()=>{class n{static{this.__NG_ELEMENT_ID__=ON}static{this.__NG_ENV_ID__=t=>t}}return n})();class PN extends Ji{constructor(e){super(),this._lView=e}onDestroy(e){return ah(this._lView,e),()=>function rg(n,e){if(null===n[ms])return;const t=n[ms].indexOf(e);-1!==t&&n[ms].splice(t,1)}(this._lView,e)}}function ON(){return new PN(ee())}let ra=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Hi(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=He({token:n,providedIn:"root",factory:()=>new n})}}return n})();const $r=class RN extends Ot{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,S0()&&(this.destroyRef=be(Ji,{optional:!0})??void 0,this.pendingTasks=be(ra,{optional:!0})??void 0)}emit(e){const t=le(null);try{super.next(e)}finally{le(t)}}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const c=e;r=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),r&&(r=this.wrapInTimeout(r)),o&&(o=this.wrapInTimeout(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof Xt&&e.add(a),a}wrapInTimeout(e){return t=>{const i=this.pendingTasks?.add();setTimeout(()=>{e(t),void 0!==i&&this.pendingTasks?.remove(i)})}}};function vh(...n){}function IE(n){let e,t;function i(){n=vh;try{void 0!==t&&"function"==typeof cancelAnimationFrame&&cancelAnimationFrame(t),void 0!==e&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),"function"==typeof requestAnimationFrame&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function AE(n){return queueMicrotask(()=>n()),()=>{n=vh}}const Sg="isAngularZone",wh=Sg+"_ID";let NN=0;class Ct{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new $r(!1),this.onMicrotaskEmpty=new $r(!1),this.onStable=new $r(!1),this.onError=new $r(!1);const{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:s=TE}=e;if(typeof Zone>"u")throw new oe(908,!1);Zone.assertZonePatched();const o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&i,o.shouldCoalesceRunChangeDetection=r,o.callbackScheduled=!1,o.scheduleInRootZone=s,function FN(n){const e=()=>{!function LN(n){function e(){IE(()=>{n.callbackScheduled=!1,Dg(n),n.isCheckStableRunning=!0,Cg(n),n.isCheckStableRunning=!1})}n.isCheckStableRunning||n.callbackScheduled||(n.callbackScheduled=!0,n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Dg(n))}(n)},t=NN++;n._inner=n._inner.fork({name:"angular",properties:{[Sg]:!0,[wh]:t,[wh+t]:!0},onInvokeTask:(i,r,s,o,a,c)=>{if(function BN(n){return PE(n,"__ignore_ng_zone__")}(c))return i.invokeTask(s,o,a,c);try{return ME(n),i.invokeTask(s,o,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||n.shouldCoalesceRunChangeDetection)&&e(),xE(n)}},onInvoke:(i,r,s,o,a,c,l)=>{try{return ME(n),i.invoke(s,o,a,c,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!function jN(n){return PE(n,"__scheduler_tick__")}(c)&&e(),xE(n)}},onHasTask:(i,r,s,o)=>{i.hasTask(s,o),r===s&&("microTask"==o.change?(n._hasPendingMicrotasks=o.microTask,Dg(n),Cg(n)):"macroTask"==o.change&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(i,r,s,o)=>(i.handleError(s,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}(o)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get(Sg)}static assertInAngularZone(){if(!Ct.isInAngularZone())throw new oe(909,!1)}static assertNotInAngularZone(){if(Ct.isInAngularZone())throw new oe(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,kN,vh,vh);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const kN={};function Cg(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Dg(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&!0===n.callbackScheduled)}function ME(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function xE(n){n._nesting--,Cg(n)}class Tg{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new $r,this.onMicrotaskEmpty=new $r,this.onStable=new $r,this.onError=new $r}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}function PE(n,e){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0]?.data?.[e]}class vr{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&bg(e);for(;t&&bg(t);)t=bg(t);return t||null}}const zN=new ye("",{providedIn:"root",factory:()=>{const n=be(Ct),e=be(vr);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function UN(){return sa(At(),ee())}function sa(n,e){return new oa(Xn(n,e))}let oa=(()=>{class n{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=UN}}return n})();function RE(n){return n instanceof oa?n.nativeElement:n}function HN(){return this._results[Symbol.iterator]()}class Ig{get changes(){return this._changes??=new $r}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const t=Ig.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=HN)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;const i=function oi(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function iR(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}function Gc(n){return!(128&~n.flags)}const Mg=new Map;let $N=0;function xg(n){Mg.delete(n[Jo])}const Eh="__ngContext__";function Hn(n,e){bn(e)?(n[Eh]=e[Jo],function qN(n){Mg.set(n[Jo],n)}(e)):n[Eh]=e}function HE(n){return $E(n[Oc])}function GE(n){return $E(n[Yi])}function $E(n){for(;null!==n&&!Un(n);)n=n[Yi];return n}let Og;const ca=new ye("",{providedIn:"root",factory:()=>uk}),uk="ng",JE=new ye(""),Xs=new ye("",{providedIn:"platform",factory:()=>"unknown"}),eb=new ye(""),tb=new ye("",{providedIn:"root",factory:()=>function ys(){if(void 0!==Og)return Og;if(typeof document<"u")return document;throw new oe(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let nb=()=>null;function jg(n,e,t=!1){return nb(n,e,t)}const ub=new ye("",{providedIn:"root",factory:()=>!1});var ws=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(ws||{});let Qg;function Jg(n,e){return Qg(n,e)}function pa(n,e,t,i,r){if(null!=i){let s,o=!1;Un(i)?s=i:bn(i)&&(o=!0,i=i[Zt]);const a=ft(i);0===n&&null!==t?null==r?jb(e,t,a):Qs(e,t,a,r||null,!0):1===n&&null!==t?Qs(e,t,a,r||null,!0):2===n?function tl(n,e,t){n.removeChild(null,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function v2(n,e,t,i,r){const s=t[gr];s!==ft(t)&&pa(e,n,i,s,r);for(let a=on;a<t.length;a++){const c=t[a];Bh(c[ge],c,n,e,i,s)}}(e,n,s,t,r)}}function kh(n,e,t){return n.createElement(e,t)}function Lb(n,e){e[pr].changeDetectionScheduler?.notify(9),Bh(n,e,e[Xe],2,null,null)}function Fb(n,e){const t=n[ea],i=e[pn];(bn(i)||e[Qt]!==i[pn][Qt])&&(n[Ue]|=ih.HasTransplantedViews),null===t?n[ea]=[e]:t.push(e)}function n_(n,e){const t=n[ea],i=t.indexOf(e);t.splice(i,1)}function el(n,e){if(n.length<=on)return;const t=on+e,i=n[t];if(i){const r=i[Hs];null!==r&&r!==n&&n_(r,i),e>0&&(n[t-1][Yi]=i[Yi]);const s=$u(n,on+e);!function h2(n,e){Lb(n,e),e[Zt]=null,e[Rn]=null}(i[ge],i);const o=s[zr];null!==o&&o.detachView(s[ge]),i[pn]=null,i[Yi]=null,i[Ue]&=-129}return i}function Lh(n,e){if(!(256&e[Ue])){const t=e[Xe];t.destroyNode&&Bh(n,e,t,3,null,null),function f2(n){let e=n[Oc];if(!e)return i_(n[ge],n);for(;e;){let t=null;if(bn(e))t=e[Oc];else{const i=e[on];i&&(t=i)}if(!t){for(;e&&!e[Yi]&&e!==n;)bn(e)&&i_(e[ge],e),e=e[pn];null===e&&(e=n),bn(e)&&i_(e[ge],e),t=e&&e[Yi]}e=t}}(e)}}function i_(n,e){if(256&e[Ue])return;const t=le(null);try{e[Ue]&=-129,e[Ue]|=256,e[Pi]&&P(e[Pi]),function _2(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Vc)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],c=s[o+1];_r(4,a,c);try{c.call(a)}finally{_r(5,a,c)}}else{_r(4,r,s);try{s.call(r)}finally{_r(5,r,s)}}}}}(n,e),function g2(n,e){const t=n.cleanup,i=e[Xo];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[Xo]=null);const r=e[ms];if(null!==r){e[ms]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[ge].type&&e[Xe].destroy();const i=e[Hs];if(null!==i&&Un(e[pn])){i!==e[pn]&&n_(i,e);const r=e[zr];null!==r&&r.detachView(n)}xg(e)}finally{le(t)}}function r_(n,e,t){return function Bb(n,e,t){let i=e;for(;null!==i&&168&i.type;)i=(e=i).parent;if(null===i)return t[Zt];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===Wi.None||s===Wi.Emulated)return null}return Xn(i,t)}}(n,e.parent,t)}function Qs(n,e,t,i,r){n.insertBefore(e,t,i,r)}function jb(n,e,t){n.appendChild(e,t)}function Vb(n,e,t,i,r){null!==i?Qs(n,e,t,i,r):jb(n,e,t)}function s_(n,e){return n.parentNode(e)}let o_,Hb=function Ub(n,e,t){return 40&n.type?Xn(n,t):null};function Fh(n,e,t,i){const r=r_(n,i,e),s=e[Xe],a=function zb(n,e,t){return Hb(n,e,t)}(i.parent||e[Rn],i,e);if(null!=r)if(Array.isArray(t))for(let c=0;c<t.length;c++)Vb(s,r,t[c],a,!1);else Vb(s,r,t,a,!1);void 0!==o_&&o_(s,i,e,t,r)}function Js(n,e){if(null!==e){const t=e.type;if(3&t)return Xn(e,n);if(4&t)return a_(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Js(n,i);{const r=n[e.index];return Un(r)?a_(-1,r):ft(r)}}if(128&t)return Js(n,e.next);if(32&t)return Jg(e,n)()||ft(n[e.index]);{const i=$b(n,e);return null!==i?Array.isArray(i)?i[0]:Js(Ur(n[Qt]),i):Js(n,e.next)}}return null}function $b(n,e){return null!==e?n[Qt][Rn].projection[e.projection]:null}function a_(n,e){const t=on+n+1;if(t<e.length){const i=e[t],r=i[ge].firstChild;if(null!==r)return Js(i,r)}return e[gr]}function c_(n,e,t,i,r,s,o){for(;null!=t;){if(128===t.type){t=t.next;continue}const a=i[t.index],c=t.type;if(o&&0===e&&(a&&Hn(ft(a),i),t.flags|=2),32&~t.flags)if(8&c)c_(n,e,t.child,i,r,s,!1),pa(e,n,r,a,s);else if(32&c){const l=Jg(t,i);let u;for(;u=l();)pa(e,n,r,u,s);pa(e,n,r,a,s)}else 16&c?qb(n,e,i,t,r,s):pa(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Bh(n,e,t,i,r,s){c_(t,i,n.firstChild,e,r,s,!1)}function qb(n,e,t,i,r,s){const o=t[Qt],c=o[Rn].projection[i.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)pa(e,n,r,c[l],s);else{let l=c;const u=o[pn];Gc(i)&&(l.flags|=128),c_(n,e,l,u,r,s,!0)}}function Kb(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Yb(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&jp(n,e,i),null!==r&&Kb(n,e,r),null!==s&&function E2(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}const et={};function l_(n=1){Xb(st(),ee(),Nn()+n,!1)}function Xb(n,e,t,i){if(!i)if(3&~e[Ue]){const s=n.preOrderHooks;null!==s&&dh(e,s,0,t)}else{const s=n.preOrderCheckHooks;null!==s&&hh(e,s,t)}qs(t)}function rt(n,e=ct.Default){const t=ee();return null===t?Le(n,e):fE(At(),t,qe(n),e)}function Zb(n,e,t,i,r,s){const o=le(null);try{let a=null;r&_s.SignalBased&&(a=e[i][Pe]),null!==a&&void 0!==a.transformFn&&(s=a.transformFn(s)),r&_s.HasDecoratorInputTransform&&(s=n.inputTransforms[i].call(e,s)),null!==n.setInput?n.setInput(e,a,s,t,i):O0(e,a,i,s)}finally{le(o)}}function jh(n,e,t,i,r,s,o,a,c,l,u){const h=e.blueprint.slice();return h[Zt]=r,h[Ue]=204|i,(null!==l||n&&2048&n[Ue])&&(h[Ue]|=2048),B0(h),h[pn]=h[Zo]=n,h[Vt]=t,h[pr]=o||n&&n[pr],h[Xe]=a||n&&n[Xe],h[gn]=c||n&&n[gn]||null,h[Rn]=s,h[Jo]=function WN(){return $N++}(),h[Yn]=u,h[T0]=l,h[Qt]=2==e.type?n[Qt]:h,h}function eo(n,e,t,i,r){let s=n.data[e];if(null===s)s=function u_(n,e,t,i,r){const s=$0(),o=og(),c=n.data[e]=function x2(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,a=0;return function Ws(){return null!==Ze.skipHydrationRootTNode}()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=c),null!==s&&(o?null==s.child&&null!==c.parent&&(s.child=c):null===s.next&&(s.next=c,c.prev=s)),c}(n,e,t,i,r),function eN(){return Ze.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Bc(){const n=Ze.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Zi(s,!0),s}function nl(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function Qb(n,e,t,i,r){const s=Nn(),o=2&i;try{qs(-1),o&&e.length>Fe&&Xb(n,e,Fe,!1),_r(o?2:0,r),t(i,r)}finally{qs(s),_r(o?3:1,r)}}function h_(n,e,t){if(Zp(e)){const i=le(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{le(i)}}}function d_(n,e,t){U0()&&(function F2(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;Gs(t)&&function G2(n,e,t){const i=Xn(e,n),r=Jb(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=Vh(n,jh(n,r,null,o,i,e,null,n[pr].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=a}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||ph(t,e),Hn(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const c=n.data[a],l=Ys(e,n,a,t);Hn(l,e),null!==o&&$2(0,a-r,l,c,0,o),Xi(c)&&(mi(t.index,e)[Vt]=Ys(e,n,a,t))}}(n,e,t,Xn(t,e)),!(64&~t.flags)&&rS(n,e,t))}function f_(n,e,t=Xn){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function Jb(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=p_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function p_(n,e,t,i,r,s,o,a,c,l,u){const h=Fe+i,d=h+r,p=function C2(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:et);return t}(h,d),f="function"==typeof l?l():l;return p[ge]={type:n,blueprint:p,template:t,queries:null,viewQuery:a,declTNode:e,data:p.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:c,consts:f,incompleteFirstPass:!1,ssrId:u}}let eS=()=>null;function tS(n,e,t,i,r){for(let s in e){if(!e.hasOwnProperty(s))continue;const o=e[s];if(void 0===o)continue;i??={};let a,c=_s.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(null!==r){if(!r.hasOwnProperty(s))continue;l=r[s]}0===n?nS(i,t,l,a,c):nS(i,t,l,a)}return i}function nS(n,e,t,i,r){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,i):s=n[t]=[e,i],void 0!==r&&s.push(r)}function g_(n,e,t,i){if(U0()){const r=null===i?null:{"":-1},s=function j2(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(f0(e,o.selectors,!1))if(i||(i=[]),Xi(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),__(n,e,a.length)}else i.unshift(o),__(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&iS(n,e,t,o,r,a),r&&function V2(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new oe(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=Ac(t.mergedAttrs,t.attrs)}function iS(n,e,t,i,r,s){for(let l=0;l<i.length;l++)vg(ph(t,e),n,i[l].type);!function U2(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let l=0;l<i.length;l++){const u=i[l];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,c=nl(n,e,i.length,null);for(let l=0;l<i.length;l++){const u=i[l];t.mergedAttrs=Ac(t.mergedAttrs,u.hostAttrs),H2(n,t,e,c,u),z2(c,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const h=u.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}!function P2(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let c=null,l=null;for(let u=e.directiveStart;u<r;u++){const h=s[u],d=t?t.get(h):null,f=d?d.outputs:null;c=tS(0,h.inputs,u,c,d?d.inputs:null),l=tS(1,h.outputs,u,l,f);const m=null===c||null===o||Vp(e)?null:W2(c,u,o);a.push(m)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(n,t,s)}function rS(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function nN(){return Ze.lFrame.currentDirectiveIndex}();try{qs(s);for(let a=i;a<r;a++){const c=n.data[a],l=e[a];cg(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&B2(c,l)}}finally{qs(-1),cg(o)}}function B2(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function __(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function z2(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Xi(e)&&(t[""]=n)}}function H2(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=Vs(r.type)),o=new Vc(s,Xi(r),rt);n.blueprint[i]=o,t[i]=o,function k2(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function L2(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,nl(n,t,r.hostVars,et),r)}function $2(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)Zb(i,t,o[a++],o[a++],o[a++],o[a++])}function W2(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){i.push(s,o[a+1],o[a+2],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function sS(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function oS(n,e){const t=n.contentQueries;if(null!==t){const i=le(null);try{for(let r=0;r<t.length;r+=2){const o=t[r+1];if(-1!==o){const a=n.data[o];lh(t[r]),a.contentQueries(2,e[o],o)}}}finally{le(i)}}}function Vh(n,e){return n[Oc]?n[D0][Yi]=e:n[Oc]=e,n[D0]=e,e}function y_(n,e,t){lh(0);const i=le(null);try{e(n,t)}finally{le(i)}}function aS(n){return n[Xo]??=[]}function cS(n){return n.cleanup??=[]}function zh(n,e){const t=n[gn],i=t?t.get(vr,null):null;i&&i.handleError(e)}function v_(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],c=t[s++];Zb(n.data[o],e[o],i,a,c,r)}}function qr(n,e,t){const i=function Lc(n,e){return ft(e[n])}(e,n);!function kb(n,e,t){n.setValue(e,t)}(n[Xe],i,t)}function q2(n,e){const t=mi(e,n),i=t[ge];!function K2(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[Zt];null!==r&&null===t[Yn]&&(t[Yn]=jg(r,t[gn])),w_(i,t,t[Vt])}function w_(n,e,t){hg(e);try{const i=n.viewQuery;null!==i&&y_(1,i,t);const r=n.template;null!==r&&Qb(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[zr]?.finishViewCreation(n),n.staticContentQueries&&oS(n,e),n.staticViewQueries&&y_(2,n.viewQuery,t);const s=n.components;null!==s&&function Y2(n,e){for(let t=0;t<e.length;t++)q2(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Ue]&=-5,dg()}}function to(n,e){return!e||null===e.firstChild||Gc(n)}function il(n,e,t,i,r=!1){for(;null!==t;){if(128===t.type){t=r?t.projectionNext:t.next;continue}const s=e[t.index];null!==s&&i.push(ft(s)),Un(s)&&hS(s,i);const o=t.type;if(8&o)il(n,e,t.child,i);else if(32&o){const a=Jg(t,e);let c;for(;c=a();)i.push(c)}else if(16&o){const a=$b(e,t);if(Array.isArray(a))i.push(...a);else{const c=Ur(e[Qt]);il(c[ge],c,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function hS(n,e){for(let t=on;t<n.length;t++){const i=n[t],r=i[ge].firstChild;null!==r&&il(i[ge],i,r,e)}n[gr]!==n[Zt]&&e.push(n[gr])}let dS=[];const J2={...F,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{oh(n.lView)},consumerOnSignalRead(){this.lView[Pi]=this}},tL={...F,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{let e=Ur(n.lView);for(;e&&!fS(e[ge]);)e=Ur(e);e&&j0(e)},consumerOnSignalRead(){this.lView[Pi]=this}};function fS(n){return 2!==n.type}const nL=100;function Uh(n,e=!0,t=0){const i=n[pr],r=i.rendererFactory;r.begin?.();try{!function iL(n,e){const t=K0();try{Y0(!0),b_(n,e);let i=0;for(;sh(n);){if(i===nL)throw new oe(103,!1);i++,b_(n,1)}}finally{Y0(t)}}(n,t)}catch(o){throw e&&zh(n,o),o}finally{r.end?.(),i.inlineEffectRunner?.flush()}}function rL(n,e,t,i){const r=e[Ue];if(!(256&~r))return;e[pr].inlineEffectRunner?.flush(),hg(e);let a=!0,c=null,l=null;fS(n)?(l=function X2(n){return n[Pi]??function Z2(n){const e=dS.pop()??Object.create(J2);return e.lView=n,e}(n)}(e),c=x(l)):null===function Oe(){return ve}()?(a=!1,l=function eL(n){const e=n[Pi]??Object.create(tL);return e.lView=n,e}(e),c=x(l)):e[Pi]&&(P(e[Pi]),e[Pi]=null);try{B0(e),function X0(n){return Ze.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&Qb(n,e,t,2,i);const u=!(3&~r);if(u){const p=n.preOrderCheckHooks;null!==p&&hh(e,p,null)}else{const p=n.preOrderHooks;null!==p&&dh(e,p,0,null),fg(e,0)}if(function sL(n){for(let e=HE(n);null!==e;e=GE(e)){if(!(e[Ue]&ih.HasTransplantedViews))continue;const t=e[ea];for(let i=0;i<t.length;i++)j0(t[i])}}(e),gS(e,0),null!==n.contentQueries&&oS(n,e),u){const p=n.contentCheckHooks;null!==p&&hh(e,p)}else{const p=n.contentHooks;null!==p&&dh(e,p,1),fg(e,1)}!function S2(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)qs(~r);else{const s=r,o=t[++i],a=t[++i];tN(o,s),a(2,e[s])}}}finally{qs(-1)}}(n,e);const h=n.components;null!==h&&mS(e,h,0);const d=n.viewQuery;if(null!==d&&y_(2,d,i),u){const p=n.viewCheckHooks;null!==p&&hh(e,p)}else{const p=n.viewHooks;null!==p&&dh(e,p,2),fg(e,2)}if(!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[th]){for(const p of e[th])p();e[th]=null}e[Ue]&=-73}catch(u){throw oh(e),u}finally{null!==l&&(M(l,c),a&&function Q2(n){n.lView[Pi]!==n&&(n.lView=null,dS.push(n))}(l)),dg()}}function gS(n,e){for(let t=HE(n);null!==t;t=GE(t))for(let i=on;i<t.length;i++)_S(t[i],e)}function oL(n,e,t){_S(mi(e,n),t)}function _S(n,e){ng(n)&&b_(n,e)}function b_(n,e){const i=n[ge],r=n[Ue],s=n[Pi];let o=!!(0===e&&16&r);if(o||=!!(64&r&&0===e),o||=!!(1024&r),o||=!(!s?.dirty||!w(s)),o||=!1,s&&(s.dirty=!1),n[Ue]&=-9217,o)rL(i,n,i.template,n[Vt]);else if(8192&r){gS(n,1);const a=i.components;null!==a&&mS(n,a,1)}}function mS(n,e,t){for(let i=0;i<e.length;i++)oL(n,e[i],t)}function rl(n,e){const t=K0()?64:1088;for(n[pr].changeDetectionScheduler?.notify(e);n;){n[Ue]|=t;const i=Ur(n);if(Nc(n)&&!i)return n;n=i}return null}class sl{get rootNodes(){const e=this._lView,t=e[ge];return il(t,e,t.firstChild,[])}constructor(e,t,i=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Vt]}set context(e){this._lView[Vt]=e}get destroyed(){return!(256&~this._lView[Ue])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[pn];if(Un(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(el(e,i),$u(t,i))}this._attachedToViewContainer=!1}Lh(this._lView[ge],this._lView)}onDestroy(e){ah(this._lView,e)}markForCheck(){rl(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[Ue]&=-129}reattach(){ig(this._lView),this._lView[Ue]|=128}detectChanges(){this._lView[Ue]|=1024,Uh(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new oe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;const e=Nc(this._lView),t=this._lView[Hs];null!==t&&!e&&n_(t,this._lView),Lb(this._lView[ge],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new oe(902,!1);this._appRef=e;const t=Nc(this._lView),i=this._lView[Hs];null!==i&&!t&&Fb(i,this._lView),ig(this._lView)}}let Kr=(()=>{class n{static{this.__NG_ELEMENT_ID__=lL}}return n})();const aL=Kr,cL=class extends aL{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=function ga(n,e,t,i){const r=le(null);try{const s=e.tView,c=jh(n,s,t,4096&n[Ue]?4096:16,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null);c[Hs]=n[e.index];const u=n[zr];return null!==u&&(c[zr]=u.createEmbeddedView(s)),w_(s,c,t),c}finally{le(r)}}(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:i});return new sl(r)}};function lL(){return Hh(At(),ee())}function Hh(n,e){return 4&n.type?new cL(e,n,sa(n,e)):null}class ya{}const fl=new ye("",{providedIn:"root",factory:()=>!1}),jS=new ye(""),R_=new ye("");class tF{}class VS{}class iF{resolveComponentFactory(e){throw function nF(n){const e=Error(`No component factory found for ${vn(n)}.`);return e.ngComponent=n,e}(e)}}class va{static{this.NULL=new iF}}class Yh{}let US=(()=>{class n{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>function rF(){const n=ee(),t=mi(At().index,n);return(bn(t)?t:n)[Xe]}()}}return n})(),sF=(()=>{class n{static{this.\u0275prov=He({token:n,providedIn:"root",factory:()=>null})}}return n})();function Zh(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=wp(r,a):2==s&&(i=wp(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}class $S extends va{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=at(e);return new _l(t,this.ngModule)}}function WS(n,e){const t=[];for(const i in n){if(!n.hasOwnProperty(i))continue;const r=n[i];if(void 0===r)continue;const s=Array.isArray(r),o=s?r[0]:r;t.push(e?{propName:o,templateName:i,isSignal:!!((s?r[1]:_s.None)&_s.SignalBased)}:{propName:o,templateName:i})}return t}class _l extends VS{get inputs(){const e=this.componentDef,t=e.inputTransforms,i=WS(e.inputs,!0);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return WS(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function pR(n){return n.map(fR).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){const s=le(null);try{let o=(r=r||this.ngModule)instanceof Ki?r:r?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const a=o?new Ks(e,o):e,c=a.get(Yh,null);if(null===c)throw new oe(407,!1);const h={rendererFactory:c,sanitizer:a.get(sF,null),inlineEffectRunner:null,changeDetectionScheduler:a.get(ya,null)},d=c.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",f=i?function D2(n,e,t,i){const s=i.get(ub,!1)||t===Wi.ShadowDom,o=n.selectRootElement(e,s);return function T2(n){eS(n)}(o),o}(d,i,this.componentDef.encapsulation,a):kh(d,p,function cF(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(p));let m=512;this.componentDef.signals?m|=4096:this.componentDef.onPush||(m|=16);let v=null;null!==f&&(v=jg(f,a,!0));const C=p_(0,null,null,1,0,null,null,null,null,null,null),I=jh(null,C,null,m,null,null,h,d,a,null,v);hg(I);let L,H,ne=null;try{const se=this.componentDef;let ce,pe=null;se.findHostDirectiveDefs?(ce=[],pe=new Map,se.findHostDirectiveDefs(se,ce,pe),ce.push(se)):ce=[se];const De=function uF(n,e){const t=n[ge],i=Fe;return n[i]=e,eo(t,i,2,"#host",null)}(I,f);ne=function hF(n,e,t,i,r,s,o){const a=r[ge];!function dF(n,e,t,i){for(const r of n)e.mergedAttrs=Ac(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Zh(e,e.mergedAttrs,!0),null!==t&&Yb(i,t,e))}(i,n,e,o);let c=null;null!==e&&(c=jg(e,r[gn]));const l=s.rendererFactory.createRenderer(e,t);let u=16;t.signals?u=4096:t.onPush&&(u=64);const h=jh(r,Jb(t),null,u,r[n.index],n,s,l,null,null,c);return a.firstCreatePass&&__(a,n,i.length-1),Vh(r,h),r[n.index]=h}(De,f,se,ce,I,h,d),H=Fc(C,Fe),f&&function pF(n,e,t,i){if(i)jp(n,t,["ng-version","18.2.3"]);else{const{attrs:r,classes:s}=function gR(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!qi(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&jp(n,t,r),s&&s.length>0&&Kb(n,t,s.join(" "))}}(d,se,f,i),void 0!==t&&function gF(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(H,this.ngContentSelectors,t),L=function fF(n,e,t,i,r,s){const o=At(),a=r[ge],c=Xn(o,r);iS(a,r,o,t,null,i);for(let u=0;u<t.length;u++)Hn(Ys(r,a,o.directiveStart+u,o),r);rS(a,r,o),c&&Hn(c,r);const l=Ys(r,a,o.directiveStart+o.componentOffset,o);if(n[Vt]=r[Vt]=l,null!==s)for(const u of s)u(l,e);return h_(a,o,r),l}(ne,se,ce,pe,I,[_F]),w_(C,I,null)}catch(se){throw null!==ne&&xg(ne),xg(I),se}finally{dg()}return new lF(this.componentType,L,sa(H,I),I,H)}finally{le(s)}}}class lF extends tF{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new sl(r,void 0,!1),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;v_(s[ge],s,r,e,t),this.previousInputValues.set(e,t),rl(mi(this._tNode.index,s),1)}}get injector(){return new Sn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function _F(){const n=At();uh(ee()[ge],n)}let Er=(()=>{class n{static{this.__NG_ELEMENT_ID__=mF}}return n})();function mF(){return YS(At(),ee())}const yF=Er,qS=class extends yF{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return sa(this._hostTNode,this._hostLView)}get injector(){return new Sn(this._hostTNode,this._hostLView)}get parentInjector(){const e=gh(this._hostTNode,this._hostLView);if(_g(e)){const t=Uc(e,this._hostLView),i=zc(e);return new Sn(t[ge].data[i+8],t)}return new Sn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=KS(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-on}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,r,to(this._hostTNode,null)),a}createComponent(e,t,i,r,s){const o=e&&!function Pc(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const f=t||{};a=f.index,i=f.injector,r=f.projectableNodes,s=f.environmentInjector||f.ngModuleRef}const c=o?e:new _l(at(e)),l=i||this.parentInjector;if(!s&&null==c.ngModule){const m=(o?l:this.parentInjector).get(Ki,null);m&&(s=m)}at(c.componentType??{});const p=c.create(l,r,null,s);return this.insertImpl(p.hostView,a,to(this._hostTNode,null)),p}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){const r=e._lView;if(function $R(n){return Un(n[pn])}(r)){const a=this.indexOf(e);if(-1!==a)this.detach(a);else{const c=r[pn],l=new qS(c,c[Rn],c[pn]);l.detach(l.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;return function _a(n,e,t,i=!0){const r=e[ge];if(function p2(n,e,t,i){const r=on+i,s=t.length;i>0&&(t[r-1][Yi]=e),i<s-on?(e[Yi]=t[r],s0(t,on+i,e)):(t.push(e),e[Yi]=null),e[pn]=t;const o=e[Hs];null!==o&&t!==o&&Fb(o,e);const a=e[zr];null!==a&&a.insertView(n),ig(e),e[Ue]|=128}(r,e,n,t),i){const o=a_(t,n),a=e[Xe],c=s_(a,n[gr]);null!==c&&function d2(n,e,t,i,r,s){i[Zt]=r,i[Rn]=e,Bh(n,i,t,1,r,s)}(r,n[Rn],a,e,c,o)}const s=e[Yn];null!==s&&null!==s.firstChild&&(s.firstChild=null)}(o,r,s,i),e.attachToViewContainerRef(),s0(L_(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=KS(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=el(this._lContainer,t);i&&($u(L_(this._lContainer),t),Lh(i[ge],i))}detach(e){const t=this._adjustIndex(e,-1),i=el(this._lContainer,t);return i&&null!=$u(L_(this._lContainer),t)?new sl(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function KS(n){return n[8]}function L_(n){return n[8]||(n[8]=[])}function YS(n,e){let t;const i=e[n.index];return Un(i)?t=i:(t=sS(i,e,null,n),e[n.index]=t,Vh(e,t)),XS(t,e,n,i),new qS(t,n,e)}let XS=function QS(n,e,t,i){if(n[gr])return;let r;r=8&t.type?ft(i):function vF(n,e){const t=n[Xe],i=t.createComment(""),r=Xn(e,n);return Qs(t,s_(t,r),i,function m2(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[gr]=r},F_=()=>!1;class B_{constructor(e){this.queryList=e,this.matches=null}clone(){return new B_(this.queryList)}setDirty(){this.queryList.setDirty()}}class j_{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new j_(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==G_(e,t).matches&&this.queries[t].setDirty()}}class JS{constructor(e,t,i=null){this.flags=t,this.read=i,this.predicate="string"==typeof e?function IF(n){return n.split(",").map(e=>e.trim())}(e):e}}class V_{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new V_(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class z_{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new z_(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1&~this.metadata.flags){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,SF(t,s)),this.matchTNodeWithReadOption(e,t,_h(t,e,s,!1,!1))}else i===Kr?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,_h(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===oa||r===Er||r===Kr&&4&t.type)this.addMatch(t.index,-2);else{const s=_h(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function SF(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function DF(n,e,t,i){return-1===t?function CF(n,e){return 11&n.type?sa(n,e):4&n.type?Hh(n,e):null}(e,n):-2===t?function TF(n,e,t){return t===oa?sa(e,n):t===Kr?Hh(e,n):t===Er?YS(e,n):void 0}(n,e,i):Ys(n,n[ge],t,e)}function eC(n,e,t,i){const r=e[zr].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let c=0;null!==o&&c<o.length;c+=2){const l=o[c];a.push(l<0?null:DF(e,s[l],o[c+1],t.metadata.read))}r.matches=a}return r.matches}function U_(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=eC(n,e,r,t);for(let a=0;a<s.length;a+=2){const c=s[a];if(c>0)i.push(o[a/2]);else{const l=s[a+1],u=e[-c];for(let h=on;h<u.length;h++){const d=u[h];d[Hs]===d[pn]&&U_(d[ge],d,l,i)}if(null!==u[ea]){const h=u[ea];for(let d=0;d<h.length;d++){const p=h[d];U_(p[ge],p,l,i)}}}}}return i}function nC(n,e,t){const i=st();return i.firstCreatePass&&(function rC(n,e,t){null===n.queries&&(n.queries=new V_),n.queries.track(new z_(e,t))}(i,new JS(n,e,t),-1),!(2&~e)&&(i.staticViewQueries=!0)),function tC(n,e,t){const i=new Ig(!(4&~t));return function M2(n,e,t,i){const r=aS(e);r.push(t),n.firstCreatePass&&cS(n).push(i,r.length-1)}(n,e,i,i.destroy),(e[zr]??=new j_).queries.push(new B_(i))-1}(i,ee(),e)}function G_(n,e){return n.queries.getByIndex(e)}function sC(n,e){const t=n[ge],i=G_(t,e);return i.crossesNgTemplate?U_(t,n,e,[]):eC(t,n,i,e)}const oC=new Set;function Qn(n){oC.has(n)||(oC.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function so(n,e){Qn("NgSignals");const t=function S(n){const e=Object.create(qt);e.value=n;const t=()=>(D(e),e.value);return t[Pe]=e,t}(n),i=t[Pe];return e?.equal&&(i.equal=e.equal),t.set=r=>ke(i,r),t.update=r=>function Ye(n,e){y()||J(),ke(n,e(n.value))}(i,r),t.asReadonly=aC.bind(t),t}function aC(){const n=this[Pe];if(void 0===n.readonlyFn){const e=()=>this();e[Pe]=n,n.readonlyFn=e}return n.readonlyFn}class oo{}class CC extends oo{constructor(e){super(),this.componentFactoryResolver=new $S(this),this.instance=null;const t=new qo([...e.providers,{provide:oo,useValue:this},{provide:va,useValue:this.componentFactoryResolver}],e.parent||Ju(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function an(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function vl(n,e,t,i,r,s,o,a,c,l){const u=t+Fe,h=e.firstCreatePass?function nB(n,e,t,i,r,s,o,a,c){const l=e.consts,u=eo(e,n,4,o||null,a||null);g_(e,t,u,Oi(l,c)),uh(e,u);const h=u.tView=p_(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}(u,e,n,i,r,s,o,a,c):e.data[u];Zi(h,!1);const d=TC(e,n,h,t);jc()&&Fh(e,n,d,h),Hn(d,n);const p=sS(d,n,d,h);return n[u]=p,Vh(n,p),function ZS(n,e,t){return F_(n,e,t)}(p,h,n),rh(h)&&d_(e,n,h),null!=c&&f_(n,h,l),h}function X_(n,e,t,i,r,s,o,a){const c=ee(),l=st();return vl(c,l,n,e,t,i,r,Oi(l.consts,s),o,a),X_}let TC=function IC(n,e,t,i){return mr(!0),e[Xe].createComment("")};var Sa=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(Sa||{});let RC=(()=>{class n{constructor(){this.impl=null}execute(){this.impl?.execute()}static{this.\u0275prov=He({token:n,providedIn:"root",factory:()=>new n})}}return n})();class bl{constructor(){this.ngZone=be(Ct),this.scheduler=be(ya),this.errorHandler=be(vr,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static{this.PHASES=[Sa.EarlyRead,Sa.Write,Sa.MixedReadWrite,Sa.Read]}execute(){this.executing=!0;for(const e of bl.PHASES)for(const t of this.sequences)if(!t.erroredOrDestroyed&&t.hooks[e])try{t.pipelinedValue=this.ngZone.runOutsideAngular(()=>t.hooks[e](t.pipelinedValue))}catch(i){t.erroredOrDestroyed=!0,this.errorHandler?.handleError(i)}this.executing=!1;for(const e of this.sequences)e.afterRun(),e.once&&this.sequences.delete(e);for(const e of this.deferredRegistrations)this.sequences.add(e);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(e){this.executing?this.deferredRegistrations.add(e):(this.sequences.add(e),this.scheduler.notify(6))}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}static{this.\u0275prov=He({token:bl,providedIn:"root",factory:()=>new bl})}}function Cl(n,e,t){const i=ee();return an(i,Qi(),e)&&function li(n,e,t,i,r,s,o,a){const c=Xn(e,t);let u,l=e.inputs;!a&&null!=l&&(u=l[i])?(v_(n,t,u,i,r),Gs(e)&&function R2(n,e){const t=mi(e,n);16&t[Ue]||(t[Ue]|=64)}(t,e.index)):3&e.type&&(i=function O2(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(c,i,r))}(st(),function zt(){const n=Ze.lFrame;return Fc(n.tView,n.selectedIndex)}(),i,n,e,i[Xe],t,!1),Cl}function hm(n,e,t,i,r){const o=r?"class":"style";v_(n,t,e.inputs[o],o,i)}function Tl(n,e,t,i){const r=ee(),s=st(),o=Fe+n,a=r[Xe],c=s.firstCreatePass?function Mj(n,e,t,i,r,s){const o=e.consts,c=eo(e,n,2,i,Oi(o,r));return g_(e,t,c,Oi(o,s)),null!==c.attrs&&Zh(c,c.attrs,!1),null!==c.mergedAttrs&&Zh(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,e,t,i):s.data[o],l=TD(s,r,c,a,e,n);r[o]=l;const u=rh(c);return Zi(c,!0),Yb(a,l,c),!function Ea(n){return!(32&~n.flags)}(c)&&jc()&&Fh(s,r,l,c),0===function WR(){return Ze.lFrame.elementDepthCount}()&&Hn(l,r),function qR(){Ze.lFrame.elementDepthCount++}(),u&&(d_(s,r,c),h_(s,c,r)),null!==i&&f_(r,c),Tl}function ud(){let n=At();og()?function ag(){Ze.lFrame.isParent=!1}():(n=n.parent,Zi(n,!1));const e=n;(function YR(n){return Ze.skipHydrationRootTNode===n})(e)&&function JR(){Ze.skipHydrationRootTNode=null}(),function KR(){Ze.lFrame.elementDepthCount--}();const t=st();return t.firstCreatePass&&(uh(t,n),Zp(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function dN(n){return!!(8&n.flags)}(e)&&hm(t,e,ee(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function fN(n){return!!(16&n.flags)}(e)&&hm(t,e,ee(),e.stylesWithoutHost,!1),ud}function hd(n,e,t,i){return Tl(n,e,t,i),ud(),hd}let TD=(n,e,t,i,r,s)=>(mr(!0),kh(i,r,function iE(){return Ze.lFrame.currentNamespace}()));const dd="en-US";let ND=dd,QD=(n,e,t)=>{};function wm(n,e,t,i){const r=ee(),s=st(),o=At();return function Em(n,e,t,i,r,s,o){const a=rh(i),l=n.firstCreatePass&&cS(n),u=e[Vt],h=aS(e);let d=!0;if(3&i.type||o){const m=Xn(i,e),v=o?o(m):m,C=h.length,I=o?H=>o(ft(H[i.index])):i.index;let L=null;if(!o&&a&&(L=function D5(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[Xo],c=r[s+2];return a.length>c?a[c]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==L)(L.__ngLastListenerFn__||L).__ngNextListenerFn__=s,L.__ngLastListenerFn__=s,d=!1;else{s=nT(i,e,u,s),QD(m,r,s);const H=t.listen(v,r,s);h.push(s,H),l&&l.push(r,I,C,C+1)}}else s=nT(i,e,u,s);const p=i.outputs;let f;if(d&&null!==p&&(f=p[r])){const m=f.length;if(m)for(let v=0;v<m;v+=2){const ne=e[f[v]][f[v+1]].subscribe(s),se=h.length;h.push(s,ne),l&&l.push(r,i.index,se,-(se+1))}}}(s,r,r[Xe],o,n,e,i),wm}function tT(n,e,t,i){const r=le(null);try{return _r(6,e,t),!1!==t(i)}catch(s){return zh(n,s),!1}finally{_r(7,e,t),le(r)}}function nT(n,e,t,i){return function r(s){if(s===Function)return i;rl(n.componentOffset>-1?mi(n.index,e):e,5);let a=tT(e,t,i,s),c=r.__ngNextListenerFn__;for(;c;)a=tT(e,t,c,s)&&a,c=c.__ngNextListenerFn__;return a}}function bm(n=1){return function rN(n){return(Ze.lFrame.contextLView=function V0(n,e){for(;n>0;)e=e[Zo],n--;return e}(n,Ze.lFrame.contextLView))[Vt]}(n)}function pT(){return function H_(n,e){return n[zr].queries[e].queryList}(ee(),ug())}let DT=(n,e,t,i,r)=>(mr(!0),function e_(n,e){return n.createText(e)}(e[Xe],i));function Dm(n){return Tm("",n,""),Dm}function Tm(n,e,t){const i=ee(),r=function xa(n,e,t,i){return an(n,Qi(),t)?e+Je(t)+i:et}(i,n,e,t);return r!==et&&qr(i,Nn(),r),Tm}let e3=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=Up(0,t.type),r=i.length>0?function DC(n,e,t=null){return new CC({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=He({token:n,providedIn:"environment",factory:()=>new n(Le(Ki))})}}return n})();function Pm(n){Qn("NgStandalone"),n.getStandaloneInjector=e=>e.get(e3).getOrCreateStandaloneInjector(n)}function zT(n,e,t,i,r){return function HT(n,e,t,i,r,s,o){const a=e+t;return function ao(n,e,t,i){const r=an(n,e,t);return an(n,e+1,i)||r}(n,a,r,s)?function br(n,e,t){return n[e]=t}(n,a+2,o?i.call(o,r,s):i(r,s)):function Ol(n,e){const t=n[e];return t===et?void 0:t}(n,a+2)}(ee(),function Zn(){const n=Ze.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}(),n,e,t,i,r)}const dI=new ye(""),Ed=new ye("");let jm,Fm=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,jm||(function gV(n){jm=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ct.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb()}});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t()},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static{this.\u0275fac=function(i){return new(i||n)(Le(Ct),Le(Bm),Le(Ed))}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac})}}return n})(),Bm=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return jm?.findTestabilityInTree(this,t,i)??null}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();function Vm(n){return!!n&&"function"==typeof n.then}function fI(n){return!!n&&"function"==typeof n.subscribe}const _V=new ye("");let pI=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=be(_V,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=r();if(Vm(s))t.push(s);else if(fI(s)){const o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const zm=new ye("");let Dr=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=be(zN),this.afterRenderManager=be(RC),this.zonelessEnabled=be(fl),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new Ot,this.afterTick=new Ot,this.componentTypes=[],this.components=[],this.isStable=be(ra).hasPendingTasks.pipe(ii(t=>!t)),this._injector=be(Ki)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof VS;if(!this._injector.get(pI).done)throw!r&&function zs(n){const e=at(n)||wn(n)||On(n);return null!==e&&e.standalone}(t),new oe(405,!1);let o;o=r?t:this._injector.get(va).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function mV(n){return n.isBoundToModule}(o)?void 0:this._injector.get(oo),l=o.create(kn.NULL,[],i||o.selector,a),u=l.location.nativeElement,h=l.injector.get(dI,null);return h?.registerApplication(u),l.onDestroy(()=>{this.detachView(l.hostView),bd(this.components,l),h?.unregisterApplication(u)}),this._loadComponent(l),l}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new oe(101,!1);const t=le(null);try{this._runningTick=!0,this.synchronize()}catch(i){this.internalErrorHandler(i)}finally{this._runningTick=!1,le(t),this.afterTick.next()}}synchronize(){let t=null;this._injector.destroyed||(t=this._injector.get(Yh,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let i=0;for(;0!==this.dirtyFlags&&i++<10;)this.synchronizeOnce(t)}synchronizeOnce(t){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,7&this.dirtyFlags){const i=!!(1&this.dirtyFlags);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(i);for(let{_lView:r,notifyErrorHandler:s}of this._views)wV(r,s,i,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),7&this.dirtyFlags)return}else t?.begin?.(),t?.end?.();8&this.dirtyFlags&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){this.allViews.some(({_lView:t})=>sh(t))?this.dirtyFlags|=2:this.dirtyFlags&=-8}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;bd(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(zm,[]);[...this._bootstrapListeners,...i].forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>bd(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new oe(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function bd(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function wV(n,e,t,i){(t||sh(n))&&Uh(n,e,t&&!i?0:1)}let CV=(()=>{class n{constructor(){this.zone=be(Ct),this.changeDetectionScheduler=be(ya),this.applicationRef=be(Dr)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Um({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new Ct({...Hm(),scheduleInRootZone:t}),[{provide:Ct,useFactory:n},{provide:Mi,multi:!0,useFactory:()=>{const i=be(CV,{optional:!0});return()=>i.initialize()}},{provide:Mi,multi:!0,useFactory:()=>{const i=be(TV);return()=>{i.initialize()}}},!0===e?{provide:jS,useValue:!0}:[],{provide:R_,useValue:t??TE}]}function Hm(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}let TV=(()=>{class n{constructor(){this.subscription=new Xt,this.initialized=!1,this.zone=be(Ct),this.pendingTasks=be(ra)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Ct.assertNotInAngularZone(),queueMicrotask(()=>{null!==t&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Ct.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Ll=(()=>{class n{constructor(){this.appRef=be(Dr),this.taskService=be(ra),this.ngZone=be(Ct),this.zonelessEnabled=be(fl),this.disableScheduling=be(jS,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new Xt,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(wh):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(be(R_,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Tg||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&5===t)return;switch(t){case 0:this.appRef.dirtyFlags|=2;break;case 3:case 2:case 4:case 5:case 1:this.appRef.dirtyFlags|=4;break;case 7:this.appRef.deferredDirtyFlags|=8;break;default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;const i=this.useMicrotaskScheduler?AE:IE;this.pendingRenderTaskId=this.taskService.add(),this.cancelScheduledCallback=this.scheduleInRootZone?Zone.root.run(()=>i(()=>this.tick())):this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||null!==this.pendingRenderTaskId||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(wh+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&7&this.appRef.dirtyFlags&&(this.appRef.dirtyFlags|=1);const t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){throw this.taskService.remove(t),i}finally{this.cleanup()}this.useMicrotaskScheduler=!0,AE(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,null!==this.pendingRenderTaskId){const t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const Cs=new ye("",{providedIn:"root",factory:()=>be(Cs,ct.Optional|ct.SkipSelf)||function AV(){return typeof $localize<"u"&&$localize.locale||dd}()}),$m=new ye("");function Cd(n){return!!n.platformInjector}let Ds=null;let qm=(()=>{class n{static{this.__NG_ELEMENT_ID__=jV}}return n})();function jV(n){return function VV(n,e,t){if(Gs(n)&&!t){const i=mi(n.index,e);return new sl(i,i)}return 175&n.type?new sl(e[Qt],e):null}(At(),ee(),!(16&~n))}let QV=(()=>{class n{constructor(t){}static{this.\u0275fac=function(i){return new(i||n)(Le(Dr))}}static{this.\u0275mod=Mc({type:n})}static{this.\u0275inj=Ho({})}}return n})();function uz(n){try{const{rootComponent:e,appProviders:t,platformProviders:i}=n,r=function FV(n=[]){if(Ds)return Ds;const e=function DI(n=[],e){return kn.create({name:e,providers:[{provide:$p,useValue:"platform"},{provide:$m,useValue:new Set([()=>Ds=null])},...n]})}(n);return Ds=e,function gI(){!function q(n){X=n}(()=>{throw new oe(600,!1)})}(),function TI(n){n.get(JE,null)?.forEach(t=>t())}(e),e}(i),s=[Um({}),{provide:ya,useExisting:Ll},...t||[]];return function bI(n){const e=Cd(n)?n.r3Injector:n.moduleRef.injector,t=e.get(Ct);return t.run(()=>{Cd(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();const i=e.get(vr,null);let r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:s=>{i.handleError(s)}})}),Cd(n)){const s=()=>e.destroy(),o=n.platformInjector.get($m);o.add(s),e.onDestroy(()=>{r.unsubscribe(),o.delete(s)})}else n.moduleRef.onDestroy(()=>{bd(n.allPlatformModules,n.moduleRef),r.unsubscribe()});return function vV(n,e,t){try{const i=t();return Vm(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(i,t,()=>{const s=e.get(pI);return s.runInitializers(),s.donePromise.then(()=>{if(function zj(n){"string"==typeof n&&(ND=n.toLowerCase().replace(/_/g,"-"))}(e.get(Cs,dd)||dd),Cd(n)){const a=e.get(Dr);return void 0!==n.rootComponent&&a.bootstrap(n.rootComponent),a}return function NV(n,e){const t=n.injector.get(Dr);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>t.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new oe(-403,!1);n.instance.ngDoBootstrap(t)}e.push(n)}(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}({r3Injector:new CC({providers:s,parent:r,debugName:"",runEnvironmentInitializers:!1}).injector,platformInjector:r,rootComponent:e})}catch(e){return Promise.reject(e)}}const QI=new ye("");function Ts(n,e){Qn("NgSignals");const t=function ie(n){const e=Object.create(O);e.computation=n;const t=()=>{if(_(e),D(e),e.value===V)throw e.error;return e.value};return t[Pe]=e,t}(n);return e?.equal&&(t[Pe].equal=e.equal),t}function Nd(n){const e=le(null);try{return n()}finally{le(e)}}const Pz=new ye("",{providedIn:"root",factory:()=>be(Oz)});let Oz=(()=>{class n{static{this.\u0275prov=He({token:n,providedIn:"root",factory:()=>new Rz})}}return n})();class Rz{constructor(){this.queuedEffectCount=0,this.queues=new Map,this.pendingTasks=be(ra),this.taskId=null}scheduleEffect(e){if(this.enqueue(e),null===this.taskId){const t=this.taskId=this.pendingTasks.add();queueMicrotask(()=>{this.flush(),this.pendingTasks.remove(t),this.taskId=null})}}enqueue(e){const t=e.creationZone;this.queues.has(t)||this.queues.set(t,new Set);const i=this.queues.get(t);i.has(e)||(this.queuedEffectCount++,i.add(e))}flush(){for(;this.queuedEffectCount>0;)for(const[e,t]of this.queues)null===e?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(const t of e)e.delete(t),this.queuedEffectCount--,t.run()}}class Nz{constructor(e,t,i,r,s,o){this.scheduler=e,this.effectFn=t,this.creationZone=i,this.injector=s,this.watcher=function Vn(n,e,t){const i=Object.create(yn);t&&(i.consumerAllowSignalWrites=!0),i.fn=n,i.schedule=e;const r=c=>{i.cleanupFn=c};return i.ref={notify:()=>A(i),run:()=>{if(null===i.fn)return;if(function te(){return Te}())throw new Error("Schedulers cannot synchronously execute watches while scheduling.");if(i.dirty=!1,i.hasRun&&!w(i))return;i.hasRun=!0;const c=x(i);try{i.cleanupFn(),i.cleanupFn=St,i.fn(r)}finally{M(i,c)}},cleanup:()=>i.cleanupFn(),destroy:()=>function o(c){(function s(c){return null===c.fn&&null===c.schedule})(c)||(P(c),c.cleanupFn(),c.fn=null,c.schedule=null,c.cleanupFn=St)}(i),[Pe]:i},i.ref}(a=>this.runEffect(a),()=>this.schedule(),o),this.unregisterOnDestroy=r?.onDestroy(()=>this.destroy())}runEffect(e){try{this.effectFn(e)}catch(t){this.injector.get(vr,null,{optional:!0})?.handleError(t)}}run(){this.watcher.run()}schedule(){this.scheduler.scheduleEffect(this)}destroy(){this.watcher.destroy(),this.unregisterOnDestroy?.()}}let u1=null;function ny(){return u1}class Lz{}const Yr=new ye(""),dy=/\s+/,v1=[];let w1=(()=>{class n{constructor(t,i){this._ngEl=t,this._renderer=i,this.initialClasses=v1,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(dy):v1}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(dy):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(dy).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static{this.\u0275fac=function(i){return new(i||n)(rt(oa),rt(US))}}static{this.\u0275dir=xi({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"},standalone:!0})}}return n})(),S1=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new TU,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){C1("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){C1("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static{this.\u0275fac=function(i){return new(i||n)(rt(Er),rt(Kr))}}static{this.\u0275dir=xi({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return n})();class TU{constructor(){this.$implicit=null,this.ngIf=null}}function C1(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${vn(e)}'.`)}let my=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Mc({type:n})}static{this.\u0275inj=Ho({})}}return n})();function A1(n){return"server"===n}class IH extends Lz{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Ey extends IH{static makeCurrent(){!function kz(n){u1??=n}(new Ey)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function AH(){return Hl=Hl||document.querySelector("base"),Hl?Hl.getAttribute("href"):null}();return null==t?null:function MH(n){return new URL(n,document.baseURI).pathname}(t)}resetBaseElement(){Hl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function bU(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let Hl=null,PH=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac})}}return n})();const Yd=new ye("");let B1=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new oe(5101,!1);return this._eventNameToPlugin.set(t,i),i}static{this.\u0275fac=function(i){return new(i||n)(Le(Yd),Le(Ct))}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac})}}return n})();class by{constructor(e){this._doc=e}}const Sy="ng-app-id";let j1=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=A1(s),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${Sy}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(Sy),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(Sy,this.appId),t.appendChild(o),o}}addStyleToHost(t,i){const r=this.getStyleElement(t,i),s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(i){return new(i||n)(Le(Yr),Le(ca),Le(tb,8),Le(Xs))}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac})}}return n})();const Cy={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Dy=/%COMP%/g,kH=new ye("",{providedIn:"root",factory:()=>!0});function z1(n,e){return e.map(t=>t.replace(Dy,n))}let Ty=(()=>{class n{constructor(t,i,r,s,o,a,c,l=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=A1(a),this.defaultRenderer=new Iy(t,o,c,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Wi.ShadowDom&&(i={...i,encapsulation:Wi.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof H1?r.applyToHost(t):r instanceof Ay&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case Wi.Emulated:s=new H1(c,l,i,this.appId,u,o,a,h);break;case Wi.ShadowDom:return new jH(c,l,t,i,o,a,this.nonce,h);default:s=new Ay(c,l,i,u,o,a,h)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(i){return new(i||n)(Le(B1),Le(j1),Le(ca),Le(kH),Le(Yr),Le(Xs),Le(Ct),Le(tb))}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac})}}return n})();class Iy{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Cy[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(U1(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(U1(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new oe(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=Cy[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=Cy[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(ws.DashCase|ws.Important)?e.style.setProperty(t,i,r&ws.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&ws.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){null!=e&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=ny().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function U1(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class jH extends Iy{constructor(e,t,i,r,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=z1(r.id,r.styles);for(const u of l){const h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=u,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Ay extends Iy{constructor(e,t,i,r,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=c?z1(c,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class H1 extends Ay{constructor(e,t,i,r,s,o,a,c){const l=r+"-"+i.id;super(e,t,i,s,o,a,c,l),this.contentAttr=function LH(n){return"_ngcontent-%COMP%".replace(Dy,n)}(l),this.hostAttr=function FH(n){return"_nghost-%COMP%".replace(Dy,n)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let VH=(()=>{class n extends by{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static{this.\u0275fac=function(i){return new(i||n)(Le(Yr))}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac})}}return n})(),zH=(()=>{class n extends by{constructor(t){super(t),this.delegate=be(QI,{optional:!0})}supports(t){return!!this.delegate&&this.delegate.supports(t)}addEventListener(t,i,r){return this.delegate.addEventListener(t,i,r)}removeEventListener(t,i,r){return this.delegate.removeEventListener(t,i,r)}static{this.\u0275fac=function(i){return new(i||n)(Le(Yr))}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac})}}return n})();const G1=["alt","control","meta","shift"],UH={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},HH={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let GH=(()=>{class n extends by{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ny().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),G1.forEach(l=>{const u=i.indexOf(l);u>-1&&(i.splice(u,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const c={};return c.domEventName=r,c.fullKey=o,c}static matchEventFullKeyCode(t,i){let r=UH[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),G1.forEach(o=>{o!==r&&(0,HH[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static{this.\u0275fac=function(i){return new(i||n)(Le(Yr))}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac})}}return n})();const YH=[{provide:Xs,useValue:"browser"},{provide:JE,useValue:function WH(){Ey.makeCurrent()},multi:!0},{provide:Yr,useFactory:function KH(){return function lk(n){Og=n}(document),document},deps:[]}],XH=new ye(""),W1=[{provide:Ed,useClass:class xH{addToWindow(e){Kt.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new oe(5103,!1);return s},Kt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Kt.getAllAngularRootElements=()=>e.getAllRootElements(),Kt.frameworkStabilizers||(Kt.frameworkStabilizers=[]),Kt.frameworkStabilizers.push(i=>{const r=Kt.getAllAngularTestabilities();let s=r.length;const o=function(){s--,0==s&&i()};r.forEach(a=>{a.whenStable(o)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?ny().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:dI,useClass:Fm,deps:[Ct,Bm,Ed]},{provide:Fm,useClass:Fm,deps:[Ct,Bm,Ed]}],q1=[{provide:$p,useValue:"root"},{provide:vr,useFactory:function qH(){return new vr},deps:[]},{provide:Yd,useClass:VH,multi:!0,deps:[Yr,Ct,Xs]},{provide:Yd,useClass:GH,multi:!0,deps:[Yr]},{provide:Yd,useClass:zH,multi:!0},Ty,j1,B1,{provide:Yh,useExisting:Ty},{provide:class JU{},useClass:PH,deps:[]},[]];let ZH=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:ca,useValue:t.appId}]}}static{this.\u0275fac=function(i){return new(i||n)(Le(XH,12))}}static{this.\u0275mod=Mc({type:n})}static{this.\u0275inj=Ho({providers:[...q1,...W1],imports:[my,QV]})}}return n})();const My={now:()=>(My.delegate||Date).now(),delegate:void 0};class tG extends Ot{constructor(e=1/0,t=1/0,i=My){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;t||(i.push(e),!r&&i.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:i,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!e.closed;o+=i?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:i,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<i.length&&i.splice(0,i.length-s),!r){const o=t.now();let a=0;for(let c=1;c<i.length&&i[c]<=o;c+=2)a=c;a&&i.splice(0,a+1)}}}function Is(n){return this instanceof Is?(this.v=n,this):new Is(n)}function J1(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function Ry(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){!function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}(a,c,(o=n[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const eA=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function tA(n){return Pt(n?.then)}function nA(n){return Pt(n[dc])}function iA(n){return Symbol.asyncIterator&&Pt(n?.[Symbol.asyncIterator])}function rA(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const sA=function SG(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function oA(n){return Pt(n?.[sA])}function aA(n){return function Q1(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function o(p){return function(f){return Promise.resolve(f).then(p,h)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(p,f){i[p]&&(r[p]=function(m){return new Promise(function(v,C){s.push([p,m,v,C])>1||c(p,m)})},f&&(r[p]=f(r[p])))}function c(p,f){try{!function l(p){p.value instanceof Is?Promise.resolve(p.value.v).then(u,h):d(s[0][2],p)}(i[p](f))}catch(m){d(s[0][3],m)}}function u(p){c("next",p)}function h(p){c("throw",p)}function d(p,f){p(f),s.shift(),s.length&&c(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield Is(t.read());if(r)return yield Is(void 0);yield yield Is(i)}}finally{t.releaseLock()}})}function cA(n){return Pt(n?.getReader)}function Tr(n){if(n instanceof sn)return n;if(null!=n){if(nA(n))return function CG(n){return new sn(e=>{const t=n[dc]();if(Pt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(eA(n))return function DG(n){return new sn(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(tA(n))return function TG(n){return new sn(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,bu)})}(n);if(iA(n))return lA(n);if(oA(n))return function IG(n){return new sn(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(cA(n))return function AG(n){return lA(aA(n))}(n)}throw rA(n)}function lA(n){return new sn(e=>{(function MG(n,e){var t,i,r,s;return function X1(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,c)}l((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=J1(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function Qr(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function Zd(n,e,t=1/0){return Pt(e)?Zd((i,r)=>ii((s,o)=>e(i,s,r,o))(Tr(n(i,r))),t):("number"==typeof e&&(t=e),Pn((i,r)=>function xG(n,e,t,i,r,s,o,a){const c=[];let l=0,u=0,h=!1;const d=()=>{h&&!c.length&&!l&&e.complete()},p=m=>l<i?f(m):c.push(m),f=m=>{s&&e.next(m),l++;let v=!1;Tr(t(m,u++)).subscribe(hn(e,C=>{r?.(C),s?p(C):e.next(C)},()=>{v=!0},void 0,()=>{if(v)try{for(l--;c.length&&l<i;){const C=c.shift();o?Qr(e,o,()=>f(C)):f(C)}d()}catch(C){e.error(C)}}))};return n.subscribe(hn(e,p,()=>{h=!0,d()})),()=>{a?.()}}(i,r,n,t)))}const uA=new sn(n=>n.complete());function Ny(n){return n[n.length-1]}function dA(n){return function RG(n){return n&&Pt(n.schedule)}(Ny(n))?n.pop():void 0}function ky(n,e=0){return Pn((t,i)=>{t.subscribe(hn(i,r=>Qr(i,n,()=>i.next(r),e),()=>Qr(i,n,()=>i.complete(),e),r=>Qr(i,n,()=>i.error(r),e)))})}function fA(n,e=0){return Pn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function pA(n,e){if(!n)throw new Error("Iterable cannot be null");return new sn(t=>{Qr(t,e,()=>{const i=n[Symbol.asyncIterator]();Qr(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Ly(n,e){return e?function VG(n,e){if(null!=n){if(nA(n))return function kG(n,e){return Tr(n).pipe(fA(e),ky(e))}(n,e);if(eA(n))return function FG(n,e){return new sn(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(tA(n))return function LG(n,e){return Tr(n).pipe(fA(e),ky(e))}(n,e);if(iA(n))return pA(n,e);if(oA(n))return function BG(n,e){return new sn(t=>{let i;return Qr(t,e,()=>{i=n[sA](),Qr(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>Pt(i?.return)&&i.return()})}(n,e);if(cA(n))return function jG(n,e){return pA(aA(n),e)}(n,e)}throw rA(n)}(n,e):Tr(n)}const Qd={schedule(n,e){const t=setTimeout(n,e);return()=>clearTimeout(t)},scheduleBeforeRender(n){if(typeof window>"u")return Qd.schedule(n,0);if(typeof window.requestAnimationFrame>"u")return Qd.schedule(n,16);const e=window.requestAnimationFrame(n);return()=>window.cancelAnimationFrame(e)}};let Fy;function ZG(n,e,t){let i=t;return function GG(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}(n)&&e.some((r,s)=>!("*"===r||!function WG(n,e){if(!Fy){const t=Element.prototype;Fy=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE&&Fy.call(n,e)}(n,r)||(i=s,0))),i}class JG{constructor(e,t){this.componentFactory=t.get(va).resolveComponentFactory(e)}create(e){return new e$(this.componentFactory,e)}}class e${constructor(e,t){this.componentFactory=e,this.injector=t,this.eventEmitters=new tG(1),this.events=this.eventEmitters.pipe(function UG(n,e){return Pn((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(hn(i,c=>{r?.unsubscribe();let l=0;const u=s++;Tr(n(c,u)).subscribe(r=hn(i,h=>i.next(e?e(c,h,u,l++):h),()=>{r=null,a()}))},()=>{o=!0,a()}))})}(i=>function zG(...n){const e=dA(n),t=function NG(n,e){return"number"==typeof Ny(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Tr(i[0]):function PG(n=1/0){return Zd(kr,n)}(t)(Ly(i,e)):uA}(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(Ct),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=Qd.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(e){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,t,i){this.runInZone(()=>{i&&(t=i.call(this.componentRef?.instance,t)),null!==this.componentRef?function qG(n,e){return n===e||n!=n&&e!=e}(t,this.getInputValue(e))&&(void 0!==t||!this.unchangedInputs.has(e))||(this.recordInputChange(e,t),this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.instance[e]=t,this.scheduleDetectChanges()):this.initialInputValues.set(e,t)})}initializeComponent(e){const t=kn.create({providers:[],parent:this.injector}),i=function XG(n,e){const t=n.childNodes,i=e.map(()=>[]);let r=-1;e.some((s,o)=>"*"===s&&(r=o,!0));for(let s=0,o=t.length;s<o;++s){const a=t[s],c=ZG(a,e,r);-1!==c&&i[c].push(a)}return i}(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(t,i,e),this.viewChangeDetectorRef=this.componentRef.injector.get(qm),this.implementsOnChanges=function $G(n){return"function"==typeof n}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(Dr).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:e,transform:t})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e),t)}),this.initialInputValues.clear()}initializeOutputs(e){const t=this.componentFactory.outputs.map(({propName:i,templateName:r})=>e.instance[i].pipe(ii(o=>({name:r,value:o}))));this.eventEmitters.next(t)}callNgOnChanges(e){if(!this.implementsOnChanges||null===this.inputChanges)return;const t=this.inputChanges;this.inputChanges=null,e.instance.ngOnChanges(t)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=Qd.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(e,t){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const i=this.inputChanges[e];if(i)return void(i.currentValue=t);const r=this.unchangedInputs.has(e),s=r?void 0:this.getInputValue(e);this.inputChanges[e]=new P0(s,t,r)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}class t$ extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}var rr=function(n){return n.AREA="Area",n.FILLING="Filling",n.FRAME="Frame",n.WING="Wing",n.DIVIDER="Divider",n.BEAM="Beam",n.DIMENSION="Dimension",n}(rr||{});class By{constructor(e){this.parent=null,this.children=[],this.data=e}addChildren(e){for(const t of e)this.addChild(t)}addChild(e){if(e.parent)throw Error("child has already had parent");e.parent=this,this.children.push(e)}createChild(e){const t=new By(e);return t.parent=this,this.children.push(t),t}removeChild(e){const t=this.children.indexOf(e);return t>0&&(this.children.splice(t,1),!0)}}class a${constructor(e,t,i=""){this.id=e,this.root=t,this.title=i}setRoot(e){this.root=e}addElement(e,t){t.createChild(e)}removeElement(e){return!!e.parent?.removeChild(e)}getElementById(e,t=this.root){if(!t)return null;if(t.data.id===e)return t;for(const i of t.children){const r=this.getElementById(e,i);if(r)return r}return null}}class Ga extends By{constructor(e){super(e)}}class _A extends Ga{constructor(e){super(e)}get type(){return"beam"}}class c$ extends Ga{constructor(e){super(e)}get type(){return"filling"}}class l$ extends Ga{constructor(e){super(e)}get type(){return"wing"}}class u$ extends Ga{constructor(e){super(e)}get type(){return"construction"}}class h$ extends Ga{constructor(e){super(e)}get type(){return"frame"}}class d$ extends Ga{constructor(e){super(e)}get type(){return"divider"}}class f$ extends a${}function jy(n){return{...n}}function mA(n,e,t=1){return{title:n,values:e,order:t}}function Gl(n,e,t,i){return{name:n,description:e,order:t,icon:i}}function yA(n,e,t){return{name:n,description:e,order:t}}var As=function(n){return n.DEFAULT="DEFAULT",n.DRAW_IMPOST="DRAW_IMPOST",n.DRAW_FRAME="DRAW_FRAME",n.DRAW_WING="DRAW_WING",n.DIMLINEAR="DIMLINEAR",n.DIMALIGNED="DIMALIGNED",n}(As||{});function Ln(n,e){return Math.sqrt((e.x-n.x)*(e.x-n.x)+(e.y-n.y)*(e.y-n.y))}function wA(n,e){return new Array(e).fill(n)}function Li(n){return n.reduce((e,t)=>e+t,0)}function SA(n){return n.reduce((e,t)=>e.concat(Array.isArray(t)?SA(t):t),[])}Error;var O$=Object.defineProperty,$y=(n,e)=>{for(var t in e)O$(n,t,{get:e[t],enumerable:!0})},tf=1e-6;function lt(n,e,t=tf){return!isNaN(n)&&!isNaN(e)&&Math.abs(n-e)<t}function Ir(n,e,t,i=tf){return e>t&&([e,t]=[t,e]),n>e+i&&n<t-i}function AA(n,e=1){return Math.round(n/e)*e}function $a(n,e=-1/0,t=1/0){return Math.min(t,Math.max(e,n))}function qy(n,e,t=.5){return n+(e-n)*t}function sr(n){return n*n}function G$(n,e=0){const i=xA(n.slice(0));return e?i.filter(r=>r.length===e):i}function xA(n){if(1===n.length)return[[],n];const e=n.pop(),t=xA(n),i=[];for(const r of t)i.push(r,[...r,e]);return i}function OA(n,e,t){return function EA(n,e,t){const i=[];for(let r=0;r<e;++r)i.push(wA(n,t));return i}(n,e,t)}function RA(n=2){const e=OA(0,n,n);for(let t=0;t<n;++t)e[t][t]=1;return e}function K$(n){const e=Math.sin(n),t=Math.cos(n);return[[t,-e],[e,t]]}function Y$(n){return[[1,n],[0,1]]}function X$(n){const e=Math.sin(2*n),t=Math.cos(2*n);return[[t,e],[e,-t]]}function NA(...n){const[e,...t]=n,i=t.length>1?NA(...t):t[0];if(e.length!==i.length||e[0].length!==i[0].length)throw new Error("Matrix sizes don\u2019t match");const r=[];for(let s=0;s<e.length;++s){const o=[];for(let a=0;a<e[s].length;++a)o.push(e[s][a]+i[s][a]);r.push(o)}return r}function Z$(n,e){return n.map(t=>t.map(i=>i*e))}function cf(...n){const[e,...t]=n,i=t.length>1?cf(...t):t[0];if(e[0].length!==i.length)throw new Error("Matrix sizes don\u2019t match.");const r=[];for(let s=0;s<e.length;++s){const o=[];for(let a=0;a<i[0].length;++a){let c=0;for(let l=0;l<i.length;++l)c+=e[s][l]*i[l][a];o.push(c)}r.push(o)}return r}function kA(n){const e=[];for(let t=0;t<n[0].length;++t){const i=[];for(let r=0;r<n.length;++r)i.push(n[r][t]);e.push(i)}return e}function Q$(n){if(n.length!==n[0].length)throw new Error("Not a square matrix.");const e=n.length;if(1===e)return n[0][0];if(2===e)return n[0][0]*n[1][1]-n[0][1]*n[1][0];let t=0;for(let i=0;i<e;++i){let r=n[0][i],s=n[0][i];for(let o=1;o<e;++o)s*=n[o][(i+o)%e],r*=n[o][(i-o+e)%e];t+=s-r}return t}function LA(n){const e=n.length;if(e!==n[0].length)throw new Error("Not a square matrix.");const t=RA(e),i=function b$(n,e,t){const i=[];for(let r=0;r<e;++r){const s=[];for(let o=0;o<t;++o)s.push(n(r,o));i.push(s)}return i}((r,s)=>n[r][s],e,e);for(let r=0;r<e;++r){let s=i[r][r];if(lt(s,0)){for(let o=r+1;o<e;++o)if(0!==i[o][r]){for(let a=0;a<e;++a)[i[o][a],i[r][a]]=[i[r][a],i[o][a]],[t[o][a],t[r][a]]=[t[r][a],t[o][a]];break}if(s=i[r][r],lt(s,0))throw new Error("Matrix not invertible.")}for(let o=0;o<e;++o)i[r][o]=i[r][o]/s,t[r][o]=t[r][o]/s;for(let o=0;o<e;++o){if(o===r)continue;const a=i[o][r];for(let c=0;c<e;++c)i[o][c]-=a*i[r][c],t[o][c]-=a*t[r][c]}}return t}$y({},{determinant:()=>Q$,fill:()=>OA,identity:()=>RA,inverse:()=>LA,product:()=>cf,reflection:()=>X$,rotation:()=>K$,scalarProduct:()=>Z$,shear:()=>Y$,sum:()=>NA,transpose:()=>kA});var Xy={};function J$(n){for(let e=(n=n.slice(0)).length-1;e>0;--e){const t=Math.floor(Math.random()*(e+1));[n[e],n[t]]=[n[t],n[e]]}return n}function e8(n,e){return(void 0===e?0:n)+Math.floor((void 0===e?n:e-n+1)*Math.random())}function FA(n){const e=Math.random()*Li(n);let t=0;return n.findIndex(i=>(t+=i)>=e)}function t8(n){return n[Math.floor(n.length*Math.random())]}$y(Xy,{bernoulli:()=>BA,binomial:()=>i8,cauchy:()=>l8,chiCDF:()=>h8,exponential:()=>a8,find:()=>t8,geometric:()=>c8,integer:()=>e8,integrate:()=>UA,normal:()=>o8,normalPDF:()=>u8,poisson:()=>r8,shuffle:()=>J$,smart:()=>n8,uniform:()=>s8,weighted:()=>FA});var lf=new Map;function n8(n,e){e||(e=function y$(n=10){return Math.random().toString(36).substr(2,n)}()),lf.has(e)||lf.set(e,wA(1,n));const t=lf.get(e),i=FA(t.map(r=>r*r));return t[i]-=1,t[i]<=0&&lf.set(e,t.map(r=>r+1)),i}function BA(n=.5){return Math.random()<n?1:0}function i8(n=1,e=.5){let t=0;for(let i=0;i<n;++i)t+=BA(e);return t}function r8(n=1){if(n<=0)return 0;const e=Math.exp(-n);let t=1,i=0;for(;t>e;++i)t*=Math.random();return i-1}function s8(n=0,e=1){return n+(e-n)*Math.random()}function o8(n=0,e=1){const t=Math.random(),i=Math.random();return Math.sqrt(-2*Math.log(t))*Math.cos(2*Math.PI*i)*Math.sqrt(e)+n}function a8(n=1){return n<=0?0:-Math.log(Math.random())/n}function c8(n=.5){if(!(n<=0||n>1))return Math.floor(Math.log(Math.random())/Math.log(1-n))}function l8(){let n,e,t;do{e=2*Math.random()-1,t=2*Math.random()-1,n=e*e+t*t}while(n>=1);return e/t}function u8(n,e=1,t=0){return Math.exp(-((n-e)**2)/(2*t))/Math.sqrt(2*Math.PI*t)}var jA=7,VA=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];function zA(n){if(n<.5)return Math.PI/(Math.sin(Math.PI*n)*zA(1-n));n-=1;let e=VA[0];for(let i=1;i<jA+2;i++)e+=VA[i]/(n+i);const t=n+jA+.5;return Math.sqrt(2*Math.PI)*Math.pow(t,n+.5)*Math.exp(-t)*e}function UA(n,e,t,i=1){let r=0;for(let s=e;s<t;s+=i)r+=n(s)*i||0;return r}function h8(n,e){return 1-UA(i=>Math.pow(i,(e-2)/2)*Math.exp(-i/2),0,n)/Math.pow(2,e/2)/zA(e/2)}function f8(n,e){let t=1,i=n[0];for(let r=1;r<n.length;++r)t*=e,i+=t*n[r];return i}function p8(n,e=!1){let t=0,i=0,r=0,s=0;const o=n.length;for(let l=0;l<o;l++)t+=n[l][0],i+=n[l][1],r+=n[l][0]*n[l][0],s+=n[l][0]*n[l][1];if(e)return[0,s/r];const a=(o*s-t*i)/(o*r-t*t);return[i/o-a*t/o,a]}function g8(n){const e=[0,0,0,0,0,0];for(const s of n)e[0]+=s[0],e[1]+=s[1],e[2]+=s[0]*s[0]*s[1],e[3]+=s[1]*Math.log(s[1]),e[4]+=s[0]*s[1]*Math.log(s[1]),e[5]+=s[0]*s[1];const t=e[1]*e[2]-e[5]*e[5];return[Math.exp((e[2]*e[3]-e[5]*e[4])/t),(e[1]*e[4]-e[5]*e[3])/t]}function _8(n){const e=[0,0,0,0],t=n.length;for(const s of n)e[0]+=Math.log(s[0]),e[1]+=s[1]*Math.log(s[0]),e[2]+=s[1],e[3]+=Math.pow(Math.log(s[0]),2);const i=(t*e[1]-e[2]*e[0])/(t*e[3]-e[0]*e[0]);return[(e[2]-i*e[0])/t,i]}function m8(n){const e=[0,0,0,0],t=n.length;for(const s of n)e[0]+=Math.log(s[0]),e[1]+=Math.log(s[1])*Math.log(s[0]),e[2]+=Math.log(s[1]),e[3]+=Math.pow(Math.log(s[0]),2);const i=(t*e[1]-e[2]*e[0])/(t*e[3]-e[0]*e[0]);return[Math.exp((e[2]-i*e[0])/t),i]}function HA(n,e=2){const t=n.map(c=>function S$(n,e,t=1){const i=[];if(void 0===e&&n>=0)for(let r=0;r<n;r+=t)i.push(r);else if(void 0===e)for(let r=0;r>n;r-=t)i.push(r);else if(n<=e)for(let r=n;r<=e;r+=t)i.push(r);else for(let r=n;r>=e;r-=t)i.push(r);return i}(e+1).map(l=>Math.pow(c[0],l))),i=kA(t),r=n.map(c=>[c[1]]),s=cf(i,t);return cf(LA(s),i,r).map(c=>c[0])}function GA(n,e){const i=n.reduce((o,a)=>o+a[1],0)/n.length,r=n.reduce((o,a)=>o+(a[1]-i)**2,0);return 1-n.reduce((o,a)=>o+(a[1]-e(a[0]))**2,0)/r}function y8(n,e=.85,t=8){if(!(n.length<=1))for(let i=1;i<t;++i){const r=HA(n,i),s=a=>f8(r,a);if(GA(n,s)>=e)return{order:i,coefficients:r,fn:s}}}$y({},{bestPolynomial:()=>y8,coefficient:()=>GA,exponential:()=>g8,linear:()=>p8,logarithmic:()=>_8,polynomial:()=>HA,power:()=>m8});var Gn=2*Math.PI;function $l(n,e){return function U$(n,e){return(n%e+e)%e}(Math.atan2(n.y-(e?e.y:0),n.x-(e?e.x:0)),Gn)}function WA(n,e){let t,i=1/0,r=-1;for(const[s,o]of e.entries()){const a=o.project(n),c=Se.distance(n,a);c<i&&(t=a,i=c,r=s)}return t?[t,r]:void 0}var Se=class kt{constructor(e=0,t=0){this.x=e,this.y=t,this.type="point"}get unitVector(){return lt(this.length,0)?new kt(1,0):this.scale(1/this.length)}get length(){return Math.sqrt(this.x**2+this.y**2)}get inverse(){return new kt(-this.x,-this.y)}get flip(){return new kt(this.y,this.x)}get perpendicular(){return new kt(-this.y,this.x)}get array(){return[this.x,this.y]}distanceFromLine(e){return kt.distance(this,e.project(this))}clamp(e,t=0){const i=$a(this.x,e.xMin+t,e.xMax-t),r=$a(this.y,e.yMin+t,e.yMax-t);return new kt(i,r)}changeCoordinates(e,t){return new kt(t.xMin+(this.x-e.xMin)/e.dx*t.dx,t.yMin+(this.y-e.yMin)/e.dy*t.dy)}add(e){return kt.sum(this,e)}subtract(e){return kt.difference(this,e)}round(e=1){return new kt(AA(this.x,e),AA(this.y,e))}floor(){return new kt(Math.floor(this.x),Math.floor(this.y))}mod(e,t=e){return new kt(this.x%e,this.y%t)}angle(e=Fi){return $l(this,e)}snap(e,t=5){return lt(this.x,e.x,t)?new kt(e.x,this.y):lt(this.y,e.y,t)?new kt(this.x,e.y):this}static average(...e){const t=Li(e.map(r=>r.x))/e.length,i=Li(e.map(r=>r.y))/e.length;return new kt(t,i)}static dot(e,t){return e.x*t.x+e.y*t.y}static sum(e,t){return new kt(e.x+t.x,e.y+t.y)}static difference(e,t){return new kt(e.x-t.x,e.y-t.y)}static distance(e,t){return Math.sqrt(sr(e.x-t.x)+sr(e.y-t.y))}static manhattan(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}static interpolate(e,t,i=.5){return new kt(qy(e.x,t.x,i),qy(e.y,t.y,i))}static interpolateList(e,t=.5){const i=e.length-1,r=Math.floor($a(t,0,1)*i);return kt.interpolate(e[r],e[r+1],i*t-r)}static fromPolar(e,t=1){return new kt(t*Math.cos(e),t*Math.sin(e))}static random(e){const t=Xy.uniform(e.xMin,e.xMax),i=Xy.uniform(e.yMin,e.yMax);return new kt(t,i)}static equals(e,t,i){return lt(e.x,t.x,i)&&lt(e.y,t.y,i)}static colinear(e,t,i,r){return lt((e.x-t.x)*(t.y-i.y),(t.x-i.x)*(e.y-t.y),r)}transform(e){return new kt(e[0][0]*this.x+e[0][1]*this.y+e[0][2],e[1][0]*this.x+e[1][1]*this.y+e[1][2])}rotate(e,t=Fi){if(lt(e,0))return this;const i=this.x-t.x,r=this.y-t.y,s=Math.cos(e),o=Math.sin(e);return new kt(i*s-r*o+t.x,i*o+r*s+t.y)}reflect(e){const t=e.p2.x-e.p1.x,i=e.p2.y-e.p1.y,o=(t*(this.y-e.p1.y)-i*(this.x-e.p1.x))/(t*t+i*i);return new kt(this.x+2*o*i,this.y-2*o*t)}scale(e,t=e){return new kt(this.x*e,this.y*t)}shift(e,t=e){return new kt(this.x+e,this.y+t)}translate(e){return this.shift(e.x,e.y)}equals(e,t){return kt.equals(this,e,t)}toString(){return`point(${this.x},${this.y})`}},Fi=new Se(0,0);function Zy(n){return["polygon","polyline","rectangle","triangle"].includes(n.type)}function Wa(n){return["line","ray","segment"].includes(n.type)}function uf(n){return"ray"===n.type}function hf(n){return"segment"===n.type}function qa(n){return"circle"===n.type}function df(n){return"arc"===n.type}function ff(n){return"angle"===n.type}var $n=class wu{constructor(e,t){this.p1=e,this.p2=t,this.type="line"}get length(){return Se.distance(this.p1,this.p2)}get lengthSquared(){return(this.p1.x-this.p2.x)**2+(this.p1.y-this.p2.y)**2}get midpoint(){return Se.average(this.p1,this.p2)}get slope(){return(this.p2.y-this.p1.y)/(this.p2.x-this.p1.x)}get intercept(){return this.p1.y-this.slope*this.p1.x}get angle(){return $l(this.p2,this.p1)}get unitVector(){return this.p2.subtract(this.p1).unitVector}get perpendicularVector(){return new Se(this.p2.y-this.p1.y,this.p1.x-this.p2.x).unitVector}parallel(e){return new wu(e,e.add(this.p2).subtract(this.p1))}perpendicular(e){const t=this.line.project(e);return Se.equals(e,t)?new wu(t,t.add(this.perpendicularVector.scale(this.length/2))):new wu(t,e)}get perpendicularBisector(){return this.perpendicular(this.midpoint)}distanceSquared(e){const t=this.project(e);return(e.x-t.x)**2+(e.y-t.y)**2}get line(){return"line"===this.type?this:new wu(this.p1,this.p2)}get ray(){return uf(this)?this:new T8(this.p1,this.p2)}get segment(){return hf(this)?this:new Wl(this.p1,this.p2)}offset(e){const t=Se.difference(this.p2,this.p1),i=Se.difference(e,this.p1);return Se.dot(t,i)/this.lengthSquared}project(e){return this.at(this.offset(e))}side(e,t){const i=Se.difference(this.p2,this.p1),r=Se.difference(e,this.p1),s=r.x*i.y-r.y*i.x;return lt(s,0,t)?0:Math.sign(s)}contains(e,t){return 0===this.side(e,t)}at(e){return Se.interpolate(this.p1,this.p2,e)}transform(e){return new this.constructor(this.p1.transform(e),this.p2.transform(e))}rotate(e,t=Fi){return lt(e,0)?this:new this.constructor(this.p1.rotate(e,t),this.p2.rotate(e,t))}reflect(e){return new this.constructor(this.p1.reflect(e),this.p2.reflect(e))}scale(e,t=e){return new this.constructor(this.p1.scale(e,t),this.p2.scale(e,t))}shift(e,t=e){return new this.constructor(this.p1.shift(e,t),this.p2.shift(e,t))}translate(e){return this.shift(e.x,e.y)}equals(e,t){return this.contains(e.p1,t)&&this.contains(e.p2,t)}toString(){return`line(${this.p1},${this.p2})`}},T8=class extends $n{constructor(){super(...arguments),this.type="ray"}equals(n,e){return!("ray"!==n.type||!this.p1.equals(n.p1,e))&&(!!this.p2.equals(n.p2,e)||n.contains(this.p2,e)||this.contains(n.p2,e))}contains(n,e){if(!super.contains(n,e))return!1;const t=this.offset(n);return lt(t,0,e)||t>0}toString(){return`ray(${this.p1},${this.p2})`}},Wl=class rO extends $n{constructor(){super(...arguments),this.type="segment"}contains(e,t){return!!super.contains(e,t)&&(!(!this.p1.equals(e,t)&&!this.p2.equals(e,t))||(lt(this.p1.x,this.p2.x,t)?Ir(e.y,this.p1.y,this.p2.y):Ir(e.x,this.p1.x,this.p2.x)))}project(e){const t=Se.difference(this.p2,this.p1),i=Se.difference(e,this.p1),r=$a(Se.dot(t,i)/this.lengthSquared,0,1);return this.p1.add(t.scale(r))}contract(e){return new rO(this.at(e),this.at(1-e))}equals(e,t,i=!1){return"segment"===e.type&&(this.p1.equals(e.p1,t)&&this.p2.equals(e.p2,t)||!i&&this.p1.equals(e.p2,t)&&this.p2.equals(e.p1,t))}toString(){return`segment(${this.p1},${this.p2})`}},po=class sc{constructor(e=Fi,t=1){this.c=e,this.r=t,this.type="circle"}get circumference(){return Gn*this.r}get area(){return Math.PI*this.r**2}get arc(){const e=this.c.shift(this.r,0);return new go(this.c,e,Gn)}tangentAt(e){const t=this.at(e),i=this.c.rotate(Math.PI/2,t);return new $n(t,i)}collision(e){return Se.distance(this.c,new Se(this.c.x<e.p.x?e.p.x:this.c.x>e.p.x+e.w?e.p.x+e.w:this.c.x,this.c.y<e.p.y?e.p.y:this.c.y>e.p.y+e.h?e.p.y+e.h:this.c.y))<=this.r}project(e){const t=e.subtract(this.c).unitVector.scale(this.r);return Se.sum(this.c,t)}at(e){const t=Gn*e;return this.c.shift(this.r*Math.cos(t),this.r*Math.sin(t))}offset(e){return $l(e,this.c)/Gn}contains(e){return Se.distance(e,this.c)<=this.r}transform(e){const t=Math.abs(e[0][0])+Math.abs(e[1][1]);return new sc(this.c.transform(e),this.r*t/2)}rotate(e,t=Fi){return lt(e,0)?this:new sc(this.c.rotate(e,t),this.r)}reflect(e){return new sc(this.c.reflect(e),this.r)}scale(e,t=e){return new sc(this.c.scale(e,t),this.r*(e+t)/2)}shift(e,t=e){return new sc(this.c.shift(e,t),this.r)}translate(e){return this.shift(e.x,e.y)}equals(e,t){return lt(this.r,e.r,t)&&this.c.equals(e.c,t)}toString(){return`circle(${this.c},${this.r})`}},go=class{constructor(n,e,t){this.c=n,this.start=e,this.angle=t,this.type="arc"}get circle(){return new po(this.c,this.radius)}get radius(){return Se.distance(this.c,this.start)}get end(){return this.start.rotate(this.angle,this.c)}get startAngle(){return $l(this.start,this.c)}contract(n){return new this.constructor(this.c,this.at(n/2),this.angle*(1-n))}get minor(){return this.angle<=Math.PI?this:new this.constructor(this.c,this.end,Gn-this.angle)}get major(){return this.angle>=Math.PI?this:new this.constructor(this.c,this.end,Gn-this.angle)}get center(){return this.at(.5)}project(n){const e=this.startAngle,t=e+this.angle;let i=$l(n,this.c);return t>Gn&&i<t-Gn&&(i+=Gn),i=$a(i,e,t),this.c.shift(this.radius,0).rotate(i,this.c)}at(n){return this.start.rotate(this.angle*n,this.c)}offset(n){return new Qy(this.start,this.c,n).rad/this.angle}contains(n){return n.equals(this.project(n))}transform(n){return new this.constructor(this.c.transform(n),this.start.transform(n),this.angle)}rotate(n,e=Fi){return lt(n,0)?this:new this.constructor(this.c.rotate(n,e),this.start.rotate(n,e),this.angle)}reflect(n){return new this.constructor(this.c.reflect(n),this.start.reflect(n),this.angle)}scale(n,e=n){return new this.constructor(this.c.scale(n,e),this.start.scale(n,e),this.angle)}shift(n,e=n){return new this.constructor(this.c.shift(n,e),this.start.shift(n,e),this.angle)}translate(n){return this.shift(n.x,n.y)}equals(){return!1}toString(){return`arc(${this.c},${this.start},${this.angle})`}},XA=class extends go{constructor(){super(...arguments),this.type="sector"}contains(n){return Se.distance(n,this.c)<=this.radius&&new Qy(this.start,this.c,n).rad<=this.angle}toString(){return`sector(${this.c},${this.start},${this.angle})`}};function I8(n,e){return lt(n.p1.x,n.p2.x)?Ir(e.y,n.p1.y,n.p2.y):Ir(e.x,n.p1.x,n.p2.x)}function A8(n,e){return lt(n.p1.x,n.p2.x)?(e.y-n.p1.y)/(n.p2.y-n.p1.y)>0:(e.x-n.p1.x)/(n.p2.x-n.p1.x)>0}function M8(n,e){return Ir(n.offset(e),0,1)}function ZA(n,e){const t=n.p2.x-n.p1.x,i=n.p2.y-n.p1.y,r=sr(t)+sr(i),s=e.c.x,o=e.c.y,a=(n.p1.x-s)*(n.p2.y-o)-(n.p2.x-s)*(n.p1.y-o),c=sr(e.r)*r-sr(a);if(c<0)return[];const l=a*i/r,u=-a*t/r;if(lt(c,0))return[e.c.shift(l,u)];const h=t*(i<0?-1:1)*Math.sqrt(c)/r,d=Math.abs(i)*Math.sqrt(c)/r;return[e.c.shift(l+h,u+d),e.c.shift(l-h,u-d)]}function en(...n){if(n.length<2)return[];if(n.length>2)return SA(G$(n,2).map(i=>en(...i)));let[e,t]=n;if(ff(e)&&(e=e.shape(!0)),ff(t)&&(t=t.shape(!0)),Zy(t)&&([e,t]=[t,e]),Zy(e)){const i=Wa(t)?e.points.filter(r=>t.contains(r)):[];for(const r of e.edges)i.push(...en(r,t));return i}return function O8(n,e){let t=[];const i=df(n)?n.circle:n,r=df(e)?e.circle:e;Wa(n)&&Wa(e)?t=function x8(n,e){const t=n.p1.x-n.p2.x,i=n.p1.y-n.p2.y,r=e.p1.x-e.p2.x,s=e.p1.y-e.p2.y,o=t*s-i*r;if(lt(o,0))return[];const a=n.p1.x*n.p2.y-n.p1.y*n.p2.x,c=e.p1.x*e.p2.y-e.p1.y*e.p2.x;return[new Se((a*r-t*c)/o,(a*s-i*c)/o)]}(n,e):Wa(i)&&qa(r)?t=ZA(i,r):qa(i)&&Wa(r)?t=ZA(r,i):qa(i)&&qa(r)&&(t=function P8(n,e){const t=Se.distance(n.c,e.c);if(t>n.r+e.r)return[];if(t<Math.abs(n.r-e.r))return[];if(lt(t,0)&&lt(n.r,e.r))return[];if(lt(t,n.r+e.r))return[new $n(n.c,e.c).midpoint];const i=(sr(n.r)-sr(e.r)+sr(t))/(2*t),r=Math.sqrt(sr(n.r)-sr(i)),a=(e.c.x-n.c.x)*i/t-(e.c.y-n.c.y)*r/t+n.c.x,c=(e.c.y-n.c.y)*i/t+(e.c.x-n.c.x)*r/t+n.c.y;return[new Se((e.c.x-n.c.x)*i/t+(e.c.y-n.c.y)*r/t+n.c.x,(e.c.y-n.c.y)*i/t-(e.c.x-n.c.x)*r/t+n.c.y),new Se(a,c)]}(i,r));for(const s of[n,e])hf(s)&&(t=t.filter(o=>I8(s,o))),uf(s)&&(t=t.filter(o=>A8(s,o))),df(s)&&(t=t.filter(o=>M8(s,o)));return t}(e,t)}var xs=class Eu{constructor(...e){this.type="polygon",this.points=e}get circumference(){if(this.points.length<=1)return 0;let e=Se.distance(this.points[0],function bA(n,e=0){return n[n.length-1-e]}(this.points));for(let t=1;t<this.points.length;++t)e+=Se.distance(this.points[t-1],this.points[t]);return e}get signedArea(){const e=this.points,t=e.length;let i=e[t-1].x*e[0].y-e[0].x*e[t-1].y;for(let r=1;r<t;++r)i+=e[r-1].x*e[r].y-e[r].x*e[r-1].y;return i/2}get area(){return Math.abs(this.signedArea)}get centroid(){const e=this.points,t=e.length;let i=0;for(let s=0;s<t;++s)i+=e[s].x;let r=0;for(let s=0;s<t;++s)r+=e[s].y;return new Se(i/t,r/t)}get edges(){const e=this.points.length,t=[];for(let i=0;i<e;++i)t.push(new Wl(this.points[i],this.points[(i+1)%e]));return t}get radius(){const e=this.centroid,t=this.points.map(i=>Se.distance(i,e));return Math.max(...t)}get oriented(){if(this.signedArea>=0)return this;const e=[...this.points].reverse();return new this.constructor(...e)}static collision(e,t,i){if(e.points.some(r=>t.contains(r))||t.points.some(r=>e.contains(r)))return!0;for(const r of e.edges)for(const s of t.edges)if(en(r,s)[0])return!0;return e.equals(t,i)}static regular(e,t=1){const i=Gn/e,r=Math.PI/2-i/2,s=function zy(n,e){const t=[];for(let i=0;i<e;++i)t.push(n(i));return t}(o=>Se.fromPolar(r+i*o,t),e);return new Eu(...s)}static interpolate(e,t,i=.5){const r=e.points.map((s,o)=>Se.interpolate(s,t.points[o],i));return new Eu(...r)}static convexHull(...e){if(e.length<=3)return new Eu(...e);const t=e.sort((o,a)=>o.x!==a.x?o.x-a.x:o.y-a.y),i=t.slice(0).reverse(),r=[],s=[];for(const[o,a]of[[t,r],[i,s]]){for(const c of o){for(;a.length>=2;){const l=a[a.length-1],u=a[a.length-2];if(!((l.x-u.x)*(c.y-u.y)>=(c.x-u.x)*(l.y-u.y)))break;a.pop()}a.push(c)}a.pop()}return new Eu(...r.concat(s))}contains(e){let t=!1;for(const i of this.edges){if(i.p1.equals(e)||i.contains(e))return!1;i.p1.y>e.y!=i.p2.y>e.y&&(e.x<(i.p2.x-i.p1.x)/(i.p2.y-i.p1.y)*(e.y-i.p1.y)+i.p1.x&&(t=!t))}return t}at(e){e<0&&(e+=Math.floor(e));const t=e*this.circumference;let i=0;for(const r of this.edges){const s=r.length;if(i+s>t)return r.at((t-i)/s);i+=s}return this.points[0]}offset(e){const t=this.edges,i=WA(e,this.edges)||[this.points[0],0];let r=0;for(let s=0;s<i[1];++s)r+=t[s].length;return r+=t[i[1]].offset(e)*t[i[1]].length,r/this.circumference}project(e){const t=WA(e,this.edges);return t?t[0]:this.points[0]}centerAt(e=Fi){return this.translate(e.subtract(this.centroid))}transform(e){return new this.constructor(...this.points.map(t=>t.transform(e)))}rotate(e,t=Fi){if(lt(e,0))return this;const i=this.points.map(r=>r.rotate(e,t));return new this.constructor(...i)}reflect(e){const t=this.points.map(i=>i.reflect(e));return new this.constructor(...t)}scale(e,t=e){const i=this.points.map(r=>r.scale(e,t));return new this.constructor(...i)}shift(e,t=e){const i=this.points.map(r=>r.shift(e,t));return new this.constructor(...i)}translate(e){return this.shift(e.x,e.y)}equals(e,t,i){const r=this.points.length;if(r!==e.points.length)return!1;const s=i?this:this.oriented,o=i?e:e.oriented;for(let a=0;a<r;++a)if(s.points.every((c,l)=>c.equals(o.points[(l+a)%r],t)))return!0;return!1}toString(){return`polygon(${this.points.join(",")})`}},R8=class extends xs{constructor(){super(...arguments),this.type="polyline"}get circumference(){return this.length}get length(){let n=0;for(let e=1;e<this.points.length;++e)n+=Se.distance(this.points[e-1],this.points[e]);return n}get edges(){const n=[];for(let e=0;e<this.points.length-1;++e)n.push(new Wl(this.points[e],this.points[e+1]));return n}toString(){return`polyline(${this.points.join(",")})`}};Math,Math;var Qy=class cr{constructor(e,t,i){this.a=e,this.b=t,this.c=i,this.type="angle"}static fromDegrees(e){return cr.fromRadians(e*(Math.PI/180))}static fromRadians(e){const t=new Se(1,0),i=t.rotate(e);return new cr(t,Fi,i)}static equals(e,t,i=Math.PI/360){return lt(e.rad,t.rad,i)}get rad(){const e=Math.atan2(this.a.y-this.b.y,this.a.x-this.b.x);let i=Math.atan2(this.c.y-this.b.y,this.c.x-this.b.x)-e;return i<0&&(i+=Gn),i}get deg(){return 180*this.rad/Math.PI}get isRight(){return lt(this.rad,Math.PI/2,Math.PI/360)}get bisector(){if(this.b.equals(this.a)||this.b.equals(this.c))return;const e=Math.atan2(this.a.y-this.b.y,this.a.x-this.b.x),t=Math.atan2(this.c.y-this.b.y,this.c.x-this.b.x);let i=(e+t)/2;e>t&&(i+=Math.PI);const r=Math.cos(i)+this.b.x,s=Math.sin(i)+this.b.y;return new $n(this.b,new Se(r,s))}get sup(){return this.rad<Math.PI?this:new cr(this.c,this.b,this.a)}get arc(){return new go(this.b,this.a,this.rad)}get radius(){return 24+20*(1-$a(this.rad,0,Math.PI)/Math.PI)}shape(e=!0,t,i){if(this.a.equals(this.b)||this.c.equals(this.b))return new xs(Fi);const r=this.isRight&&!i;t||(t=r?20:this.radius);const s=new Wl(this.b,this.a),o=s.at(t/s.length);if(r){const a=Se.difference(this.c,this.b).unitVector.scale(t);return e?new xs(this.b,o,o.add(a),this.b.add(a)):new R8(o,o.add(a),this.b.add(a))}return e?new XA(this.b,o,this.rad):new go(this.b,o,this.rad)}project(e){return this.contains(e)?e:this.shape(!0).project(e)}at(){return this.c}offset(){return 0}contains(e){return this.shape(!0).contains(e)}transform(e){return new cr(this.a.transform(e),this.b.transform(e),this.c.transform(e))}rotate(e,t){return lt(e,0)?this:new cr(this.a.rotate(e,t),this.b.rotate(e,t),this.c.rotate(e,t))}reflect(e){return new cr(this.a.reflect(e),this.b.reflect(e),this.c.reflect(e))}scale(e,t=e){return new cr(this.a.scale(e,t),this.b.scale(e,t),this.c.scale(e,t))}shift(e,t=e){return new cr(this.a.shift(e,t),this.b.shift(e,t),this.c.shift(e,t))}translate(e){return new cr(this.a.translate(e),this.b.translate(e),this.c.translate(e))}equals(e,t){return cr.equals(e,this,t)}toString(){return`angle(${this.a},${this.b},${this.c})`}},QA=class oc{constructor(e,t=1,i=t){this.p=e,this.w=t,this.h=i,this.type="rectangle"}static aroundPoints(e){let t=1/0,i=-1/0,r=1/0,s=-1/0;for(const o of e)t=t<o.x?t:o.x,i=i>o.x?i:o.x,r=r<o.y?r:o.y,s=s>o.y?s:o.y;return new oc(new Se(t,r),i-t,s-r)}get center(){return new Se(this.p.x+this.w/2,this.p.y+this.h/2)}get centroid(){return this.center}get circumference(){return 2*Math.abs(this.w)+2*Math.abs(this.h)}get area(){return Math.abs(this.signedArea)}get signedArea(){return this.w*this.h}get edges(){return this.polygon.edges}get points(){return this.polygon.points}get polygon(){const e=new Se(this.p.x+this.w,this.p.y),t=new Se(this.p.x+this.w,this.p.y+this.h),i=new Se(this.p.x,this.p.y+this.h);return new xs(this.p,e,t,i)}get bounds(){return new F8(this.p.x,this.p.x+this.w,this.p.y,this.p.y+this.h)}collision(e){return this.p.x<e.p.x+e.w&&this.p.x+this.w>e.p.x&&this.p.y<e.p.y+e.h&&this.p.y+this.h>e.p.y||this.equals(e.polygon)}padding(e,t,i,r){return new oc(this.p.shift(-r,-e),this.w+r+t,this.h+e+i)}get unsigned(){if(this.w>0&&this.h>0)return this;const e=this.p.shift(this.w<0?this.w:0,this.h<0?this.h:0);return new oc(e,Math.abs(this.w),Math.abs(this.h))}contains(e,t){return Ir(e.x,this.p.x,this.p.x+this.w,t)&&Ir(e.y,this.p.y,this.p.y+this.h,t)}project(e){let t;for(const i of this.edges){const r=i.project(e);(!t||Se.distance(e,r)<Se.distance(e,t))&&(t=r)}return t}at(e){return this.polygon.at(e)}offset(e){return this.polygon.offset(e)}get oriented(){return this.polygon.oriented}transform(e){return this.polygon.transform(e)}rotate(e,t=Fi){return lt(e,0)?this:this.polygon.rotate(e,t)}reflect(e){return this.polygon.reflect(e)}scale(e,t=e){return new oc(this.p.scale(e,t),this.w*e,this.h*t)}shift(e,t=e){return new oc(this.p.shift(e,t),this.w,this.h)}translate(e){return this.shift(e.x,e.y)}equals(e){return this.polygon.equals(e)}toString(){return`rectangle(${this.p},${this.w},${this.h})`}},F8=class ep{constructor(e,t,i,r,s){this.xMin=e,this.xMax=t,this.yMin=i,this.yMax=r,"swap"===s?(this.dx<0&&([this.xMin,this.xMax]=[t,e]),this.dy<0&&([this.yMin,this.yMax]=[r,i])):"center"===s&&(this.dx<0&&(this.xMin=this.xMax=(e+t)/2),this.dy<0&&(this.yMin=this.yMax=(i+r)/2))}contains(e){return this.containsX(e)&&this.containsY(e)}containsX(e){return Ir(e.x,this.xMin,this.xMax)}containsY(e){return Ir(e.y,this.yMin,this.yMax)}resize(e,t){return new ep(this.xMin,this.xMax+e,this.yMin,this.yMax+t)}get dx(){return this.xMax-this.xMin}get dy(){return this.yMax-this.yMin}get xRange(){return[this.xMin,this.xMax]}get yRange(){return[this.yMin,this.yMax]}extend(e,t=e,i=e,r=t){return new ep(this.xMin-r,this.xMax+t,this.yMin-e,this.yMax+i)}get rect(){return new QA(new Se(this.xMin,this.yMin),this.dx,this.dy)}get center(){return new Se(this.xMin+this.dx/2,this.yMin+this.dy/2)}get flip(){return new ep(this.yMin,this.yMax,this.xMin,this.xMax)}};function nM(n){const e=n.points.reduce((t,i)=>({xSum:t.xSum+i.x,ySum:t.ySum+i.y}),{xSum:0,ySum:0});return new Se(e.xSum/n.points.length,e.ySum/n.points.length)}Math.sqrt(2);const gf=2*Math.PI;function iM(n,e){const t=e.x-n.x,i=e.y-n.y,r=Math.sqrt(t*t+i*i);return new Se(-i/r,t/r)}function G8(n,e){const t=iM(n,e);return new Se(-t.x,-t.y)}function ev(n){const e=[];let t=n[0].x,i=n[0].y,r=t,s=i;for(let a=0;a<n.length;a++){const c=n[a],l=n[(a+1)%n.length],u=G8(c,l),h=iM(c,l);e.push({vertex1:c,vertex2:l,index:a,outwardNormal:u,inwardNormal:h});const p=n[a].x,f=n[a].y;t=Math.min(p,t),i=Math.min(f,i),r=Math.max(p,r),s=Math.max(f,s)}return{vertices:n,edges:e,minX:t,minY:i,maxX:r,maxY:s}}function rM(n,e){const t=(e.vertex2.y-e.vertex1.y)*(n.vertex2.x-n.vertex1.x)-(e.vertex2.x-e.vertex1.x)*(n.vertex2.y-n.vertex1.y);if(0==t)return null;const i=((e.vertex2.x-e.vertex1.x)*(n.vertex1.y-e.vertex1.y)-(e.vertex2.y-e.vertex1.y)*(n.vertex1.x-e.vertex1.x))/t,r=((n.vertex2.x-n.vertex1.x)*(n.vertex1.y-e.vertex1.y)-(n.vertex2.y-n.vertex1.y)*(n.vertex1.x-e.vertex1.x))/t;return{x:n.vertex1.x+i*(n.vertex2.x-n.vertex1.x),y:n.vertex1.y+i*(n.vertex2.y-n.vertex1.y),isIntersectionOutside:i<0||r<0||i>1||r>1}}function sM(n,e,t,i,r,s,o){let a=Math.atan2(r.y-t.y,r.x-t.x),c=Math.atan2(s.y-t.y,s.x-t.x);a<0&&(a+=gf),c<0&&(c+=gf);const l=a>c?a-c:a+gf-c,u=(o?-l:gf-l)/n;e.push(r);for(let h=1;h<n;++h){const d=a+u*h,p=new Se(t.x+Math.cos(d)*i,t.y+Math.sin(d)*i);e.push(p)}e.push(s)}function oM(n,e,t){return{vertex1:new Se(n.vertex1.x+e,n.vertex1.y+t),vertex2:new Se(n.vertex2.x+e,n.vertex2.y+t)}}function _f(n,e,t=0){const i=ev(n);return e>0?function $8(n,e,t){const i=[];for(let o=0;o<n.edges.length;o++){const a=n.edges[o];i.push(oM(a,a.outwardNormal.x*e,a.outwardNormal.y*e))}const r=[];for(let o=0;o<i.length;o++){const a=i[o],c=i[(o+i.length-1)%i.length],l=rM(c,a);l&&(!l.isIntersectionOutside||t<1)?r.push(new Se(l.x,l.y)):sM(t,r,n.edges[o].vertex1,e,c.vertex2,a.vertex1,!1)}const s=ev(r);return s.offsetEdges=i,s}(i,e,t).vertices:function W8(n,e,t){const i=[];for(let o=0;o<n.edges.length;o++){const a=n.edges[o];i.push(oM(a,a.inwardNormal.x*e,a.inwardNormal.y*e))}const r=[];for(let o=0;o<i.length;o++){const a=i[o],c=i[(o+i.length-1)%i.length],l=rM(c,a);l&&(!l.isIntersectionOutside||t<1)?r.push(new Se(l.x,l.y)):sM(t,r,n.edges[o].vertex1,e,c.vertex2,a.vertex1,!0)}const s=ev(r);return s.offsetEdges=i,s}(i,-e,t).vertices}function cM(n,e,t){const i=_f(n,e),r=_f(n,-e),s=new xs(...i),o=new xs(...r);let a,c;return s.area<o.area?(a=s,c=o):(a=o,c=s),t?c.points:a.points}var un=function(n){return n.AREA="area",n.FRAME="frame",n.WING="wing",n.FILLING="filling",n.POLYGON="polygon",n}(un||{});class we extends Se{constructor(e,t,i=0){super(e,t),this.s=i}equals(e,t=.05){return t?new po(this,t).contains(e):super.equals(e)}}class q8 extends QA{}class K8 extends po{}var Ar=function(n){return n.codeError="codeError",n.dataError="dataError",n.unknownError="unknownError",n}(Ar||{}),Mr=function(n){return n.points="points",n.segments="segments",n.data="data",n.unknown="unknown",n}(Mr||{});class Jr{constructor(e,t){this.code=e.code,this.type=e.type,this.msg=e.msg,t&&(this.meta=t)}}let Ce=(()=>{class n{static{this.axisTolerance=0}static equalNumbers(t,i,r=.01){return Math.abs(t-i)<=r}static getPointWithOffset(t,i,r){const a=new We(t,i).length-r,c=r/a;return 0===a?i:new we((t.x+c*i.x)/(1+c),(t.y+c*i.y)/(1+c))}static getMiddlePoint(t,i){const r=t.perpendicular(t.midpoint);return n.getPointWithOffset(r.p1,r.p2,i)}static flatten(t){let i=[];for(let r=0;r<t.length;r++)Array.isArray(t[r])?i=i.concat(n.flatten(t[r])):i.push(t[r]);return i}static sortPointsByLine(t){if(t.length<2)return t;let i=[];return i=n.equalNumbers(t[0].x,t[1].x)?t.sort((r,s)=>r.y-s.y):t.sort((r,s)=>r.x-s.x),i}static sortPointsByCircle(t,i){const r="circle"===i.type?t[0]:i.start;if(null==r)return t;const s=[];return t.forEach(a=>{if(a.equals(r))return void s.push({point:a,angle:0});const d=en(new We(r,a).perpendicular(i.c),i).map(p=>new hi(r,p,a)).find(p=>p.start.equals(r));null!=d&&s.push({point:a,angle:d.angle})}),s.sort((a,c)=>a.angle-c.angle).map(a=>a.point)}static createSegments(t){const i=[];for(let r=0;r<t.length-1;r++)r%2==0&&i.push(new We(t[r],t[r+1]));return i}static createArcs(t,i){const r=[];for(let s=0;s<i.length-1;s++)s%2==0&&r.push(t.getChildArc(i[s],i[s+1]));return r}static getPointsOfEdge(t){switch(t.type){case"segment":return[t.p1,t.p2];case"arc":return[t.start,t.customEnd];default:return[]}}static getEdgeSegment(t){return"arc"===t.type?t.chord:t}static getExtremePoints(t){const i=[];return t.forEach(r=>{const s=n.getPointsOfEdge(r);i.push(...s)}),i}static breakDownEdgesByPoint(t,i){const r=[];return t.forEach(s=>{const o=n.getPointsOfEdge(s),a=i.filter(u=>s.contains(u));if(0===a.length)return void r.push(s);const c=[...o,...a],l="segment"===s.type?this.sortPointsByLine(c):this.sortPointsByCircle(c,s);for(let u=0;u<l.length-1;u++)switch(s.type){case"segment":r.push(new We(l[u],l[u+1]));break;case"arc":{const h=s.getChildArc(l[u],l[u+1]);if(null==h)return;r.push(h);break}}}),r}static getPointKey(t){return`${t.x};${t.y}`}static createAdjacencyMatrix(t){const i={};function r(s,o){const a=i[n.getPointKey(s)];a?a.push(o):i[n.getPointKey(s)]=[o]}return t.forEach(s=>{switch(s.type){case"segment":{const o=s;r(o.p2,o.p1),r(o.p1,o.p2);break}case"arc":r(s.customEnd,s.start),r(s.start,s.customEnd)}}),i}static getEdgesByPoints(t,i){const r=new Gt(...i).centroid,s=i.map((a,c,l)=>{const u=new We(a,l[(c+1)%i.length]);return t.filter(h=>{switch(h.type){case"arc":return h.chord.equals(u);case"segment":return h.equals(u);default:return!1}})});return 2===i.length?s[0]:s.map(a=>{if(1===a.length)return a[0];let c,l;return a.forEach(u=>{let h;switch(u.type){case"segment":h=u.midpoint;break;case"arc":h=u.center}if(null==h)return;const d=Ln(r,h);(null==l||d<l)&&(l=d,c=u)}),c})}static getPolygonPointsByEdges(t){const i=[];if(2===t.length){let r;return t.forEach(s=>{const[o,a]=n.getPointsOfEdge(s),c=i.some(u=>u.equals(o))?a:o,l="arc"===s.type?s.getS(r):0;r=c.equals(o)?a:o,i.push(new we(c.x,c.y,l))}),i}return t.forEach((r,s,o)=>{const a=o[(s+1)%o.length],[c,l]=n.getPointsOfEdge(r),h=n.getPointsOfEdge(a).some(d=>d.equals(c))?l:c;i.push(new we(h.x,h.y,"s"in r?r.getS(h):void 0))}),i}static findLoops(t){const i=this.createAdjacencyMatrix(t),r=[];return function s(o){let a;if(Object.values(o).forEach(f=>{null==a&&f.length&&(a=f[0])}),!a)return;let c=[];if(function l(f,m){if(!(c.length&&f.length>=c.length)){if(null!=f[0]&&f[0].equals(m)){if(f.length<2)return;if(2===f.length){const v=t.filter(C=>{const[I,L]=n.getPointsOfEdge(C);return!(!I||!L)&&new We(I,L).equals(new We(f[0],f[1]))});if(1===v.length||!v.some(C=>"segment"!==C.type))return;return void(c=f)}return void(c=f)}f.some(v=>v.equals(m))||o[n.getPointKey(m)].forEach(v=>l([...f,m],v))}}([],a),0===c.length)return;const u=n.getEdgesByPoints(t,c),h=n.getPolygonPointsByEdges(u);r.push(new Gt(...h));const d=[];c.forEach(f=>{2===o[n.getPointKey(f)].length&&d.push(f)});const p={...o};d.forEach(f=>{o[n.getPointKey(f)].forEach(v=>{p[n.getPointKey(v)]=p[n.getPointKey(v)].filter(C=>!C.equals(f))}),p[n.getPointKey(f)]=[]}),s(p)}(i),r}static findSegmentVariants(t,i){const r=[];return t.forEach(s=>{i.forEach(o=>{r.push(new We(s,o))})}),r}static findApproximateSegment(t,i,r){const{p1:s,p2:o}=t;let a,c,l,u;const h=this.findSegmentVariants(i,r);h.forEach(p=>{const{p1:f,p2:m}=p,v=Ln(s,f),C=Ln(o,m);(null==c||v<c)&&(a=f,c=v),(null==u||C<u)&&(l=m,u=C)});const d=h.find(p=>p.p1.equals(a)&&p.p2.equals(l)||p.p1.equals(l)&&p.p2.equals(a));if(null==d)throw new Jr({code:Ar.codeError,type:Mr.segments,msg:"Helper.findApproximateSegment. \u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430 \u043f\u0440\u0438\u0431\u043b\u0438\u0436\u0435\u043d\u043d\u0430\u044f \u043f\u0440\u044f\u043c\u0430\u044f"},{data:h});return d}static getApproximateEdges(t,i,r=!1){const s=cM(t.points,i,r),o=new Gt(...s).edges;return t.edgeArcs.map((a,c)=>{const l=new $n(o[c].p1,o[c].p2);switch(a.type){case"segment":return{element:l};case"arc":{const u=n.getPointWithOffset(a.center,a.c,-i),h=n.getPointWithOffset(a.center,a.c,i),d=new po(a.c,Ln(a.c,u)),p=new po(a.c,Ln(a.c,h)),[f,m]=this.getPointsOfEdge(a),v=t.points.find((C,I,L)=>{const H=L[(I+1)%L.length];return f.equals(C)&&m.equals(H)||f.equals(H)&&m.equals(C)});if(null!=v&&v.s)return{middlePoint:v.s<0!==r?u:h,element:v.s<0!==r?d:p};throw new Jr({code:Ar.codeError,type:Mr.data,msg:"Helpers.getApproximateEdges. \u041f\u0440\u0438\u0431\u043b\u0438\u0436\u0435\u043d\u0438\u044f \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b"},{circle1:d,circle2:p,line:l})}default:return}})}static getPointsByClockwise(t){let i=0;return t.forEach((s,o,a)=>{const c=a[(o+1)%a.length];i+=s.x*c.y-c.x*s.y}),i/2>0?t:[...t].reverse().map((s,o,a)=>{const c=a[(o+1)%a.length];return new we(s.x,s.y,c.s?-c.s:void 0)})}static intersect(t,i){const r=t.points.filter(v=>i.containArcs(v)),s=i.points.filter(v=>t.containArcs(v)),o=t.points.filter(v=>i.points.some(C=>v.equals(C))),a=t.points.filter(v=>i.edgeArcs.some(C=>C.contains(v))),c=i.points.filter(v=>t.edgeArcs.some(C=>C.contains(v))),l=[],u=t.edgeArcs,h=i.edgeArcs;u.forEach(v=>{h.forEach(C=>{l.push(...en(v,C))})});let d=[];[...a,...c,...r,...s,...o,...l].forEach(v=>{d.some(C=>C.equals(v))||d.push(v)});const p=d.length,f=[];return function m(v){f[v]=[];let C=d[0];d=d.filter(L=>!L.equals(C));const I=n.flatten(f).length;for(;I!==p;){const L=[];if([...u,...h].forEach(ce=>{d.some(pe=>{if(ce.contains(C)&&ce.contains(pe)||"arc"===ce.type&&(ce.contains(C)&&ce.customEnd.equals(pe)||ce.contains(pe)&&ce.customEnd.equals(C))){let De,Me;switch(ce.type){case"segment":{const pt=new We(C,pe);De=pt,Me=pt.midpoint;break}case"arc":{const pt=ce.getChildArc(C,pe);De=pt,Me=pt.center;break}}const Ve=d.filter(pt=>!pt.equals(pe)),Ke=f[v],ze=Ke[Ke.length-1];let ht=!1;if(ze&&De){const[pt,ue]=n.getPointsOfEdge(De),[Ee,Ae]=n.getPointsOfEdge(ze);Ee.equals(pt)||Ee.equals(ue)?ht=De.contains(Ae):Ae.equals(pt)||Ae.equals(ue)?ht=De.contains(Ee):pt.equals(Ee)||pt.equals(Ae)?ht=ze.contains(ue):(ue.equals(Ee)||ue.equals(Ae))&&(ht=ze.contains(pt))}if(null!=De&&!Ve.some(pt=>De.contains(pt))&&null!=Me&&t.containArcs(Me)&&i.containArcs(Me)&&!ht)return L.push(De),!0}return!1})}),0===L.length){d.length>0&&m(v+1);break}0===f[v].length&&L.length>=2&&f[v].push(L[1]);const H=L[0];f[v].push(H);const[ne,se]=n.getPointsOfEdge(H);C=C.equals(ne)?se:ne,d=d.filter(ce=>!ce.equals(C))}}(0),f.map(v=>new Gt(...n.getPointsByClockwise(n.getPolygonPointsByEdges(v))))}static getBasePoint(t,i){const[r,s]=n.getPointsOfEdge(i);return t.points.find((o,a,c)=>{const l=c[(a+1)%c.length];return r.equals(o)&&s.equals(l)||r.equals(l)&&s.equals(o)})}static matchPolygons(t,i){t.length!=i.length&&console.warn("\u0427\u0442\u043e-\u0442\u043e \u0441 \u0441\u043e\u043f\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435\u043c \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0433\u043e \u0438 \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u043f\u043e\u043b\u0438\u0433\u043e\u043d\u0430. \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043d\u0435 \u0440\u0430\u0432\u043d\u043e",i,t);const r=[];return t.forEach(s=>{const o=i.find(a=>a.points.every(c=>s.containArcs(c)));if(!o)throw new Jr({code:Ar.dataError,type:Mr.data,msg:"Helpers.matchPolygons. \u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u043f\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0433\u043e \u0438 \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u043f\u043e\u043b\u0438\u0433\u043e\u043d\u0430"},{externalPolygon:s,internal:i});r.push({skeleton:s,internal:o})}),r}static matchMullions(t,i){t.length!=i.length&&console.warn("\u0427\u0442\u043e-\u0442\u043e \u0441 \u0441\u043e\u043f\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435\u043c \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0433\u043e \u0438 \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u0438\u043c\u043f\u043e\u0441\u0442\u0430. \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043d\u0435 \u0440\u0430\u0432\u043d\u043e",i,t);const r=[];return t.forEach(s=>{const o=i.find(a=>{if(a.edge.type!==s.type)return!1;switch(a.edge.type){case"segment":return"segment"===this.intersectSegment(a.edge,s)?.type;case"arc":return"arc"===this.intersectArc(a.edge,s)?.type;default:return!1}});if(!o)throw new Jr({code:Ar.dataError,type:Mr.data,msg:"Helpers.matchMullions. \u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u043f\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0433\u043e \u0438 \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u0438\u043c\u043f\u043e\u0441\u0442\u0430"},{externalEdge:s,internal:i});r.push({edge:s,polygon:o.polygon})}),r}static intersectSegment(t,i){const r=n.getPointsOfEdge(t),s=n.getPointsOfEdge(i),o=[...r,...s.filter(u=>!r.some(h=>h===u))];let c,l;return n.sortPointsByLine(o).forEach(u=>{[t,i].every(h=>h.contains(u)||h.p1.equals(u)||h.p2.equals(u))&&(null==c?c=u:l=u)}),null!=c&&null!=l?new We(c,l):null!=c?c:void 0}static intersectArc(t,i){if(t.start.equals(i.customEnd)&&i.start.equals(t.customEnd))return;const r=n.getPointsOfEdge(t),s=n.getPointsOfEdge(i),o=[...r,...s.filter(u=>!r.some(h=>h===u))];let c,l;if(n.sortPointsByCircle(o,i.circle).forEach(u=>{[t,i].every(h=>h.contains(u)||h.start.equals(u)||h.customEnd.equals(u))&&(null==c?c=u:l=u)}),null!=c&&null!=l&&!c.equals(l)){const u=n.getAngle(t.c,c,l),h=new tv(t.c,c,u);return new hi(c,h.center,l)}return null!=c?c:void 0}static getAngle(t,i,r){const s=Ln(t,i),o=Ln(i,r),a=Ln(t,r);return Math.acos((s*s+a*a-o*o)/(2*s*a))}static getChildArcs(t,i,r){return en(new We(i,r).perpendicular(t.c),t).map(c=>new hi(i,c,r))}static getEdgeCenter(t){return"segment"===t.type?t.midpoint:t.center}static adaptBeamPoints(t){if(4!==t.length)return t;if(0===t[0].s)return t.map(i=>new we(i.x,i.y));{const i=new we(t[0].x,t[0].y,t[0].s),r=new we(t[1].x,t[1].y),s=new we(t[2].x,t[2].y,t[3].s),o=new we(t[3].x,t[3].y);return i.s>0?s.s=-s.s:i.s<0&&(s.s=Math.abs(s.s)),[i,new we(r.x,r.y),s,new we(o.x,o.y)]}}static findDeleteElement(t,i){let r;const s=[],o=[];return function a(l){if(null!=r)return;const u=l.dividers.find(h=>h.id===t);if(u)return r=l,void s.push(u);l.areas.forEach(h=>{a(h)})}(i),0===s.length||null==r?{deleteImposts:[],deleteAreas:[]}:(r.areas.forEach(function c(l){o.push(l),s.push(...l.dividers),l.areas.forEach(c)}),{deleteImposts:s,deleteAreas:o})}static calculateOrthogonalityPoint(t,i,r){const a=r||t;return Math.abs(i.x-t.x)>Math.abs(i.y-t.y)?new we(i.x,a.y):new we(a.x,i.y)}static calculateLineOrthogonalityPoint(t,i,r){const s=Math.abs(i.x-t.midpoint.x),o=Math.abs(i.y-t.midpoint.y),a=r||t.midpoint;return this.equalNumbers(t.p1.x,t.p2.x,this.axisTolerance)&&s<o?new we(i.x,a.y):this.equalNumbers(t.p1.y,t.p2.y,this.axisTolerance)&&s>o?new we(a.x,i.y):s>o?new we(i.x,a.y):new we(a.x,i.y)}static getAdjacentElements(t,i){const r=t.length;return[t[(i-1+r)%r],t[i],t[(i+1)%r]]}static getEdgeFromOriginal(t,i){return"arc"===t.type?i.getArc(t.getS()):i}static createEdge(t,i,r=0){const s=new We(t,i);return r?s.getArc(r):s}static updateEdge(t,i){const[r,s]=this.getPointsOfEdge(t);return new We(r,s).midpoint.equals(i,30)?new We(r,s):new hi(r,i,s)}static checkCommonSideExists(t){if(!t.length)return;const i=t.some(s=>2===s.points.length),r=t.every(s=>2===s.points.length||!s.points.length);if(!i||!r)throw new Jr({code:Ar.dataError,type:Mr.segments,msg:"\u0420\u0430\u043c\u043a\u0438 \u0434\u043e\u043b\u0436\u043d\u044b \u043e\u0431\u043b\u0430\u0434\u0430\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0443\u043c 1\u0439 \u043e\u0431\u0449\u0435\u0439 \u0441\u0442\u043e\u0440\u043e\u043d\u043e\u0439."},t)}static projectPointOnVectorLine(t,i){const r=t.unitVector,s=new we(i.x-t.p1.x,i.y-t.p1.y),o=s.x*r.x+s.y*r.y;return new we(t.p1.x+o*r.x,t.p1.y+o*r.y)}static isPointOnEdgeVector(t,i){const[r,s]=this.getPointsOfEdge(t),{x:o,y:a}=r,{x:c,y:l}=s,{x:u,y:h}=i;return(c-o)*(h-l)==(l-a)*(u-c)}static getCenterEdgeArcPoint(t){return t.reduce((i,r)=>"arc"===r.type?[...i,r.start,r.customEnd,r.center]:[...i,r.p1,r.p2],[])}static getSecondEdgePoint(t,i){const[r,s]=this.getPointsOfEdge(t);return!i||r.equals(i)?s:r}static getEdgePointName(t,i){return"segment"===t.type?this.getSegmentPointName(t,i):this.getArcPointName(t,i)}static getSegmentPointName(t,i){return t.p1.equals(i)?"p1":t.p2.equals(i)?"p2":t.midpoint.equals(i)?"midpoint":null}static getArcPointName(t,i){return t.start.equals(i)?"start":t.customEnd.equals(i)?"customEnd":t.center.equals(i)?"center":null}static getCorrectPointDistance(t,i){const r=n.getCorrectedSegment(t),s=r.midpoint,o=r.p1.x,a=r.p1.y;return(i.x-o)*(r.p2.y-a)-(i.y-a)*(r.p2.x-o)>0?Math.abs(we.distance(i,s)):-Math.abs(we.distance(i,s))}static bendEdgeWithPerpendicularOffsetPoint(t,i){const[r,s]=n.getPointsOfEdge(t),a=new We(r,s).getPerpendicularProject(i).midpoint;return n.updateEdge(t,a)}static getCorrectedSegment(t){const[i,r]=n.getPointsOfEdge(t),s=new we(0,0);return Ln(s,i)<Ln(s,r)?new We(i,r):new We(r,i)}}return n})();var Y8=it(38),lM=it.n(Y8);class Gt extends xs{constructor(...e){super(...e),this.fillColor="transparent"}get edgeArcs(){const e=this.points,t=e.length,i=[];for(let r=0;r<t;++r){const s=new We(e[r],e[(r+1)%t]);if(e[r].s){const o=s.getArc(e[r].s||0);i.push(o)}else i.push(s)}return 1===i.length&&"arc"===i[0].type&&i.push(new We(i[0].start,i[0].customEnd)),i}getCutLine(e,t=0){const i=this.edgeArcs;function r(l){const u=[],[h,d]=Ce.getPointsOfEdge(l);return i.forEach(p=>{u.push(...en(p,l)),[h,d].forEach(f=>{p.contains(f)&&!u.some(m=>m.equals(f))&&u.push(f)})}),u}if(!t){const l=r(e);if(l.length<2)return;const u=Ce.sortPointsByLine(l),h=[];for(let d=0;d<u.length-1;d++){const p=u[d],f=u[d+1],m=new We(p,f);this.containArcs(m.midpoint)&&h.push(...[p,f].filter(v=>!h.some(C=>C.equals(v))))}return h.length<2?void 0:new We(h[0],h[h.length-1])}const s=e.getArc(t),o=r(s);if(o.length<2)return;const a=Ce.sortPointsByCircle(o,s),c=[];for(let l=0;l<a.length-1;l++){const u=a[l],h=a[l+1],d=s.getChildArc(u,h);this.containArcs(d.center)&&c.push(...[u,h].filter(p=>!c.some(f=>f.equals(p))))}return c.length<2?void 0:s.getChildArc(c[0],c[c.length-1])}getCutSegment_nearestIntersection(e){const t=new We(e.p1,e.p2),i=e.line,r=[];this.edgeArcs.forEach(c=>{r.push(...en(c,i))}),this.points.forEach(c=>{Ce.isPointOnEdgeVector(t,c)&&!r.some(l=>l.equals(c))&&r.push(c)});const s=Ce.sortPointsByLine(r),o=[],a=[];for(let c=0;c<s.length-1;c++){const l=new We(s[c],s[c+1]),u=Ce.intersectSegment(t,l);null!=u&&"point"!==u.type&&(u.equals(t)||u.equals(l)?a.push(l):o.push(l))}return a.length>0?new We(a[0].p1,a[a.length-1].p2):o.length>0?new We(o[0].p1,o[o.length-1].p2):void 0}getCutArc_nearestIntersection(e){const t=e.circle,i=[];this.edgeArcs.forEach(c=>i.push(...en(c,t)));const r=Ce.sortPointsByCircle(i,t),s=[],o=[];r.push(r[0]);for(let c=0;c<r.length-1;c++){const u=Ce.getChildArcs(t,r[c],r[c+1]).find(p=>p.start.equals(r[c]));if(null==u){console.warn("\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430 \u0434\u0443\u0433\u0430");continue}const h=Ce.getEdgeCenter(u);if(!this.containArcs(h))continue;const d=Ce.intersectArc(e,u);null!=d&&"point"!==d.type&&(d.customEquals(e)||d.customEquals(u)?o.push(u):s.push(u))}if(o.length>0){const c=function a(c){const l=[];return c.forEach(u=>{l.push(...Ce.getPointsOfEdge(u))}),Ce.sortPointsByCircle(l,c[0])}(o);return new hi(c[0],o[0].center,c[c.length-1])}if(s.length>0)return new hi(s[0].start,s[0].center,s[s.length-1].customEnd)}intersection(e){const t=[];this.edgeArcs.forEach(s=>{t.push(...en(s,e))});const i=Ce.getExtremePoints([e]);if(i.forEach(s=>{this.edgeArcs.some(o=>o.contains(s))&&!t.some(o=>o.equals(s))&&t.push(s)}),t.length||this.points.some(s=>!!e.contains(s)&&t.push(...i)),1===t.length&&t.push(...i.filter(s=>!t.some(o=>o.equals(s)))),t.length%2!=0&&console.warn("\u043d\u0435\u0447\u0435\u0442\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u043e\u0447\u0435\u043a \u043f\u0435\u0440\u0435\u0441\u0435\u0447\u0435\u043d\u0438\u044f",t),"segment"===e.type){const s=Ce.sortPointsByLine(t);return Ce.createSegments(s)}const r=Ce.sortPointsByCircle(t,e);return Ce.createArcs(e,r)}cutArcs(e){const t=[];Array.isArray(e)?e.forEach(o=>{t.push(...this.intersection(o))}):t.push(...this.intersection(e));const i=Ce.getExtremePoints(t),s=[...Ce.breakDownEdgesByPoint(this.edgeArcs,i),...t];return Ce.findLoops(s)}getInnerPolygon(e,t=!1){const i=cM(this.points,e,t),r=new Gt(...i).edges,s=Ce.getApproximateEdges(this,e,t),o=[],a=[];s.forEach((l,u,h)=>{if(null==l)return;if("line"===l?.element.type)return void o.push(l.element);if(null==l.middlePoint)return;const d=0===u?h[h.length-1]:h[u-1],p=h[(u+1)%h.length];if(null==d||null==p)return;const f=en(d.element,l.element);if(0==f.length)return void a.push([d.element,l.element]);const m=en(p.element,l.element);if(0==m.length)return void a.push([p.element,l.element]);const v=[];f.forEach(H=>{m.forEach(ne=>{try{v.push(new hi(H,l.middlePoint,ne))}catch{}})});const C=f.filter(H=>v.some(ne=>ne.customEnd.equals(H)||ne.start.equals(H))),I=m.filter(H=>v.some(ne=>ne.customEnd.equals(H)||ne.start.equals(H))),L=Ce.findApproximateSegment(r[u],C,I);o.push(new hi(L.p1,l.middlePoint,L.p2))});const c=[];if(o.forEach((l,u,h)=>{if("arc"===l.type)return void c.push(l);const d=0===u?h[h.length-1]:h[u-1],p=h[(u+1)%h.length];if(null==d||null==p)return;let f=en(d,l);if("arc"===d.type){const C=Ce.getPointsOfEdge(d).filter(I=>l.contains(I));C.length>0&&(f=C)}if(0==f.length)return void a.push(["arc"===d.type?d.circle:d,l]);let m=en(p,l);if("arc"===p.type){const C=Ce.getPointsOfEdge(p).filter(I=>l.contains(I));C.length>0&&(m=C)}if(0==m.length)return void a.push(["arc"===p.type?p.circle:p,l]);const v=Ce.findApproximateSegment(r[u],f,m);c.push(v)}),0!=a.length)throw new Jr({code:Ar.dataError,type:Mr.data,msg:"Polygon.getInnerPolygon. \u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 \u043f\u043e\u043b\u0438\u0433\u043e\u043d"},a);return new Gt(...Ce.getPolygonPointsByEdges(c))}getSkeletons(e){const t=[];return Array.isArray(e)?e.forEach(i=>{t.push(...this.intersection(i))}):t.push(...this.intersection(e)),{frames:this.cutArcs(t),edges:t}}getInnerZones(e,t=0){const i=[],r=[],s=Array.isArray(e)?e:[e],o=[];if(s.forEach(c=>{const l=Object.assign(this);switch(c.type){case"segment":{const{line1:u,line2:h}=c.getOffsetLines(t);[u,h].forEach(d=>{const f=new We(d.p1,d.p2).cut(this),m=null==f||Array.isArray(f)||"point"===f.type?d:f,v=this.getCutSegment_nearestIntersection(m);v&&o.push(v)});break}case"arc":{const{arc1:u,arc2:h}=c.getOffsetArcs(t);[u,h].forEach(d=>{const p=d.trimEdges(l),f=this.getCutArc_nearestIntersection(p);f&&o.push(f)})}}}),0===t||0===o.length||o.length%2!=0){const c=this.getSkeletons(e);return{frames:c.frames,mullions:c.edges.map(l=>({edge:l,polygon:new Gt}))}}return o.reduce((c,l)=>{const u=[];return c.forEach(h=>{u.push(...h.cutArcs(l))}),u},[this]).forEach(c=>{const l=s.find(u=>c.intersection(u).length);if(l){const u=c.intersection(l);0!=u.length&&i.push({edge:u[0],polygon:c})}else r.push(c)}),{mullions:i,frames:r}}containArcs(e){const t=this.edgeArcs;if(t.some(a=>a.contains(e)))return!0;if(2===this.points.length){const a=t.filter(u=>"arc"===u.type).length;if(0===a)return!1;if(1===a){const u=t.find(h=>"arc"===h.type);return null!=u&&u.containsToChord(e)}let l,c=1;if(t.forEach(u=>{c*=Math.sign(u.getS(l)),l=u.customEnd}),c>0)return t.some(u=>u.containsToChord(e));if(c<0){let h,p,u=1/0,d=-1/0;return t.forEach(f=>{const m=Math.abs(f.getS());m<u&&(u=m,h=f),m>d&&(d=m,p=f)}),null!=p&&null!=h&&p.containsToChord(e)&&!h.containsToChord(e)}return!1}const i=this.contains(e);if(t.every(a=>"segment"===a.type))return i;const r=new Gt(...Ce.getPointsByClockwise([...this.points]));if(i){let a=!1,c=!1;return r.edgeArcs.forEach(l=>{if("segment"===l.type)return;const u=l;Ce.getBasePoint(r,u).s>0||(a=!0,c=c||u.containsToChord(e))}),!a||!c}let s=!1,o=!1;return r.edgeArcs.forEach(a=>{if("segment"===a.type||o)return;const c=a;Ce.getBasePoint(r,c).s<0||(s=!0,o=c.containsToChord(e))}),s&&o}containPoint(e,t){const i=this.points.map(r=>[Math.round(r.x),Math.round(r.y)]);return 1!==lM()(i,[e,t])}}const uM=1e9;class X8{static getAngleBetweenPoints(e,t,i){const r=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));return Math.acos((i*i+i*i-r*r)/(2*i*i))}static getArcParams(e,t,i){const r=t.x-e.x,s=t.y-e.y,o=i.x-e.x,a=i.y-e.y,c=r*(e.x+t.x)+s*(e.y+t.y),l=o*(e.x+i.x)+a*(e.y+i.y),u=2*(r*(i.y-t.y)-s*(i.x-t.x));if(0==u)throw new Jr({code:Ar.dataError,type:Mr.points,msg:"Arc.getArcParams. \u0422\u043e\u0447\u043a\u0438 \u043b\u0435\u0436\u0430\u0442 \u043d\u0430 \u043e\u0434\u043d\u043e\u0439 \u043f\u0440\u044f\u043c\u043e\u0439 \u0438\u043b\u0438 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442"},{points:[e,t,i]});const h=(a*c-s*l)/u,d=(r*l-o*c)/u,p=new we(h,d),f=Math.sqrt(Math.pow(e.x-h,2)+Math.pow(e.y-d,2)),m=this.getAngleBetweenPoints(e,t,f),v=this.getAngleBetweenPoints(t,i,f),C=new go(p,e,m+v);if(t.equals(C.project(t),1)&&i.equals(C.end,1))return{center:p,radius:f,angle:m+v,start:e,end:i};const I=new go(p,i,m+v);if(t.equals(I.project(t),1)&&e.equals(I.end,1))return{center:p,radius:f,angle:m+v,start:i,end:e};throw new Jr({code:Ar.unknownError,type:Mr.unknown,msg:"Arc.getArcParams. \u041a\u0435\u0439\u0441 \u043f\u0440\u0438 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u0430 \u0434\u0430\u043d\u043d\u0430\u044f \u0441\u0438\u0442\u0443\u0432\u0446\u0438\u044f \u043d\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0430"},{start:e,middleOfArc:t,end:i})}}class tv extends go{get length(){return this.radius*this.angle}}class hi extends tv{constructor(e,t,i){const r=X8.getArcParams(e,t,i);super(r.center,r.start,r.angle);const s=new We(r.start,r.end),o=new tv(r.center,r.start,r.angle);this.s=Math.round(Ln(s.midpoint,o.center)*uM)/uM,this.customEnd=r.end,this.chord=s}get intermediatePoint(){return this.getChildArc(this.start,this.center).center}get angleDeg(){return this.chord.angle*(180/Math.PI)}shift(e,t){return new this.constructor(this.start.shift(e,t),this.center.shift(e,t),this.customEnd.shift(e,t))}getChildArc(e,t){if(this.start.equals(e)&&this.customEnd.equals(t)||this.start.equals(t)&&this.customEnd.equals(e))return this;const i=Ce.getChildArcs(this.circle,e,t),r=[];[this.start,this.customEnd,e,t].forEach(o=>{r.find(a=>a.equals(o))||r.push(o)});const s=i.filter(o=>2===r.filter(a=>o.contains(a)||o.start.equals(a)||o.customEnd.equals(a)).length);return 1!==s.length&&console.error("\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043d\u0430\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0435 filteredArcs \u0434\u043b\u044f getChildArc",e,t,this,s),s[0]}containsToChord(e){if(this.contains(e)||this.chord.contains(e))return!0;const t=new XA(this.c,this.start,this.angle),i=new Gt(this.start,this.c,this.customEnd);return!(!t.contains(e)&&!i.contains(e))&&en(this,new $n(this.start,e)).length>0}customEquals(e){return this.start.equals(e.start)&&this.c.equals(e.c)&&this.angle===e.angle}getOffsetArcs(e){function t(r,s){const c=(r.center.x-r.c.x)*s/r.radius+r.c.x,l=(r.center.y-r.c.y)*s/r.radius+r.c.y,u=(r.customEnd.x-r.c.x)*s/r.radius+r.c.x,h=(r.customEnd.y-r.c.y)*s/r.radius+r.c.y,d=new we((r.start.x-r.c.x)*s/r.radius+r.c.x,(r.start.y-r.c.y)*s/r.radius+r.c.y),p=new we(c,l),f=new we(u,h);return new hi(d,p,f)}const i=e/2;return{arc1:t(this,this.radius-i),arc2:t(this,this.radius+i)}}trimEdges(e){const t=Ce.getPointsOfEdge(this),i=[];e.edgeArcs.forEach(o=>{i.push(...en(o,this))});const r=[...i];t.forEach(o=>{e.containArcs(o)&&!r.some(a=>a.equals(o))&&r.push(o)});const s=Ce.sortPointsByCircle(r,this);return s.length>1?new hi(s[0],this.center,s[s.length-1]):this}getS(e="start"){let t;if(t="start"===e?this.start:"end"===e?this.customEnd:e,t.equals(this.start))return this.s;if(t.equals(this.customEnd))return-this.s;throw new Jr({code:Ar.dataError,type:Mr.points,msg:"Arc.getS. \u0422\u043e\u0447\u043a\u0430 \u0441\u043e\u043f\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430"},{points:[this.start,this.customEnd]})}}class We extends Wl{get intermediatePoint(){return new we((this.p1.x+this.midpoint.x)/2,(this.p1.y+this.midpoint.y)/2)}getArc(e){if(e){const t=Ce.getMiddlePoint(this,e),i=new we(this.p1.x,this.p1.y,e);return new hi(i,t,this.p2)}return this}get angleDeg(){return this.angle*(180/Math.PI)}getOffsetLines(e){const t=this.angle,i=e*Math.sin(t)/2,r=e*Math.cos(t)/2;return{line1:new $n(new we(this.p1.x-i,this.p1.y+r),new we(this.p2.x-i,this.p2.y+r)),line2:new $n(new we(this.p1.x+i,this.p1.y-r),new we(this.p2.x+i,this.p2.y-r))}}cut(e){const t=Ce.getPointsOfEdge(this),i=[];e.edgeArcs.forEach(c=>{i.push(...en(c,this))});const r=[...i];t.forEach(c=>{e.containArcs(c)&&!r.some(l=>l.equals(c))&&r.push(c)});const s=Ce.sortPointsByLine(r),o=[];for(let c=0;c<s.length-1;c++){const l=new We(s[c],s[c+1]);e.containArcs(l.midpoint)&&o.push(l)}const a=[];if(s.forEach(c=>{o.some(l=>l.p1.equals(c)||l.p2.equals(c))||a.push(c)}),0!==a.length||0!==o.length){if(1===a.length&&0===o.length)return a[0];if(a.length>0)return[...a,...o];if(o.length>1)return o;if(1===o.length)return o[0]}}getPerpendicularVectorOffset(e){return((e.x-this.p2.x)*this.perpendicularVector.x+(e.y-this.p2.y)*this.perpendicularVector.y)/(this.perpendicularVector.x*this.perpendicularVector.x+this.perpendicularVector.y*this.perpendicularVector.y)}getPerpendicularProject(e){const t=this.getPerpendicularVectorOffset(e),i=new we(this.p1.x+t*this.perpendicularVector.x,this.p1.y+t*this.perpendicularVector.y),r=new we(this.p2.x+t*this.perpendicularVector.x,this.p2.y+t*this.perpendicularVector.y);return new this.constructor(i,r)}getVectorPointWithOffset(e){const t=this.p2.x-this.p1.x,i=this.p2.y-this.p1.y,r=Math.sqrt(t*t+i*i);return new we(this.midpoint.x+t/r*e,this.midpoint.y+i/r*e)}}const hM={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let nv;const Z8=new Uint8Array(16);function Q8(){if(!nv){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");nv=crypto.getRandomValues.bind(crypto)}return nv(Z8)}const Fn=[];for(let n=0;n<256;++n)Fn.push((n+256).toString(16).slice(1));const Si=function J8(n,e,t){if(hM.randomUUID&&!e&&!n)return hM.randomUUID();const i=(n=n||{}).random||(n.rng||Q8)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){t=t||0;for(let r=0;r<16;++r)e[t+r]=i[r];return e}return function dM(n,e=0){return(Fn[n[e+0]]+Fn[n[e+1]]+Fn[n[e+2]]+Fn[n[e+3]]+"-"+Fn[n[e+4]]+Fn[n[e+5]]+"-"+Fn[n[e+6]]+Fn[n[e+7]]+"-"+Fn[n[e+8]]+Fn[n[e+9]]+"-"+Fn[n[e+10]]+Fn[n[e+11]]+Fn[n[e+12]]+Fn[n[e+13]]+Fn[n[e+14]]+Fn[n[e+15]]).toLowerCase()}(i)};class fM extends Gt{constructor(e,t,i){super(...t),this.id=e,this.vertices=t,this.edge=i}get edgeArcs(){const e=this.vertices,t=e.length,i=[];for(let r=0;r<t;++r){const s=new We(e[r],e[(r+1)%t]);if(e[r].s){const o=s.getArc(e[r].s||0);i.push(o)}else i.push(s)}return 1===i.length&&"arc"===i[0].type&&i.push(new We(i[0].start,i[0].customEnd)),i}}class es extends Gt{constructor(e){super(...Ce.getPointsByClockwise(e.points)),this.areas=[],this.dividers=[],this.beams=[],this.id=Si(),this.type=e.type||un.AREA,this.skeleton=e.skeleton,e.points&&e.innerPoints&&!e.noBeams&&(this.beams=this.createBeams(e.points,e.innerPoints)),this.innerPolygon=new Gt(...Ce.getPointsByClockwise(e.innerPoints||e.points))}get edges(){const e=this.points.length,t=[];for(let i=0;i<e;++i)t.push(new We(this.points[i],this.points[(i+1)%e]));return t}setAreas(e){this.areas=Object.assign([],e)}setDividers(e){this.dividers=Object.assign([],e)}updateAreaContent(e){this.areas=e.areas,this.dividers=e.dividers}getCutEdge(e,t=0,i=this){let r=i.skeleton.getCutLine(e,t);return null==r&&i.areas.forEach(s=>{const o=this.getCutEdge(e,t,s);null!=o&&(r=o)}),r}getCutEdge_nearestIntersection(e,t=0,i=!1){const s=(i?this.getParentAreas():this.getAreas()).map(a=>t?a.skeleton.getCutArc_nearestIntersection(e.getArc(t)):a.skeleton.getCutSegment_nearestIntersection(e)).filter(Boolean);if(0===s.length)return;const o=[];if(s.forEach(a=>{const c=Ce.getPointsOfEdge(a).filter(l=>!o.some(u=>u.equals(l)));o.push(...c)}),t){const a=Ce.sortPointsByCircle(o,e.getArc(t));let c=!1,l=!1;if(console.log(a,c,l),s.forEach(u=>{c=c||u.start.equals(a[0]),l=l||u.customEnd.equals(a[0])}),c&&l){const d=[a[a.length-1],...a.slice(0,-1)];return new hi(d[0],s[0].center,d[d.length-1])}return new hi(a[0],s[0].center,a[a.length-1])}{const a=Ce.sortPointsByLine(o);return new We(a[0],a[a.length-1])}}divide(e,t=0,i,r=!1,s=!1,o){const a=s?this.getParentAreas():this.getAreas(),{beadOffset:c,dividerOffset:l}=i,u=!t&&r?this.getCutEdge_nearestIntersection(e,t,s):this.getCutEdge(e,t);if(null==u)return[];const h=[],d=[];return a.forEach(p=>{const f=[],m=[];if(0===p.intersection(u).length)return;const v=p.skeleton.getSkeletons(u),C=p.innerPolygon.getInnerZones(u,l);try{const I=Ce.matchPolygons(v.frames,C.frames),L=Ce.matchMullions(v.edges,C.mullions);if(0===L.length)return;const H=L.map(ne=>{const ce=Ce.intersect(ne.polygon,p.innerPolygon);return ce[0].fillColor="blue",{id:o||Si(),edge:ne.edge,mullions:ce,beam:new fM(Si(),ce[0].points,ne.edge),offset:l}});f.push(...H),I.forEach(ne=>{const se=Ce.intersect(ne.internal,p.innerPolygon);se.length>1&&console.warn("\u041f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u043e \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0445 \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439 \u0434\u043b\u044f \u043e\u0434\u043d\u043e\u0439 \u0432\u043d\u0435\u0448\u043d\u0435\u0439");const ce=new es({points:ne.skeleton.points,skeleton:new Gt(...ne.skeleton.points),innerPoints:se[0].points,noBeams:!0});s&&ce.convertIntoFilling(c),m.push(ce)})}catch(I){return void console.error(I)}h.push(...m.map(I=>({parentId:p.id,area:I}))),d.push(...f.map(I=>({areaId:p.id,divider:I})))}),a.forEach(p=>{const f=h.filter(v=>v.parentId===p.id).map(v=>v.area),m=d.filter(v=>v.areaId===p.id).map(v=>v.divider);f.length&&m.length&&(p.setAreas(f),p.setDividers(m))}),d.map(p=>p.divider)}convertIntoFilling(e){const t=this.innerPolygon.points,r=this.innerPolygon.getInnerPolygon(e).points,s=new es({type:un.FILLING,points:t,skeleton:this.skeleton,innerPoints:r});return s.fillColor="yellow",this.areas.push(s),s}convertIntoWing(e){const t=this.innerPolygon.getInnerPolygon(e.wingOverlap,!0),i=t.getInnerPolygon(e.wingOffset).points,r=new es({type:un.WING,points:t.points,innerPoints:i,skeleton:this.skeleton});return r.fillColor="gray",this.areas=[],this.areas.push(r),r}getAreas(){const e=[];return this.areas.length>0?this.areas.forEach(t=>{e.push(...t.getAreas())}):e.push(this),e}getParentAreas(){const e=[];return 1!==this.areas.length||this.areas[0].areas.length?this.areas.forEach(t=>{e.push(...t.getParentAreas())}):e.push(this),e}deleteDividers(e,t){let i;if(function r(a){i||(a.dividers.some(c=>c.id===e)?i=a:a.areas.find(c=>r(c)))}(this),null==i)return;const s=[];let o;return i.dividers.forEach(a=>{a.id===e?o=a:s.push(a)}),i.dividers=[],i.areas=[],i.convertIntoFilling(t.beadOffset),0===s.length||(s.forEach(a=>{const c="segment"===a.edge.type?a.edge:a.edge.chord,l="segment"===a.edge.type?0:a.edge.getS();i.divide(c,l,t)}),i.areas=i.getAreas(),i.dividers=s),o}findDividerByCoords(e,t=this){const i=t.dividers.find(s=>s.mullions.some(o=>o.containArcs(e)));if(i)return i;let r;return t.areas.find(s=>{const o=this.findDividerByCoords(e,s);return o&&(r=o),o}),r}isStrokeIncludePoint(e){return this.containArcs(e)&&!this.innerPolygon.containArcs(e)}findDividerById(e,t=this){const i=t.dividers.find(s=>s.id===e);if(i)return i;let r;return t.areas.find(s=>{const o=this.findDividerById(e,s);return o&&(r=o),o}),r}findBeamByCoords(e,t=this){const i=t.beams.find(s=>s.containArcs(e));if(i)return i;let r;return t.areas.find(s=>{const o=this.findBeamByCoords(e,s);return o&&(r=o),o}),r}findAreaByCoords(e,t=this){if(this.isStrokeIncludePoint(e))return this;const i=t.areas?.find(s=>s.type!==un.AREA&&s.containArcs(e)&&!s.innerPolygon.containArcs(e));if(i)return i;let r;return t.areas.find(s=>{const o=this.findAreaByCoords(e,s);return o&&(r=o),o}),r}findAreaByPoints(e,t=this){const i=t.areas?.find(s=>s.points.every(o=>e.some(a=>a.equals(o))));if(i)return i;let r;return t.areas.find(s=>{const o=this.findAreaByPoints(e,s);return o&&(r=o),o}),r}findAreaById(e,t=this){const i=t.areas?.find(s=>s.id===e);if(i)return i;let r;return t.areas.find(s=>{const o=this.findAreaById(e,s);return o&&(r=o),o}),r}findAreaByDividerId(e,t=this){if(t.dividers.find(s=>s.id===e))return t;let r;return t.areas.find(s=>{const o=this.findAreaByDividerId(e,s);return o&&(r=o),o}),r}findChildDividersByDividerId(e){const t=this.findAreaByDividerId(e);if(!t)return[];const i=[];return function r(s){s.areas.forEach(o=>{i.push(...o.dividers),r(o)})}(t),i}changeDivider(e,t){const i=this.findDividerById(e),r=this.findAreaByDividerId(e);if(null==i||null==r)return;const c=function s(L){let H=L.edge;return null==t.segment?"arc"===L.edge.type&&(H=L.edge.chord):H="function"!=typeof t.segment?t.segment:"arc"===L.edge.type?L.edge.chord:L.edge,Ce.getCorrectedSegment(H)}(i),l=function o(L,H){if(null!=t.s){if("number"==typeof t.s)return t.s;if("arc"===L.edge.type){const[ne,se]=Ce.getPointsOfEdge(L.edge),ce=Ln(H,ne),pe=Ln(H,se);return t.s(L.edge.getS(ce>pe?se:ne))}return t.s(0)}return"arc"===L.edge.type?L.edge.getS():0}(i,c.p1),u=function a(L){return null!=t.offset?"number"==typeof t.offset?t.offset:t.offset(L.offset):L.offset}(i),h=this.getCutEdge(c,l);if(null==h)return;const d=r.dividers.filter(L=>L.id!=e).map(L=>L.edge),p=r.getSkeletons([...d,h]),f=r.innerPolygon.getInnerZones([...d,h],u),m=Ce.matchPolygons(p.frames,f.frames),C=Ce.matchMullions(p.edges,f.mullions).find(L=>!r.dividers.find(H=>H.mullions[0].equals(L.polygon)));C&&(i.edge=C.edge,i.mullions=[C.polygon],i.offset=u);const I=[];return m.forEach(L=>{const H=r.areas.find(ne=>ne.equals(L.skeleton));if(H){const ne=new es({points:L.skeleton.points,skeleton:new Gt(...L.skeleton.points),innerPoints:L.internal.points});ne.id=H.id,I.push(ne)}}),r.setAreas(I),i}changeDividerBend(e,t,i){const r=this.findDividerById(e),s=this.findAreaByDividerId(e);if(!r||!s)return;const a=Ce.getCorrectedSegment(Ce.getEdgeSegment(r.edge)),c=function o(u,h){if("arc"===u.type){const[d,p]=Ce.getPointsOfEdge(u),f=Ln(h,d),m=Ln(h,p);return i(u.getS(f>m?p:d))}return i(0)}(r.edge,a.p1),l=this.getCutEdge(a,c);return l&&(r.edge=l),s.redivide(t)}createWing(e,t){const r=this.getParentAreas().find(s=>s.containPoint(e.x,e.y));r&&(r.areas=[],r.convertIntoWing(t).convertIntoFilling(t.beadOffset||8))}findAreaContainedPoint(e){return this.getParentAreas().find(i=>i.containPoint(e.x,e.y))}findLowestArea(e){const t=this.areas.find(i=>i.areas.length?i.findLowestArea(e):i.containPoint(e.x,e.y));if(t)return t?.areas.length?t.findLowestArea(e):t}redivide(e){const{beadOffset:t,wingOffset:i,wingOverlap:r}=e,s=[],o=[];(function a(u,h=0,d=0){s[h]?s[h].push(...u.dividers):s[h]=u.dividers,1===u.areas.length&&u.areas[0].areas.length?o[h]?o[h].push(nM(u.areas[0])):o.push([nM(u.areas[0])]):o[h]||o.push([]),u.areas.forEach((p,f)=>{a(p,h+1,f)})})(this),this.dividers=[],this.areas=[],this.convertIntoFilling(t);const c=[];function l(u,h){let d,p=0;switch(u.edge.type){case"segment":{const f=h.skeleton.getCutSegment_nearestIntersection(u.edge);f&&(d=f);break}case"arc":{const f=h.skeleton.getCutSegment_nearestIntersection(u.edge.chord);if(f){d=f;const[m,v]=Ce.getPointsOfEdge(f),C=Ln(u.edge.start,m),I=Ln(u.edge.start,v);p=u.edge.getS(C<I?"start":"end")??0}break}}if(d)return{id:u.id,segment:d,s:p,offset:u.offset}}return s.forEach((u,h)=>{const d=[],p=this.getParentAreas();u.forEach(f=>{let v,m=f.edge;"arc"===f.edge.type&&(m=f.edge.chord),p.some(C=>{const I=[];return C.innerPolygon.edgeArcs.forEach(L=>I.push(...en(L,m))),I.length||C.innerPolygon.points.some(L=>!!m.contains(L)&&I.push(...Ce.getPointsOfEdge(m))),2===I.length&&(v=l(f,C)),null==v&&1===I.length&&(v=l(f,C)),I.length>2&&console.warn("changePoint - \u0447\u0442\u043e-\u0442\u043e \u043d\u0435 \u0442\u043e \u0441 \u043f\u0435\u0440\u0435\u0441\u0435\u0447\u0435\u043d\u0438\u0435\u043c \u0437\u043e\u043d\u044b \u0438 \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u044f",I),2===I.length}),v&&d.push(v)}),o[h]?.forEach(f=>{this.createWing(f,{wingOffset:i,wingOverlap:r,beadOffset:t})}),d.forEach(f=>{const m=this.divide(f.segment,f.s,e,!!f.s,!0,f.id);c.push(...m)})}),c}createBeams(e,t){return e.map((i,r,s)=>{const o=r===s.length-1?0:r+1,a=Ce.adaptBeamPoints([i,s[o],t[o],t[r]]),c=new We(i,s[o]),l=i.s?c.getArc(i.s):c;return new fM(Si(),a,l)})}}class pM extends es{constructor(e){const t=e.config?.frameOffset||0,i=new Gt(...Ce.getPointsByClockwise(e.points)),r=i.getInnerPolygon(t);super({type:un.FRAME,points:i.points,skeleton:new Gt(...e.points),innerPoints:r?.points}),this.config={constructionId:this.id,beadOffset:20,dividerOffset:40,frameOffset:45,couplings:70,extensions:70,wingOffset:58,wingOverlap:8},this.id=e.id||Si(),this.points=i.points,this.beams=this.createBeams(i.points,r.points),this.config=e.config??this.config,e.withFilling&&this.areas.push(this.createFilling(this.config)),this.fillColor="red"}changePoint(e,t,i){return this.points=this.points.map(r=>r.equals(e)?t:r),this.innerPolygon=this.getInnerPolygon(this.config.frameOffset)??this,this.skeleton=new Gt(...this.points),this.beams=this.createBeams(this.points,this.innerPolygon.points),this.redivide(i)}changeImpostPoint(e,t,i,r){const s=this.findDividerById(e);if(null==s)return[];const o=this.findAreaByDividerId(e);if(null==o)return[];const a=Ce.getPointsOfEdge(s.edge).find(l=>!l.equals(t));if(null==a)return[];const c=new We(a,i);switch(s.edge.type){case"segment":s.edge=c;break;case"arc":{const l=s.edge.getS(a),u=c.getArc(l),h=o.getCutArc_nearestIntersection(u);h&&(s.edge=h);break}}return o.redivide(r)}changeImpostPosition(e,t,i){const r=this.findDividerById(e);if(null==r)return[];const s=this.findAreaByDividerId(e);if(null==s)return[];const o=Ce.getEdgeCenter(r.edge),a=r.edge.shift(t.x-o.x,t.y-o.y);switch(a.type){case"segment":{const c=s.getCutSegment_nearestIntersection(a);c&&(r.edge=c);break}case"arc":{const c=s.getCutArc_nearestIntersection(a);c&&(r.edge=c);break}}return s.redivide(i)}changePoints(e,t){return this.points=this.points.map(i=>{const r=e.find(({old:s})=>s.equals(i));return null==r?i:r.new}),this.innerPolygon=this.getInnerPolygon(this.config.frameOffset)??this,this.skeleton=new Gt(...this.points),this.beams=this.createBeams(this.points,this.innerPolygon.points),this.redivide(t)}changeArc(e,t,i){return Ce.getBasePoint(this,e).s=t,this.innerPolygon=this.getInnerPolygon(i.frameOffset)??this,this.beams=this.createBeams(this.points,this.innerPolygon.points),this.redivide(i)}createFilling(e=this.config){const t=this.innerPolygon.points,r=new Gt(...t).getInnerPolygon(e.beadOffset),s=new es({type:un.FILLING,points:t,skeleton:this.skeleton,innerPoints:r.points});return s.fillColor="yellow",s}}class e4{constructor(e,t,i){this.id=e,this.name=t,this.areas=i}addFrame(e){this.areas.push(e)}addArea(e,t){const i=this.findAreaContainedPoint(t);i&&(i.areas=[e])}findInAreas(e){for(const t of this.areas){const i=e(t);if(i)return i}}checkAreaExistsUnderCoords({x:e,y:t}){return this.areas.some(i=>i.containPoint(e,t))}findAreaByCoords(e){return this.findInAreas(t=>t.findAreaByCoords(e))}findAreaByPoints(e){return this.findInAreas(t=>t.findAreaByPoints(e))}findFrameById(e){return this.areas.find(t=>t.id===e)}findAreaById(e){return this.findInAreas(t=>t.findAreaById(e))}findDividerById(e){return this.findInAreas(t=>t.findDividerById(e))}findAreaByDividerId(e){return this.findInAreas(t=>t.findAreaByDividerId(e))}findDividerByCoords(e){return this.findInAreas(t=>t.findDividerByCoords(e))}findAreaContainedPoint(e){return this.findInAreas(t=>t.findAreaContainedPoint(e))}findLowestArea(e){return this.findInAreas(t=>t.findLowestArea(e))}createWing(e,t){this.areas.forEach(i=>{i.createWing(e,t)})}changeImpostPosition(e,t,i){const r=[];return this.areas.forEach(s=>{r.push(...s.changeImpostPosition(e,t,i))}),r}changeImpostPoint(e,t,i,r){const s=[];return this.areas.forEach(o=>{s.push(...o.changeImpostPoint(e,t,i,r))}),s}createDivider(e,t,i,r=!1,s=!1){const o=[];return this.areas.forEach(a=>{o.push(...a.divide(e,i,t,r,s))}),o}deleteArea(e,t){e.type!==un.FRAME?e.type===un.WING&&t&&this.removeWingArea(e,t):this.removeFrameAreaById(e.id)}getAllAngularPoints(){const e=[],i=r=>{(r=>{e.push(...r.filter(s=>!e.some(o=>s.equals(o))))})([...Ce.getCenterEdgeArcPoint(r.edgeArcs),...Ce.getCenterEdgeArcPoint(r.innerPolygon.edgeArcs),...r.points,...r.innerPolygon.points]),r.areas.forEach(a=>{i(a)})};return this.areas.map(r=>{i(r)}),e}getEdgeAngularPoints(){const e=[];return this.areas.forEach(t=>{t.points.forEach(i=>{e.some(r=>i.equals(r))||e.push(i)}),t.edgeArcs.forEach(i=>{"arc"===i.type&&e.push(i.center)}),t.areas.length&&this.getAreaDividersAngularPoints(t,e)}),e}getAreaDividersAngularPoints(e,t=[]){if(e.dividers.length){const i=e.dividers.reduce((r,s)=>"arc"===s.edge.type?[...r,s.edge.start,s.edge.customEnd,s.edge.center]:[...r,s.edge.p1,s.edge.p2],[]);t.push(...i.filter(r=>!t.some(s=>r.equals(s))))}if(e.areas.length)return e.areas.forEach(i=>this.getAreaDividersAngularPoints(i,t))}removeFrameAreaById(e){this.areas=this.areas.filter(t=>t.id!==e)}removeWingArea(e,t){const i=r=>{1===r.areas.length&&r.areas[0].id===e.id?(r.areas=[],r.convertIntoFilling(t.beadOffset)):r.areas.forEach(s=>{i(s)})};this.areas.forEach(r=>{i(r)})}}let rv=(()=>{class n{constructor(){}getAngleBetweenSegments(t,i){const r=t.p1,s=t.p2,o=i.p1,a=i.p2,c=new we(s.x-r.x,s.y-r.y),l=new we(a.x-o.x,a.y-o.y),u=c.x*l.x+c.y*l.y,h=Math.sqrt(c.x*c.x+c.y*c.y),d=Math.sqrt(l.x*l.x+l.y*l.y),f=Math.acos(u/(h*d)),m=f*(180/Math.PI);return{rad:Math.PI-f,deg:Math.round(180-m)}}transformToCutAngle(t){const i=t.deg<90;return t.deg=Math.abs(90-t.deg),t.rad=t.deg*Math.PI/180,i&&(t.deg=-t.deg,t.rad=-t.rad),t}isDividerIntersectsPolygonSide(t,i){const r=new We(i.p1,t.p1),s=new We(t.p1,i.p2),o=new We(i.p1,t.p2),a=new We(t.p2,i.p2),c=this.getAngleBetweenSegments(r,s),l=this.getAngleBetweenSegments(o,a);return 180===c.deg||isNaN(c.deg)&&!isNaN(l.deg)?{intersects:!0,point:t.p1}:180===l.deg||isNaN(l.deg)&&!isNaN(c.deg)?{intersects:!0,point:t.p2}:{intersects:!1}}isPolygonInside(t,i){const r=function H8(n,e,t){return new Se((n.x+e.x+t.x)/3,(n.y+e.y+t.y)/3)}(t[0],t[1],t[2]),s=[r.x,r.y];return 1!==lM()(i.map(o=>[Math.round(o.x),Math.round(o.y)]),s)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),sv=(()=>{class n{constructor(){this.materials={profiles:[],beams:[]},this.sizes={points:[],arcs:[]}}getProfileById(t){return this.materials.profiles.find(i=>i.profileId===t)}getProfileByComponentBeam(t,i){let r;return this.materials.beams.forEach(s=>{if(this.getBeamPointByBeamMaterial(s,t)){const a=this.getProfileById(s.profile.profileId)?.types.find(c=>c.class===i);a&&(r=a)}}),r||void 0}getBeamPointByBeamMaterial(t,i){return t.beams.find(r=>r[0]===i[0]&&r[1]===i[1])}getBeamFromDividerGeometry(t){return t.map(i=>i.flat()[0])}convertPoint3DToPoint(t){const i=Array.isArray(t),[r,s,o]=i?this.sizes.points[t[0]]:this.sizes.points[t],a=i?this.sizes.arcs?.at(t[1]):0;return new we(r,o,a)}getAreaFromComponent(t){return"area"in t?t.area:t}getPolygonFromComponent(t){const i=this.getAreaFromComponent(t).geometry;return new Gt(...i.map(r=>this.convertPoint3DToPoint(r)))}getPropertiesFromPolygon(t,i){const{width:r,height:s}=this.getConstructionSize(i);return[mA(t,[jy({value:r,type:"string",name:"width"}),jy({value:s,type:"string",name:"height"})])]}getDividerProperties(t){return[mA("divider",[jy({value:Math.max(...Object.values(this.getConstructionSize(t.beam.points))),type:"string",name:"length"})])]}getConstructionSize(t){if(0===t.length)return{width:0,height:0};let i=t[0].x,r=t[0].x,s=t[0].y,o=t[0].y;return t.forEach(l=>{l.x<i&&(i=l.x),l.x>r&&(r=l.x),l.y<s&&(s=l.y),l.y>o&&(o=l.y)}),{width:Math.round(100*(r-i))/100,height:Math.round(100*(o-s))/100}}getBeamFromComponentGeometry(t,i){return t.map((r,s,o)=>{const c=o[s===o.length-1?0:s+1],l=Array.isArray(r)?r[0]:r,u=Array.isArray(c)?c[0]:c;return{type:{type:i},beam:[l,u]}})}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),mf=(()=>{class n{constructor(t,i){this.geometryService=t,this.helpersService=i,this.config={constructionId:"",beadOffset:20,dividerOffset:40,frameOffset:45,couplings:70,extensions:70,wingOffset:58,wingOverlap:8}}convertOWSP(t){const{id:i,name:r,definition:{template:s,sizes:o,materials:a}}=t;this.helpersService.materials=a,this.helpersService.sizes=o,this.config.constructionId=i;const l=new e4(i,r,[]);return s.elements.forEach(u=>{if("type"in u&&"frame"===u.type){const h=this.convertFrameToCoreArea(u);l.addFrame(h)}}),{konvaConstruction:l,config:{...this.config}}}convertFrameToCoreArea(t){const i=[],{geometry:r}=t.area;r.forEach(a=>{i.push(this.helpersService.convertPoint3DToPoint(a))});const s=this.helpersService.getProfileByComponentBeam(t.beamTypes[0].beam,"frame");this.config.frameOffset=s?.sizes.c||0;const o=new pM({points:i,config:this.config});return o.fillColor="red",this.handleArea(o,t),o}handleArea(t,i){const r=this.helpersService.getAreaFromComponent(i);if(r.dividers?.length){const s=r.dividers[0].geometry,o=s.map(u=>this.helpersService.convertPoint3DToPoint(u[0])),a=new We(o[0],o[1]),c=this.helpersService.getBeamFromDividerGeometry(s),l=this.helpersService.getProfileByComponentBeam(c,"mullion");this.config.dividerOffset=2*(l?.sizes.c||0),t.divide(a,o[0].s||0,this.config),t.dividers.length&&t.dividers.forEach(u=>{u.mullions[0].fillColor="blue"})}if(t.areas.forEach(s=>{const o=r.components?.find(a=>{const l=this.helpersService.getAreaFromComponent(a).geometry.map(u=>this.helpersService.convertPoint3DToPoint(u));return this.geometryService.isPolygonInside(s.points,l)});if("area"in o&&o.type===un.WING){const a=this.helpersService.getProfileByComponentBeam(o.beamTypes[0].beam,un.WING);if(a?.sizes){const{b:l,c:u}=a.sizes;this.config.wingOverlap=u-l,this.config.wingOffset=u}s=s.convertIntoWing({wingOffset:this.config.wingOffset,wingOverlap:this.config.wingOverlap})}if("area"in o&&o.type===un.FILLING){const a=this.helpersService.getProfileByComponentBeam(o.glazingBeadTypes[0].beam,"glazing bead");this.config.beadOffset=a?.sizes.h||0,s=s.convertIntoFilling(this.config.beadOffset)}this.handleArea(s,o)}),!t.areas.length&&r.components?.length){const s=r.components[0];let o;if(s.type===un.WING){const a=this.helpersService.getProfileByComponentBeam(s.beamTypes[0].beam,un.WING);if(a?.sizes){const{b:l,c:u}=a.sizes;this.config.wingOverlap=u-l,this.config.wingOffset=u}const c={wingOffset:this.config.wingOffset,wingOverlap:this.config.wingOverlap};this.config.wingOffset=a?.sizes.c||0,o=t.convertIntoWing(c)}if(s.type===un.FILLING){const a=this.helpersService.getProfileByComponentBeam(s.glazingBeadTypes[0].beam,"glazing bead");this.config.beadOffset=a?.sizes.h||0,t.convertIntoFilling(this.config.beadOffset)}o&&this.handleArea(o,s)}}convertCoreAreaToTreeComponent(t){const i=new u$({id:t.id,propertiesGroups:[],title:t.name}),r=new f$(t.id,i),s=t.areas.map(o=>{const a=this.helpersService.getPropertiesFromPolygon("frame",o.points),c=new h$({propertiesGroups:a,id:o.id,title:rr.FRAME}),l=this.getDividerFromArea(o);l?.length&&c.addChildren(l);const u=this.getTreeBeamsFromArea(o.beams);return c.addChildren(u),o.areas.length&&c&&this.fillComponentWithContent(c,o),c});return i.addChildren(s),r}fillComponentWithContent(t,i){const r=this.getDividerFromArea(i);if(i.type===un.FRAME&&i.areas.length)i.areas.forEach(s=>{this.fillComponentWithContent(t,s)});else{if(i.type===un.FILLING){const s=this.helpersService.getPropertiesFromPolygon("filling",i.points),o=new c$({id:i.id,title:rr.FILLING,propertiesGroups:s});r&&t.addChildren(r);const a=this.getTreeBeamsFromArea(i.beams);return o.addChildren(a),void t.addChild(o)}if(i.type===un.WING){const s=this.helpersService.getPropertiesFromPolygon("wing",i.points),o=new l$({id:i.id,title:rr.WING,propertiesGroups:s});r&&o.addChildren(r);const a=this.getTreeBeamsFromArea(i.beams);return o.addChildren(a),t.addChild(o),void this.divideParentComponent(o,r,i)}i.type===un.AREA&&i.areas.forEach(s=>{this.fillComponentWithContent(t,s)})}}getDividerFromArea(t){const i=[];return t.dividers?.length?(i.push(this.getDividerComponent(t.dividers[0])),[...i,...this.searchOthersDivider(t)]):null}searchOthersDivider(t){let i=[];return t.areas.length&&t.areas.forEach(s=>{s.dividers.length&&s.type===un.AREA&&(2===t.areas.length&&i.push(this.getDividerComponent(s.dividers[0])),i=[...i,...this.searchOthersDivider(s)])}),i.filter(s=>!!s)}getDividerComponent(t){const i=this.helpersService.getDividerProperties(t),r=new _A({propertiesGroups:i,id:t?.beam.id,title:rr.BEAM}),s=new d$({id:t.id,title:rr.DIVIDER,propertiesGroups:i});return s.addChild(r),s}divideParentComponent(t,i,r){i?.length||!r.areas[0]?i?.length&&r.areas.forEach(s=>{this.fillComponentWithContent(t,s)}):this.fillComponentWithContent(t,r.areas[0])}getTreeBeamsFromArea(t){return t.map(i=>{const r=this.helpersService.getPropertiesFromPolygon(rr.BEAM,i.points);return new _A({id:i.id,title:rr.BEAM,propertiesGroups:r})})}static{this.\u0275fac=function(i){return new(i||n)(Le(rv),Le(sv))}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),r4=(()=>{class n{createConstructionMetrics(t){if(!t.areas.length)return{constructionId:t.id,customSizes:[]};const i=this.getAngularPoints(t),{top:r,right:s,bottom:o,left:a}=this.getExtremePoints(i),c=new We(new we(a.x,o.y),new we(s.x,o.y)),l=new We(new we(a.x,r.y),new we(a.x,o.y));return{constructionId:t.id,sizes:{vertical:[],horizontal:[]},width:c,height:l,customSizes:[]}}getExtremePoints(t){return{top:t.reduce((a,c)=>c.y<a.y?c:a,new we(0,1/0)),right:t.reduce((a,c)=>c.x>a.x?c:a,new we(-1/0,0)),bottom:t.reduce((a,c)=>c.y>a.y?c:a,new we(0,-1/0)),left:t.reduce((a,c)=>c.x<a.x?c:a,new we(1/0,0))}}getAngularPoints(t){return t.areas.reduce((i,r)=>[...i,...r.points,...this.getEdgeArcsCenterPoints(r.edgeArcs)],[])}getEdgeArcsCenterPoints(t){return t.reduce((i,r)=>"arc"===r.type?[...i,r.center]:i,[])}getMathesPointsAndSizes(t,i){return t.reduce((r,s)=>{const o=s.baseLinePoints.every(c=>i.some(l=>l.equals(c))),a=s.pointsIndexes.every(c=>i[c]);if(o){const c=s.baseLinePoints.map(l=>i.findIndex(u=>u.equals(l)));return s.updateIndexes(c),[...r,s]}return a?(s.updateSize(i[s.pointsIndexes[0]],i[s.pointsIndexes[1]]),[...r,s]):r},[])}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),ov=(()=>{class n{constructor(){this.constructions=[],this.onNewConstruction=new Ot,this.onEndMullionDraw=new Ot}findConstruction(t){return this.constructions.find(i=>i.name===t)}getNoNameNextIndex(){let t=0;return this.constructions.forEach(i=>{const r=i.name;if(r.includes("noname-")){const s=r.slice(7),o=parseInt(s);o>t&&(t=o)}}),t+1}parseConstruction(t){try{const r=JSON.parse(t),s=r&&r.name?r.name:"noname-"+this.getNoNameNextIndex(),o={id:Si(),name:s,...r};return new sn(a=>{a.next(o),a.complete()})}catch{return function s4(n,e){const t=Pt(n)?n:()=>n,i=r=>r.error(t());return new sn(e?r=>e.schedule(i,0,r):i)}(()=>new Error("Invalid model data."))}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();it(222);var nt=function(n){return n[n.SimpleLine=0]="SimpleLine",n[n.PolygonLine=1]="PolygonLine",n[n.FrameBeamLine=2]="FrameBeamLine",n[n.GripsLine=3]="GripsLine",n[n.GridMajorLine=4]="GridMajorLine",n[n.GridMinorLine=5]="GridMinorLine",n[n.UCSAxisLine=6]="UCSAxisLine",n[n.DummyLine=7]="DummyLine",n[n.RandomLine=8]="RandomLine",n[n.CustomLine=9]="CustomLine",n[n.DimensionLine=10]="DimensionLine",n[n.DashedLine=11]="DashedLine",n}(nt||{}),tn=function(n){return n[n.CirclePoint=0]="CirclePoint",n[n.RectPoint=1]="RectPoint",n}(tn||{});class v4{constructor(e,t){this.guiConfig=t,this.viewPort=e,this.setUnitScale()}setUnitScale(){this.unitScale=(this.viewPort.rb.x-this.viewPort.tl.x)/this.guiConfig.getUnitsConfig().width}setViewPort(e,t){this.viewPort={...e},this.setUnitScale(),t||this.drawGridInt(),this.drawUCSInt()}redraw(){this.drawGridInt(),this.drawUCSInt()}drawGridInt(){const e=(s,o)=>(s-s%o)/o,t=this.guiConfig.getGridConfig(),i=t.majorStep*t.minorStep,r={tl:new we(e(this.viewPort.tl.x,i)*i-2*i,e(this.viewPort.tl.y,i)*i-2*i),rb:new we(e(this.viewPort.rb.x,i)*i+3*i,e(this.viewPort.rb.y,i)*i+3*i)};this.drawGrid(r,t)}drawUCSInt(){const e=this.guiConfig.getUCSConfig(),t=e.origin.x>this.viewPort.tl.x&&e.origin.x<this.viewPort.rb.x&&e.origin.y>this.viewPort.tl.y&&e.origin.y<this.viewPort.rb.y?new we(e.origin.x,e.origin.y):new we(this.viewPort.tl.x+10,this.viewPort.tl.y+10);this.drawUCS(t,e)}}class w4 extends Xt{constructor(e,t){super()}schedule(e,t=0){return this}}const yf={setInterval(n,e,...t){const{delegate:i}=yf;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=yf;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class wM extends w4{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return yf.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&yf.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,lr(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}class Kl{constructor(e,t=Kl.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}Kl.now=My.now;class EM extends Kl{constructor(e,t=Kl.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const E4=new EM(wM);function bM(n,e=E4){return Pn((t,i)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const l=s;s=null,i.next(l)}};function c(){const l=o+n,u=e.now();if(u<l)return r=this.schedule(void 0,l-u),void i.add(r);a()}t.subscribe(hn(i,l=>{s=l,o=e.now(),r||(r=e.schedule(c,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{s=r=null}))})}function cv(n){return Pn((e,t)=>{Tr(n).subscribe(hn(t,()=>t.complete(),xo)),!t.closed&&e.subscribe(t)})}var S4=Math.PI/180;const Ka=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},Re={_global:Ka,version:"8.4.3",isBrowser:function C4(){return typeof window<"u"&&("[object Window]"==={}.toString.call(window)||"[object global]"==={}.toString.call(window))}(),isUnminified:/param/.test(function(n){}.toString()),dblClickWindow:400,getAngle:n=>Re.angleDeg?n*S4:n,enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging:()=>Re.DD.isDragging,isDragReady:()=>!!Re.DD.node,releaseCanvasOnDestroy:!0,document:Ka.document,_injectGlobal(n){Ka.Konva=n}},Jt=n=>{Re[n.prototype.getClassName()]=n};Re._injectGlobal(Re);class Ci{constructor(e=[1,0,0,1,0,0]){this.dirty=!1,this.m=e&&e.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new Ci(this.m)}copyInto(e){e.m[0]=this.m[0],e.m[1]=this.m[1],e.m[2]=this.m[2],e.m[3]=this.m[3],e.m[4]=this.m[4],e.m[5]=this.m[5]}point(e){var t=this.m;return{x:t[0]*e.x+t[2]*e.y+t[4],y:t[1]*e.x+t[3]*e.y+t[5]}}translate(e,t){return this.m[4]+=this.m[0]*e+this.m[2]*t,this.m[5]+=this.m[1]*e+this.m[3]*t,this}scale(e,t){return this.m[0]*=e,this.m[1]*=e,this.m[2]*=t,this.m[3]*=t,this}rotate(e){var t=Math.cos(e),i=Math.sin(e),s=this.m[1]*t+this.m[3]*i,o=this.m[0]*-i+this.m[2]*t,a=this.m[1]*-i+this.m[3]*t;return this.m[0]=this.m[0]*t+this.m[2]*i,this.m[1]=s,this.m[2]=o,this.m[3]=a,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(e,t){var r=this.m[1]+this.m[3]*t,s=this.m[2]+this.m[0]*e,o=this.m[3]+this.m[1]*e;return this.m[0]=this.m[0]+this.m[2]*t,this.m[1]=r,this.m[2]=s,this.m[3]=o,this}multiply(e){var i=this.m[1]*e.m[0]+this.m[3]*e.m[1],r=this.m[0]*e.m[2]+this.m[2]*e.m[3],s=this.m[1]*e.m[2]+this.m[3]*e.m[3],o=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],a=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];return this.m[0]=this.m[0]*e.m[0]+this.m[2]*e.m[1],this.m[1]=i,this.m[2]=r,this.m[3]=s,this.m[4]=o,this.m[5]=a,this}invert(){var e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),i=-this.m[1]*e,r=-this.m[2]*e,s=this.m[0]*e,o=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=this.m[3]*e,this.m[1]=i,this.m[2]=r,this.m[3]=s,this.m[4]=o,this.m[5]=a,this}getMatrix(){return this.m}decompose(){var e=this.m[0],t=this.m[1],i=this.m[2],r=this.m[3],a=e*r-t*i;let c={x:this.m[4],y:this.m[5],rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!=e||0!=t){var l=Math.sqrt(e*e+t*t);c.rotation=t>0?Math.acos(e/l):-Math.acos(e/l),c.scaleX=l,c.scaleY=a/l,c.skewX=(e*i+t*r)/a,c.skewY=0}else if(0!=i||0!=r){var u=Math.sqrt(i*i+r*r);c.rotation=Math.PI/2-(r>0?Math.acos(-i/u):-Math.acos(i/u)),c.scaleX=a/u,c.scaleY=u,c.skewX=0,c.skewY=(e*i+t*r)/a}return c.rotation=G._getRotation(c.rotation),c}}var M4=Math.PI/180,x4=180/Math.PI,SM="Konva error: ",uv={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},k4=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,vf=[];const L4=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(n){setTimeout(n,60)},G={_isElement:n=>!(!n||1!=n.nodeType),_isFunction:n=>!!(n&&n.constructor&&n.call&&n.apply),_isPlainObject:n=>!!n&&n.constructor===Object,_isArray:n=>"[object Array]"===Object.prototype.toString.call(n),_isNumber:n=>"[object Number]"===Object.prototype.toString.call(n)&&!isNaN(n)&&isFinite(n),_isString:n=>"[object String]"===Object.prototype.toString.call(n),_isBoolean:n=>"[object Boolean]"===Object.prototype.toString.call(n),isObject:n=>n instanceof Object,isValidSelector(n){if("string"!=typeof n)return!1;var e=n[0];return"#"===e||"."===e||e===e.toUpperCase()},_sign:n=>0===n||n>0?1:-1,requestAnimFrame(n){vf.push(n),1===vf.length&&L4(function(){const e=vf;vf=[],e.forEach(function(t){t()})})},createCanvasElement(){var n=document.createElement("canvas");try{n.style=n.style||{}}catch{}return n},createImageElement:()=>document.createElement("img"),_isInDocument(n){for(;n=n.parentNode;)if(n==document)return!0;return!1},_urlToImage(n,e){var t=G.createImageElement();t.onload=function(){e(t)},t.src=n},_rgbToHex:(n,e,t)=>((1<<24)+(n<<16)+(e<<8)+t).toString(16).slice(1),_hexToRgb(n){n=n.replace("#","");var e=parseInt(n,16);return{r:e>>16&255,g:e>>8&255,b:255&e}},getRandomColor(){for(var n=(16777215*Math.random()|0).toString(16);n.length<6;)n="0"+n;return"#"+n},getRGB(n){var e;return n in uv?{r:(e=uv[n])[0],g:e[1],b:e[2]}:"#"===n[0]?this._hexToRgb(n.substring(1)):"rgb("===n.substr(0,4)?(e=k4.exec(n.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA:n=>G._namedColorToRBA(n=n||"black")||G._hex3ColorToRGBA(n)||G._hex4ColorToRGBA(n)||G._hex6ColorToRGBA(n)||G._hex8ColorToRGBA(n)||G._rgbColorToRGBA(n)||G._rgbaColorToRGBA(n)||G._hslColorToRGBA(n),_namedColorToRBA(n){var e=uv[n.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA(n){if(0===n.indexOf("rgb(")){var e=(n=n.match(/rgb\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA(n){if(0===n.indexOf("rgba(")){var e=(n=n.match(/rgba\(([^)]+)\)/)[1]).split(/ *, */).map((t,i)=>"%"===t.slice(-1)?3===i?parseInt(t)/100:parseInt(t)/100*255:Number(t));return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex8ColorToRGBA(n){if("#"===n[0]&&9===n.length)return{r:parseInt(n.slice(1,3),16),g:parseInt(n.slice(3,5),16),b:parseInt(n.slice(5,7),16),a:parseInt(n.slice(7,9),16)/255}},_hex6ColorToRGBA(n){if("#"===n[0]&&7===n.length)return{r:parseInt(n.slice(1,3),16),g:parseInt(n.slice(3,5),16),b:parseInt(n.slice(5,7),16),a:1}},_hex4ColorToRGBA(n){if("#"===n[0]&&5===n.length)return{r:parseInt(n[1]+n[1],16),g:parseInt(n[2]+n[2],16),b:parseInt(n[3]+n[3],16),a:parseInt(n[4]+n[4],16)/255}},_hex3ColorToRGBA(n){if("#"===n[0]&&4===n.length)return{r:parseInt(n[1]+n[1],16),g:parseInt(n[2]+n[2],16),b:parseInt(n[3]+n[3],16),a:1}},_hslColorToRGBA(n){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(n)){const[e,...t]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(n),i=Number(t[0])/360,r=Number(t[1])/100,s=Number(t[2])/100;let o,a,c;if(0===r)return c=255*s,{r:Math.round(c),g:Math.round(c),b:Math.round(c),a:1};o=s<.5?s*(1+r):s+r-s*r;const l=2*s-o,u=[0,0,0];for(let h=0;h<3;h++)a=i+1/3*-(h-1),a<0&&a++,a>1&&a--,c=6*a<1?l+6*(o-l)*a:2*a<1?o:3*a<2?l+(o-l)*(2/3-a)*6:l,u[h]=255*c;return{r:Math.round(u[0]),g:Math.round(u[1]),b:Math.round(u[2]),a:1}}},haveIntersection:(n,e)=>!(e.x>n.x+n.width||e.x+e.width<n.x||e.y>n.y+n.height||e.y+e.height<n.y),cloneObject(n){var e={};for(var t in n)e[t]=this._isPlainObject(n[t])?this.cloneObject(n[t]):this._isArray(n[t])?this.cloneArray(n[t]):n[t];return e},cloneArray:n=>n.slice(0),degToRad:n=>n*M4,radToDeg:n=>n*x4,_degToRad:n=>(G.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),G.degToRad(n)),_radToDeg:n=>(G.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),G.radToDeg(n)),_getRotation:n=>Re.angleDeg?G.radToDeg(n):n,_capitalize:n=>n.charAt(0).toUpperCase()+n.slice(1),throw(n){throw new Error(SM+n)},error(n){console.error(SM+n)},warn(n){Re.showWarnings&&console.warn("Konva warning: "+n)},each(n,e){for(var t in n)e(t,n[t])},_inRange:(n,e,t)=>e<=n&&n<t,_getProjectionToSegment(n,e,t,i,r,s){var o,a,c,l=(n-t)*(n-t)+(e-i)*(e-i);if(0==l)o=n,a=e,c=(r-t)*(r-t)+(s-i)*(s-i);else{var u=((r-n)*(t-n)+(s-e)*(i-e))/l;u<0?(o=n,a=e,c=(n-r)*(n-r)+(e-s)*(e-s)):u>1?(o=t,a=i,c=(t-r)*(t-r)+(i-s)*(i-s)):c=((o=n+u*(t-n))-r)*(o-r)+((a=e+u*(i-e))-s)*(a-s)}return[o,a,c]},_getProjectionToLine(n,e,t){var i=G.cloneObject(n),r=Number.MAX_VALUE;return e.forEach(function(s,o){if(t||o!==e.length-1){var a=e[(o+1)%e.length],c=G._getProjectionToSegment(s.x,s.y,a.x,a.y,n.x,n.y),u=c[1],h=c[2];h<r&&(i.x=c[0],i.y=u,r=h)}}),i},_prepareArrayForTween(n,e,t){var i,r=[],s=[];if(n.length>e.length){var o=e;e=n,n=o}for(i=0;i<n.length;i+=2)r.push({x:n[i],y:n[i+1]});for(i=0;i<e.length;i+=2)s.push({x:e[i],y:e[i+1]});var a=[];return s.forEach(function(c){var l=G._getProjectionToLine(c,r,t);a.push(l.x),a.push(l.y)}),a},_prepareToStringify(n){var e;for(var t in n.visitedByCircularReferenceRemoval=!0,n)if(n.hasOwnProperty(t)&&n[t]&&"object"==typeof n[t])if(e=Object.getOwnPropertyDescriptor(n,t),n[t].visitedByCircularReferenceRemoval||G._isElement(n[t])){if(!e.configurable)return null;delete n[t]}else if(null===G._prepareToStringify(n[t])){if(!e.configurable)return null;delete n[t]}return delete n.visitedByCircularReferenceRemoval,n},_assign(n,e){for(var t in e)n[t]=e[t];return n},_getFirstPointerId:n=>n.touches?n.changedTouches[0].identifier:n.pointerId||999,releaseCanvas(...n){Re.releaseCanvasOnDestroy&&n.forEach(e=>{e.width=0,e.height=0})},drawRoundedRectPath(n,e,t,i){let r=0,s=0,o=0,a=0;"number"==typeof i?r=s=o=a=Math.min(i,e/2,t/2):(r=Math.min(i[0]||0,e/2,t/2),s=Math.min(i[1]||0,e/2,t/2),a=Math.min(i[2]||0,e/2,t/2),o=Math.min(i[3]||0,e/2,t/2)),n.moveTo(r,0),n.lineTo(e-s,0),n.arc(e-s,s,s,3*Math.PI/2,0,!1),n.lineTo(e,t-a),n.arc(e-a,t-a,a,0,Math.PI/2,!1),n.lineTo(o,t),n.arc(o,t-o,o,Math.PI/2,Math.PI,!1),n.lineTo(0,r),n.arc(r,r,r,Math.PI,3*Math.PI/2,!1)}};function ns(n){return G._isString(n)?'"'+n+'"':"[object Number]"===Object.prototype.toString.call(n)||G._isBoolean(n)?n:Object.prototype.toString.call(n)}function CM(n){return n>255?255:n<0?0:Math.round(n)}function _e(){if(Re.isUnminified)return function(n,e){return G._isNumber(n)||G.warn(ns(n)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),n}}function hv(n){if(Re.isUnminified)return function(e,t){let i=G._isNumber(e),r=G._isArray(e)&&e.length==n;return!i&&!r&&G.warn(ns(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or Array<number>('+n+")"),e}}function dv(){if(Re.isUnminified)return function(n,e){return G._isNumber(n)||"auto"===n||G.warn(ns(n)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),n}}function Ya(){if(Re.isUnminified)return function(n,e){return G._isString(n)||G.warn(ns(n)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),n}}function DM(){if(Re.isUnminified)return function(n,e){const t=G._isString(n),i="[object CanvasGradient]"===Object.prototype.toString.call(n)||n&&n.addColorStop;return t||i||G.warn(ns(n)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),n}}function or(){if(Re.isUnminified)return function(n,e){return!0===n||!1===n||G.warn(ns(n)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),n}}var Yl="get",Xl="set";const R={addGetterSetter(n,e,t,i,r){R.addGetter(n,e,t),R.addSetter(n,e,i,r),R.addOverloadedGetterSetter(n,e)},addGetter(n,e,t){var i=Yl+G._capitalize(e);n.prototype[i]=n.prototype[i]||function(){var r=this.attrs[e];return void 0===r?t:r}},addSetter(n,e,t,i){var r=Xl+G._capitalize(e);n.prototype[r]||R.overWriteSetter(n,e,t,i)},overWriteSetter(n,e,t,i){var r=Xl+G._capitalize(e);n.prototype[r]=function(s){return t&&null!=s&&(s=t.call(this,s,e)),this._setAttr(e,s),i&&i.call(this),this}},addComponentsGetterSetter(n,e,t,i,r){var l,u,s=t.length,o=G._capitalize,a=Yl+o(e),c=Xl+o(e);n.prototype[a]=function(){var d={};for(l=0;l<s;l++)d[u=t[l]]=this.getAttr(e+o(u));return d};var h=function B4(n){if(Re.isUnminified)return function(e,t){return null==e||G.isObject(e)||G.warn(ns(e)+' is a not valid value for "'+t+'" attribute. The value should be an object with properties '+n),e}}(t);n.prototype[c]=function(d){var f,p=this.attrs[e];for(f in i&&(d=i.call(this,d)),h&&h.call(this,d,e),d)d.hasOwnProperty(f)&&this._setAttr(e+o(f),d[f]);return d||t.forEach(m=>{this._setAttr(e+o(m),void 0)}),this._fireChangeEvent(e,p,d),r&&r.call(this),this},R.addOverloadedGetterSetter(n,e)},addOverloadedGetterSetter(n,e){var t=G._capitalize(e),i=Xl+t,r=Yl+t;n.prototype[e]=function(){return arguments.length?(this[i](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(n,e,t,i){G.error("Adding deprecated "+e);var r=Yl+G._capitalize(e),s=e+" property is deprecated and will be removed soon. Look at Konva change log for more information.";n.prototype[r]=function(){G.error(s);var o=this.attrs[e];return void 0===o?t:o},R.addSetter(n,e,i,function(){G.error(s)}),R.addOverloadedGetterSetter(n,e)},backCompat(n,e){G.each(e,function(t,i){var r=n.prototype[i],s=Yl+G._capitalize(t),o=Xl+G._capitalize(t);function a(){r.apply(this,arguments),G.error('"'+t+'" method is deprecated and will be removed soon. Use ""'+i+'" instead.')}n.prototype[t]=a,n.prototype[s]=a,n.prototype[o]=a})},afterSetFilter(){this._filterUpToDate=!1}};var Ef,IM=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"];class wf{constructor(e){this.canvas=e,Re.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,t){var o,a,c,l,i=this.traceArr,r=i.length,s="";for(o=0;o<r;o++)(c=(a=i[o]).method)?(l=a.args,s+=c,e?s+="()":G._isArray(l[0])?s+="(["+l.join(",")+"])":(t&&(l=l.map(u=>"number"==typeof u?Math.floor(u):u)),s+="("+l.join(",")+")")):(s+=a.property,e||(s+="="+a.val)),s+=";";return s}clearTrace(){this.traceArr=[]}_trace(e){var t=this.traceArr;t.push(e),t.length>=100&&t.shift()}reset(){var e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){var t=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,t.getWidth()/t.pixelRatio,t.getHeight()/t.pixelRatio)}_applyLineCap(e){const t=e.attrs.lineCap;t&&this.setAttr("lineCap",t)}_applyOpacity(e){var t=e.getAbsoluteOpacity();1!==t&&this.setAttr("globalAlpha",t)}_applyLineJoin(e){const t=e.attrs.lineJoin;t&&this.setAttr("lineJoin",t)}setAttr(e,t){this._context[e]=t}arc(e,t,i,r,s,o){this._context.arc(e,t,i,r,s,o)}arcTo(e,t,i,r,s){this._context.arcTo(e,t,i,r,s)}beginPath(){this._context.beginPath()}bezierCurveTo(e,t,i,r,s,o){this._context.bezierCurveTo(e,t,i,r,s,o)}clearRect(e,t,i,r){this._context.clearRect(e,t,i,r)}clip(){this._context.clip()}closePath(){this._context.closePath()}createImageData(e,t){var i=arguments;return 2===i.length?this._context.createImageData(e,t):1===i.length?this._context.createImageData(e):void 0}createLinearGradient(e,t,i,r){return this._context.createLinearGradient(e,t,i,r)}createPattern(e,t){return this._context.createPattern(e,t)}createRadialGradient(e,t,i,r,s,o){return this._context.createRadialGradient(e,t,i,r,s,o)}drawImage(e,t,i,r,s,o,a,c,l){var u=arguments,h=this._context;3===u.length?h.drawImage(e,t,i):5===u.length?h.drawImage(e,t,i,r,s):9===u.length&&h.drawImage(e,t,i,r,s,o,a,c,l)}ellipse(e,t,i,r,s,o,a,c){this._context.ellipse(e,t,i,r,s,o,a,c)}isPointInPath(e,t,i,r){return i?this._context.isPointInPath(i,e,t,r):this._context.isPointInPath(e,t,r)}fill(e){e?this._context.fill(e):this._context.fill()}fillRect(e,t,i,r){this._context.fillRect(e,t,i,r)}strokeRect(e,t,i,r){this._context.strokeRect(e,t,i,r)}fillText(e,t,i,r){r?this._context.fillText(e,t,i,r):this._context.fillText(e,t,i)}measureText(e){return this._context.measureText(e)}getImageData(e,t,i,r){return this._context.getImageData(e,t,i,r)}lineTo(e,t){this._context.lineTo(e,t)}moveTo(e,t){this._context.moveTo(e,t)}rect(e,t,i,r){this._context.rect(e,t,i,r)}putImageData(e,t,i){this._context.putImageData(e,t,i)}quadraticCurveTo(e,t,i,r){this._context.quadraticCurveTo(e,t,i,r)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,t){this._context.scale(e,t)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,t,i,r,s,o){this._context.setTransform(e,t,i,r,s,o)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,t,i,r){this._context.strokeText(e,t,i,r)}transform(e,t,i,r,s,o){this._context.transform(e,t,i,r,s,o)}translate(e,t){this._context.translate(e,t)}_enableTrace(){var r,s,e=this,t=IM.length,i=this.setAttr,o=function(a){var l,c=e[a];e[a]=function(){return s=function j4(n){var r,s,e=[],t=n.length,i=G;for(r=0;r<t;r++)i._isNumber(s=n[r])?s=Math.round(1e3*s)/1e3:i._isString(s)||(s+=""),e.push(s);return e}(Array.prototype.slice.call(arguments,0)),l=c.apply(e,arguments),e._trace({method:a,args:s}),l}};for(r=0;r<t;r++)o(IM[r]);e.setAttr=function(){i.apply(e,arguments);var a=arguments[0],c=arguments[1];("shadowOffsetX"===a||"shadowOffsetY"===a||"shadowBlur"===a)&&(c/=this.canvas.getPixelRatio()),e._trace({property:a,val:c})}}_applyGlobalCompositeOperation(e){const t=e.attrs.globalCompositeOperation;!t||"source-over"===t||this.setAttr("globalCompositeOperation",t)}}["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"].forEach(function(n){Object.defineProperty(wf.prototype,n,{get(){return this._context[n]},set(e){this._context[n]=e}})});class Y4 extends wf{constructor(e){super(e),this._context=e._canvas.getContext("2d")}_fillColor(e){var t=e.fill();this.setAttr("fillStyle",t),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){var t=e._getLinearGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fillRadialGradient(e){const t=e._getRadialGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fill(e){const t=e.fill(),i=e.getFillPriority();if(t&&"color"===i)return void this._fillColor(e);const r=e.getFillPatternImage();if(r&&"pattern"===i)return void this._fillPattern(e);const s=e.getFillLinearGradientColorStops();if(s&&"linear-gradient"===i)return void this._fillLinearGradient(e);const o=e.getFillRadialGradientColorStops();o&&"radial-gradient"===i?this._fillRadialGradient(e):t?this._fillColor(e):r?this._fillPattern(e):s?this._fillLinearGradient(e):o&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const t=e.getStrokeLinearGradientStartPoint(),i=e.getStrokeLinearGradientEndPoint(),r=e.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(t.x,t.y,i.x,i.y);if(r){for(var o=0;o<r.length;o+=2)s.addColorStop(r[o],r[o+1]);this.setAttr("strokeStyle",s)}}_stroke(e){var t=e.dash(),i=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!i){this.save();var r=this.getCanvas().getPixelRatio();this.setTransform(r,0,0,r,0,0)}this._applyLineCap(e),t&&e.dashEnabled()&&(this.setLineDash(t),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),i||this.restore()}}_applyShadow(e){var t,i,r,s=null!==(t=e.getShadowRGBA())&&void 0!==t?t:"black",o=null!==(i=e.getShadowBlur())&&void 0!==i?i:5,a=null!==(r=e.getShadowOffset())&&void 0!==r?r:{x:0,y:0},c=e.getAbsoluteScale(),l=this.canvas.getPixelRatio(),u=c.x*l,h=c.y*l;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",o*Math.min(Math.abs(u),Math.abs(h))),this.setAttr("shadowOffsetX",a.x*u),this.setAttr("shadowOffsetY",a.y*h)}}class X4 extends wf{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const s=e.getStrokeScaleEnabled();if(!s){this.save();var t=this.getCanvas().getPixelRatio();this.setTransform(t,0,0,t,0,0)}this._applyLineCap(e);var i=e.hitStrokeWidth(),r="auto"===i?e.strokeWidth():i;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),s||this.restore()}}}class bf{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var i=(e||{}).pixelRatio||Re.pixelRatio||function Z4(){if(Ef)return Ef;var n=G.createCanvasElement(),e=n.getContext("2d");return Ef=(Re._global.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1),G.releaseCanvas(n),Ef}();this.pixelRatio=i,this._canvas=G.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){var t=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/t,this.getHeight()/t)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";var t=this.pixelRatio;this.getContext()._context.scale(t,t)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";var t=this.pixelRatio;this.getContext()._context.scale(t,t)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,t){this.setWidth(e||0),this.setHeight(t||0)}toDataURL(e,t){try{return this._canvas.toDataURL(e,t)}catch{try{return this._canvas.toDataURL()}catch(r){return G.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}R.addGetterSetter(bf,"pixelRatio",void 0,_e());class Xa extends bf{constructor(e={width:0,height:0}){super(e),this.context=new Y4(this),this.setSize(e.width,e.height)}}class fv extends bf{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new X4(this),this.setSize(e.width,e.height)}}const _t={get isDragging(){var n=!1;return _t._dragElements.forEach(e=>{"dragging"===e.dragStatus&&(n=!0)}),n},justDragged:!1,get node(){var n;return _t._dragElements.forEach(e=>{n=e.node}),n},_dragElements:new Map,_drag(n){const e=[];_t._dragElements.forEach((t,i)=>{const{node:r}=t,s=r.getStage();s.setPointersPositions(n),void 0===t.pointerId&&(t.pointerId=G._getFirstPointerId(n));const o=s._changedPointerPositions.find(l=>l.id===t.pointerId);if(o){if("dragging"!==t.dragStatus){var a=r.dragDistance();if(Math.max(Math.abs(o.x-t.startPointerPos.x),Math.abs(o.y-t.startPointerPos.y))<a||(r.startDrag({evt:n}),!r.isDragging()))return}r._setDragPosition(n,t),e.push(r)}}),e.forEach(t=>{t.fire("dragmove",{type:"dragmove",target:t,evt:n},!0)})},_endDragBefore(n){const e=[];_t._dragElements.forEach(t=>{const{node:i}=t,r=i.getStage();if(n&&r.setPointersPositions(n),!r._changedPointerPositions.find(a=>a.id===t.pointerId))return;("dragging"===t.dragStatus||"stopped"===t.dragStatus)&&(_t.justDragged=!0,Re._mouseListenClick=!1,Re._touchListenClick=!1,Re._pointerListenClick=!1,t.dragStatus="stopped");const o=t.node.getLayer()||t.node instanceof Re.Stage&&t.node;o&&-1===e.indexOf(o)&&e.push(o)}),e.forEach(t=>{t.draw()})},_endDragAfter(n){_t._dragElements.forEach((e,t)=>{"stopped"===e.dragStatus&&e.node.fire("dragend",{type:"dragend",target:e.node,evt:n},!0),"dragging"!==e.dragStatus&&_t._dragElements.delete(t)})}};Re.isBrowser&&(window.addEventListener("mouseup",_t._endDragBefore,!0),window.addEventListener("touchend",_t._endDragBefore,!0),window.addEventListener("mousemove",_t._drag),window.addEventListener("touchmove",_t._drag),window.addEventListener("mouseup",_t._endDragAfter,!1),window.addEventListener("touchend",_t._endDragAfter,!1));var Sf="absoluteOpacity",Cf="allEventListeners",is="absoluteTransform",AM="absoluteScale",_o="canvas",pv="listening",MM="mouseenter",xM="mouseleave",Ps="transform",gv="visible",nW=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(" ");let iW=1;class me{constructor(e){this._id=iW++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){e!==Ps&&e!==is||!this._cache.get(e)?e?this._cache.delete(e):this._cache.clear():this._cache.get(e).dirty=!0}_getCache(e,t){var i=this._cache.get(e);return(void 0===i||(e===Ps||e===is)&&!0===i.dirty)&&(i=t.call(this),this._cache.set(e,i)),i}_calculate(e,t,i){if(!this._attachedDepsListeners.get(e)){const r=t.map(s=>s+"Change.konva").join(" ");this.on(r,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,i)}_getCanvasCache(){return this._cache.get(_o)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===is&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(_o)){const{scene:e,filter:t,hit:i}=this._cache.get(_o);G.releaseCanvas(e,t,i),this._cache.delete(_o)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){var t=e||{},i={};(void 0===t.x||void 0===t.y||void 0===t.width||void 0===t.height)&&(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()}));var r=Math.ceil(t.width||i.width),s=Math.ceil(t.height||i.height),o=t.pixelRatio,a=void 0===t.x?Math.floor(i.x):t.x,c=void 0===t.y?Math.floor(i.y):t.y,l=t.offset||0,u=t.drawBorder||!1,h=t.hitCanvasPixelRatio||1;if(r&&s){a-=l,c-=l;var d=new Xa({pixelRatio:o,width:r+=2*l+1,height:s+=2*l+1}),p=new Xa({pixelRatio:o,width:0,height:0}),f=new fv({pixelRatio:h,width:r,height:s}),m=d.getContext(),v=f.getContext();return f.isCache=!0,d.isCache=!0,this._cache.delete(_o),this._filterUpToDate=!1,!1===t.imageSmoothingEnabled&&(d.getContext()._context.imageSmoothingEnabled=!1,p.getContext()._context.imageSmoothingEnabled=!1),m.save(),v.save(),m.translate(-a,-c),v.translate(-a,-c),this._isUnderCache=!0,this._clearSelfAndDescendantCache(Sf),this._clearSelfAndDescendantCache(AM),this.drawScene(d,this),this.drawHit(f,this),this._isUnderCache=!1,m.restore(),v.restore(),u&&(m.save(),m.beginPath(),m.rect(0,0,r,s),m.closePath(),m.setAttr("strokeStyle","red"),m.setAttr("lineWidth",5),m.stroke(),m.restore()),this._cache.set(_o,{scene:d,filter:p,hit:f,x:a,y:c}),this._requestDraw(),this}G.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.")}isCached(){return this._cache.has(_o)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,t){var r,s,o,a,i=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],c=this.getAbsoluteTransform(t);return i.forEach(function(l){var u=c.point(l);void 0===r&&(r=o=u.x,s=a=u.y),r=Math.min(r,u.x),s=Math.min(s,u.y),o=Math.max(o,u.x),a=Math.max(a,u.y)}),{x:r,y:s,width:o-r,height:a-s}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const t=this._getCanvasCache();e.translate(t.x,t.y);var i=this._getCachedSceneCanvas(),r=i.pixelRatio;e.drawImage(i._canvas,0,0,i.width/r,i.height/r),e.restore()}_drawCachedHitCanvas(e){var t=this._getCanvasCache(),i=t.hit;e.save(),e.translate(t.x,t.y),e.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),e.restore()}_getCachedSceneCanvas(){var o,a,c,l,e=this.filters(),t=this._getCanvasCache(),i=t.scene,r=t.filter,s=r.getContext();if(e){if(!this._filterUpToDate){var u=i.pixelRatio;r.setSize(i.width/i.pixelRatio,i.height/i.pixelRatio);try{for(o=e.length,s.clear(),s.drawImage(i._canvas,0,0,i.getWidth()/u,i.getHeight()/u),a=s.getImageData(0,0,r.getWidth(),r.getHeight()),c=0;c<o;c++)"function"==typeof(l=e[c])?(l.call(this,a),s.putImageData(a,0,0)):G.error("Filter should be type of function, but got "+typeof l+" instead. Please check correct filters")}catch(h){G.error("Unable to apply filter. "+h.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return r}return i}on(e,t){if(this._cache&&this._cache.delete(Cf),3===arguments.length)return this._delegate.apply(this,arguments);var s,a,c,l,i=e.split(" "),r=i.length;for(s=0;s<r;s++)l=(a=i[s].split("."))[1]||"",this.eventListeners[c=a[0]]||(this.eventListeners[c]=[]),this.eventListeners[c].push({name:l,handler:t});return this}off(e,t){var s,o,c,l,u,i=(e||"").split(" "),r=i.length;if(this._cache&&this._cache.delete(Cf),!e)for(o in this.eventListeners)this._off(o);for(s=0;s<r;s++)if(u=(c=i[s].split("."))[1],l=c[0])this.eventListeners[l]&&this._off(l,u,t);else for(o in this.eventListeners)this._off(o,u,t);return this}dispatchEvent(e){return this.fire(e.type,{target:this,type:e.type,evt:e}),this}addEventListener(e,t){return this.on(e,function(i){t.call(this,i.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,t,i){var r=this;this.on(e,function(s){for(var o=s.target.findAncestors(t,!0,r),a=0;a<o.length;a++)(s=G.cloneObject(s)).currentTarget=o[a],i.call(o[a],s)})}remove(){return this.isDragging()&&this.stopDrag(),_t._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(is),this._clearSelfAndDescendantCache(Sf),this._clearSelfAndDescendantCache(AM),this._clearSelfAndDescendantCache("stage"),this._clearSelfAndDescendantCache(gv),this._clearSelfAndDescendantCache(pv)}_remove(){this._clearCaches();var e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){var t="get"+G._capitalize(e);return G._isFunction(this[t])?this[t]():this.attrs[e]}getAncestors(){for(var e=this.getParent(),t=[];e;)t.push(e),e=e.getParent();return t}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{var t,i;if(!e)return this;for(t in e)"children"!==t&&(i="set"+G._capitalize(t),G._isFunction(this[i])?this[i](e[t]):this._setAttr(t,e[t]))}),this}isListening(){return this._getCache(pv,this._isListening)}_isListening(e){if(!this.listening())return!1;const i=this.getParent();return!i||i===e||this===e||i._isListening(e)}isVisible(){return this._getCache(gv,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const i=this.getParent();return!i||i===e||this===e||i._isVisible(e)}shouldDrawHit(e,t=!1){if(e)return this._isVisible(e)&&this._isListening(e);var i=this.getLayer(),r=!1;_t._dragElements.forEach(o=>{"dragging"===o.dragStatus&&("Stage"===o.node.nodeType||o.node.getLayer()===i)&&(r=!0)});var s=!t&&!Re.hitOnDragEnabled&&r;return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var r,s,o,a,e=this.getDepth(),t=this,i=0;return"Stage"!==t.nodeType&&function c(l){for(r=[],s=l.length,o=0;o<s;o++)i++,"Shape"!==(a=l[o]).nodeType&&(r=r.concat(a.getChildren().slice())),a._id===t._id&&(o=s);r.length>0&&r[0].getDepth()<=e&&c(r)}(t.getStage().getChildren()),i}getDepth(){for(var e=0,t=this.parent;t;)e++,t=t.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Ps),this._clearSelfAndDescendantCache(is)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){if(!this.getStage())return null;var e=this.getStage().getPointerPosition();if(!e)return null;var t=this.getAbsoluteTransform().copy();return t.invert(),t.point(e)}getAbsolutePosition(e){let t=!1,i=this.parent;for(;i;){if(i.isCached()){t=!0;break}i=i.parent}t&&!e&&(e=!0);var r=this.getAbsoluteTransform(e).getMatrix(),s=new Ci,o=this.offset();return s.m=r.slice(),s.translate(o.x,o.y),s.getTranslation()}setAbsolutePosition(e){var t=this._clearTransform();this.attrs.x=t.x,this.attrs.y=t.y,delete t.x,delete t.y,this._clearCache(Ps);var i=this._getAbsoluteTransform().copy();return i.invert(),i.translate(e.x,e.y),e={x:this.attrs.x+i.getTranslation().x,y:this.attrs.y+i.getTranslation().y},this._setTransform(t),this.setPosition({x:e.x,y:e.y}),this._clearCache(Ps),this._clearSelfAndDescendantCache(is),this}_setTransform(e){var t;for(t in e)this.attrs[t]=e[t]}_clearTransform(){var e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){var t=e.x,i=e.y,r=this.x(),s=this.y();return void 0!==t&&(r+=t),void 0!==i&&(s+=i),this.setPosition({x:r,y:s}),this}_eachAncestorReverse(e,t){var s,o,i=[],r=this.getParent();if(!t||t._id!==this._id){for(i.unshift(this);r&&(!t||r._id!==t._id);)i.unshift(r),r=r.parent;for(s=i.length,o=0;o<s;o++)e(i[o])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return G.warn("Node has no parent. moveToTop function is ignored."),!1;var e=this.index;return e<this.parent.getChildren().length-1&&(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0)}moveUp(){if(!this.parent)return G.warn("Node has no parent. moveUp function is ignored."),!1;var e=this.index;return e<this.parent.getChildren().length-1&&(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0)}moveDown(){if(!this.parent)return G.warn("Node has no parent. moveDown function is ignored."),!1;var e=this.index;return e>0&&(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0)}moveToBottom(){if(!this.parent)return G.warn("Node has no parent. moveToBottom function is ignored."),!1;var e=this.index;return e>0&&(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0)}setZIndex(e){return this.parent?((e<0||e>=this.parent.children.length)&&G.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+"."),this.parent.children.splice(this.index,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this):(G.warn("Node has no parent. zIndex parameter is ignored."),this)}getAbsoluteOpacity(){return this._getCache(Sf,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var e=this.opacity(),t=this.getParent();return t&&!t._isUnderCache&&(e*=t.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){var i,r,s,o,e={},t=this.getAttrs();for(i in e.attrs={},t)(!G.isObject(r=t[i])||G._isPlainObject(r)||G._isArray(r))&&(s="function"==typeof this[i]&&this[i],delete t[i],o=s?s.call(this):null,t[i]=r,o!==r&&(e.attrs[i]=r));return e.className=this.getClassName(),G._prepareToStringify(e)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,t,i){var r=[];t&&this._isMatch(e)&&r.push(this);for(var s=this.parent;s;){if(s===i)return r;s._isMatch(e)&&r.push(s),s=s.parent}return r}isAncestorOf(e){return!1}findAncestor(e,t,i){return this.findAncestors(e,t,i)[0]}_isMatch(e){if(!e)return!1;if("function"==typeof e)return e(this);var r,s,t=e.replace(/ /g,"").split(","),i=t.length;for(r=0;r<i;r++)if(G.isValidSelector(s=t[r])||(G.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),G.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),G.warn("Konva is awesome, right?")),"#"===s.charAt(0)){if(this.id()===s.slice(1))return!0}else if("."===s.charAt(0)){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){var e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache("stage",this._getStage)}_getStage(){var e=this.getParent();if(e)return e.getStage()}fire(e,t={},i){return t.target=t.target||this,i?this._fireAndBubble(e,t):this._fire(e,t),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(is,this._getAbsoluteTransform)}_getAbsoluteTransform(e){var t;if(e)return t=new Ci,this._eachAncestorReverse(function(r){var s=r.transformsEnabled();"all"===s?t.multiply(r.getTransform()):"position"===s&&t.translate(r.x()-r.offsetX(),r.y()-r.offsetY())},e),t;t=this._cache.get(is)||new Ci,this.parent?this.parent.getAbsoluteTransform().copyInto(t):t.reset();var i=this.transformsEnabled();return"all"===i?t.multiply(this.getTransform()):"position"===i&&t.translate((this.attrs.x||0)-(this.attrs.offsetX||0),(this.attrs.y||0)-(this.attrs.offsetY||0)),t.dirty=!1,t}getAbsoluteScale(e){for(var t=this;t;)t._isUnderCache&&(e=t),t=t.getParent();const r=this.getAbsoluteTransform(e).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Ps,this._getTransform)}_getTransform(){var e,t,i=this._cache.get(Ps)||new Ci;i.reset();var r=this.x(),s=this.y(),o=Re.getAngle(this.rotation()),a=null!==(e=this.attrs.scaleX)&&void 0!==e?e:1,c=null!==(t=this.attrs.scaleY)&&void 0!==t?t:1,l=this.attrs.skewX||0,u=this.attrs.skewY||0,h=this.attrs.offsetX||0,d=this.attrs.offsetY||0;return(0!==r||0!==s)&&i.translate(r,s),0!==o&&i.rotate(o),(0!==l||0!==u)&&i.skew(l,u),(1!==a||1!==c)&&i.scale(a,c),(0!==h||0!==d)&&i.translate(-1*h,-1*d),i.dirty=!1,i}clone(e){var i,r,s,o,a,t=G.cloneObject(this.attrs);for(i in e)t[i]=e[i];var c=new this.constructor(t);for(i in this.eventListeners)for(s=(r=this.eventListeners[i]).length,o=0;o<s;o++)(a=r[o]).name.indexOf("konva")<0&&(c.eventListeners[i]||(c.eventListeners[i]=[]),c.eventListeners[i].push(a));return c}_toKonvaCanvas(e){e=e||{};var t=this.getClientRect(),i=this.getStage(),r=void 0!==e.x?e.x:Math.floor(t.x),s=void 0!==e.y?e.y:Math.floor(t.y),o=e.pixelRatio||1,a=new Xa({width:e.width||Math.ceil(t.width)||(i?i.width():0),height:e.height||Math.ceil(t.height)||(i?i.height():0),pixelRatio:o}),c=a.getContext();return!1===e.imageSmoothingEnabled&&(c._context.imageSmoothingEnabled=!1),c.save(),(r||s)&&c.translate(-1*r,-1*s),this.drawScene(a),c.restore(),a}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){var t=(e=e||{}).mimeType||null,i=e.quality||null,r=this._toKonvaCanvas(e).toDataURL(t,i);return e.callback&&e.callback(r),r}toImage(e){return new Promise((t,i)=>{try{const r=e?.callback;r&&delete e.callback,G._urlToImage(this.toDataURL(e),function(s){t(s),r?.(s)})}catch(r){i(r)}})}toBlob(e){return new Promise((t,i)=>{try{const r=e?.callback;r&&delete e.callback,this.toCanvas(e).toBlob(s=>{t(s),r?.(s)})}catch(r){i(r)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Re.dragDistance}_off(e,t,i){var s,o,r=this.eventListeners[e];for(s=0;s<r.length;s++)if(!("konva"===(o=r[s].name)&&"konva"!==t||t&&o!==t||i&&i!==r[s].handler)){if(r.splice(s,1),0===r.length){delete this.eventListeners[e];break}s--}}_fireChangeEvent(e,t,i){this._fire(e+"Change",{oldVal:t,newVal:i})}addName(e){if(!this.hasName(e)){var t=this.name();this.name(t?t+" "+e:e)}return this}hasName(e){if(!e)return!1;const t=this.name();return!!t&&-1!==(t||"").split(/\s/g).indexOf(e)}removeName(e){var t=(this.name()||"").split(/\s/g),i=t.indexOf(e);return-1!==i&&(t.splice(i,1),this.name(t.join(" "))),this}setAttr(e,t){var i=this["set"+G._capitalize(e)];return G._isFunction(i)?i.call(this,t):this._setAttr(e,t),this}_requestDraw(){if(Re.autoDrawEnabled){const e=this.getLayer()||this.getStage();e?.batchDraw()}}_setAttr(e,t){var i=this.attrs[e];i===t&&!G.isObject(t)||(null==t?delete this.attrs[e]:this.attrs[e]=t,this._shouldFireChangeEvents&&this._fireChangeEvent(e,i,t),this._requestDraw())}_setComponentAttr(e,t,i){var r;void 0!==i&&((r=this.attrs[e])||(this.attrs[e]=this.getAttr(e)),this.attrs[e][t]=i,this._fireChangeEvent(e,r,i))}_fireAndBubble(e,t,i){if(t&&"Shape"===this.nodeType&&(t.target=this),e!==MM&&e!==xM||!(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||"Stage"===this.nodeType&&!i)){this._fire(e,t);var s=(e===MM||e===xM)&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(t&&!t.cancelBubble||!t)&&this.parent&&this.parent.isListening()&&!s&&(i&&i.parent?this._fireAndBubble.call(this.parent,e,t,i):this._fireAndBubble.call(this.parent,e,t))}}_getProtoListeners(e){let t=this._cache.get(Cf);if(!t){t={};let r=Object.getPrototypeOf(this);for(;r;)if(r.eventListeners){for(var i in r.eventListeners)t[i]=r.eventListeners[i].concat(t[i]||[]);r=Object.getPrototypeOf(r)}else r=Object.getPrototypeOf(r);this._cache.set(Cf,t)}return t[e]}_fire(e,t){(t=t||{}).currentTarget=this,t.type=e;const i=this._getProtoListeners(e);if(i)for(var r=0;r<i.length;r++)i[r].handler.call(this,t);const s=this.eventListeners[e];if(s)for(r=0;r<s.length;r++)s[r].handler.call(this,t)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){var t=e?e.pointerId:void 0,i=this.getStage(),r=this.getAbsolutePosition(),s=i._getPointerById(t)||i._changedPointerPositions[0]||r;_t._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-r.x,y:s.y-r.y},dragStatus:"ready",pointerId:t})}startDrag(e,t=!0){_t._dragElements.has(this._id)||this._createDragElement(e),_t._dragElements.get(this._id).dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},t)}_setDragPosition(e,t){const i=this.getStage()._getPointerById(t.pointerId);if(i){var r={x:i.x-t.offset.x,y:i.y-t.offset.y},s=this.dragBoundFunc();if(void 0!==s){const o=s.call(this,r,e);o?r=o:G.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==r.x||this._lastPos.y!==r.y)&&(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}}stopDrag(e){const t=_t._dragElements.get(this._id);t&&(t.dragStatus="stopped"),_t._endDragBefore(e),_t._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=_t._dragElements.get(this._id);return!!e&&"dragging"===e.dragStatus}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if((void 0===e.evt.button||Re.dragButtons.indexOf(e.evt.button)>=0)&&!this.isDragging()){var r=!1;_t._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(r=!0)}),r||this._createDragElement(e)}})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const t=_t._dragElements.get(this._id),r=t&&"ready"===t.dragStatus;t&&"dragging"===t.dragStatus?this.stopDrag():r&&_t._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const t=this.getStage();if(!t)return!1;const i={x:-e.x,y:-e.y,width:t.width()+2*e.x,height:t.height()+2*e.y};return G.haveIntersection(i,this.getClientRect())}static create(e,t){return G._isString(e)&&(e=JSON.parse(e)),this._createNode(e,t)}static _createNode(e,t){var s,o,a,i=me.prototype.getClassName.call(e),r=e.children;if(t&&(e.attrs.container=t),Re[i]||(G.warn('Can not find a node with class name "'+i+'". Fallback to "Shape".'),i="Shape"),s=new(0,Re[i])(e.attrs),r)for(o=r.length,a=0;a<o;a++)s.add(me._createNode(r[a]));return s}}me.prototype.nodeType="Node",me.prototype._attrsAffectingSize=[],me.prototype.eventListeners={},me.prototype.on.call(me.prototype,nW,function(){this._batchingTransformChange?this._needClearTransformCache=!0:(this._clearCache(Ps),this._clearSelfAndDescendantCache(is))}),me.prototype.on.call(me.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(gv)}),me.prototype.on.call(me.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(pv)}),me.prototype.on.call(me.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Sf)});const Bt=R.addGetterSetter;Bt(me,"zIndex"),Bt(me,"absolutePosition"),Bt(me,"position"),Bt(me,"x",0,_e()),Bt(me,"y",0,_e()),Bt(me,"globalCompositeOperation","source-over",Ya()),Bt(me,"opacity",1,_e()),Bt(me,"name","",Ya()),Bt(me,"id","",Ya()),Bt(me,"rotation",0,_e()),R.addComponentsGetterSetter(me,"scale",["x","y"]),Bt(me,"scaleX",1,_e()),Bt(me,"scaleY",1,_e()),R.addComponentsGetterSetter(me,"skew",["x","y"]),Bt(me,"skewX",0,_e()),Bt(me,"skewY",0,_e()),R.addComponentsGetterSetter(me,"offset",["x","y"]),Bt(me,"offsetX",0,_e()),Bt(me,"offsetY",0,_e()),Bt(me,"dragDistance",null,_e()),Bt(me,"width",0,_e()),Bt(me,"height",0,_e()),Bt(me,"listening",!0,or()),Bt(me,"preventDefault",!0,or()),Bt(me,"filters",null,function(n){return this._filterUpToDate=!1,n}),Bt(me,"visible",!0,or()),Bt(me,"transformsEnabled","all",Ya()),Bt(me,"size"),Bt(me,"dragBoundFunc"),Bt(me,"draggable",!1,or()),R.backCompat(me,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class Di extends me{constructor(){super(...arguments),this.children=[]}getChildren(e){if(!e)return this.children||[];var i=[];return(this.children||[]).forEach(function(r){e(r)&&i.push(r)}),i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(0===e.length)return this;if(e.length>1){for(var t=0;t<e.length;t++)this.add(e[t]);return this}const i=e[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){var t=this._generalFind(e,!0);return t.length>0?t[0]:void 0}_generalFind(e,t){var i=[];return this._descendants(r=>{const s=r._isMatch(e);return s&&i.push(r),!(!s||!t)}),i}_descendants(e){let t=!1;const i=this.getChildren();for(const r of i){if(t=e(r),t)return!0;if(r.hasChildren()&&(t=r._descendants(e),t))return!0}return!1}toObject(){var e=me.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(t=>{e.children.push(t.toObject())}),e}isAncestorOf(e){for(var t=e.getParent();t;){if(t._id===this._id)return!0;t=t.getParent()}return!1}clone(e){var t=me.prototype.clone.call(this,e);return this.getChildren().forEach(function(i){t.add(i.clone())}),t}getAllIntersections(e){var t=[];return this.find("Shape").forEach(function(i){i.isVisible()&&i.intersects(e)&&t.push(i)}),t}_clearSelfAndDescendantCache(e){var t;super._clearSelfAndDescendantCache(e),!this.isCached()&&(null===(t=this.children)||void 0===t||t.forEach(function(i){i._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;null===(e=this.children)||void 0===e||e.forEach(function(t,i){t.index=i}),this._requestDraw()}drawScene(e,t){var i=this.getLayer(),r=e||i&&i.getCanvas(),s=r&&r.getContext(),o=this._getCanvasCache(),a=o&&o.scene,c=r&&r.isCache;if(!this.isVisible()&&!c)return this;if(a){s.save();var l=this.getAbsoluteTransform(t).getMatrix();s.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",r,t);return this}drawHit(e,t){if(!this.shouldDrawHit(t))return this;var i=this.getLayer(),r=e||i&&i.hitCanvas,s=r&&r.getContext(),o=this._getCanvasCache();if(o&&o.hit){s.save();var c=this.getAbsoluteTransform(t).getMatrix();s.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",r,t);return this}_drawChildren(e,t,i){var r,s=t&&t.getContext(),o=this.clipWidth(),a=this.clipHeight(),c=this.clipFunc(),l=o&&a||c;const u=i===this;if(l){s.save();var h=this.getAbsoluteTransform(i),d=h.getMatrix();if(s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),s.beginPath(),c)c.call(this,s,this);else{var p=this.clipX(),f=this.clipY();s.rect(p,f,o,a)}s.clip(),d=h.copy().invert().getMatrix(),s.transform(d[0],d[1],d[2],d[3],d[4],d[5])}var m=!u&&"source-over"!==this.globalCompositeOperation()&&"drawScene"===e;m&&(s.save(),s._applyGlobalCompositeOperation(this)),null===(r=this.children)||void 0===r||r.forEach(function(v){v[e](t,i)}),m&&s.restore(),l&&s.restore()}getClientRect(e){var t,s,o,a,c,l,i=(e=e||{}).skipTransform,r=e.relativeTo,u=this;null===(t=this.children)||void 0===t||t.forEach(function(m){if(m.visible()){var v=m.getClientRect({relativeTo:u,skipShadow:e.skipShadow,skipStroke:e.skipStroke});0===v.width&&0===v.height||(void 0===s?(s=v.x,o=v.y,a=v.x+v.width,c=v.y+v.height):(s=Math.min(s,v.x),o=Math.min(o,v.y),a=Math.max(a,v.x+v.width),c=Math.max(c,v.y+v.height)))}});for(var h=this.find("Shape"),d=!1,p=0;p<h.length;p++)if(h[p]._isVisible(this)){d=!0;break}return l=d&&void 0!==s?{x:s,y:o,width:a-s,height:c-o}:{x:0,y:0,width:0,height:0},i?l:this._transformedRect(l,r)}}R.addComponentsGetterSetter(Di,"clip",["x","y","width","height"]),R.addGetterSetter(Di,"clipX",void 0,_e()),R.addGetterSetter(Di,"clipY",void 0,_e()),R.addGetterSetter(Di,"clipWidth",void 0,_e()),R.addGetterSetter(Di,"clipHeight",void 0,_e()),R.addGetterSetter(Di,"clipFunc");const Zl=new Map,NM=void 0!==Re._global.PointerEvent;function _v(n){return Zl.get(n)}function mv(n){return{evt:n,pointerId:n.pointerId}}function kM(n,e){return Zl.get(n)===e}function LM(n,e){Ql(n),e.getStage()&&(Zl.set(n,e),NM&&e._fire("gotpointercapture",mv(new PointerEvent("gotpointercapture"))))}function Ql(n,e){const t=Zl.get(n);t&&(t.getStage(),Zl.delete(n),NM&&t._fire("lostpointercapture",mv(new PointerEvent("lostpointercapture"))))}var BM="mouseleave",jM="mouseover",VM="mouseenter",zM="mousemove",UM="mousedown",HM="mouseup",Jl="pointermove",eu="pointerdown",Za="pointerup",tu="pointercancel",Tf="pointerout",If="pointerleave",Af="pointerover",Mf="pointerenter",yv="contextmenu",GM="touchstart",$M="touchend",WM="touchmove",qM="touchcancel",vv="wheel",lW=[[VM,"_pointerenter"],[UM,"_pointerdown"],[zM,"_pointermove"],[HM,"_pointerup"],[BM,"_pointerleave"],[GM,"_pointerdown"],[WM,"_pointermove"],[$M,"_pointerup"],[qM,"_pointercancel"],[jM,"_pointerover"],[vv,"_wheel"],[yv,"_contextmenu"],[eu,"_pointerdown"],[Jl,"_pointermove"],[Za,"_pointerup"],[tu,"_pointercancel"],["lostpointercapture","_lostpointercapture"]];const wv={mouse:{[Tf]:"mouseout",[If]:BM,[Af]:jM,[Mf]:VM,[Jl]:zM,[eu]:UM,[Za]:HM,[tu]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[Tf]:"touchout",[If]:"touchleave",[Af]:"touchover",[Mf]:"touchenter",[Jl]:WM,[eu]:GM,[Za]:$M,[tu]:qM,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[Tf]:Tf,[If]:If,[Af]:Af,[Mf]:Mf,[Jl]:Jl,[eu]:eu,[Za]:Za,[tu]:tu,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},nu=n=>n.indexOf("pointer")>=0?"pointer":n.indexOf("touch")>=0?"touch":"mouse",Qa=n=>{const e=nu(n);return"pointer"===e?Re.pointerEventsEnabled&&wv.pointer:"touch"===e?wv.touch:"mouse"===e?wv.mouse:void 0};function KM(n={}){return(n.clipFunc||n.clipWidth||n.clipHeight)&&G.warn("Stage does not support clipping. Please use clip for Layers or Groups."),n}const xf=[];class iu extends Di{constructor(e){super(KM(e)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),xf.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{KM(this.attrs)}),this._checkVisibility()}_validateAdd(e){const t="Layer"===e.getType(),i="FastLayer"===e.getType();t||i||G.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const e=this.visible()?"":"none";this.content.style.display=e}setContainer(e){if("string"==typeof e){if("."===e.charAt(0)){var t=e.slice(1);e=document.getElementsByClassName(t)[0]}else{var i;i="#"!==e.charAt(0)?e:e.slice(1),e=document.getElementById(i)}if(!e)throw"Can not find container in document with id "+i}return this._setAttr("container",e),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),e.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var i,e=this.children,t=e.length;for(i=0;i<t;i++)e[i].clear();return this}clone(e){return e||(e={}),e.container=typeof document<"u"&&document.createElement("div"),Di.prototype.clone.call(this,e)}destroy(){super.destroy();var e=this.content;e&&G._isInDocument(e)&&this.container().removeChild(e);var t=xf.indexOf(this);return t>-1&&xf.splice(t,1),G.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const e=this._pointerPositions[0]||this._changedPointerPositions[0];return e?{x:e.x,y:e.y}:(G.warn("Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);"),null)}_getPointerById(e){return this._pointerPositions.find(t=>t.id===e)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(e){(e=e||{}).x=e.x||0,e.y=e.y||0,e.width=e.width||this.width(),e.height=e.height||this.height();var t=new Xa({width:e.width,height:e.height,pixelRatio:e.pixelRatio||1}),i=t.getContext()._context,r=this.children;return(e.x||e.y)&&i.translate(-1*e.x,-1*e.y),r.forEach(function(s){if(s.isVisible()){var o=s._toKonvaCanvas(e);i.drawImage(o._canvas,e.x,e.y,o.getWidth()/o.getPixelRatio(),o.getHeight()/o.getPixelRatio())}}),t}getIntersection(e){if(!e)return null;var s,t=this.children;for(s=t.length-1;s>=0;s--){const o=t[s].getIntersection(e);if(o)return o}return null}_resizeDOM(){var e=this.width(),t=this.height();this.content&&(this.content.style.width=e+"px",this.content.style.height=t+"px"),this.bufferCanvas.setSize(e,t),this.bufferHitCanvas.setSize(e,t),this.children.forEach(i=>{i.setSize({width:e,height:t}),i.draw()})}add(e,...t){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}super.add(e);var r=this.children.length;return r>5&&G.warn("The stage has "+r+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),e.setSize({width:this.width(),height:this.height()}),e.draw(),Re.isBrowser&&this.content.appendChild(e.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(e){return kM(e,this)}setPointerCapture(e){LM(e,this)}releaseCapture(e){Ql(e)}getLayers(){return this.children}_bindContentEvents(){Re.isBrowser&&lW.forEach(([e,t])=>{this.content.addEventListener(e,i=>{this[t](i)},{passive:!1})})}_pointerenter(e){this.setPointersPositions(e);const t=Qa(e.type);this._fire(t.pointerenter,{evt:e,target:this,currentTarget:this})}_pointerover(e){this.setPointersPositions(e);const t=Qa(e.type);this._fire(t.pointerover,{evt:e,target:this,currentTarget:this})}_getTargetShape(e){let t=this[e+"targetShape"];return t&&!t.getStage()&&(t=null),t}_pointerleave(e){const t=Qa(e.type),i=nu(e.type);if(t){this.setPointersPositions(e);var r=this._getTargetShape(i),s=!_t.isDragging||Re.hitOnDragEnabled;r&&s?(r._fireAndBubble(t.pointerout,{evt:e}),r._fireAndBubble(t.pointerleave,{evt:e}),this._fire(t.pointerleave,{evt:e,target:this,currentTarget:this}),this[i+"targetShape"]=null):s&&(this._fire(t.pointerleave,{evt:e,target:this,currentTarget:this}),this._fire(t.pointerout,{evt:e,target:this,currentTarget:this})),this.pointerPos=void 0,this._pointerPositions=[]}}_pointerdown(e){const t=Qa(e.type),i=nu(e.type);if(t){this.setPointersPositions(e);var r=!1;this._changedPointerPositions.forEach(s=>{var o=this.getIntersection(s);if(_t.justDragged=!1,Re["_"+i+"ListenClick"]=!0,!o||!o.isListening())return;Re.capturePointerEventsEnabled&&o.setPointerCapture(s.id),this[i+"ClickStartShape"]=o,o._fireAndBubble(t.pointerdown,{evt:e,pointerId:s.id}),r=!0;const c=e.type.indexOf("touch")>=0;o.preventDefault()&&e.cancelable&&c&&e.preventDefault()}),r||this._fire(t.pointerdown,{evt:e,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(e){const t=Qa(e.type),i=nu(e.type);if(!t)return;if(_t.isDragging&&_t.node.preventDefault()&&e.cancelable&&e.preventDefault(),this.setPointersPositions(e),_t.isDragging&&!Re.hitOnDragEnabled)return;var s={};let o=!1;var a=this._getTargetShape(i);this._changedPointerPositions.forEach(c=>{const l=_v(c.id)||this.getIntersection(c),u=c.id,h={evt:e,pointerId:u};var d=a!==l;if(d&&a&&(a._fireAndBubble(t.pointerout,Object.assign({},h),l),a._fireAndBubble(t.pointerleave,Object.assign({},h),l)),l){if(s[l._id])return;s[l._id]=!0}l&&l.isListening()?(o=!0,d&&(l._fireAndBubble(t.pointerover,Object.assign({},h),a),l._fireAndBubble(t.pointerenter,Object.assign({},h),a),this[i+"targetShape"]=l),l._fireAndBubble(t.pointermove,Object.assign({},h))):a&&(this._fire(t.pointerover,{evt:e,target:this,currentTarget:this,pointerId:u}),this[i+"targetShape"]=null)}),o||this._fire(t.pointermove,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(e){const t=Qa(e.type),i=nu(e.type);if(!t)return;this.setPointersPositions(e);const r=this[i+"ClickStartShape"],s=this[i+"ClickEndShape"];var o={};let a=!1;this._changedPointerPositions.forEach(c=>{const l=_v(c.id)||this.getIntersection(c);if(l){if(l.releaseCapture(c.id),o[l._id])return;o[l._id]=!0}const u=c.id,h={evt:e,pointerId:u};let d=!1;Re["_"+i+"InDblClickWindow"]?(d=!0,clearTimeout(this[i+"DblTimeout"])):_t.justDragged||(Re["_"+i+"InDblClickWindow"]=!0,clearTimeout(this[i+"DblTimeout"])),this[i+"DblTimeout"]=setTimeout(function(){Re["_"+i+"InDblClickWindow"]=!1},Re.dblClickWindow),l&&l.isListening()?(a=!0,this[i+"ClickEndShape"]=l,l._fireAndBubble(t.pointerup,Object.assign({},h)),Re["_"+i+"ListenClick"]&&r&&r===l&&(l._fireAndBubble(t.pointerclick,Object.assign({},h)),d&&s&&s===l&&l._fireAndBubble(t.pointerdblclick,Object.assign({},h)))):(this[i+"ClickEndShape"]=null,Re["_"+i+"ListenClick"]&&this._fire(t.pointerclick,{evt:e,target:this,currentTarget:this,pointerId:u}),d&&this._fire(t.pointerdblclick,{evt:e,target:this,currentTarget:this,pointerId:u}))}),a||this._fire(t.pointerup,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),Re["_"+i+"ListenClick"]=!1,e.cancelable&&"touch"!==i&&e.preventDefault()}_contextmenu(e){this.setPointersPositions(e);var t=this.getIntersection(this.getPointerPosition());t&&t.isListening()?t._fireAndBubble(yv,{evt:e}):this._fire(yv,{evt:e,target:this,currentTarget:this})}_wheel(e){this.setPointersPositions(e);var t=this.getIntersection(this.getPointerPosition());t&&t.isListening()?t._fireAndBubble(vv,{evt:e}):this._fire(vv,{evt:e,target:this,currentTarget:this})}_pointercancel(e){this.setPointersPositions(e);const t=_v(e.pointerId)||this.getIntersection(this.getPointerPosition());t&&t._fireAndBubble(Za,mv(e)),Ql(e.pointerId)}_lostpointercapture(e){Ql(e.pointerId)}setPointersPositions(e){var t=this._getContentPosition(),i=null,r=null;void 0!==(e=e||window.event).touches?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(e.touches,s=>{this._pointerPositions.push({id:s.identifier,x:(s.clientX-t.left)/t.scaleX,y:(s.clientY-t.top)/t.scaleY})}),Array.prototype.forEach.call(e.changedTouches||e.touches,s=>{this._changedPointerPositions.push({id:s.identifier,x:(s.clientX-t.left)/t.scaleX,y:(s.clientY-t.top)/t.scaleY})})):(this.pointerPos={x:i=(e.clientX-t.left)/t.scaleX,y:r=(e.clientY-t.top)/t.scaleY},this._pointerPositions=[{x:i,y:r,id:G._getFirstPointerId(e)}],this._changedPointerPositions=[{x:i,y:r,id:G._getFirstPointerId(e)}])}_setPointerPosition(e){G.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(e)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var e=this.content.getBoundingClientRect();return{top:e.top,left:e.left,scaleX:e.width/this.content.clientWidth||1,scaleY:e.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new Xa({width:this.width(),height:this.height()}),this.bufferHitCanvas=new fv({pixelRatio:1,width:this.width(),height:this.height()}),Re.isBrowser){var e=this.container();if(!e)throw"Stage has no container. A container is required.";e.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),e.appendChild(this.content),this._resizeDOM()}}cache(){return G.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(e){e.batchDraw()}),this}}iu.prototype.nodeType="Stage",Jt(iu),R.addGetterSetter(iu,"container");var YM="hasShadow",XM="shadowRGBA",ZM="patternImage",QM="linearGradient",JM="radialGradient";let Pf;function Ev(){return Pf||(Pf=G.createCanvasElement().getContext("2d"),Pf)}const ru={};class de extends me{constructor(e){let t;for(super(e);t=G.getRandomColor(),!t||t in ru;);this.colorKey=t,ru[t]=this}getContext(){return G.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return G.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(YM,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&0!==this.shadowOpacity()&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(ZM,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const t=Ev().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(t&&t.setTransform){const i=new Ci;i.translate(this.fillPatternX(),this.fillPatternY()),i.rotate(Re.getAngle(this.fillPatternRotation())),i.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),i.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const r=i.getMatrix(),s=typeof DOMMatrix>"u"?{a:r[0],b:r[1],c:r[2],d:r[3],e:r[4],f:r[5]}:new DOMMatrix(r);t.setTransform(s)}return t}}_getLinearGradient(){return this._getCache(QM,this.__getLinearGradient)}__getLinearGradient(){var e=this.fillLinearGradientColorStops();if(e){for(var t=Ev(),i=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),s=t.createLinearGradient(i.x,i.y,r.x,r.y),o=0;o<e.length;o+=2)s.addColorStop(e[o],e[o+1]);return s}}_getRadialGradient(){return this._getCache(JM,this.__getRadialGradient)}__getRadialGradient(){var e=this.fillRadialGradientColorStops();if(e){for(var t=Ev(),i=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),s=t.createRadialGradient(i.x,i.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius()),o=0;o<e.length;o+=2)s.addColorStop(e[o],e[o+1]);return s}}getShadowRGBA(){return this._getCache(XM,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var e=G.colorToRGBA(this.shadowColor());if(e)return"rgba("+e.r+","+e.g+","+e.b+","+e.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!(!this.stroke()&&!this.strokeLinearGradientColorStops()))}hasHitStroke(){const e=this.hitStrokeWidth();return"auto"===e?this.hasStroke():this.strokeEnabled()&&!!e}intersects(e){var i=this.getStage().bufferHitCanvas;return i.getContext().clear(),this.drawHit(i,null,!0),i.context.getImageData(Math.round(e.x),Math.round(e.y),1,1).data[3]>0}destroy(){return me.prototype.destroy.call(this),delete ru[this.colorKey],delete this.colorKey,this}_useBufferCanvas(e){var t;if(!this.getStage()||null!==(t=this.attrs.perfectDrawEnabled)&&void 0!==t&&!t)return!1;const r=e||this.hasFill(),s=this.hasStroke(),o=1!==this.getAbsoluteOpacity();if(r&&s&&o)return!0;const a=this.hasShadow(),c=this.shadowForStrokeEnabled();return!!(r&&s&&a&&c)}setStrokeHitEnabled(e){G.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),this.hitStrokeWidth(e?"auto":0)}getStrokeHitEnabled(){return 0!==this.hitStrokeWidth()}getSelfRect(){var e=this.size();return{x:this._centroid?-e.width/2:0,y:this._centroid?-e.height/2:0,width:e.width,height:e.height}}getClientRect(e={}){const t=e.skipTransform,i=e.relativeTo,r=this.getSelfRect(),o=!e.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,a=r.width+o,c=r.height+o,l=!e.skipShadow&&this.hasShadow(),u=l?this.shadowOffsetX():0,h=l?this.shadowOffsetY():0,d=a+Math.abs(u),p=c+Math.abs(h),f=l&&this.shadowBlur()||0,C={width:d+2*f,height:p+2*f,x:-(o/2+f)+Math.min(u,0)+r.x,y:-(o/2+f)+Math.min(h,0)+r.y};return t?C:this._transformedRect(C,i)}drawScene(e,t){var u,h,i=this.getLayer(),r=e||i.getCanvas(),s=r.getContext(),o=this._getCanvasCache(),a=this.getSceneFunc(),c=this.hasShadow(),d=r.isCache,p=t===this;if(!this.isVisible()&&!p)return this;if(o){s.save();var f=this.getAbsoluteTransform(t).getMatrix();return s.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedSceneCanvas(s),s.restore(),this}if(!a)return this;if(s.save(),this._useBufferCanvas()&&!d){(h=(u=this.getStage().bufferCanvas).getContext()).clear(),h.save(),h._applyLineJoin(this);var m=this.getAbsoluteTransform(t).getMatrix();h.transform(m[0],m[1],m[2],m[3],m[4],m[5]),a.call(this,h,this),h.restore();var v=u.pixelRatio;c&&s._applyShadow(this),s._applyOpacity(this),s._applyGlobalCompositeOperation(this),s.drawImage(u._canvas,0,0,u.width/v,u.height/v)}else s._applyLineJoin(this),p||(m=this.getAbsoluteTransform(t).getMatrix(),s.transform(m[0],m[1],m[2],m[3],m[4],m[5]),s._applyOpacity(this),s._applyGlobalCompositeOperation(this)),c&&s._applyShadow(this),a.call(this,s,this);return s.restore(),this}drawHit(e,t,i=!1){if(!this.shouldDrawHit(t,i))return this;var r=this.getLayer(),s=e||r.hitCanvas,o=s&&s.getContext(),a=this.hitFunc()||this.sceneFunc(),c=this._getCanvasCache(),l=c&&c.hit;if(this.colorKey||G.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),l){o.save();var u=this.getAbsoluteTransform(t).getMatrix();return o.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(o),o.restore(),this}if(!a)return this;if(o.save(),o._applyLineJoin(this),this!==t){var d=this.getAbsoluteTransform(t).getMatrix();o.transform(d[0],d[1],d[2],d[3],d[4],d[5])}return a.call(this,o,this),o.restore(),this}drawHitFromCache(e=0){var c,l,u,h,d,t=this._getCanvasCache(),i=this._getCachedSceneCanvas(),r=t.hit,s=r.getContext(),o=r.getWidth(),a=r.getHeight();s.clear(),s.drawImage(i._canvas,0,0,o,a);try{for(u=(l=(c=s.getImageData(0,0,o,a)).data).length,h=G._hexToRgb(this.colorKey),d=0;d<u;d+=4)l[d+3]>e?(l[d]=h.r,l[d+1]=h.g,l[d+2]=h.b,l[d+3]=255):l[d+3]=0;s.putImageData(c,0,0)}catch(f){G.error("Unable to draw hit graph from cached scene canvas. "+f.message)}return this}hasPointerCapture(e){return kM(e,this)}setPointerCapture(e){LM(e,this)}releaseCapture(e){Ql(e)}}de.prototype._fillFunc=function hW(n){n.fill()},de.prototype._strokeFunc=function dW(n){n.stroke()},de.prototype._fillFuncHit=function fW(n){n.fill()},de.prototype._strokeFuncHit=function pW(n){n.stroke()},de.prototype._centroid=!1,de.prototype.nodeType="Shape",Jt(de),de.prototype.eventListeners={},de.prototype.on.call(de.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",function gW(){this._clearCache(YM)}),de.prototype.on.call(de.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",function _W(){this._clearCache(XM)}),de.prototype.on.call(de.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",function mW(){this._clearCache(ZM)}),de.prototype.on.call(de.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",function yW(){this._clearCache(QM)}),de.prototype.on.call(de.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",function vW(){this._clearCache(JM)}),R.addGetterSetter(de,"stroke",void 0,DM()),R.addGetterSetter(de,"strokeWidth",2,_e()),R.addGetterSetter(de,"fillAfterStrokeEnabled",!1),R.addGetterSetter(de,"hitStrokeWidth","auto",dv()),R.addGetterSetter(de,"strokeHitEnabled",!0,or()),R.addGetterSetter(de,"perfectDrawEnabled",!0,or()),R.addGetterSetter(de,"shadowForStrokeEnabled",!0,or()),R.addGetterSetter(de,"lineJoin"),R.addGetterSetter(de,"lineCap"),R.addGetterSetter(de,"sceneFunc"),R.addGetterSetter(de,"hitFunc"),R.addGetterSetter(de,"dash"),R.addGetterSetter(de,"dashOffset",0,_e()),R.addGetterSetter(de,"shadowColor",void 0,Ya()),R.addGetterSetter(de,"shadowBlur",0,_e()),R.addGetterSetter(de,"shadowOpacity",1,_e()),R.addComponentsGetterSetter(de,"shadowOffset",["x","y"]),R.addGetterSetter(de,"shadowOffsetX",0,_e()),R.addGetterSetter(de,"shadowOffsetY",0,_e()),R.addGetterSetter(de,"fillPatternImage"),R.addGetterSetter(de,"fill",void 0,DM()),R.addGetterSetter(de,"fillPatternX",0,_e()),R.addGetterSetter(de,"fillPatternY",0,_e()),R.addGetterSetter(de,"fillLinearGradientColorStops"),R.addGetterSetter(de,"strokeLinearGradientColorStops"),R.addGetterSetter(de,"fillRadialGradientStartRadius",0),R.addGetterSetter(de,"fillRadialGradientEndRadius",0),R.addGetterSetter(de,"fillRadialGradientColorStops"),R.addGetterSetter(de,"fillPatternRepeat","repeat"),R.addGetterSetter(de,"fillEnabled",!0),R.addGetterSetter(de,"strokeEnabled",!0),R.addGetterSetter(de,"shadowEnabled",!0),R.addGetterSetter(de,"dashEnabled",!0),R.addGetterSetter(de,"strokeScaleEnabled",!0),R.addGetterSetter(de,"fillPriority","color"),R.addComponentsGetterSetter(de,"fillPatternOffset",["x","y"]),R.addGetterSetter(de,"fillPatternOffsetX",0,_e()),R.addGetterSetter(de,"fillPatternOffsetY",0,_e()),R.addComponentsGetterSetter(de,"fillPatternScale",["x","y"]),R.addGetterSetter(de,"fillPatternScaleX",1,_e()),R.addGetterSetter(de,"fillPatternScaleY",1,_e()),R.addComponentsGetterSetter(de,"fillLinearGradientStartPoint",["x","y"]),R.addComponentsGetterSetter(de,"strokeLinearGradientStartPoint",["x","y"]),R.addGetterSetter(de,"fillLinearGradientStartPointX",0),R.addGetterSetter(de,"strokeLinearGradientStartPointX",0),R.addGetterSetter(de,"fillLinearGradientStartPointY",0),R.addGetterSetter(de,"strokeLinearGradientStartPointY",0),R.addComponentsGetterSetter(de,"fillLinearGradientEndPoint",["x","y"]),R.addComponentsGetterSetter(de,"strokeLinearGradientEndPoint",["x","y"]),R.addGetterSetter(de,"fillLinearGradientEndPointX",0),R.addGetterSetter(de,"strokeLinearGradientEndPointX",0),R.addGetterSetter(de,"fillLinearGradientEndPointY",0),R.addGetterSetter(de,"strokeLinearGradientEndPointY",0),R.addComponentsGetterSetter(de,"fillRadialGradientStartPoint",["x","y"]),R.addGetterSetter(de,"fillRadialGradientStartPointX",0),R.addGetterSetter(de,"fillRadialGradientStartPointY",0),R.addComponentsGetterSetter(de,"fillRadialGradientEndPoint",["x","y"]),R.addGetterSetter(de,"fillRadialGradientEndPointX",0),R.addGetterSetter(de,"fillRadialGradientEndPointY",0),R.addGetterSetter(de,"fillPatternRotation",0),R.backCompat(de,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});var ex=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],SW=ex.length;class Os extends Di{constructor(e){super(e),this.canvas=new Xa,this.hitCanvas=new fv({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);var t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),e<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[e+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){me.prototype.moveToTop.call(this);var e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!me.prototype.moveUp.call(this))return!1;var t=this.getStage();return!(!t||!t.content||(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),0))}moveDown(){if(me.prototype.moveDown.call(this)){var e=this.getStage();if(e){var t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(me.prototype.moveToBottom.call(this)){var e=this.getStage();if(e){var t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var e=this.getNativeCanvasElement();return me.prototype.remove.call(this),e&&e.parentNode&&G._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:t}){return this.canvas.setSize(e,t),this.hitCanvas.setSize(e,t),this._setSmoothEnabled(),this}_validateAdd(e){var t=e.getType();"Group"!==t&&"Shape"!==t&&G.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return(e=e||{}).width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=void 0!==e.x?e.x:this.x(),e.y=void 0!==e.y?e.y:this.y(),me.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.canvas._canvas.style.display=this.visible()?"block":"none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){G.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){G.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,G.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;for(var t=1,i=!1;;){for(let r=0;r<SW;r++){const s=ex[r],o=this._getIntersection({x:e.x+s.x*t,y:e.y+s.y*t}),a=o.shape;if(a)return a;if(i=!!o.antialiased,!o.antialiased)break}if(!i)return null;t+=1}}_getIntersection(e){const t=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(e.x*t),Math.round(e.y*t),1,1).data,r=i[3];if(255===r){const s=G._rgbToHex(i[0],i[1],i[2]),o=ru["#"+s];return o?{shape:o}:{antialiased:!0}}return r>0?{antialiased:!0}:{}}drawScene(e,t){var i=this.getLayer(),r=e||i&&i.getCanvas();return this._fire("beforeDraw",{node:this}),this.clearBeforeDraw()&&r.getContext().clear(),Di.prototype.drawScene.call(this,r,t),this._fire("draw",{node:this}),this}drawHit(e,t){var i=this.getLayer(),r=e||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),Di.prototype.drawHit.call(this,r,t),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){G.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return G.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(this.parent&&this.parent.content){var e=this.parent;this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}}destroy(){return G.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}Os.prototype.nodeType="Layer",Jt(Os),R.addGetterSetter(Os,"imageSmoothingEnabled",!0),R.addGetterSetter(Os,"clearBeforeDraw",!0),R.addGetterSetter(Os,"hitGraphEnabled",!0,or());class rs extends Di{_validateAdd(e){var t=e.getType();"Group"!==t&&"Shape"!==t&&G.throw("You may only add groups and shapes to groups.")}}function bv(n,e,t,i,r,s,o){var a=Math.sqrt(Math.pow(t-n,2)+Math.pow(i-e,2)),c=Math.sqrt(Math.pow(r-t,2)+Math.pow(s-i,2)),l=o*a/(a+c),u=o*c/(a+c);return[t-l*(r-n),i-l*(s-e),t+u*(r-n),i+u*(s-e)]}function tx(n,e){var r,s,t=n.length,i=[];for(r=2;r<t-2;r+=2)s=bv(n[r-2],n[r-1],n[r],n[r+1],n[r+2],n[r+3],e),!isNaN(s[0])&&(i.push(s[0]),i.push(s[1]),i.push(n[r]),i.push(n[r+1]),i.push(s[2]),i.push(s[3]));return i}rs.prototype.nodeType="Group",Jt(rs);class An extends de{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){var a,c,l,t=this.points(),i=t.length,r=this.tension(),s=this.closed(),o=this.bezier();if(i){if(e.beginPath(),e.moveTo(t[0],t[1]),0!==r&&i>4){for(c=(a=this.getTensionPoints()).length,l=s?0:4,s||e.quadraticCurveTo(a[0],a[1],a[2],a[3]);l<c-2;)e.bezierCurveTo(a[l++],a[l++],a[l++],a[l++],a[l++],a[l++]);s||e.quadraticCurveTo(a[c-2],a[c-1],t[i-2],t[i-1])}else if(o)for(l=2;l<i;)e.bezierCurveTo(t[l++],t[l++],t[l++],t[l++],t[l++],t[l++]);else for(l=2;l<i;l+=2)e.lineTo(t[l],t[l+1]);s?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():tx(this.points(),this.tension())}_getTensionPointsClosed(){var e=this.points(),t=e.length,i=this.tension(),r=bv(e[t-2],e[t-1],e[0],e[1],e[2],e[3],i),s=bv(e[t-4],e[t-3],e[t-2],e[t-1],e[0],e[1],i),o=tx(e,i);return[r[2],r[3]].concat(o).concat([s[0],s[1],e[t-2],e[t-1],s[2],s[3],r[0],r[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};for(var o,a,t=(e=0!==this.tension()?[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:this.points())[0],i=e[0],r=e[1],s=e[1],c=0;c<e.length/2;c++)o=e[2*c],a=e[2*c+1],t=Math.min(t,o),i=Math.max(i,o),r=Math.min(r,a),s=Math.max(s,a);return{x:t,y:r,width:i-t,height:s-r}}}An.prototype.className="Line",An.prototype._attrsAffectingSize=["points","bezier","tension"],Jt(An),R.addGetterSetter(An,"closed",!1),R.addGetterSetter(An,"bezier",!1),R.addGetterSetter(An,"tension",0,_e()),R.addGetterSetter(An,"points",[],function F4(){if(Re.isUnminified)return function(n,e){const t=Int8Array?Object.getPrototypeOf(Int8Array):null;return t&&n instanceof t||(G._isArray(n)?n.forEach(function(i){G._isNumber(i)||G.warn('"'+e+'" attribute has non numeric element '+i+". Make sure that all elements are numbers.")}):G.warn(ns(n)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),n}}());class Rt extends de{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this.dataArray=Rt.parsePathData(this.data()),this.pathLength=0;for(var t=0;t<this.dataArray.length;++t)this.pathLength+=this.dataArray[t].pathLength;this.on("dataChange.konva",function(){this.dataArray=Rt.parsePathData(this.data()),this.pathLength=0;for(var i=0;i<this.dataArray.length;++i)this.pathLength+=this.dataArray[i].pathLength})}_sceneFunc(e){var t=this.dataArray;e.beginPath();for(var i=!1,r=0;r<t.length;r++){var o=t[r].points;switch(t[r].command){case"L":e.lineTo(o[0],o[1]);break;case"M":e.moveTo(o[0],o[1]);break;case"C":e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"Q":e.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case"A":var a=o[0],c=o[1],l=o[2],u=o[3],h=o[4],d=o[5],p=o[6],f=o[7],m=l>u?l:u,v=l>u?1:l/u,C=l>u?u/l:1;e.translate(a,c),e.rotate(p),e.scale(v,C),e.arc(0,0,m,h,h+d,1-f),e.scale(1/v,1/C),e.rotate(-p),e.translate(-a,-c);break;case"z":i=!0,e.closePath()}}i||this.hasFill()?e.fillStrokeShape(this):e.strokeShape(this)}getSelfRect(){var e=[];this.dataArray.forEach(function(l){if("A"===l.command){var u=l.points[4],h=l.points[5],d=l.points[4]+h,p=Math.PI/180;if(Math.abs(u-d)<p&&(p=Math.abs(u-d)),h<0)for(let f=u-p;f>d;f-=p){const m=Rt.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],f,0);e.push(m.x,m.y)}else for(let f=u+p;f<d;f+=p){const m=Rt.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],f,0);e.push(m.x,m.y)}}else if("C"===l.command)for(let f=0;f<=1;f+=.01){const m=Rt.getPointOnCubicBezier(f,l.start.x,l.start.y,l.points[0],l.points[1],l.points[2],l.points[3],l.points[4],l.points[5]);e.push(m.x,m.y)}else e=e.concat(l.points)});for(var o,a,t=e[0],i=e[0],r=e[1],s=e[1],c=0;c<e.length/2;c++)o=e[2*c],a=e[2*c+1],isNaN(o)||(t=Math.min(t,o),i=Math.max(i,o)),isNaN(a)||(r=Math.min(r,a),s=Math.max(s,a));return{x:t,y:r,width:i-t,height:s-r}}getLength(){return this.pathLength}getPointAtLength(e){var t,i=0,r=this.dataArray.length;if(!r)return null;for(;i<r&&e>this.dataArray[i].pathLength;)e-=this.dataArray[i].pathLength,++i;if(i===r)return{x:(t=this.dataArray[i-1].points.slice(-2))[0],y:t[1]};if(e<.01)return{x:(t=this.dataArray[i].points.slice(0,2))[0],y:t[1]};var s=this.dataArray[i],o=s.points;switch(s.command){case"L":return Rt.getPointOnLine(e,s.start.x,s.start.y,o[0],o[1]);case"C":return Rt.getPointOnCubicBezier(e/s.pathLength,s.start.x,s.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return Rt.getPointOnQuadraticBezier(e/s.pathLength,s.start.x,s.start.y,o[0],o[1],o[2],o[3]);case"A":var h=o[4];return Rt.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],h+=o[5]*e/s.pathLength,o[6])}return null}static getLineLength(e,t,i,r){return Math.sqrt((i-e)*(i-e)+(r-t)*(r-t))}static getPointOnLine(e,t,i,r,s,o,a){void 0===o&&(o=t),void 0===a&&(a=i);var c=(s-i)/(r-t+1e-8),l=Math.sqrt(e*e/(1+c*c));r<t&&(l*=-1);var h,u=c*l;if(r===t)h={x:o,y:a+u};else if((a-i)/(o-t+1e-8)===c)h={x:o+l,y:a+u};else{var d,p,f=this.getLineLength(t,i,r,s),m=(o-t)*(r-t)+(a-i)*(s-i),v=this.getLineLength(o,a,d=t+(m/=f*f)*(r-t),p=i+m*(s-i)),C=Math.sqrt(e*e-v*v);l=Math.sqrt(C*C/(1+c*c)),r<t&&(l*=-1),h={x:d+l,y:p+(u=c*l)}}return h}static getPointOnCubicBezier(e,t,i,r,s,o,a,c,l){function u(v){return v*v*v}function h(v){return 3*v*v*(1-v)}function d(v){return 3*v*(1-v)*(1-v)}function p(v){return(1-v)*(1-v)*(1-v)}return{x:c*u(e)+o*h(e)+r*d(e)+t*p(e),y:l*u(e)+a*h(e)+s*d(e)+i*p(e)}}static getPointOnQuadraticBezier(e,t,i,r,s,o,a){function c(p){return p*p}function l(p){return 2*p*(1-p)}function u(p){return(1-p)*(1-p)}return{x:o*c(e)+r*l(e)+t*u(e),y:a*c(e)+s*l(e)+i*u(e)}}static getPointOnEllipticalArc(e,t,i,r,s,o){var a=Math.cos(o),c=Math.sin(o),l_x=i*Math.cos(s),l_y=r*Math.sin(s);return{x:e+(l_x*a-l_y*c),y:t+(l_x*c+l_y*a)}}static parsePathData(e){if(!e)return[];var t=e,i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(var r=0;r<i.length;r++)t=t.replace(new RegExp(i[r],"g"),"|"+i[r]);var h,s=t.split("|"),o=[],a=[],c=0,l=0,u=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;for(r=1;r<s.length;r++){var d=s[r],p=d.charAt(0);for(d=d.slice(1),a.length=0;h=u.exec(d);)a.push(h[0]);for(var f=[],m=0,v=a.length;m<v;m++)if("00"!==a[m]){var C=parseFloat(a[m]);isNaN(C)?f.push(0):f.push(C)}else f.push(0,0);for(;f.length>0&&!isNaN(f[0]);){var se,ce,pe,De,Me,Ve,Ke,ze,ht,pt,I=null,L=[],H=c,ne=l;switch(p){case"l":c+=f.shift(),l+=f.shift(),I="L",L.push(c,l);break;case"L":c=f.shift(),l=f.shift(),L.push(c,l);break;case"m":var ue=f.shift(),Ee=f.shift();if(c+=ue,l+=Ee,I="M",o.length>2&&"z"===o[o.length-1].command)for(var Ae=o.length-2;Ae>=0;Ae--)if("M"===o[Ae].command){c=o[Ae].points[0]+ue,l=o[Ae].points[1]+Ee;break}L.push(c,l),p="l";break;case"M":c=f.shift(),l=f.shift(),I="M",L.push(c,l),p="L";break;case"h":c+=f.shift(),I="L",L.push(c,l);break;case"H":c=f.shift(),I="L",L.push(c,l);break;case"v":l+=f.shift(),I="L",L.push(c,l);break;case"V":l=f.shift(),I="L",L.push(c,l);break;case"C":L.push(f.shift(),f.shift(),f.shift(),f.shift()),c=f.shift(),l=f.shift(),L.push(c,l);break;case"c":L.push(c+f.shift(),l+f.shift(),c+f.shift(),l+f.shift()),c+=f.shift(),l+=f.shift(),I="C",L.push(c,l);break;case"S":ce=c,pe=l,"C"===(se=o[o.length-1]).command&&(ce=c+(c-se.points[2]),pe=l+(l-se.points[3])),L.push(ce,pe,f.shift(),f.shift()),c=f.shift(),l=f.shift(),I="C",L.push(c,l);break;case"s":ce=c,pe=l,"C"===(se=o[o.length-1]).command&&(ce=c+(c-se.points[2]),pe=l+(l-se.points[3])),L.push(ce,pe,c+f.shift(),l+f.shift()),c+=f.shift(),l+=f.shift(),I="C",L.push(c,l);break;case"Q":L.push(f.shift(),f.shift()),c=f.shift(),l=f.shift(),L.push(c,l);break;case"q":L.push(c+f.shift(),l+f.shift()),c+=f.shift(),l+=f.shift(),I="Q",L.push(c,l);break;case"T":ce=c,pe=l,"Q"===(se=o[o.length-1]).command&&(ce=c+(c-se.points[0]),pe=l+(l-se.points[1])),c=f.shift(),l=f.shift(),I="Q",L.push(ce,pe,c,l);break;case"t":ce=c,pe=l,"Q"===(se=o[o.length-1]).command&&(ce=c+(c-se.points[0]),pe=l+(l-se.points[1])),c+=f.shift(),l+=f.shift(),I="Q",L.push(ce,pe,c,l);break;case"A":De=f.shift(),Me=f.shift(),Ve=f.shift(),Ke=f.shift(),ze=f.shift(),ht=c,pt=l,c=f.shift(),l=f.shift(),I="A",L=this.convertEndpointToCenterParameterization(ht,pt,c,l,Ke,ze,De,Me,Ve);break;case"a":De=f.shift(),Me=f.shift(),Ve=f.shift(),Ke=f.shift(),ze=f.shift(),ht=c,pt=l,c+=f.shift(),l+=f.shift(),I="A",L=this.convertEndpointToCenterParameterization(ht,pt,c,l,Ke,ze,De,Me,Ve)}o.push({command:I||p,points:L,start:{x:H,y:ne},pathLength:this.calcLength(H,ne,I||p,L)})}("z"===p||"Z"===p)&&o.push({command:"z",points:[],start:void 0,pathLength:0})}return o}static calcLength(e,t,i,r){var s,o,a,c,l=Rt;switch(i){case"L":return l.getLineLength(e,t,r[0],r[1]);case"C":for(s=0,o=l.getPointOnCubicBezier(0,e,t,r[0],r[1],r[2],r[3],r[4],r[5]),c=.01;c<=1;c+=.01)a=l.getPointOnCubicBezier(c,e,t,r[0],r[1],r[2],r[3],r[4],r[5]),s+=l.getLineLength(o.x,o.y,a.x,a.y),o=a;return s;case"Q":for(s=0,o=l.getPointOnQuadraticBezier(0,e,t,r[0],r[1],r[2],r[3]),c=.01;c<=1;c+=.01)a=l.getPointOnQuadraticBezier(c,e,t,r[0],r[1],r[2],r[3]),s+=l.getLineLength(o.x,o.y,a.x,a.y),o=a;return s;case"A":s=0;var u=r[4],h=r[5],d=r[4]+h,p=Math.PI/180;if(Math.abs(u-d)<p&&(p=Math.abs(u-d)),o=l.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],u,0),h<0)for(c=u-p;c>d;c-=p)a=l.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],c,0),s+=l.getLineLength(o.x,o.y,a.x,a.y),o=a;else for(c=u+p;c<d;c+=p)a=l.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],c,0),s+=l.getLineLength(o.x,o.y,a.x,a.y),o=a;return a=l.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],d,0),s+l.getLineLength(o.x,o.y,a.x,a.y)}return 0}static convertEndpointToCenterParameterization(e,t,i,r,s,o,a,c,l){var u=l*(Math.PI/180),h=Math.cos(u)*(e-i)/2+Math.sin(u)*(t-r)/2,d=-1*Math.sin(u)*(e-i)/2+Math.cos(u)*(t-r)/2,p=h*h/(a*a)+d*d/(c*c);p>1&&(a*=Math.sqrt(p),c*=Math.sqrt(p));var f=Math.sqrt((a*a*(c*c)-a*a*(d*d)-c*c*(h*h))/(a*a*(d*d)+c*c*(h*h)));s===o&&(f*=-1),isNaN(f)&&(f=0);var m=f*a*d/c,v=f*-c*h/a,C=(e+i)/2+Math.cos(u)*m-Math.sin(u)*v,I=(t+r)/2+Math.sin(u)*m+Math.cos(u)*v,L=function(Me){return Math.sqrt(Me[0]*Me[0]+Me[1]*Me[1])},H=function(Me,Ve){return(Me[0]*Ve[0]+Me[1]*Ve[1])/(L(Me)*L(Ve))},ne=function(Me,Ve){return(Me[0]*Ve[1]<Me[1]*Ve[0]?-1:1)*Math.acos(H(Me,Ve))},se=ne([1,0],[(h-m)/a,(d-v)/c]),ce=[(h-m)/a,(d-v)/c],pe=[(-1*h-m)/a,(-1*d-v)/c],De=ne(ce,pe);return H(ce,pe)<=-1&&(De=Math.PI),H(ce,pe)>=1&&(De=0),0===o&&De>0&&(De-=2*Math.PI),1===o&&De<0&&(De+=2*Math.PI),[C,I,a,c,se,De,u,o]}}Rt.prototype.className="Path",Rt.prototype._attrsAffectingSize=["data"],Jt(Rt),R.addGetterSetter(Rt,"data");class Bi extends An{_sceneFunc(e){super._sceneFunc(e);var t=2*Math.PI,i=this.points(),r=i,s=0!==this.tension()&&i.length>4;s&&(r=this.getTensionPoints());var c,l,o=this.pointerLength(),a=i.length;if(s){const d=[r[r.length-4],r[r.length-3],r[r.length-2],r[r.length-1],i[a-2],i[a-1]],p=Rt.calcLength(r[r.length-4],r[r.length-3],"C",d),f=Rt.getPointOnQuadraticBezier(Math.min(1,1-o/p),d[0],d[1],d[2],d[3],d[4],d[5]);c=i[a-2]-f.x,l=i[a-1]-f.y}else c=i[a-2]-i[a-4],l=i[a-1]-i[a-3];var u=(Math.atan2(l,c)+t)%t,h=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(i[a-2],i[a-1]),e.rotate(u),e.moveTo(0,0),e.lineTo(-o,h/2),e.lineTo(-o,-h/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(i[0],i[1]),s?(c=(r[0]+r[2])/2-i[0],l=(r[1]+r[3])/2-i[1]):(c=i[2]-i[0],l=i[3]-i[1]),e.rotate((Math.atan2(-l,-c)+t)%t),e.moveTo(0,0),e.lineTo(-o,h/2),e.lineTo(-o,-h/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){var t=this.dashEnabled();t&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),t&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),t=this.pointerWidth()/2;return{x:e.x-t,y:e.y-t,width:e.width+2*t,height:e.height+2*t}}}Bi.prototype.className="Arrow",Jt(Bi),R.addGetterSetter(Bi,"pointerLength",10,_e()),R.addGetterSetter(Bi,"pointerWidth",10,_e()),R.addGetterSetter(Bi,"pointerAtBeginning",!1),R.addGetterSetter(Bi,"pointerAtEnding",!0);class xr extends de{_sceneFunc(e){var t=Re.getAngle(this.angle()),i=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,t,i),e.arc(0,0,this.innerRadius(),t,0,!i),e.closePath(),e.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),t=this.outerRadius(),i=this.clockwise(),r=Re.getAngle(i?360-this.angle():this.angle()),s=Math.cos(Math.min(r,Math.PI)),a=Math.sin(Math.min(Math.max(Math.PI,r),3*Math.PI/2)),c=Math.sin(Math.min(r,Math.PI/2)),l=s*(s>0?e:t),h=a*(a>0?e:t),d=c*(c>0?t:e);return{x:l,y:i?-1*d:h,width:1*t-l,height:d-h}}}xr.prototype._centroid=!0,xr.prototype.className="Arc",xr.prototype._attrsAffectingSize=["innerRadius","outerRadius"],Jt(xr),R.addGetterSetter(xr,"innerRadius",0,_e()),R.addGetterSetter(xr,"outerRadius",0,_e()),R.addGetterSetter(xr,"angle",0,_e()),R.addGetterSetter(xr,"clockwise",!1,or());class mo extends de{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,2*Math.PI,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}}mo.prototype._centroid=!0,mo.prototype.className="Circle",mo.prototype._attrsAffectingSize=["radius"],Jt(mo),R.addGetterSetter(mo,"radius",0,_e());class Ja extends de{_sceneFunc(e){var t=this.cornerRadius(),i=this.width(),r=this.height();e.beginPath(),t?G.drawRoundedRectPath(e,i,r,t):e.rect(0,0,i,r),e.closePath(),e.fillStrokeShape(this)}}Ja.prototype.className="Rect",Jt(Ja),R.addGetterSetter(Ja,"cornerRadius",0,hv(4));var nx=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],Cv="right",Dv="down",Tv="left",TW=nx.length;class ec extends rs{constructor(e){super(e),this.on("add.konva",function(t){this._addListeners(t.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){var i,t=this,r=function(){t._sync()};for(i=0;i<TW;i++)e.on(nx[i]+"Change.konva",r)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var i,r,s,o,a,c,l,e=this.getText(),t=this.getTag();if(e&&t){switch(i=e.width(),r=e.height(),s=t.pointerDirection(),o=t.pointerWidth(),l=t.pointerHeight(),a=0,c=0,s){case"up":a=i/2,c=-1*l;break;case Cv:a=i+o,c=r/2;break;case Dv:a=i/2,c=r+l;break;case Tv:a=-1*o,c=r/2}t.setAttrs({x:-1*a,y:-1*c,width:i,height:r}),e.setAttrs({x:-1*a,y:-1*c})}}}ec.prototype.className="Label",Jt(ec);class yo extends de{_sceneFunc(e){var t=this.width(),i=this.height(),r=this.pointerDirection(),s=this.pointerWidth(),o=this.pointerHeight(),a=this.cornerRadius();let c=0,l=0,u=0,h=0;"number"==typeof a?c=l=u=h=Math.min(a,t/2,i/2):(c=Math.min(a[0]||0,t/2,i/2),l=Math.min(a[1]||0,t/2,i/2),h=Math.min(a[2]||0,t/2,i/2),u=Math.min(a[3]||0,t/2,i/2)),e.beginPath(),e.moveTo(c,0),"up"===r&&(e.lineTo((t-s)/2,0),e.lineTo(t/2,-1*o),e.lineTo((t+s)/2,0)),e.lineTo(t-l,0),e.arc(t-l,l,l,3*Math.PI/2,0,!1),r===Cv&&(e.lineTo(t,(i-o)/2),e.lineTo(t+s,i/2),e.lineTo(t,(i+o)/2)),e.lineTo(t,i-h),e.arc(t-h,i-h,h,0,Math.PI/2,!1),r===Dv&&(e.lineTo((t+s)/2,i),e.lineTo(t/2,i+o),e.lineTo((t-s)/2,i)),e.lineTo(u,i),e.arc(u,i-u,u,Math.PI/2,Math.PI,!1),r===Tv&&(e.lineTo(0,(i+o)/2),e.lineTo(-1*s,i/2),e.lineTo(0,(i-o)/2)),e.lineTo(0,c),e.arc(c,c,c,Math.PI,3*Math.PI/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){var e=0,t=0,i=this.pointerWidth(),r=this.pointerHeight(),s=this.pointerDirection(),o=this.width(),a=this.height();return"up"===s?(t-=r,a+=r):s===Dv?a+=r:s===Tv?(e-=1.5*i,o+=i):s===Cv&&(o+=1.5*i),{x:e,y:t,width:o,height:a}}}function ix(n){return Array.from(n)}yo.prototype.className="Tag",Jt(yo),R.addGetterSetter(yo,"pointerDirection","none"),R.addGetterSetter(yo,"pointerWidth",0,_e()),R.addGetterSetter(yo,"pointerHeight",0,_e()),R.addGetterSetter(yo,"cornerRadius",0,hv(4));var Rf,tc="auto",su="justify",lx=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],BW=lx.length;function Av(){return Rf||(Rf=G.createCanvasElement().getContext("2d"))}class Mt extends de{constructor(e){super(function UW(n){return!(n=n||{}).fillLinearGradientColorStops&&!n.fillRadialGradientColorStops&&!n.fillPatternImage&&(n.fill=n.fill||"black"),n}(e)),this._partialTextX=0,this._partialTextY=0;for(var t=0;t<BW;t++)this.on(lx[t]+"Change.konva",this._setTextData);this._setTextData()}_sceneFunc(e){var t=this.textArr,i=t.length;if(this.text()){var v,r=this.padding(),s=this.fontSize(),o=this.lineHeight()*s,a=this.verticalAlign(),c=0,l=this.align(),u=this.getWidth(),h=this.letterSpacing(),d=this.fill(),p=this.textDecoration(),f=-1!==p.indexOf("underline"),m=-1!==p.indexOf("line-through"),C=0,I=(C=o/2,0),L=0;for(e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline","middle"),e.setAttr("textAlign","left"),"middle"===a?c=(this.getHeight()-i*o-2*r)/2:"bottom"===a&&(c=this.getHeight()-i*o-2*r),e.translate(r,c+r),v=0;v<i;v++){I=0,L=0;var pe,De,Me,H=t[v],ne=H.text,se=H.width,ce=H.lastInParagraph;if(e.save(),"right"===l?I+=u-se-2*r:"center"===l&&(I+=(u-se-2*r)/2),f){e.save(),e.beginPath(),e.moveTo(I,C+L+Math.round(s/2)),De=0==(pe=ne.split(" ").length-1),Me=l!==su||ce?se:u-2*r,e.lineTo(I+Math.round(Me),C+L+Math.round(s/2)),e.lineWidth=s/15;const ue=this._getLinearGradient();e.strokeStyle=ue||d,e.stroke(),e.restore()}if(m){e.save(),e.beginPath(),e.moveTo(I,C+L),De=0==(pe=ne.split(" ").length-1),Me=l===su&&ce&&!De?u-2*r:se,e.lineTo(I+Math.round(Me),C+L),e.lineWidth=s/15;const ue=this._getLinearGradient();e.strokeStyle=ue||d,e.stroke(),e.restore()}if(0!==h||l===su){pe=ne.split(" ").length-1;for(var Ve=ix(ne),Ke=0;Ke<Ve.length;Ke++){var ze=Ve[Ke];" "===ze&&!ce&&l===su&&(I+=(u-2*r-se)/pe),this._partialTextX=I,this._partialTextY=C+L,this._partialText=ze,e.fillStrokeShape(this),I+=this.measureSize(ze).width+h}}else this._partialTextX=I,this._partialTextY=C+L,this._partialText=ne,e.fillStrokeShape(this);e.restore(),i>1&&(C+=o)}}}_hitFunc(e){var t=this.getWidth(),i=this.getHeight();e.beginPath(),e.rect(0,0,t,i),e.closePath(),e.fillStrokeShape(this)}setText(e){var t=G._isString(e)?e:null==e?"":e+"";return this._setAttr("text",t),this}getWidth(){return this.attrs.width===tc||void 0===this.attrs.width?this.getTextWidth()+2*this.padding():this.attrs.width}getHeight(){return this.attrs.height===tc||void 0===this.attrs.height?this.fontSize()*this.textArr.length*this.lineHeight()+2*this.padding():this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return G.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var r,t=Av(),i=this.fontSize();return t.save(),t.font=this._getContextFont(),r=t.measureText(e),t.restore(),{width:r.width,height:i}}_getContextFont(){return this.fontStyle()+" "+this.fontVariant()+" "+this.fontSize()+"px "+function jW(n){return n.split(",").map(e=>{const t=(e=e.trim()).indexOf(" ")>=0,i=e.indexOf('"')>=0||e.indexOf("'")>=0;return t&&!i&&(e=`"${e}"`),e}).join(", ")}(this.fontFamily())}_addTextLine(e){this.align()===su&&(e=e.trim());var i=this._getTextWidth(e);return this.textArr.push({text:e,width:i,lastInParagraph:!1})}_getTextWidth(e){var t=this.letterSpacing(),i=e.length;return Av().measureText(e).width+(i?t*(i-1):0)}_setTextData(){var e=this.text().split("\n"),t=+this.fontSize(),i=0,r=this.lineHeight()*t,s=this.attrs.width,o=this.attrs.height,a=s!==tc&&void 0!==s,c=o!==tc&&void 0!==o,l=this.padding(),u=s-2*l,h=o-2*l,d=0,p=this.wrap(),m="char"!==p&&"none"!==p,v=this.ellipsis();this.textArr=[],Av().font=this._getContextFont();for(var C=v?this._getTextWidth("\u2026"):0,I=0,L=e.length;I<L;++I){var H=e[I],ne=this._getTextWidth(H);if(a&&ne>u)for(;H.length>0;){for(var se=0,ce=H.length,pe="",De=0;se<ce;){var Me=se+ce>>>1,Ve=H.slice(0,Me+1),Ke=this._getTextWidth(Ve)+C;Ke<=u?(se=Me+1,pe=Ve,De=Ke):ce=Me}if(!pe)break;if(m){var ze,ht=H[pe.length];(ze=(" "===ht||"-"===ht)&&De<=u?pe.length:Math.max(pe.lastIndexOf(" "),pe.lastIndexOf("-"))+1)>0&&(pe=pe.slice(0,se=ze),De=this._getTextWidth(pe))}if(pe=pe.trimRight(),this._addTextLine(pe),i=Math.max(i,De),this._shouldHandleEllipsis(d+=r)){this._tryToAddEllipsisToLastLine();break}if((H=(H=H.slice(se)).trimLeft()).length>0&&(ne=this._getTextWidth(H))<=u){this._addTextLine(H),d+=r,i=Math.max(i,ne);break}}else this._addTextLine(H),d+=r,i=Math.max(i,ne),this._shouldHandleEllipsis(d)&&I<L-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),c&&d+r>h)break}this.textHeight=t,this.textWidth=i}_shouldHandleEllipsis(e){var t=+this.fontSize(),i=this.lineHeight()*t,r=this.attrs.height,s=r!==tc&&void 0!==r,a=r-2*this.padding();return!("none"!==this.wrap())||s&&e+i>a}_tryToAddEllipsisToLastLine(){var e=this.attrs.width,t=e!==tc&&void 0!==e,r=e-2*this.padding(),s=this.ellipsis(),o=this.textArr[this.textArr.length-1];o&&s&&(t&&(this._getTextWidth(o.text+"\u2026")<r||(o.text=o.text.slice(0,o.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(o.text+"\u2026"))}getStrokeScaleEnabled(){return!0}}Mt.prototype._fillFunc=function VW(n){n.fillText(this._partialText,this._partialTextX,this._partialTextY)},Mt.prototype._strokeFunc=function zW(n){n.strokeText(this._partialText,this._partialTextX,this._partialTextY)},Mt.prototype.className="Text",Mt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],Jt(Mt),R.overWriteSetter(Mt,"width",dv()),R.overWriteSetter(Mt,"height",dv()),R.addGetterSetter(Mt,"fontFamily","Arial"),R.addGetterSetter(Mt,"fontSize",12,_e()),R.addGetterSetter(Mt,"fontStyle","normal"),R.addGetterSetter(Mt,"fontVariant","normal"),R.addGetterSetter(Mt,"padding",0,_e()),R.addGetterSetter(Mt,"align","left"),R.addGetterSetter(Mt,"verticalAlign","top"),R.addGetterSetter(Mt,"lineHeight",1,_e()),R.addGetterSetter(Mt,"wrap","word"),R.addGetterSetter(Mt,"ellipsis",!1,or()),R.addGetterSetter(Mt,"letterSpacing",0,_e()),R.addGetterSetter(Mt,"text","",Ya()),R.addGetterSetter(Mt,"textDecoration",""),it(716);class HW{constructor(e,t,i){this.layer=t,this.config=i,this.group=new rs({id:Si()}),this.xLine=new An({...i.xLine,points:[e.x,e.y,e.x+i.xLength,e.y]}),this.group.add(this.xLine),this.yLine=new An({...i.xLine,points:[e.x,e.y,e.x,e.y+i.yLength]}),this.group.add(this.yLine),this.xText=new Mt({x:e.x+i.xLength-10,y:e.y+5,text:"X",fontSize:12,fill:"black"}),this.group.add(this.xText),this.yText=new Mt({x:e.x+5,y:e.y+i.yLength-10,text:"Y",fontSize:12,fill:"black"}),this.group.add(this.yText),this.layer.add(this.group)}scale(){const e=this.layer.getStage();this.group.setAttrs({scaleX:1/e.scaleX(),scaleY:1/e.scaleY()})}}class GW{constructor(e,t,i,r,s){this.viewPort=e,this.unitScale=t,this.stageScale=i,this.layer=r,this.config=s,this.group=new rs({id:Si()});let o=e.tl.x;for(;o<=e.rb.x;){const c=(o-e.tl.x)/s.minorStep%s.majorStep==0?s.majorLine:s.minorLine,l=new An({points:this.scalePoints([o,e.tl.y,o,e.rb.y]),...c,strokeScaleEnabled:!1});this.group.add(l),o+=s.minorStep}let a=e.tl.y;for(;a<=e.rb.y;){const c=(a-e.tl.y)/s.minorStep%s.majorStep==0?s.majorLine:s.minorLine,l=new An({points:this.scalePoints([e.tl.x,a,e.rb.x,a]),...c,strokeScaleEnabled:!1});this.group.add(l),a+=s.minorStep}this.layer.add(this.group)}scalePoints(e){return e.map(t=>t*this.unitScale/this.stageScale)}}class Mv extends Os{constructor(e){super(e),this.listening(!1),G.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}Mv.prototype.nodeType="FastLayer",Jt(Mv);var xv=Ka.performance&&Ka.performance.now?function(){return Ka.performance.now()}:function(){return(new Date).getTime()};let Pv=(()=>{class n{constructor(t,i){this.id=n.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:xv(),frameRate:0},this.func=t,this.setLayers(i)}setLayers(t){return this.layers=t?t.length>0?t:[t]:[],this}getLayers(){return this.layers}addLayer(t){var s,i=this.layers,r=i.length;for(s=0;s<r;s++)if(i[s]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){var s,i=n.animations,r=i.length;for(s=0;s<r;s++)if(i[s].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=xv(),n._addAnimation(this),this}stop(){return n._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){var o,i=t.id,r=this.animations,s=r.length;for(o=0;o<s;o++)if(r[o].id===i){this.animations.splice(o,1);break}}static _runFrames(){var r,s,o,a,c,l,u,h,t={},i=this.animations;for(a=0;a<i.length;a++)if(s=(r=i[a]).layers,o=r.func,r._updateFrameObject(xv()),l=s.length,!o||!1!==o.call(r,r.frame))for(c=0;c<l;c++)void 0!==(u=s[c])._id&&(t[u._id]=u);for(h in t)t.hasOwnProperty(h)&&t[h].batchDraw()}static _animationLoop(){var t=n;t.animations.length?(t._runFrames(),G.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,G.requestAnimFrame(this._animationLoop))}}return n.animations=[],n.animIdCounter=0,n.animRunning=!1,n})();var $W={node:1,duration:1,easing:1,onFinish:1,yoyo:1},qW=0,dx=["fill","stroke","shadowColor"];class KW{constructor(e,t,i,r,s,o,a){this.prop=e,this.propFunc=t,this.begin=r,this._pos=r,this.duration=o,this._change=0,this.prevPos=0,this.yoyo=a,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=i,this._change=s-this.begin,this.pause()}fire(e){var t=this[e];t&&t()}setTime(e){e>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():e<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=e,this.update())}getTime(){return this._time}setPosition(e){this.prevPos=this._pos,this.propFunc(e),this._pos=e}getPosition(e){return void 0===e&&(e=this._time),this.func(e,this.begin,this._change,this.duration)}play(){this.state=2,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=3,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(e){this.pause(),this._time=e,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var e=this.getTimer()-this._startTime;2===this.state?this.setTime(e):3===this.state&&this.setTime(this.duration-e)}pause(){this.state=1,this.fire("onPause")}getTimer(){return(new Date).getTime()}}let fx=(()=>{class n{constructor(t){var o,l,i=this,r=t.node,s=r._id,a=t.easing||ou.Linear,c=!!t.yoyo;o=typeof t.duration>"u"?.3:0===t.duration?.001:t.duration,this.node=r,this._id=qW++;var u=r.getLayer()||(r instanceof Re.Stage?r.getLayers():null);for(l in u||G.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new Pv(function(){i.tween.onEnterFrame()},u),this.tween=new KW(l,function(h){i._tweenFunc(h)},a,0,1,1e3*o,c),this._addListeners(),n.attrs[s]||(n.attrs[s]={}),n.attrs[s][this._id]||(n.attrs[s][this._id]={}),n.tweens[s]||(n.tweens[s]={}),t)void 0===$W[l]&&this._addAttr(l,t[l]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,i){var o,a,c,l,u,h,d,p,r=this.node,s=r._id;if((c=n.tweens[s][t])&&delete n.attrs[s][c][t],o=r.getAttr(t),G._isArray(i))if(a=[],u=Math.max(i.length,o.length),"points"===t&&i.length!==o.length&&(i.length>o.length?(d=o,o=G._prepareArrayForTween(o,i,r.closed())):(h=i,i=G._prepareArrayForTween(i,o,r.closed()))),0===t.indexOf("fill"))for(l=0;l<u;l++)if(l%2==0)a.push(i[l]-o[l]);else{var f=G.colorToRGBA(o[l]);p=G.colorToRGBA(i[l]),o[l]=f,a.push({r:p.r-f.r,g:p.g-f.g,b:p.b-f.b,a:p.a-f.a})}else for(l=0;l<u;l++)a.push(i[l]-o[l]);else-1!==dx.indexOf(t)?(o=G.colorToRGBA(o),a={r:(p=G.colorToRGBA(i)).r-o.r,g:p.g-o.g,b:p.b-o.b,a:p.a-o.a}):a=i-o;n.attrs[s][this._id][t]={start:o,diff:a,end:i,trueEnd:h,trueStart:d},n.tweens[s][t]=this._id}_tweenFunc(t){var s,o,a,c,l,u,h,d,i=this.node,r=n.attrs[i._id][this._id];for(s in r){if(c=(o=r[s]).diff,d=o.end,G._isArray(a=o.start))if(l=[],h=Math.max(a.length,d.length),0===s.indexOf("fill"))for(u=0;u<h;u++)l.push(u%2==0?(a[u]||0)+c[u]*t:"rgba("+Math.round(a[u].r+c[u].r*t)+","+Math.round(a[u].g+c[u].g*t)+","+Math.round(a[u].b+c[u].b*t)+","+(a[u].a+c[u].a*t)+")");else for(u=0;u<h;u++)l.push((a[u]||0)+c[u]*t);else l=-1!==dx.indexOf(s)?"rgba("+Math.round(a.r+c.r*t)+","+Math.round(a.g+c.g*t)+","+Math.round(a.b+c.b*t)+","+(a.a+c.a*t)+")":a+c*t;i.setAttr(s,l)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var t=this.node,i=n.attrs[t._id][this._id];i.points&&i.points.trueEnd&&t.setAttr("points",i.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var t=this.node,i=n.attrs[t._id][this._id];i.points&&i.points.trueStart&&t.points(i.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(1e3*t),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var s,t=this.node._id,i=this._id,r=n.tweens[t];for(s in this.pause(),r)delete n.tweens[t][s];delete n.attrs[t][i]}}return n.attrs={},n.tweens={},n})();me.prototype.to=function(n){var e=n.onFinish;n.node=this,n.onFinish=function(){this.destroy(),e&&e()},new fx(n).play()};const ou={BackEaseIn(n,e,t,i){var r=1.70158;return t*(n/=i)*n*((r+1)*n-r)+e},BackEaseOut(n,e,t,i){var r=1.70158;return t*((n=n/i-1)*n*((r+1)*n+r)+1)+e},BackEaseInOut(n,e,t,i){var r=1.70158;return(n/=i/2)<1?t/2*(n*n*((1+(r*=1.525))*n-r))+e:t/2*((n-=2)*n*((1+(r*=1.525))*n+r)+2)+e},ElasticEaseIn(n,e,t,i,r,s){var o=0;return 0===n?e:1==(n/=i)?e+t:(s||(s=.3*i),!r||r<Math.abs(t)?(r=t,o=s/4):o=s/(2*Math.PI)*Math.asin(t/r),-r*Math.pow(2,10*(n-=1))*Math.sin((n*i-o)*(2*Math.PI)/s)+e)},ElasticEaseOut(n,e,t,i,r,s){var o=0;return 0===n?e:1==(n/=i)?e+t:(s||(s=.3*i),!r||r<Math.abs(t)?(r=t,o=s/4):o=s/(2*Math.PI)*Math.asin(t/r),r*Math.pow(2,-10*n)*Math.sin((n*i-o)*(2*Math.PI)/s)+t+e)},ElasticEaseInOut(n,e,t,i,r,s){var o=0;return 0===n?e:2==(n/=i/2)?e+t:(s||(s=i*(.3*1.5)),!r||r<Math.abs(t)?(r=t,o=s/4):o=s/(2*Math.PI)*Math.asin(t/r),n<1?r*Math.pow(2,10*(n-=1))*Math.sin((n*i-o)*(2*Math.PI)/s)*-.5+e:r*Math.pow(2,-10*(n-=1))*Math.sin((n*i-o)*(2*Math.PI)/s)*.5+t+e)},BounceEaseOut:(n,e,t,i)=>(n/=i)<1/2.75?t*(7.5625*n*n)+e:n<2/2.75?t*(7.5625*(n-=1.5/2.75)*n+.75)+e:n<2.5/2.75?t*(7.5625*(n-=2.25/2.75)*n+.9375)+e:t*(7.5625*(n-=2.625/2.75)*n+.984375)+e,BounceEaseIn:(n,e,t,i)=>t-ou.BounceEaseOut(i-n,0,t,i)+e,BounceEaseInOut:(n,e,t,i)=>n<i/2?.5*ou.BounceEaseIn(2*n,0,t,i)+e:.5*ou.BounceEaseOut(2*n-i,0,t,i)+.5*t+e,EaseIn:(n,e,t,i)=>t*(n/=i)*n+e,EaseOut:(n,e,t,i)=>-t*(n/=i)*(n-2)+e,EaseInOut:(n,e,t,i)=>(n/=i/2)<1?t/2*n*n+e:-t/2*(--n*(n-2)-1)+e,StrongEaseIn:(n,e,t,i)=>t*(n/=i)*n*n*n*n+e,StrongEaseOut:(n,e,t,i)=>t*((n=n/i-1)*n*n*n*n+1)+e,StrongEaseInOut:(n,e,t,i)=>(n/=i/2)<1?t/2*n*n*n*n*n+e:t/2*((n-=2)*n*n*n*n+2)+e,Linear:(n,e,t,i)=>t*n/i+e},px=G._assign(Re,{Util:G,Transform:Ci,Node:me,Container:Di,Stage:iu,stages:xf,Layer:Os,FastLayer:Mv,Group:rs,DD:_t,Shape:de,shapes:ru,Animation:Pv,Tween:fx,Easings:ou,Context:wf,Canvas:bf});class Rs extends de{_sceneFunc(e){var t=this.radiusX(),i=this.radiusY();e.beginPath(),e.save(),t!==i&&e.scale(1,i/t),e.arc(0,0,t,0,2*Math.PI,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return 2*this.radiusX()}getHeight(){return 2*this.radiusY()}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}Rs.prototype.className="Ellipse",Rs.prototype._centroid=!0,Rs.prototype._attrsAffectingSize=["radiusX","radiusY"],Jt(Rs),R.addComponentsGetterSetter(Rs,"radius",["x","y"]),R.addGetterSetter(Rs,"radiusX",0,_e()),R.addGetterSetter(Rs,"radiusY",0,_e());class ji extends de{constructor(e){super(e),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&4===e.readyState||e&&e.addEventListener&&e.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(e){const t=this.getWidth(),i=this.getHeight(),r=this.cornerRadius(),s=this.attrs.image;let o;if(s){const a=this.attrs.cropWidth,c=this.attrs.cropHeight;o=a&&c?[s,this.cropX(),this.cropY(),a,c,0,0,t,i]:[s,0,0,t,i]}(this.hasFill()||this.hasStroke()||r)&&(e.beginPath(),r?G.drawRoundedRectPath(e,t,i,r):e.rect(0,0,t,i),e.closePath(),e.fillStrokeShape(this)),s&&(r&&e.clip(),e.drawImage.apply(e,o))}_hitFunc(e){var t=this.width(),i=this.height(),r=this.cornerRadius();e.beginPath(),r?G.drawRoundedRectPath(e,t,i,r):e.rect(0,0,t,i),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,t;return null!==(e=this.attrs.width)&&void 0!==e?e:null===(t=this.image())||void 0===t?void 0:t.width}getHeight(){var e,t;return null!==(e=this.attrs.height)&&void 0!==e?e:null===(t=this.image())||void 0===t?void 0:t.height}static fromURL(e,t,i=null){var r=G.createImageElement();r.onload=function(){var s=new ji({image:r});t(s)},r.onerror=i,r.crossOrigin="Anonymous",r.src=e}}ji.prototype.className="Image",Jt(ji),R.addGetterSetter(ji,"cornerRadius",0,hv(4)),R.addGetterSetter(ji,"image"),R.addComponentsGetterSetter(ji,"crop",["x","y","width","height"]),R.addGetterSetter(ji,"cropX",0,_e()),R.addGetterSetter(ji,"cropY",0,_e()),R.addGetterSetter(ji,"cropWidth",0,_e()),R.addGetterSetter(ji,"cropHeight",0,_e());class vo extends de{_sceneFunc(e){const t=this._getPoints();e.beginPath(),e.moveTo(t[0].x,t[0].y);for(var i=1;i<t.length;i++)e.lineTo(t[i].x,t[i].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,t=this.attrs.radius||0,i=[];for(var r=0;r<e;r++)i.push({x:t*Math.sin(2*r*Math.PI/e),y:-1*t*Math.cos(2*r*Math.PI/e)});return i}getSelfRect(){const e=this._getPoints();var t=e[0].x,i=e[0].y,r=e[0].x,s=e[0].y;return e.forEach(o=>{t=Math.min(t,o.x),i=Math.max(i,o.x),r=Math.min(r,o.y),s=Math.max(s,o.y)}),{x:t,y:r,width:i-t,height:s-r}}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}vo.prototype.className="RegularPolygon",vo.prototype._centroid=!0,vo.prototype._attrsAffectingSize=["radius"],Jt(vo),R.addGetterSetter(vo,"radius",0,_e()),R.addGetterSetter(vo,"sides",0,_e());var gx=2*Math.PI;class wo extends de{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,gx,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),gx,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}wo.prototype.className="Ring",wo.prototype._centroid=!0,wo.prototype._attrsAffectingSize=["innerRadius","outerRadius"],Jt(wo),R.addGetterSetter(wo,"innerRadius",0,_e()),R.addGetterSetter(wo,"outerRadius",0,_e());class Pr extends de{constructor(e){super(e),this._updated=!0,this.anim=new Pv(()=>{var t=this._updated;return this._updated=!1,t}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){var t=this.animation(),i=this.frameIndex(),r=4*i,s=this.animations()[t],o=this.frameOffsets(),a=s[r+0],c=s[r+1],l=s[r+2],u=s[r+3],h=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,l,u),e.closePath(),e.fillStrokeShape(this)),h)if(o){var d=o[t],p=2*i;e.drawImage(h,a,c,l,u,d[p+0],d[p+1],l,u)}else e.drawImage(h,a,c,l,u,0,0,l,u)}_hitFunc(e){var t=this.animation(),i=this.frameIndex(),r=4*i,s=this.animations()[t],o=this.frameOffsets(),a=s[r+2],c=s[r+3];if(e.beginPath(),o){var l=o[t],u=2*i;e.rect(l[u+0],l[u+1],a,c)}else e.rect(0,0,a,c);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(!this.isRunning()){var e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var e=this.frameIndex(),t=this.animation(),i=this.animations();this.frameIndex(e<i[t].length/4-1?e+1:0)}}Pr.prototype.className="Sprite",Jt(Pr),R.addGetterSetter(Pr,"animation"),R.addGetterSetter(Pr,"animations"),R.addGetterSetter(Pr,"frameOffsets"),R.addGetterSetter(Pr,"image"),R.addGetterSetter(Pr,"frameIndex",0,_e()),R.addGetterSetter(Pr,"frameRate",17,_e()),R.backCompat(Pr,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class Ns extends de{_sceneFunc(e){var t=this.innerRadius(),i=this.outerRadius(),r=this.numPoints();e.beginPath(),e.moveTo(0,0-i);for(var s=1;s<2*r;s++){var o=s%2==0?i:t,a=o*Math.sin(s*Math.PI/r),c=-1*o*Math.cos(s*Math.PI/r);e.lineTo(a,c)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}function mx(n){n.fillText(this.partialText,0,0)}function yx(n){n.strokeText(this.partialText,0,0)}Ns.prototype.className="Star",Ns.prototype._centroid=!0,Ns.prototype._attrsAffectingSize=["innerRadius","outerRadius"],Jt(Ns),R.addGetterSetter(Ns,"numPoints",5,_e()),R.addGetterSetter(Ns,"innerRadius",0,_e()),R.addGetterSetter(Ns,"outerRadius",0,_e());class Tn extends de{constructor(e){super(e),this.dummyCanvas=G.createCanvasElement(),this.dataArray=[],this.dataArray=Rt.parsePathData(this.attrs.data),this.on("dataChange.konva",function(){this.dataArray=Rt.parsePathData(this.attrs.data),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();var t=this.textDecoration(),i=this.fill(),r=this.fontSize(),s=this.glyphInfo;"underline"===t&&e.beginPath();for(var o=0;o<s.length;o++){e.save();var a=s[o].p0;e.translate(a.x,a.y),e.rotate(s[o].rotation),this.partialText=s[o].text,e.fillStrokeShape(this),"underline"===t&&(0===o&&e.moveTo(0,r/2+1),e.lineTo(r,r/2+1)),e.restore()}"underline"===t&&(e.strokeStyle=i,e.lineWidth=r/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();var t=this.glyphInfo;if(t.length>=1){var i=t[0].p0;e.moveTo(i.x,i.y)}for(var r=0;r<t.length;r++){var s=t[r].p1;e.lineTo(s.x,s.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return G.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return Mt.prototype.setText.call(this,e)}_getContextFont(){return Mt.prototype._getContextFont.call(this)}_getTextSize(e){var i=this.dummyCanvas.getContext("2d");i.save(),i.font=this._getContextFont();var r=i.measureText(e);return i.restore(),{width:r.width,height:parseInt(this.attrs.fontSize,10)}}_setTextData(){var e=this,t=this._getTextSize(this.attrs.text),i=this.letterSpacing(),r=this.align(),s=this.kerningFunc();this.textWidth=t.width,this.textHeight=t.height;var o=Math.max(this.textWidth+((this.attrs.text||"").length-1)*i,0);this.glyphInfo=[];for(var a=0,c=0;c<e.dataArray.length;c++)e.dataArray[c].pathLength>0&&(a+=e.dataArray[c].pathLength);var l=0;"center"===r&&(l=Math.max(0,a/2-o/2)),"right"===r&&(l=Math.max(0,a-o));for(var d,p,f,u=ix(this.text()),h=this.text().split(" ").length-1,m=-1,v=0,C=function(){v=0;for(var Ke=e.dataArray,ze=m+1;ze<Ke.length;ze++){if(Ke[ze].pathLength>0)return m=ze,Ke[ze];"M"===Ke[ze].command&&(d={x:Ke[ze].points[0],y:Ke[ze].points[1]})}return{}},I=function(Ke){var ze=e._getTextSize(Ke).width+i;" "===Ke&&"justify"===r&&(ze+=(a-o)/h);var ht=0,pt=0;for(p=void 0;Math.abs(ze-ht)/ze>.01&&pt<20;){pt++;for(var ue=ht;void 0===f;)(f=C())&&ue+f.pathLength<ze&&(ue+=f.pathLength,f=void 0);if(0===Object.keys(f).length||void 0===d)return;var Ee=!1;switch(f.command){case"L":Rt.getLineLength(d.x,d.y,f.points[0],f.points[1])>ze?p=Rt.getPointOnLine(ze,d.x,d.y,f.points[0],f.points[1],d.x,d.y):f=void 0;break;case"A":var tt=f.points[5],Ge=f.points[4]+tt;0===v?v=f.points[4]+1e-8:ze>ht?v+=Math.PI/180*tt/Math.abs(tt):v-=Math.PI/360*tt/Math.abs(tt),(tt<0&&v<Ge||tt>=0&&v>Ge)&&(v=Ge,Ee=!0),p=Rt.getPointOnEllipticalArc(f.points[0],f.points[1],f.points[2],f.points[3],v,f.points[6]);break;case"C":0===v?v=ze>f.pathLength?1e-8:ze/f.pathLength:ze>ht?v+=(ze-ht)/f.pathLength/2:v=Math.max(v-(ht-ze)/f.pathLength/2,0),v>1&&(v=1,Ee=!0),p=Rt.getPointOnCubicBezier(v,f.start.x,f.start.y,f.points[0],f.points[1],f.points[2],f.points[3],f.points[4],f.points[5]);break;case"Q":0===v?v=ze/f.pathLength:ze>ht?v+=(ze-ht)/f.pathLength:v-=(ht-ze)/f.pathLength,v>1&&(v=1,Ee=!0),p=Rt.getPointOnQuadraticBezier(v,f.start.x,f.start.y,f.points[0],f.points[1],f.points[2],f.points[3])}void 0!==p&&(ht=Rt.getLineLength(d.x,d.y,p.x,p.y)),Ee&&(Ee=!1,f=void 0)}},ne=l/(e._getTextSize("C").width+i)-1,se=0;se<ne&&(I("C"),void 0!==d&&void 0!==p);se++)d=p;for(var ce=0;ce<u.length&&(I(u[ce]),void 0!==d&&void 0!==p);ce++){var pe=Rt.getLineLength(d.x,d.y,p.x,p.y),De=0;if(s)try{De=s(u[ce-1],u[ce])*this.fontSize()}catch{De=0}d.x+=De,p.x+=De,this.textWidth+=De;var Me=Rt.getPointOnLine(De+pe/2,d.x,d.y,p.x,p.y),Ve=Math.atan2(p.y-d.y,p.x-d.x);this.glyphInfo.push({transposeX:Me.x,transposeY:Me.y,text:u[ce],rotation:Ve,p0:d,p1:p}),d=p}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var e=[];this.glyphInfo.forEach(function(u){e.push(u.p0.x),e.push(u.p0.y),e.push(u.p1.x),e.push(u.p1.y)});for(var o,a,t=e[0]||0,i=e[0]||0,r=e[1]||0,s=e[1]||0,c=0;c<e.length/2;c++)o=e[2*c],a=e[2*c+1],t=Math.min(t,o),i=Math.max(i,o),r=Math.min(r,a),s=Math.max(s,a);var l=this.fontSize();return{x:t-l/2,y:r-l/2,width:i-t+l,height:s-r+l}}destroy(){return G.releaseCanvas(this.dummyCanvas),super.destroy()}}Tn.prototype._fillFunc=mx,Tn.prototype._strokeFunc=yx,Tn.prototype._fillFuncHit=mx,Tn.prototype._strokeFuncHit=yx,Tn.prototype.className="TextPath",Tn.prototype._attrsAffectingSize=["text","fontSize","data"],Jt(Tn),R.addGetterSetter(Tn,"data"),R.addGetterSetter(Tn,"fontFamily","Arial"),R.addGetterSetter(Tn,"fontSize",12,_e()),R.addGetterSetter(Tn,"fontStyle","normal"),R.addGetterSetter(Tn,"align","left"),R.addGetterSetter(Tn,"letterSpacing",0,_e()),R.addGetterSetter(Tn,"textBaseline","middle"),R.addGetterSetter(Tn,"fontVariant","normal"),R.addGetterSetter(Tn,"text",""),R.addGetterSetter(Tn,"textDecoration",null),R.addGetterSetter(Tn,"kerningFunc",null);var vx="tr-konva",XW=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange"].map(n=>n+`.${vx}`).join(" "),wx="nodesRect",ZW=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],QW={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const JW="ontouchstart"in Re._global;var Nf=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],Ex=1e8;function bx(n,e,t){const i=t.x+(n.x-t.x)*Math.cos(e)-(n.y-t.y)*Math.sin(e),r=t.y+(n.x-t.x)*Math.sin(e)+(n.y-t.y)*Math.cos(e);return Object.assign(Object.assign({},n),{rotation:n.rotation+e,x:i,y:r})}class Dt extends rs{constructor(e){super(e),this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(XW,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return G.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return vx+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const t=e.filter(r=>!r.isAncestorOf(this)||(G.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1));return this._nodes=e=t,1===e.length&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(r=>{const s=()=>{1===this.nodes().length&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},o=r._attrsAffectingSize.map(a=>a+"Change."+this._getEventNamespace()).join(" ");r.on(o,s),r.on(ZW.map(a=>a+`.${this._getEventNamespace()}`).join(" "),s),r.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(r)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let t;e.on(`dragstart.${this._getEventNamespace()}`,i=>{t=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(i,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,i=>{if(!t)return;const r=e.getAbsolutePosition(),s=r.x-t.x,o=r.y-t.y;this.nodes().forEach(a=>{if(a===e||a.isDragging())return;const c=a.getAbsolutePosition();a.setAbsolutePosition({x:c.x+s,y:c.y+o}),a.startDrag(i)}),t=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(wx),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(wx,this.__getNodeRect)}__getNodeShape(e,t=this.rotation(),i){var r=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=e.getAbsoluteScale(i),o=e.getAbsolutePosition(i),a=r.x*s.x-e.offsetX()*s.x,c=r.y*s.y-e.offsetY()*s.y;const l=(Re.getAngle(e.getAbsoluteRotation())+2*Math.PI)%(2*Math.PI);return bx({x:o.x+a*Math.cos(l)+c*Math.sin(-l),y:o.y+c*Math.cos(l)+a*Math.sin(l),width:r.width*s.x,height:r.height*s.y,rotation:l},-Re.getAngle(t),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-Ex,y:-Ex,width:0,height:0,rotation:0};const t=[];this.nodes().map(l=>{const u=l.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var h=[{x:u.x,y:u.y},{x:u.x+u.width,y:u.y},{x:u.x+u.width,y:u.y+u.height},{x:u.x,y:u.y+u.height}],d=l.getAbsoluteTransform();h.forEach(function(p){var f=d.point(p);t.push(f)})});const i=new Ci;var r,s,o,a;i.rotate(-Re.getAngle(this.rotation())),t.forEach(function(l){var u=i.point(l);void 0===r&&(r=o=u.x,s=a=u.y),r=Math.min(r,u.x),s=Math.min(s,u.y),o=Math.max(o,u.x),a=Math.max(a,u.y)}),i.invert();const c=i.point({x:r,y:s});return{x:c.x,y:c.y,width:o-r,height:a-s,rotation:Re.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Nf.forEach(function(e){this._createAnchor(e)}.bind(this)),this._createAnchor("rotater")}_createAnchor(e){var t=new Ja({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:JW?10:"auto"}),i=this;t.on("mousedown touchstart",function(r){i._handleMouseDown(r)}),t.on("dragstart",r=>{t.stopDrag(),r.cancelBubble=!0}),t.on("dragend",r=>{r.cancelBubble=!0}),t.on("mouseenter",()=>{var r=Re.getAngle(this.rotation()),s=function e6(n,e){if("rotater"===n)return"crosshair";e+=G.degToRad(QW[n]||0);var t=(G.radToDeg(e)%360+360)%360;return G._inRange(t,337.5,360)||G._inRange(t,0,22.5)?"ns-resize":G._inRange(t,22.5,67.5)?"nesw-resize":G._inRange(t,67.5,112.5)?"ew-resize":G._inRange(t,112.5,157.5)?"nwse-resize":G._inRange(t,157.5,202.5)?"ns-resize":G._inRange(t,202.5,247.5)?"nesw-resize":G._inRange(t,247.5,292.5)?"ew-resize":G._inRange(t,292.5,337.5)?"nwse-resize":(G.error("Transformer has unknown angle for cursor detection: "+t),"pointer")}(e,r);t.getStage().content&&(t.getStage().content.style.cursor=s),this._cursorChange=!0}),t.on("mouseout",()=>{t.getStage().content&&(t.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(t)}_createBack(){var e=new de({name:"back",width:0,height:0,draggable:!0,sceneFunc(t){var i=this.getParent(),r=i.padding();t.beginPath(),t.rect(-r,-r,this.width()+2*r,this.height()+2*r),t.moveTo(this.width()/2,-r),i.rotateEnabled()&&t.lineTo(this.width()/2,-i.rotateAnchorOffset()*G._sign(this.height())-r),t.fillStrokeShape(this)},hitFunc:(t,i)=>{if(this.shouldOverdrawWholeArea()){var r=this.padding();t.beginPath(),t.rect(-r,-r,i.width()+2*r,i.height()+2*r),t.fillStrokeShape(i)}}});this.add(e),this._proxyDrag(e),e.on("dragstart",t=>{t.cancelBubble=!0}),e.on("dragmove",t=>{t.cancelBubble=!0}),e.on("dragend",t=>{t.cancelBubble=!0}),this.on("dragmove",t=>{this.update()})}_handleMouseDown(e){this._movingAnchorName=e.target.name().split(" ")[0];var t=this._getNodeRect(),i=t.width,r=t.height,s=Math.sqrt(Math.pow(i,2)+Math.pow(r,2));this.sin=Math.abs(r/s),this.cos=Math.abs(i/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var o=e.target.getAbsolutePosition(),a=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:a.x-o.x,y:a.y-o.y},this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(c=>{c._fire("transformstart",{evt:e.evt,target:c})})}_handleMouseMove(e){var t,i,r,s=this.findOne("."+this._movingAnchorName),o=s.getStage();o.setPointersPositions(e);const a=o.getPointerPosition();let c={x:a.x-this._anchorDragOffset.x,y:a.y-this._anchorDragOffset.y};const l=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(c=this.anchorDragBoundFunc()(l,c,e)),s.setAbsolutePosition(c);const u=s.getAbsolutePosition();if(l.x!==u.x||l.y!==u.y){if("rotater"===this._movingAnchorName){var h=this._getNodeRect();t=s.x()-h.width/2,i=-s.y()+h.height/2;let Ke=Math.atan2(-i,t)+Math.PI/2;h.height<0&&(Ke-=Math.PI);const ze=Re.getAngle(this.rotation())+Ke,ht=Re.getAngle(this.rotationSnapTolerance()),ue=function i6(n,e,t){let i=e;for(let r=0;r<n.length;r++){const s=Re.getAngle(n[r]),o=Math.abs(s-e)%(2*Math.PI);Math.min(o,2*Math.PI-o)<t&&(i=s)}return i}(this.rotationSnaps(),ze,ht)-h.rotation,Ee=function n6(n,e){const t=function t6(n){return{x:n.x+n.width/2*Math.cos(n.rotation)+n.height/2*Math.sin(-n.rotation),y:n.y+n.height/2*Math.cos(n.rotation)+n.width/2*Math.sin(n.rotation)}}(n);return bx(n,e,t)}(h,ue);return void this._fitNodesInto(Ee,e)}var p=this.keepRatio()||e.shiftKey,I=this.centeredScaling()||e.altKey;if("top-left"===this._movingAnchorName){if(p){var f=I?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(f.x-s.x(),2)+Math.pow(f.y-s.y(),2));var m=this.findOne(".top-left").x()>f.x?-1:1,v=this.findOne(".top-left").y()>f.y?-1:1;t=r*this.cos*m,i=r*this.sin*v,this.findOne(".top-left").x(f.x-t),this.findOne(".top-left").y(f.y-i)}}else if("top-center"===this._movingAnchorName)this.findOne(".top-left").y(s.y());else if("top-right"===this._movingAnchorName){p&&(f=I?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()},r=Math.sqrt(Math.pow(s.x()-f.x,2)+Math.pow(f.y-s.y(),2)),m=this.findOne(".top-right").x()<f.x?-1:1,v=this.findOne(".top-right").y()>f.y?-1:1,t=r*this.cos*m,i=r*this.sin*v,this.findOne(".top-right").x(f.x+t),this.findOne(".top-right").y(f.y-i));var C=s.position();this.findOne(".top-left").y(C.y),this.findOne(".bottom-right").x(C.x)}else"middle-left"===this._movingAnchorName?this.findOne(".top-left").x(s.x()):"middle-right"===this._movingAnchorName?this.findOne(".bottom-right").x(s.x()):"bottom-left"===this._movingAnchorName?(p&&(f=I?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()},r=Math.sqrt(Math.pow(f.x-s.x(),2)+Math.pow(s.y()-f.y,2)),m=f.x<s.x()?-1:1,v=s.y()<f.y?-1:1,i=r*this.sin*v,s.x(f.x-(t=r*this.cos*m)),s.y(f.y+i)),C=s.position(),this.findOne(".top-left").x(C.x),this.findOne(".bottom-right").y(C.y)):"bottom-center"===this._movingAnchorName?this.findOne(".bottom-right").y(s.y()):"bottom-right"===this._movingAnchorName?p&&(f=I?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()},r=Math.sqrt(Math.pow(s.x()-f.x,2)+Math.pow(s.y()-f.y,2)),m=this.findOne(".bottom-right").x()<f.x?-1:1,v=this.findOne(".bottom-right").y()<f.y?-1:1,t=r*this.cos*m,i=r*this.sin*v,this.findOne(".bottom-right").x(f.x+t),this.findOne(".bottom-right").y(f.y+i)):console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(I=this.centeredScaling()||e.altKey){var L=this.findOne(".top-left"),H=this.findOne(".bottom-right"),ne=L.x(),se=L.y(),ce=this.getWidth()-H.x(),pe=this.getHeight()-H.y();H.move({x:-ne,y:-se}),L.move({x:ce,y:pe})}var De=this.findOne(".top-left").getAbsolutePosition();t=De.x,i=De.y;var Me=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),Ve=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:t,y:i,width:Me,height:Ve,rotation:Re.getAngle(this.rotation())},e)}}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var t=this.getNode();this._fire("transformend",{evt:e,target:t}),t&&this._nodes.forEach(i=>{i._fire("transformend",{evt:e,target:i})}),this._movingAnchorName=null}}_fitNodesInto(e,t){var i=this._getNodeRect();if(G._inRange(e.width,2*-this.padding()-1,1))return void this.update();if(G._inRange(e.height,2*-this.padding()-1,1))return void this.update();const s=this.flipEnabled();var o=new Ci;if(o.rotate(Re.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const h=o.point({x:2*-this.padding(),y:0});if(e.x+=h.x,e.y+=h.y,e.width+=2*this.padding(),this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,!s)return void this.update()}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const h=o.point({x:2*this.padding(),y:0});if(this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.width+=2*this.padding(),!s)return void this.update()}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const h=o.point({x:0,y:2*-this.padding()});if(e.x+=h.x,e.y+=h.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.height+=2*this.padding(),!s)return void this.update()}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const h=o.point({x:0,y:2*this.padding()});if(this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.height+=2*this.padding(),!s)return void this.update()}if(this.boundBoxFunc()){const h=this.boundBoxFunc()(i,e);h?e=h:G.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const a=1e7,c=new Ci;c.translate(i.x,i.y),c.rotate(i.rotation),c.scale(i.width/a,i.height/a);const l=new Ci;l.translate(e.x,e.y),l.rotate(e.rotation),l.scale(e.width/a,e.height/a);const u=l.multiply(c.invert());this._nodes.forEach(h=>{var d;const p=h.getParent().getAbsoluteTransform(),f=h.getTransform().copy();f.translate(h.offsetX(),h.offsetY());const m=new Ci;m.multiply(p.copy().invert()).multiply(u).multiply(p).multiply(f);const v=m.decompose();h.setAttrs(v),this._fire("transform",{evt:t,target:h}),h._fire("transform",{evt:t,target:h}),null===(d=h.getLayer())||void 0===d||d.batchDraw()}),this.rotation(G._getRotation(e.rotation)),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,t){this.findOne(e).setAttrs(t)}update(){var e,t=this._getNodeRect();this.rotation(G._getRotation(t.rotation));var i=t.width,r=t.height,s=this.enabledAnchors(),o=this.resizeEnabled(),a=this.padding(),c=this.anchorSize();this.find("._anchor").forEach(l=>{l.setAttrs({width:c,height:c,offsetX:c/2,offsetY:c/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:c/2+a,offsetY:c/2+a,visible:o&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:i/2,y:0,offsetY:c/2+a,visible:o&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:i,y:0,offsetX:c/2-a,offsetY:c/2+a,visible:o&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:c/2+a,visible:o&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:i,y:r/2,offsetX:c/2-a,visible:o&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:c/2+a,offsetY:c/2-a,visible:o&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:i/2,y:r,offsetY:c/2-a,visible:o&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:i,y:r,offsetX:c/2-a,offsetY:c/2-a,visible:o&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:i/2,y:-this.rotateAnchorOffset()*G._sign(r)-a,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:i,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0}),null===(e=this.getLayer())||void 0===e||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),rs.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return me.prototype.toObject.call(this)}clone(e){return me.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Dt.prototype.className="Transformer",Jt(Dt),R.addGetterSetter(Dt,"enabledAnchors",Nf,function r6(n){return n instanceof Array||G.warn("enabledAnchors value should be an array"),n instanceof Array&&n.forEach(function(e){-1===Nf.indexOf(e)&&G.warn("Unknown anchor name: "+e+". Available names are: "+Nf.join(", "))}),n||[]}),R.addGetterSetter(Dt,"flipEnabled",!0,or()),R.addGetterSetter(Dt,"resizeEnabled",!0),R.addGetterSetter(Dt,"anchorSize",10,_e()),R.addGetterSetter(Dt,"rotateEnabled",!0),R.addGetterSetter(Dt,"rotationSnaps",[]),R.addGetterSetter(Dt,"rotateAnchorOffset",50,_e()),R.addGetterSetter(Dt,"rotationSnapTolerance",5,_e()),R.addGetterSetter(Dt,"borderEnabled",!0),R.addGetterSetter(Dt,"anchorStroke","rgb(0, 161, 255)"),R.addGetterSetter(Dt,"anchorStrokeWidth",1,_e()),R.addGetterSetter(Dt,"anchorFill","white"),R.addGetterSetter(Dt,"anchorCornerRadius",0,_e()),R.addGetterSetter(Dt,"borderStroke","rgb(0, 161, 255)"),R.addGetterSetter(Dt,"borderStrokeWidth",1,_e()),R.addGetterSetter(Dt,"borderDash"),R.addGetterSetter(Dt,"keepRatio",!0),R.addGetterSetter(Dt,"centeredScaling",!1),R.addGetterSetter(Dt,"ignoreStroke",!1),R.addGetterSetter(Dt,"padding",0,_e()),R.addGetterSetter(Dt,"node"),R.addGetterSetter(Dt,"nodes"),R.addGetterSetter(Dt,"boundBoxFunc"),R.addGetterSetter(Dt,"anchorDragBoundFunc"),R.addGetterSetter(Dt,"shouldOverdrawWholeArea",!1),R.addGetterSetter(Dt,"useSingleNodeRotation",!0),R.backCompat(Dt,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class ss extends de{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,Re.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}function Sx(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}ss.prototype.className="Wedge",ss.prototype._centroid=!0,ss.prototype._attrsAffectingSize=["radius"],Jt(ss),R.addGetterSetter(ss,"radius",0,_e()),R.addGetterSetter(ss,"angle",0,_e()),R.addGetterSetter(ss,"clockwise",!1),R.backCompat(ss,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var s6=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],o6=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function Ov(n,e,t,i,r){var s=t-e,o=r-i;return 0===s?i+o/2:0===o?i:o*((n-e)/s)+i}function kf(n,e,t){var i=4*(t*n.width+e),r=[];return r.push(n.data[i++],n.data[i++],n.data[i++],n.data[i++]),r}function au(n,e){return Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)+Math.pow(n[2]-e[2],2))}R.addGetterSetter(me,"blurRadius",0,_e(),R.afterSetFilter),R.addGetterSetter(me,"brightness",0,_e(),R.afterSetFilter),R.addGetterSetter(me,"contrast",0,_e(),R.afterSetFilter),R.addGetterSetter(me,"embossStrength",.5,_e(),R.afterSetFilter),R.addGetterSetter(me,"embossWhiteLevel",.5,_e(),R.afterSetFilter),R.addGetterSetter(me,"embossDirection","top-left",null,R.afterSetFilter),R.addGetterSetter(me,"embossBlend",!1,null,R.afterSetFilter),R.addGetterSetter(me,"enhance",0,_e(),R.afterSetFilter),R.addGetterSetter(me,"hue",0,_e(),R.afterSetFilter),R.addGetterSetter(me,"saturation",0,_e(),R.afterSetFilter),R.addGetterSetter(me,"luminance",0,_e(),R.afterSetFilter),R.addGetterSetter(me,"hue",0,_e(),R.afterSetFilter),R.addGetterSetter(me,"saturation",0,_e(),R.afterSetFilter),R.addGetterSetter(me,"value",0,_e(),R.afterSetFilter),R.addGetterSetter(me,"kaleidoscopePower",2,_e(),R.afterSetFilter),R.addGetterSetter(me,"kaleidoscopeAngle",0,_e(),R.afterSetFilter),R.addGetterSetter(me,"threshold",0,_e(),R.afterSetFilter),R.addGetterSetter(me,"noise",.2,_e(),R.afterSetFilter),R.addGetterSetter(me,"pixelSize",8,_e(),R.afterSetFilter),R.addGetterSetter(me,"levels",.5,_e(),R.afterSetFilter),R.addGetterSetter(me,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)}),R.addGetterSetter(me,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)}),R.addGetterSetter(me,"blue",0,CM,R.afterSetFilter),R.addGetterSetter(me,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)}),R.addGetterSetter(me,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)}),R.addGetterSetter(me,"blue",0,CM,R.afterSetFilter),R.addGetterSetter(me,"alpha",1,function(n){return this._filterUpToDate=!1,n>1?1:n<0?0:n}),R.addGetterSetter(me,"threshold",.5,_e(),R.afterSetFilter);const Eo=px.Util._assign(px,{Arc:xr,Arrow:Bi,Circle:mo,Ellipse:Rs,Image:ji,Label:ec,Tag:yo,Line:An,Path:Rt,Rect:Ja,RegularPolygon:vo,Ring:wo,Sprite:Pr,Star:Ns,Text:Mt,TextPath:Tn,Transformer:Dt,Wedge:ss,Filters:{Blur:function(e){var t=Math.round(this.blurRadius());t>0&&function a6(n,e){var s,o,a,c,l,u,h,d,p,f,m,v,C,I,L,H,ne,se,ce,pe,De,Me,Ve,Ke,t=n.data,i=n.width,r=n.height,ze=e+e+1,ht=i-1,pt=r-1,ue=e+1,Ee=ue*(ue+1)/2,Ae=new Sx,tt=null,Ge=Ae,gt=null,Nt=null,Bn=s6[e],yt=o6[e];for(a=1;a<ze;a++)Ge=Ge.next=new Sx,a===ue&&(tt=Ge);for(Ge.next=Ae,h=u=0,o=0;o<r;o++){for(H=ne=se=ce=d=p=f=m=0,v=ue*(pe=t[u]),C=ue*(De=t[u+1]),I=ue*(Me=t[u+2]),L=ue*(Ve=t[u+3]),d+=Ee*pe,p+=Ee*De,f+=Ee*Me,m+=Ee*Ve,Ge=Ae,a=0;a<ue;a++)Ge.r=pe,Ge.g=De,Ge.b=Me,Ge.a=Ve,Ge=Ge.next;for(a=1;a<ue;a++)d+=(Ge.r=pe=t[c=u+((ht<a?ht:a)<<2)])*(Ke=ue-a),p+=(Ge.g=De=t[c+1])*Ke,f+=(Ge.b=Me=t[c+2])*Ke,m+=(Ge.a=Ve=t[c+3])*Ke,H+=pe,ne+=De,se+=Me,ce+=Ve,Ge=Ge.next;for(gt=Ae,Nt=tt,s=0;s<i;s++)t[u+3]=Ve=m*Bn>>yt,0!==Ve?(t[u]=(d*Bn>>yt)*(Ve=255/Ve),t[u+1]=(p*Bn>>yt)*Ve,t[u+2]=(f*Bn>>yt)*Ve):t[u]=t[u+1]=t[u+2]=0,d-=v,p-=C,f-=I,m-=L,v-=gt.r,C-=gt.g,I-=gt.b,L-=gt.a,c=h+((c=s+e+1)<ht?c:ht)<<2,d+=H+=gt.r=t[c],p+=ne+=gt.g=t[c+1],f+=se+=gt.b=t[c+2],m+=ce+=gt.a=t[c+3],gt=gt.next,v+=pe=Nt.r,C+=De=Nt.g,I+=Me=Nt.b,L+=Ve=Nt.a,H-=pe,ne-=De,se-=Me,ce-=Ve,Nt=Nt.next,u+=4;h+=i}for(s=0;s<i;s++){for(ne=se=ce=H=p=f=m=d=0,v=ue*(pe=t[u=s<<2]),C=ue*(De=t[u+1]),I=ue*(Me=t[u+2]),L=ue*(Ve=t[u+3]),d+=Ee*pe,p+=Ee*De,f+=Ee*Me,m+=Ee*Ve,Ge=Ae,a=0;a<ue;a++)Ge.r=pe,Ge.g=De,Ge.b=Me,Ge.a=Ve,Ge=Ge.next;for(l=i,a=1;a<=e;a++)d+=(Ge.r=pe=t[u=l+s<<2])*(Ke=ue-a),p+=(Ge.g=De=t[u+1])*Ke,f+=(Ge.b=Me=t[u+2])*Ke,m+=(Ge.a=Ve=t[u+3])*Ke,H+=pe,ne+=De,se+=Me,ce+=Ve,Ge=Ge.next,a<pt&&(l+=i);for(u=s,gt=Ae,Nt=tt,o=0;o<r;o++)t[3+(c=u<<2)]=Ve=m*Bn>>yt,Ve>0?(t[c]=(d*Bn>>yt)*(Ve=255/Ve),t[c+1]=(p*Bn>>yt)*Ve,t[c+2]=(f*Bn>>yt)*Ve):t[c]=t[c+1]=t[c+2]=0,d-=v,p-=C,f-=I,m-=L,v-=gt.r,C-=gt.g,I-=gt.b,L-=gt.a,c=s+((c=o+ue)<pt?c:pt)*i<<2,d+=H+=gt.r=t[c],p+=ne+=gt.g=t[c+1],f+=se+=gt.b=t[c+2],m+=ce+=gt.a=t[c+3],gt=gt.next,v+=pe=Nt.r,C+=De=Nt.g,I+=Me=Nt.b,L+=Ve=Nt.a,H-=pe,ne-=De,se-=Me,ce-=Ve,Nt=Nt.next,u+=i}}(e,t)},Brighten:function(n){var r,e=255*this.brightness(),t=n.data,i=t.length;for(r=0;r<i;r+=4)t[r]+=e,t[r+1]+=e,t[r+2]+=e},Contrast:function(n){var a,e=Math.pow((this.contrast()+100)/100,2),t=n.data,i=t.length,r=150,s=150,o=150;for(a=0;a<i;a+=4)r=t[a],s=t[a+1],o=t[a+2],r/=255,r-=.5,r*=e,r+=.5,s/=255,s-=.5,s*=e,s+=.5,o/=255,o-=.5,o*=e,o+=.5,s=(s*=255)<0?0:s>255?255:s,o=(o*=255)<0?0:o>255?255:o,t[a]=r=(r*=255)<0?0:r>255?255:r,t[a+1]=s,t[a+2]=o},Emboss:function(n){var e=10*this.embossStrength(),t=255*this.embossWhiteLevel(),i=this.embossDirection(),r=this.embossBlend(),s=0,o=0,a=n.data,c=n.width,l=n.height,u=4*c,h=l;switch(i){case"top-left":s=-1,o=-1;break;case"top":s=-1,o=0;break;case"top-right":s=-1,o=1;break;case"right":s=0,o=1;break;case"bottom-right":s=1,o=1;break;case"bottom":s=1,o=0;break;case"bottom-left":s=1,o=-1;break;case"left":s=0,o=-1;break;default:G.error("Unknown emboss direction: "+i)}do{var d=(h-1)*u,p=s;h+p<1&&(p=0),h+p>l&&(p=0);var f=(h-1+p)*c*4,m=c;do{var v=d+4*(m-1),C=o;m+C<1&&(C=0),m+C>c&&(C=0);var I=f+4*(m-1+C),H=a[v+1]-a[I+1],ne=a[v+2]-a[I+2],se=a[v]-a[I],ce=se>0?se:-se;if((H>0?H:-H)>ce&&(se=H),(ne>0?ne:-ne)>ce&&(se=ne),se*=e,r){var Me=a[v]+se,Ve=a[v+1]+se,Ke=a[v+2]+se;a[v]=Me>255?255:Me<0?0:Me,a[v+1]=Ve>255?255:Ve<0?0:Ve,a[v+2]=Ke>255?255:Ke<0?0:Ke}else{var ze=t-se;ze<0?ze=0:ze>255&&(ze=255),a[v]=a[v+1]=a[v+2]=ze}}while(--m)}while(--h)},Enhance:function(n){var s,c,h,d,e=n.data,t=e.length,i=e[0],r=i,o=e[1],a=o,l=e[2],u=l,p=this.enhance();if(0!==p){for(d=0;d<t;d+=4)(s=e[d+0])<i?i=s:s>r&&(r=s),(c=e[d+1])<o?o=c:c>a&&(a=c),(h=e[d+2])<l?l=h:h>u&&(u=h);var f,m,v,C,I,L,H,ne,se;for(r===i&&(r=255,i=0),a===o&&(a=255,o=0),u===l&&(u=255,l=0),p>0?(m=r+p*(255-r),v=i-p*(i-0),I=a+p*(255-a),L=o-p*(o-0),ne=u+p*(255-u),se=l-p*(l-0)):(m=r+p*(r-(f=.5*(r+i))),v=i+p*(i-f),I=a+p*(a-(C=.5*(a+o))),L=o+p*(o-C),ne=u+p*(u-(H=.5*(u+l))),se=l+p*(l-H)),d=0;d<t;d+=4)e[d+0]=Ov(e[d+0],i,r,v,m),e[d+1]=Ov(e[d+1],o,a,L,I),e[d+2]=Ov(e[d+2],l,u,se,ne)}},Grayscale:function(n){var i,r,e=n.data,t=e.length;for(i=0;i<t;i+=4)e[i]=r=.34*e[i]+.5*e[i+1]+.16*e[i+2],e[i+1]=r,e[i+2]=r},HSL:function(n){var a,L,H,ne,se,e=n.data,t=e.length,r=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,o=127*this.luminance(),c=1*r*Math.cos(s*Math.PI/180),l=1*r*Math.sin(s*Math.PI/180),u=.299+.701*c+.167*l,h=.587-.587*c+.33*l,d=.114-.114*c-.497*l,p=.299-.299*c-.328*l,f=.587+.413*c+.035*l,m=.114-.114*c+.293*l,v=.299-.3*c+1.25*l,C=.587-.586*c-1.05*l,I=.114+.886*c-.2*l;for(a=0;a<t;a+=4)se=e[a+3],e[a+0]=u*(L=e[a+0])+h*(H=e[a+1])+d*(ne=e[a+2])+o,e[a+1]=p*L+f*H+m*ne+o,e[a+2]=v*L+C*H+I*ne+o,e[a+3]=se},HSV:function(n){var o,I,L,H,ne,e=n.data,t=e.length,i=Math.pow(2,this.value()),r=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,a=i*r*Math.cos(s*Math.PI/180),c=i*r*Math.sin(s*Math.PI/180),l=.299*i+.701*a+.167*c,u=.587*i-.587*a+.33*c,h=.114*i-.114*a-.497*c,d=.299*i-.299*a-.328*c,p=.587*i+.413*a+.035*c,f=.114*i-.114*a+.293*c,m=.299*i-.3*a+1.25*c,v=.587*i-.586*a-1.05*c,C=.114*i+.886*a-.2*c;for(o=0;o<t;o+=4)ne=e[o+3],e[o+0]=l*(I=e[o+0])+u*(L=e[o+1])+h*(H=e[o+2]),e[o+1]=d*I+p*L+f*H,e[o+2]=m*I+v*L+C*H,e[o+3]=ne},Invert:function(n){var i,e=n.data,t=e.length;for(i=0;i<t;i+=4)e[i]=255-e[i],e[i+1]=255-e[i+1],e[i+2]=255-e[i+2]},Kaleidoscope:function(n){var i,r,s,o,c,l,u,h,d,e=n.width,t=n.height,p=Math.round(this.kaleidoscopePower()),f=Math.round(this.kaleidoscopeAngle()),m=Math.floor(e*(f%360)/360);if(!(p<1)){var v=G.createCanvasElement();v.width=e,v.height=t;var C=v.getContext("2d").getImageData(0,0,e,t);G.releaseCanvas(v),function(n,e,t){var l,u,h,v,i=n.data,r=e.data,s=n.width,o=n.height,a=t.polarCenterX||s/2,c=t.polarCenterY||o/2,d=0,p=0,f=0,m=0,C=Math.sqrt(a*a+c*c);u=s-a,h=o-c,C=(v=Math.sqrt(u*u+h*h))>C?v:C;var H,ne,ce,pe,I=o,L=s,se=360/L*Math.PI/180;for(ne=0;ne<L;ne+=1)for(ce=Math.sin(ne*se),pe=Math.cos(ne*se),H=0;H<I;H+=1)u=Math.floor(a+C*H/I*pe),d=i[0+(l=4*((h=Math.floor(c+C*H/I*ce))*s+u))],p=i[l+1],f=i[l+2],m=i[l+3],r[0+(l=4*(ne+H*s))]=d,r[l+1]=p,r[l+2]=f,r[l+3]=m}(n,C,{polarCenterX:e/2,polarCenterY:t/2});for(var I=e/Math.pow(2,p);I<=8;)I*=2,p-=1;var L=I=Math.ceil(I),H=0,ne=L,se=1;for(m+I>e&&(H=L,ne=0,se=-1),r=0;r<t;r+=1)for(i=H;i!==ne;i+=se)s=Math.round(i+m)%e,c=C.data[1+(h=4*(e*r+s))],l=C.data[h+2],u=C.data[h+3],C.data[0+(d=4*(e*r+i))]=C.data[h+0],C.data[d+1]=c,C.data[d+2]=l,C.data[d+3]=u;for(r=0;r<t;r+=1)for(L=Math.floor(I),o=0;o<p;o+=1){for(i=0;i<L+1;i+=1)c=C.data[1+(h=4*(e*r+i))],l=C.data[h+2],u=C.data[h+3],C.data[0+(d=4*(e*r+2*L-i-1))]=C.data[h+0],C.data[d+1]=c,C.data[d+2]=l,C.data[d+3]=u;L*=2}!function(n,e,t){var l,u,h,d,p,I,i=n.data,r=e.data,s=n.width,o=n.height,a=t.polarCenterX||s/2,c=t.polarCenterY||o/2,f=0,m=0,v=0,C=0,L=Math.sqrt(a*a+c*c);u=s-a,h=o-c,L=(I=Math.sqrt(u*u+h*h))>L?I:L;var se,ce,De,H=o,ne=s,pe=t.polarRotation||0;for(u=0;u<s;u+=1)for(h=0;h<o;h+=1)d=u-a,p=h-c,se=Math.sqrt(d*d+p*p)*H/L,ce=(ce=(180*Math.atan2(p,d)/Math.PI+360+pe)%360)*ne/360,De=Math.floor(ce),f=i[0+(l=4*(Math.floor(se)*s+De))],m=i[l+1],v=i[l+2],C=i[l+3],r[0+(l=4*(h*s+u))]=f,r[l+1]=m,r[l+2]=v,r[l+3]=C}(C,n,{polarRotation:0})}},Mask:function(n){var t=function E6(n,e){var t=kf(n,0,0),i=kf(n,n.width-1,0),r=kf(n,0,n.height-1),s=kf(n,n.width-1,n.height-1),o=e||10;if(au(t,i)<o&&au(i,s)<o&&au(s,r)<o&&au(r,t)<o){for(var a=function w6(n){for(var e=[0,0,0],t=0;t<n.length;t++)e[0]+=n[t][0],e[1]+=n[t][1],e[2]+=n[t][2];return e[0]/=n.length,e[1]/=n.length,e[2]/=n.length,e}([i,t,s,r]),c=[],l=0;l<n.width*n.height;l++){var u=au(a,[n.data[4*l],n.data[4*l+1],n.data[4*l+2]]);c[l]=u<o?0:255}return c}}(n,this.threshold());return t&&(t=function S6(n,e,t){for(var i=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(i.length)),s=Math.floor(r/2),o=[],a=0;a<t;a++)for(var c=0;c<e;c++){for(var l=a*e+c,u=0,h=0;h<r;h++)for(var d=0;d<r;d++){var p=a+h-s,f=c+d-s;p>=0&&p<t&&f>=0&&f<e&&(u+=n[p*e+f]*i[h*r+d])}o[l]=2040===u?255:0}return o}(t,n.width,n.height),t=function C6(n,e,t){for(var i=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(i.length)),s=Math.floor(r/2),o=[],a=0;a<t;a++)for(var c=0;c<e;c++){for(var l=a*e+c,u=0,h=0;h<r;h++)for(var d=0;d<r;d++){var p=a+h-s,f=c+d-s;p>=0&&p<t&&f>=0&&f<e&&(u+=n[p*e+f]*i[h*r+d])}o[l]=u>=1020?255:0}return o}(t,n.width,n.height),t=function D6(n,e,t){for(var i=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],r=Math.round(Math.sqrt(i.length)),s=Math.floor(r/2),o=[],a=0;a<t;a++)for(var c=0;c<e;c++){for(var l=a*e+c,u=0,h=0;h<r;h++)for(var d=0;d<r;d++){var p=a+h-s,f=c+d-s;p>=0&&p<t&&f>=0&&f<e&&(u+=n[p*e+f]*i[h*r+d])}o[l]=u}return o}(t,n.width,n.height),function b6(n,e){for(var t=0;t<n.width*n.height;t++)n.data[4*t+3]=e[t]}(n,t)),n},Noise:function(n){var s,e=255*this.noise(),t=n.data,i=t.length,r=e/2;for(s=0;s<i;s+=4)t[s+0]+=r-2*r*Math.random(),t[s+1]+=r-2*r*Math.random(),t[s+2]+=r-2*r*Math.random()},Pixelate:function(n){var r,s,o,a,c,l,u,p,f,m,v,C,I,L,e=Math.ceil(this.pixelSize()),t=n.width,i=n.height,h=Math.ceil(t/e),d=Math.ceil(i/e),H=n.data;if(e<=0)G.error("pixelSize value can not be <= 0");else for(C=0;C<h;C+=1)for(I=0;I<d;I+=1){for(a=0,c=0,l=0,u=0,f=(p=C*e)+e,v=(m=I*e)+e,L=0,r=p;r<f;r+=1)if(!(r>=t))for(s=m;s<v;s+=1)s>=i||(a+=H[0+(o=4*(t*s+r))],c+=H[o+1],l+=H[o+2],u+=H[o+3],L+=1);for(a/=L,c/=L,l/=L,u/=L,r=p;r<f;r+=1)if(!(r>=t))for(s=m;s<v;s+=1)s>=i||(H[0+(o=4*(t*s+r))]=a,H[o+1]=c,H[o+2]=l,H[o+3]=u)}},Posterize:function(n){var s,e=Math.round(254*this.levels())+1,t=n.data,i=t.length,r=255/e;for(s=0;s<i;s+=1)t[s]=Math.floor(t[s]/r)*r},RGB:function(n){var o,a,e=n.data,t=e.length,i=this.red(),r=this.green(),s=this.blue();for(o=0;o<t;o+=4)e[o]=(a=(.34*e[o]+.5*e[o+1]+.16*e[o+2])/255)*i,e[o+1]=a*r,e[o+2]=a*s,e[o+3]=e[o+3]},RGBA:function(n){var a,c,e=n.data,t=e.length,i=this.red(),r=this.green(),s=this.blue(),o=this.alpha();for(a=0;a<t;a+=4)e[a]=i*o+e[a]*(c=1-o),e[a+1]=r*o+e[a+1]*c,e[a+2]=s*o+e[a+2]*c},Sepia:function(n){var i,r,s,o,e=n.data,t=e.length;for(i=0;i<t;i+=4)r=e[i+0],s=e[i+1],o=e[i+2],e[i+0]=Math.min(255,.393*r+.769*s+.189*o),e[i+1]=Math.min(255,.349*r+.686*s+.168*o),e[i+2]=Math.min(255,.272*r+.534*s+.131*o)},Solarize:function(n){var e=n.data,t=n.width,r=4*t,s=n.height;do{var o=(s-1)*r,a=t;do{var c=o+4*(a-1),l=e[c],u=e[c+1],h=e[c+2];l>127&&(l=255-l),u>127&&(u=255-u),h>127&&(h=255-h),e[c]=l,e[c+1]=u,e[c+2]=h}while(--a)}while(--s)},Threshold:function(n){var r,e=255*this.threshold(),t=n.data,i=t.length;for(r=0;r<i;r+=1)t[r]=t[r]<e?0:255}}});var ae=function(n){return n.construction="construction",n.beam="beam",n.frame="frame",n.framePrimary="frame-primary",n.frameInner="frame-inner",n.frameTest="frame-test",n.frameTestPoint="frame-test-point",n.areas="areas",n.areasSkeleton="areas-skeleton",n.areasInner="areas-inner",n.drawingLine="drawingLine",n.drawingDashedLine="drawingDashedLine",n.drawingDimensionArrowLine="drawingDimensionArrowLine",n.drawingDimension="drawingDimension",n.dimension="dimension",n.activeMullions="active-mullions",n.activeMullionsPoint="active-mullions-point",n.activeCoreStroke="active-core-stroke",n.activeCorePoint="active-core-point",n.activeBeam="active-beam",n.activeBeamPoint="active-beam-point",n.mullionEdge="mullion-edge",n.createImpostPoint="createImpostPoint",n.mullions="mullions",n.activeWing="active-wing",n.activeFilling="active-filling",n.metrics="metrics",n.angularPoints="angularPoints",n.activeCustomSize="activeCustomSize",n.customSizePoints="customSizePoints",n.activeCustomSizePoint="activeCustomSizePoint",n.predictedCustomSize="predictedCustomSize",n}(ae||{});class k6{constructor(e){this._hammer=new Hammer(e),this.configureGestureConflicts()}configureGestureConflicts(){const e=this._hammer.get("pan"),t=this._hammer.get("pinch"),i=this._hammer.get("press");e.set({direction:Hammer.DIRECTION_ALL}),t.set({enable:!0}),i.set({time:400,threshold:5})}add(e,t){this._hammer.on(e,t)}off(e){this._hammer.off(e)}setEnableEvent(e,t){try{this._hammer.get(e).set({enable:t})}catch{console.error("\u0422\u0430\u043a\u043e\u0433\u043e \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u043d\u0435\u0442")}}}var cu=function(n){return n[n.Mobile=0]="Mobile",n[n.Desktop=1]="Desktop",n}(cu||{});class L6 extends v4{constructor(e,t,i,r,s=!0){super({tl:{x:0,y:0},rb:{x:r.getUnitsConfig().width,y:r.getUnitsConfig().height}},r),this.container=e,this.layers=[],this._lastZoomStep=1,this.onClick=new Ot,this.onDblClick=new Ot,this.onMouseMove=new Ot,this.onScale=new Ot,this.onDrag=new Ot,this.onChangeStageSize=new Ot,this.onPress=new Ot,this.onPressUp=new Ot,this.onTouchStart=new Ot,this.onTouchEnd=new Ot,this.stage=new iu({container:e,name:e,width:t,height:i,draggable:s}),this._hammer=new k6(this.stage.container()),this.defaultLayer=this.createLayer(e),this.gridLayer=this.createLayer("grid",{draggable:!1}),this.gridLayer.zIndex(0),this._deviceType="ontouchstart"in window?cu.Mobile:cu.Desktop,this.ucsLayer=this.createLayer("ucs",{draggable:!1}),this._unitScale=t/r.getUnitsConfig().width,this._stageScale=1,this.redraw(),this.preventDefaultEvents(),this.initEvents()}get stageName(){return this.stage.name()}getStageSize(){return{width:this.stage.width(),height:this.stage.height()}}resetPointer(){this.stage.container().style.cursor="default"}setStageSize(e){(e.width!==this.stage.width()||e.height!==this.stage.height())&&(this.stage.width(e.width),this.stage.height(e.height))}setDraggable(e){this.stage.draggable(e)}scale(e){const t=this.stage.scaleX(),i=this.stage.scaleY();return this.stage.scale({x:t*e,y:i*e}),!0}get stageSize(){return this.getStageSize()}set stageSize(e){this.setStageSize(e)}createLayer(e,t){const i=t?{...t,name:e}:{name:e},r=new Os(i);return this.stage.add(r),this.layers.push(r),r}findLayer(e){return this.layers.find(i=>i.attrs.name==e)}getOrCreateLayer(e){return e?this.stage.name()==e?this.defaultLayer:this.findLayer(e)||this.createLayer(e):this.defaultLayer}stageZoom(e){this.stage.draggable()&&(this._stageScale=this._stageScale*e,this._unitScale=this._unitScale*e,this.scale(e),this.setViewPort({tl:{x:this.viewPort.tl.x/e,y:this.viewPort.tl.y/e},rb:{x:this.viewPort.rb.x/e,y:this.viewPort.rb.y/e}},!0),this.onScale.next(e))}preventDefaultEvents(){this.stage.container().addEventListener("touchstart",e=>{e.preventDefault()})}initEvents(){switch(this._deviceType){case cu.Desktop:this.stage.on("click",e=>{this.onClick.next({x:this.viewPort.tl.x+e.evt.offsetX/this._unitScale,y:this.viewPort.tl.y+e.evt.offsetY/this._unitScale})}),this.stage.on("mousemove",e=>{e.evt&&this.onMouseMove.next({x:this.viewPort.tl.x+e.evt.offsetX/this._unitScale,y:this.viewPort.tl.y+e.evt.offsetY/this._unitScale})}),this.stage.on("wheel",e=>{e.evt&&1==e.evt.shiftKey&&this.stageZoom(e.evt.deltaY<0?1.1:.9090909090909091)});break;case cu.Mobile:this._hammer.add("pinchstart",e=>{this._lastZoomStep=1}),this._hammer.add("pinchmove",e=>{const t=e.scale/this._lastZoomStep;this._lastZoomStep=e.scale,this.stageZoom(t)}),this.stage.on("touchmove",e=>{this.emitTouchEvent("touchmove")}),this._hammer.add("tap panstart panend press pressup",e=>{this.emitTouchEvent(e.type)})}this.stage.dragBoundFunc(e=>(this.onDrag.next(e),{x:e.x,y:e.y})),this.onDrag.pipe(bM(200),function b4(n,e=!1){return Pn((t,i)=>{let r=0;t.subscribe(hn(i,s=>{const o=n(s,r++);(o||e)&&i.next(s),!o&&i.complete()}))})}(()=>this.stage.draggable())).subscribe(e=>{this.setViewPort({tl:{x:-e.x/this._unitScale,y:-e.y/this._unitScale},rb:{x:(-e.x+this.stage.width())/this._unitScale,y:(-e.y+this.stage.height())/this._unitScale}})})}emitTouchEvent(e){const t=this.getCurrentPointerPosition();if(t)switch(e){case"panstart":this.onTouchStart.next(t);break;case"panend":this.onTouchEnd.next(t);break;case"tap":this.onClick.next(t);break;case"touchmove":this.onMouseMove.next(t);break;case"press":this.onPress.next(t);break;case"pressup":this.onPressUp.next(t)}}getCurrentPointerPosition(){const e=this.stage.getPointerPosition();return e?{x:this.viewPort.tl.x+e.x/this._unitScale,y:this.viewPort.tl.y+e.y/this._unitScale}:null}getOnClick(){return this.onClick}getOnMouseMove(){return this.onMouseMove}getOnDblClick(){return this.onDblClick}getObjectById(e){return this.stage.findOne(`#${e}`)}showObject(e){return this.getObjectById(e).show(),!0}hideObject(e){return this.getObjectById(e).hide(),!0}deleteObject(e){const t=this.getObjectById(e);return t&&t.destroy(),!0}deleteObjects(e){return this.stage.find(`#${e}`).forEach(i=>{i.fire("destroy",i),i.destroy()}),!0}createGroup(e){return this.createGroupInt(e),!0}createGroupInt(e,t){const i=this.getOrCreateLayer(t),r=new rs(e?{id:e}:{id:Si()});return i.add(r),r}checkOrCreateGroup(e){return e?this.getObjectById(e)||this.createGroupInt(e):this.createGroupInt()}lineToKonvaPoints(e){return[e.p1.x,e.p1.y,e.p2.x,e.p2.y]}verticesToKonvaPoints(e){const t=[];return e.forEach(i=>{t.push(i.x),t.push(i.y)}),t}scalePoints(e){return e.map(t=>t*this._unitScale/this._stageScale)}scaleAndFlattenPolygonPoints(e){const t=e.points.reduce((i,r)=>(i.push(r.x,r.y),i),[]);return this.scalePoints(t)}createArcInt(e,t,i){const r=[e.radius,e.c.x,e.c.y],[s,o,a]=i?r:this.scalePoints(r);return new xr({x:o,y:a,innerRadius:s,outerRadius:s,rotation:180*e.startAngle/Math.PI,angle:180*e.angle/Math.PI,...t,strokeScaleEnabled:!1})}drawEdge(e,t,i,r){return"arc"===t.type?this.drawArc(e,t,i,r):this.drawLine(e,t,i,r)}drawLine(e,t,i,r){const s=this.lineToKonvaPoints(t),o={...this.guiConfig.getLineConfig(i),id:e},a=this.checkOrCreateGroup(r),c=this.createLineInt(s,o,i.notScale);return c.listening(!1),a.add(c),this.defaultLayer.add(a),!0}drawArc(e,t,i,r){const s={...this.guiConfig.getLineConfig(i),id:e},o=this.checkOrCreateGroup(r),a=this.createArcInt(t,s,i.notScale);return o.add(a),a.listening(!1),this.defaultLayer.add(o),!0}drawPolygon(e,t,i,r){const s=this.verticesToKonvaPoints(t),o={...this.guiConfig.getPolygonConfig(i),id:e},a=this.checkOrCreateGroup(r),c=this.createLineInt(s,o,i.notScale);return a.add(c),this.defaultLayer.add(a),!0}createLineInt(e,t,i){const r=i?e:this.scalePoints(e);return new An({points:r,...t,strokeScaleEnabled:!1})}drawPolygonByLines(e,t,i,r){const s={...this.guiConfig.getPolygonConfig(i),id:e,fill:i.color},o=this.checkOrCreateGroup(r),a=t.map(c=>"p1"in c?this.createLineInt([c.p1.x,c.p1.y,c.p2.x,c.p2.y],s,i.notScale):this.createArcInt(c,s,i.notScale));return o.add(...a),this.defaultLayer.add(o),!0}drawShapeEdge(e,t,i){if("s"in e){const r=[e.radius,e.c.x,e.c.y],[s,o,a]=this.scalePoints(r);let c,l,u=!1;e.customEnd.x===i.x&&e.customEnd.y===i.y?(c=e.startAngle,l=c+e.angle):(c=e.startAngle+e.angle,l=e.startAngle,u=!0),t.arc(o,a,s,c,l,u)}else{const[r,s]=this.scalePoints([e.p2.x,e.p2.y]);t.lineTo(r,s)}}drawFilledDivider(e,t,i){const r=this.checkOrCreateGroup(i),s=new Eo.Shape({sceneFunc:(o,a)=>{o.beginPath();const[c,l]=this.scalePoints([e.points?.[0]?.x,e.points?.[0]?.y]);o.moveTo(c,l),e.edgeArcs.forEach((u,h)=>{this.drawShapeEdge(u,o,e.points.at(h+1)||e.points[0])}),o.fillStrokeShape(a)},fill:"blue"});this.defaultLayer.add(s),r&&s&&r.add(s)}drawFilledPolygon(e,t,i,r){t.dividers.length&&this.drawFilledDivider(t.dividers[0].mullions[0],i,ae.mullions);const s=this.checkOrCreateGroup(r),o=new Eo.Shape({sceneFunc:(a,c)=>{a.beginPath();const[l,u]=this.scalePoints([t.points[0].x,t.points[0].y]);a.moveTo(l,u),t.edgeArcs.forEach((C,I)=>{this.drawShapeEdge(C,a,t.points.at(I+1)||t.points[0])});const h=[...t.innerPolygon.points.map(C=>new we(C.x,C.y,C.s))],d=h[h.length-1].s;for(let C=h.length-1;C>0;C--){const I=h[C-1].s;h[C].s=I?-I:0}h[0].s=d?-d:0;const p=new Gt(...h.reverse()),f=p.points[0],[m,v]=this.scalePoints([f.x,f.y]);a.moveTo(m,v),p.edgeArcs.forEach((C,I)=>{this.drawShapeEdge(C,a,h.at(I+1)||h[0])}),a.fillStrokeShape(c)},fill:i.color});return this.defaultLayer.add(o),s&&s.add(o),!0}drawBeam(e,t,i,r){const s={...this.guiConfig.getPolygonConfig(i),id:e},o=this.checkOrCreateGroup(r),a=new Eo.Shape({sceneFunc:(c,l)=>{c.beginPath();const[u,h]=this.scalePoints([t.vertices[0].x,t.vertices[0].y]);c.moveTo(u,h),t.edgeArcs.forEach((d,p)=>{this.drawShapeEdge(d,c,t.vertices.at(p+1)||t.vertices[0])}),c.fillStrokeShape(l)},...s,strokeScaleEnabled:!1});return this.defaultLayer.add(a),o&&(o.add(a),a.on("pointerover",()=>{this.stage.container().style.cursor="pointer"}),a.on("pointerout",()=>{this.stage.container().style.cursor="default"})),!0}drawPoint(e,t,i,r=!1,s,o){const a=this.scalePoints([t.x,t.y]);if(t=new we(a[0],a[1]),i.type===tn.CirclePoint){const c=this.guiConfig.getPointConfig(i),l=new K8(t,this.scalePoints([c.radius])[0]);this.drawCircle(e,l,c,r,s,o)}if(i.type===tn.RectPoint){const c=this.guiConfig.getPointConfig(i),l=new q8(t,c.width/this._unitScale,c.height/this._unitScale);this.drawRect(e,l,c,r,s,o)}}drawCircle(e,t,i,r=!1,s,o){const a=this.guiConfig.getPointConfig(i),c=this.checkOrCreateGroup(s),{x:l,y:u}=t.c,h=new mo({...a,id:e,x:l,y:u,radius:t.r/this._unitScale,strokeScaleEnabled:!1});this.defaultLayer.add(h);const d=new Ot;this.onScale.pipe(cv(d)).subscribe(p=>{h.radius(h.radius()/p)}),h.on("destroy",()=>{d.next(),d.complete()}),h.on("pointerover",()=>{this.stage.container().style.cursor="cross",r&&h.fill("rgba(0,196,255,0.6)")}),h.on("pointerout",()=>{this.stage.container().style.cursor="default",r&&h.fill(a.fill||"transparent")}),o&&h.on("click touchstart touchend",p=>{p.cancelBubble=!0,o()}),c&&h&&c.add(h)}drawRect(e,t,i,r=!1,s,o){const a=this.guiConfig.getPointConfig(i),c=this.checkOrCreateGroup(s),{p:l,w:u,h}=t,d=new Ja({id:e,...a,x:l.x,y:l.y,width:u,height:h,offsetX:u/2,offsetY:h/2,strokeScaleEnabled:!1});this.defaultLayer.add(d);const p=new Ot;this.onScale.pipe(cv(p)).subscribe(f=>{const m=d.width()/f,v=d.height()/f;d.width(m),d.height(v),d.offsetX(m/2),d.offsetY(v/2)}),d.on("destroy",()=>{p.next(),p.complete()}),d.on("pointerover",()=>{this.stage.container().style.cursor="crosshair",r&&d.fill("rgba(0,196,255,0.6)")}),d.on("pointerout",()=>{this.stage.container().style.cursor="default",r&&d.fill(a.fill||"transparent")}),o&&d.on("click touchstart touchend",f=>{f.cancelBubble=!0,o()}),c&&d&&c.add(d)}drawGrid(e){this.gridLayer.removeChildren();const t=this.guiConfig.getGridConfig();return null!=new GW(e,this._unitScale,this._stageScale,this.gridLayer,{minorStep:t.minorStep,majorStep:t.majorStep,minorLine:this.guiConfig.getLineConfig(t.minorLine),majorLine:this.guiConfig.getLineConfig(t.majorLine)})}drawUCS(e){const t=this.guiConfig.getUCSConfig(),i=this.guiConfig.getLineConfig(t.xAxis),r=this.guiConfig.getLineConfig(t.yAxis);return this.ucsLayer.removeChildren(),new HW(e,this.ucsLayer,{xLine:i,yLine:r,xLength:75,yLength:75}).scale(),!0}drawingDimensionArrowLine(e,t,i,r=!1,s,o){"arc"===t.type||this.drawCustomDimensionLine(e,t,i,s,r,o)}drawingDimension(e,t,i,r,s){this.drawEdge(e,new We(t.startPoint,t.line.p1),i,r),this.drawEdge(e,new We(t.endPoint,t.line.p2),i,r),this.drawingDimensionArrowLine(e,t.line,i,!1,r,s),this.drawLabel(e,t.label,i,r)}drawActiveCustomSize(e,t,i,r,s){this.drawingDimensionArrowLine(e,t.line,i,!1,r,s),this.drawEdge(e,new We(t.startPoint,t.line.p1),i,r),this.drawEdge(e,new We(t.endPoint,t.line.p2),i,r)}drawMetrics(e,t,i,r){return!0}drawVerticalSizeLine(e,t=100,i,r){const a=new Bi({points:this.scalePoints([e.p1.x+t,e.p1.y,e.p2.x+t,e.p2.y]),...i,strokeScaleEnabled:!1,pointerAtEnding:!0,pointerAtBeginning:!0,pointerLength:10,pointerWidth:5,fill:i.fillColor}),c=new An({points:this.scalePoints([e.p1.x+t+50,e.p1.y,e.p1.x+t-50,e.p1.y]),...i,strokeScaleEnabled:!1}),l=new An({points:this.scalePoints([e.p2.x+t+50,e.p2.y,e.p2.x+t-50,e.p2.y]),...i,strokeScaleEnabled:!1});this.defaultLayer.add(a,c,l),r&&a&&r.add(a)}drawHorizontalSizeLine(e,t=100,i,r){const a=new Bi({points:this.scalePoints([e.p1.x,e.p1.y+t,e.p2.x,e.p2.y+t]),...i,strokeScaleEnabled:!1,pointerAtEnding:!0,pointerAtBeginning:!0,pointerLength:10,pointerWidth:5,fill:i.fillColor}),c=new An({points:this.scalePoints([e.p1.x,e.p1.y+t+50,e.p1.x,e.p1.y+t-50]),...i,strokeScaleEnabled:!1}),l=new An({points:this.scalePoints([e.p2.x,e.p2.y+t+50,e.p2.x,e.p2.y+t-50]),...i,strokeScaleEnabled:!1});this.defaultLayer.add(a,c,l),r&&a&&r.add(a)}drawVerticalSizeInfo(e,t=100,i,r){const[s,o]=this.scalePoints([e.midpoint.x+t,e.midpoint.y]),a=new ec(i);a.add(new Eo.Tag({fill:"white",strokeScaleEnabled:!1,stroke:"grey",strokeWidth:.5}));const c=new Mt({text:String(Math.round(100*e.length)/100),padding:2,fontSize:14,fill:"black",strokeScaleEnabled:!1});a.position({x:s-c.textHeight/1.5,y:o+c.textWidth/2}),a.add(c),this.defaultLayer.add(a),r&&a&&r.add(a)}drawHorizontalSizeInfo(e,t=100,i,r){const[s,o]=this.scalePoints([e.midpoint.x,e.midpoint.y+t]),a=new ec(i);a.add(new Eo.Tag({fill:"white",strokeScaleEnabled:!1,stroke:"grey",strokeWidth:.5}));const c=new Mt({text:String(Math.round(100*e.length)/100),padding:2,fontSize:14,fill:"black",strokeScaleEnabled:!1});a.position({x:s-c.textWidth/2,y:o-c.textHeight/1.5}),a.add(c),this.defaultLayer.add(a),r&&a&&r.add(a)}drawCustomDimensionLine(e,t,i,r,s=!1,o){const a={...this.guiConfig.getLineConfig(i),id:e},c=this.checkOrCreateGroup(r),l=this.createLongLengthDimensionArrowLine(t,a);s||(c.on("pointerover",h=>{this.stage.container().style.cursor="pointer"}),c.on("pointerout",h=>{this.stage.container().style.cursor="default"}));const u=new Mt({text:String(Math.round(100*t.length)/100),padding:2,fontSize:14});u.getWidth()+30>l.getWidth()&&u.getWidth()>l.getHeight()&&(this.drawShortLengthDimension(t,a,c),l.pointerAtBeginning(!1),l.pointerAtEnding(!1),l.dashEnabled(!1)),s||l.on("click tap",h=>{o&&(h.cancelBubble=!0,o())}),this.defaultLayer.add(l),c.add(l),s&&c.listening(!1)}drawShortLengthDimension(e,t,i){const r=e.getVectorPointWithOffset(-e.length),s=new Bi({points:this.scalePoints([r.x,r.y,e.p1.x,e.p1.y]),...t,hitStrokeWidth:20,strokeScaleEnabled:!1,pointerAtEnding:!0,pointerAtBeginning:!1,pointerLength:10,pointerWidth:5,fill:t.fillColor,opacity:t.opacity}),o=e.getVectorPointWithOffset(e.length),a=new Bi({points:this.scalePoints([e.p2.x,e.p2.y,o.x,o.y]),...t,hitStrokeWidth:20,strokeScaleEnabled:!1,pointerAtEnding:!1,pointerAtBeginning:!0,pointerLength:10,pointerWidth:5,fill:t.fillColor,opacity:t.opacity});i.add(s,a)}createLongLengthDimensionArrowLine(e,t){return new Bi({points:this.scalePoints([e.p1.x,e.p1.y,e.p2.x,e.p2.y]),...t,lineJoin:"round",dash:[30,10],lineCap:"round",tension:.5,hitStrokeWidth:20,strokeScaleEnabled:!1,pointerAtEnding:!0,pointerAtBeginning:!0,pointerLength:10,pointerWidth:5,fill:t.fillColor,opacity:t.opacity})}drawLabel(e,t,i,r,s){const o={...this.guiConfig.getLineConfig(i),id:e},a=this.checkOrCreateGroup(r),[c,l]=this.scalePoints([t.position.x,t.position.y]),u=new ec({}),h=new Eo.Tag({fill:"white",strokeScaleEnabled:!1,stroke:"gray",strokeWidth:.5,opacity:o.opacity});u.add(h);const d=new Mt({text:t.text,padding:2,fontSize:14,fill:"black",strokeScaleEnabled:!1,opacity:o.opacity});t.changeSize(d.getWidth(),d.getHeight()),u.position({x:c-t.width/2,y:l-t.height/2}),s&&u.on("click touchstart touchend",p=>{p.cancelBubble=!0,s()}),u.add(d),a.add(u),this.defaultLayer.add(a)}drawWing(e,t,i,r){const s={...this.guiConfig.getLineConfig(i),id:e},o=this.checkOrCreateGroup(r),a=t.edges.map(m=>we.distance(m.midpoint,t.centroid)).sort()[0],c=a>100?100:a,{x:l,y:u}=t.centroid,h=this.verticesToKonvaPoints([new we(l,u+c),new we(l,u-c)]),d=this.verticesToKonvaPoints([new we(l-c,u),new we(l+c,u)]),p=this.createLineInt(h,s,i.notScale),f=this.createLineInt(d,s,i.notScale);o.add(p,f),this.defaultLayer.add(o)}drawSkeleton(e,t,i,r){const s={...this.guiConfig.getLineConfig(i),id:e},o=this.checkOrCreateGroup(r);let a;if("arc"===t.type)a=this.createArcInt(t,s);else{const{p1:c,p2:l}=t;a=this.createLineInt([c.x,c.y,l.x,l.y],s)}o.add(a),o.on("pointerover",()=>{this.stage.container().style.cursor="pointer"}),o.on("pointerout",()=>{this.stage.container().style.cursor="default"}),a.on("click tap",c=>{c.cancelBubble=!0,this.onClick.next(t.intermediatePoint)}),this.defaultLayer.add(o)}}function Cx(){return Eo.Util.getRandomColor()}class F6{getLineConfig(e){switch(e.line){case nt.PolygonLine:return{stroke:"blue",strokeWidth:1.5};case nt.SimpleLine:case nt.FrameBeamLine:return{stroke:"red",strokeWidth:1.5};case nt.GripsLine:return{stroke:"blue",strokeWidth:1};case nt.GridMinorLine:return{stroke:"#ebf0ec",strokeWidth:1};case nt.GridMajorLine:return{stroke:"lightgrey",strokeWidth:1};case nt.UCSAxisLine:return{stroke:"black",strokeWidth:1};case nt.DummyLine:return{stroke:"gray",strokeWidth:1.5};case nt.DimensionLine:return{stroke:"green",strokeWidth:1.5};case nt.RandomLine:{const t=e.color||Cx();return{fill:t,stroke:t,strokeWidth:0}}case nt.CustomLine:return{fillColor:e.fillColor,stroke:e.color?e.color:"black",strokeWidth:e.strokeWidth?e.strokeWidth:1,...e};case nt.DashedLine:return{stroke:e.color?e.color:"black",strokeWidth:e.strokeWidth?e.strokeWidth:1,...e}}}getPointConfig(e){switch(e.type){case tn.CirclePoint:{const t=e.radius||20;return{...e,fill:e.fill||"black",radius:t}}case tn.RectPoint:{const t=e.width||20,i=e.height||t;return{...e,fill:e.fill||"black",width:t,height:i}}}}getPolygonConfig(e){const t=this.getLineConfig(e),i=e.fill?t.stroke:t.fillColor;return{...t,closed:!0,fill:i}}getFrameConfig(){return{beam:{mark:!0,line:nt.FrameBeamLine,fill:!1},grips:{frame:{line:nt.GripsLine},center:{type:"rectangle",fill:!0,width:36,height:12},vertex:{type:"square",fill:!0,size:24}},offset:75}}getGridConfig(){return{minorStep:100,majorStep:5,minorLine:{line:nt.GridMinorLine},majorLine:{line:nt.GridMajorLine}}}getDefaultStageConfig(){return{width:5e3,height:4e3}}getUCSConfig(){return{origin:{x:0,y:0},xAxisText:"X",yAxisText:"Y",xAxis:{line:nt.UCSAxisLine},yAxis:{line:nt.UCSAxisLine}}}getUnitsConfig(){return{width:5e3,height:3e3}}}Cx();const je_WIDTH=2,je_MIDDLE_POINT_WIDTH=5,je_MIDDLE_POINT_HEIGHT=1,je_STROKE="rgb(0,0,0)",je_STROKE_WIDTH=2,je_COLOR="rgb(0,196,255)",je_RADIUS=10,je_HIT_SIZE=20,Dx=()=>{};class nc{static getActiveMullionsItem(e,t=0){return`${ae.activeMullions}-${e}.${t}`}static getMullionEdgeItem(e,t=0){return`${ae.mullionEdge}-${e}.${t}`}static getBeamItem(e,t=0){return`${ae.beam}-${e}.${t}`}}class Tx{constructor(e,t){this.type=e,this.gui=t}drawActiveImpostPoints(e){Ce.getPointsOfEdge(e.edge).forEach(t=>{this.gui.drawPoint(ae.activeMullions,t,{type:tn.RectPoint,fill:je_COLOR,width:je_WIDTH,hitStrokeWidth:je_HIT_SIZE},!1,ae.activeMullions)}),this.gui.drawPoint(ae.activeMullions,Ce.getEdgeCenter(e.edge),{type:tn.RectPoint,fill:je_COLOR,width:je_MIDDLE_POINT_WIDTH,height:je_MIDDLE_POINT_HEIGHT,rotation:e.edge.angleDeg,hitStrokeWidth:je_HIT_SIZE},!1,ae.activeMullions)}drawFrameEdge(e,t=je_RADIUS){this.gui.drawEdge(ae.frame,e,{line:nt.CustomLine,strokeWidth:3},ae.frame)}drawDimension(e,t){e.forEach(i=>{this.gui.drawingDimension(i.id,i,{line:nt.CustomLine,fillColor:"green"},ae.dimension,()=>t(i.id))})}drawPredictedCustomSize(e){this.gui.drawingDimension(e.id,e,{line:nt.CustomLine,color:"rgb(255,127,39)",strokeWidth:3,opacity:1},ae.predictedCustomSize)}drawActiveDimension(e,t,i,r){this.gui.drawActiveCustomSize(e.id,e,{line:nt.CustomLine,color:"green",strokeWidth:3,opacity:.7},ae.activeCustomSize,()=>t(e.id)),e.baseLinePoints.forEach(s=>{this.gui.drawPoint(ae.customSizePoints,s,{type:tn.RectPoint,fill:je_COLOR,width:je_WIDTH,stroke:je_STROKE,strokeWidth:je_STROKE_WIDTH,hitStrokeWidth:je_HIT_SIZE},!1,ae.customSizePoints,()=>r(s))}),e.points.forEach(s=>{this.gui.drawPoint(ae.customSizePoints,s,{type:tn.RectPoint,fill:je_COLOR,width:je_WIDTH,stroke:je_STROKE,strokeWidth:je_STROKE_WIDTH,hitStrokeWidth:je_HIT_SIZE},!1,ae.customSizePoints,()=>i(s))}),this.gui.drawLabel(e.id,e.label,{line:nt.CustomLine,color:"green",strokeWidth:3,opacity:.7},ae.activeCustomSize,()=>r(e.label.position))}drawCustomSizeActivePoint(e){this.gui.drawPoint(ae.activeCustomSizePoint,e,{type:tn.RectPoint,fill:"green",width:je_WIDTH,stroke:je_STROKE,strokeWidth:je_STROKE_WIDTH,hitStrokeWidth:je_HIT_SIZE},!1,ae.activeCustomSizePoint)}clearActiveCustomSize(){this.gui.deleteObjects(ae.activeCustomSize),this.gui.deleteObjects(ae.customSizePoints)}clearTestPoints(){this.gui.deleteObjects(ae.frameTestPoint)}clearActiveCustomSizePoint(){this.gui.deleteObjects(ae.activeCustomSizePoint)}clearPredictedCustomSizePoint(){this.gui.deleteObjects(ae.predictedCustomSize)}clearAngularPoints(){this.gui.deleteObjects(ae.angularPoints)}clearAllDividers(){this.gui.deleteObjects(ae.mullionEdge),this.gui.deleteObjects(ae.mullions)}clearDrawingLine(){this.gui.deleteObjects(ae.drawingLine)}clearDrawingImpost(){this.gui.deleteObject(ae.createImpostPoint),this.gui.deleteObjects(ae.drawingLine)}clearDrawingDashedLine(){this.gui.deleteObjects(ae.drawingDashedLine)}clearDrawingDimensionArrowLine(){this.gui.deleteObjects(ae.drawingDimensionArrowLine)}clearDrawingDimension(){this.gui.deleteObjects(ae.drawingDimension)}clearDimensions(){this.gui.deleteObjects(ae.dimension)}clearAreas(){this.gui.deleteObjects(ae.areas),this.gui.deleteObjects(ae.beam)}clearFrames(){this.gui.deleteObjects(ae.frame)}clearFramesTest(){this.gui.deleteObjects(ae.frameTest)}clearActiveImposts(){this.gui.deleteObjects(ae.activeMullions),this.gui.deleteObjects(ae.activeMullionsPoint)}clearActiveCoreStroke(){this.gui.deleteObjects(ae.activeCoreStroke),this.gui.deleteObjects(ae.activeCorePoint)}clearActiveWing(){this.gui.deleteObjects(ae.activeWing)}clearActiveFilling(){this.gui.deleteObjects(ae.activeFilling)}clearActiveBeam(){this.gui.deleteObjects(ae.activeBeam),this.gui.deleteObjects(ae.activeBeamPoint)}clearMetrics(){this.gui.deleteObjects(ae.metrics)}updateDrawingLine(e){this.gui.deleteObjects(ae.drawingLine),this.gui.drawEdge(ae.drawingLine,e,{line:nt.GripsLine})}updateDrawingDashedLine(e){this.gui.deleteObjects(ae.drawingDashedLine),this.gui.drawLine(ae.drawingDashedLine,e,{line:nt.DashedLine,dash:[25,10],strokeWidth:2,opacity:.4},ae.drawingDashedLine)}updateDrawingAngleEdgeLine(e){this.gui.deleteObjects(ae.drawingLine),e.forEach(t=>{this.gui.drawEdge(ae.drawingLine,t,{line:nt.CustomLine,color:"rgb(255,127,39)",strokeWidth:3,opacity:.6},ae.drawingLine)})}updateDrawingDimensionArrowLine(e,t){this.clearDrawingDimensionArrowLine(),this.gui.drawingDimensionArrowLine(ae.drawingDimensionArrowLine,e,{fillColor:"gray",line:nt.CustomLine,opacity:.6},!0,ae.drawingDimensionArrowLine),this.gui.drawLabel(ae.drawingDimensionArrowLine,t,{fillColor:"gray",line:nt.CustomLine,opacity:.6},ae.drawingDimensionArrowLine)}updateDrawingCustomDimension(e){this.clearDrawingDimension(),this.gui.drawingDimension(e.id,e,{fillColor:"gray",line:nt.CustomLine,opacity:.7},ae.drawingDimension)}updateDrawingPredictedCustomDimension(e){this.clearPredictedCustomSizePoint(),this.drawPredictedCustomSize(e)}updateFrameTestEdge(e,t){this.gui.deleteObjects(ae.frameTest),this.gui.drawEdge(ae.frameTest,e,{line:nt.CustomLine,color:"gray",strokeWidth:3},ae.frameTest),t&&this.gui.drawPoint(ae.frameTest,Ce.getSecondEdgePoint(e),{type:tn.CirclePoint,fill:"rgb(0,196,255)",radius:je_RADIUS,hitStrokeWidth:je_HIT_SIZE},!1,ae.frameTest)}updateActiveMullionsPoint(e){this.clearActiveImposts(),this.gui.drawPoint(ae.activeMullionsPoint,e,{type:tn.RectPoint,fill:je_COLOR,width:je_WIDTH,stroke:je_STROKE,strokeWidth:je_STROKE_WIDTH,hitStrokeWidth:je_HIT_SIZE},!1,ae.activeMullionsPoint)}updateActiveCorePoint(e){this.gui.deleteObjects(ae.activeCorePoint),this.gui.drawPoint(ae.activeCorePoint,e,{type:tn.RectPoint,fill:je_COLOR,width:je_WIDTH,stroke:je_STROKE,strokeWidth:je_STROKE_WIDTH,hitStrokeWidth:je_HIT_SIZE},!1,ae.activeCorePoint)}}class B6 extends Tx{constructor(e,t){super(e,t)}drawActiveImpost(e){e&&(e.mullions.forEach((t,i)=>{this.gui.drawPolygonByLines(nc.getActiveMullionsItem(e.id,i),t.edgeArcs,{line:nt.CustomLine,color:"green",fill:!0,strokeWidth:5},ae.activeMullions)}),this.drawActiveImpostPoints(e))}drawActiveBeam(e){this.gui.drawBeam(ae.activeBeam,e,{line:nt.CustomLine,color:"green",fill:!0},ae.activeBeam)}drawActiveCoreStroke(e){e.beams.forEach(t=>{this.gui.drawBeam(ae.activeCoreStroke,t,{line:nt.CustomLine,color:"green",fill:!0},ae.activeCoreStroke)}),e.points.forEach(t=>{this.gui.drawPoint(ae.activeCorePoint,t,{type:tn.RectPoint,fill:je_COLOR,width:je_WIDTH,hitStrokeWidth:je_HIT_SIZE},!1,ae.activeCorePoint)}),e.edgeArcs.forEach(t=>{const i=Ce.getEdgeCenter(t);this.gui.drawPoint(ae.activeCorePoint,i,{type:tn.RectPoint,fill:je_COLOR,width:je_MIDDLE_POINT_WIDTH,height:je_MIDDLE_POINT_HEIGHT,rotation:t.angleDeg,hitStrokeWidth:je_HIT_SIZE},!1,ae.activeCorePoint)})}drawActiveWing(e){e.beams.forEach(t=>{this.gui.drawBeam(ae.activeWing,t,{line:nt.CustomLine,color:"green",fill:!0},ae.activeWing)}),e.points.forEach(t=>{this.gui.drawPoint(ae.activeWing,t,{type:tn.RectPoint,fill:je_COLOR,width:je_WIDTH,hitStrokeWidth:je_HIT_SIZE},!1,ae.activeWing)}),e.edgeArcs.forEach(t=>{const i=Ce.getEdgeCenter(t);this.gui.drawPoint(ae.activeWing,i,{type:tn.RectPoint,fill:je_COLOR,width:je_MIDDLE_POINT_WIDTH,height:je_MIDDLE_POINT_HEIGHT,rotation:t.angleDeg,hitStrokeWidth:je_HIT_SIZE},!1,ae.activeWing)})}drawActiveFilling(e){e.beams.forEach(t=>{this.gui.drawBeam(ae.activeFilling,t,{line:nt.CustomLine,color:"green",fill:!0},ae.activeFilling)})}drawConstruction(e){e.areas.forEach(t=>{this.drawAreaDividers(t),this.drawConvertedArea(t)})}drawConvertedArea(e){e.beams.forEach((t,i)=>{this.gui.drawBeam(nc.getBeamItem(t.id,i),t,{line:nt.CustomLine,strokeWidth:.5,fillColor:e.fillColor},ae.beam)}),e.areas.forEach(t=>{this.drawConvertedArea(t)})}drawAreaDivider(e){this.gui.drawBeam(nc.getMullionEdgeItem(e.id),e.beam,{line:nt.CustomLine,strokeWidth:.5,fillColor:e.mullions[0].fillColor},ae.mullionEdge)}drawAreaDividers(e){e.dividers.forEach(t=>{this.drawAreaDivider(t)}),e.areas.forEach(t=>{this.drawAreaDividers(t)})}drawAngularPoint({points:e,hiddenPoints:t,handleClick:i}){e.forEach(r=>{this.gui.drawPoint(ae.angularPoints,r,{type:tn.RectPoint,fill:je_COLOR,width:je_WIDTH},!1,ae.angularPoints,i&&(()=>i(r)))}),t&&t.forEach(r=>{this.gui.drawPoint(ae.angularPoints,r,{type:tn.RectPoint,fill:"transparent",width:je_WIDTH},!0,ae.angularPoints,i&&(()=>i(r)))})}}class j6 extends Tx{constructor(e,t){super(e,t),this.drawActiveWing=Dx,this.drawActiveFilling=Dx}drawActiveImpost(e){e&&(this.gui.drawEdge(nc.getActiveMullionsItem(e.id),e.edge,{line:nt.CustomLine,color:"green",strokeWidth:5},ae.activeMullions),this.drawActiveImpostPoints(e))}drawActiveBeam(e){this.gui.drawSkeleton(ae.activeBeam,e.edge,{line:nt.CustomLine,color:"green",strokeWidth:5,hitStrokeWidth:25},ae.activeBeam)}drawActiveCoreStroke(e){e.edgeArcs.forEach(t=>{const i=Ce.getEdgeCenter(t);this.gui.drawEdge(ae.activeCoreStroke,t,{line:nt.CustomLine,color:"green",strokeWidth:3},ae.activeCoreStroke),this.gui.drawPoint(ae.activeCorePoint,i,{type:tn.RectPoint,fill:je_COLOR,width:je_MIDDLE_POINT_WIDTH,height:je_MIDDLE_POINT_HEIGHT,rotation:t.angleDeg,hitStrokeWidth:je_HIT_SIZE},!1,ae.activeCorePoint)}),e.points.forEach(t=>{this.gui.drawPoint(ae.activeCorePoint,t,{type:tn.RectPoint,fill:je_COLOR,width:je_WIDTH,hitStrokeWidth:je_HIT_SIZE},!1,ae.activeCorePoint)})}drawConstruction(e){e.areas.forEach(t=>{this.drawAreaDividers(t),this.drawConvertedArea(t)})}drawConvertedArea(e){e.type===un.FRAME&&e.beams.forEach((t,i)=>{this.gui.drawSkeleton(nc.getBeamItem(t.id,i),t.edge,{line:nt.CustomLine,fillColor:e.fillColor,hitStrokeWidth:25},ae.beam)}),e.areas.forEach(t=>{this.drawConvertedArea(t)})}drawAreaDivider(e){this.gui.drawSkeleton(nc.getMullionEdgeItem(e.id),e.edge,{line:nt.CustomLine,hitStrokeWidth:25},ae.mullionEdge)}drawAreaDividers(e){e.dividers.forEach(t=>{this.drawAreaDivider(t)}),e.areas.forEach(t=>{this.drawAreaDividers(t)})}drawAngularPoint({points:e,handleClick:i}){e.forEach(r=>{this.gui.drawPoint(ae.angularPoints,r,{type:tn.RectPoint,fill:je_COLOR,width:je_WIDTH},!1,ae.angularPoints,i&&(()=>i(r)))})}}var Or=function(n){return n.SOLID="SOLID",n.WIRE="WIRE",n}(Or||{});const V6={[Or.SOLID]:n=>new B6(Or.SOLID,n),[Or.WIRE]:n=>new j6(Or.WIRE,n)};let Ix=(()=>{class n{constructor(){this.gui=null,this.onCreateGui=new Ot}createGui(t,i={width:1e3,height:1e3}){this.gui=new L6(t,i.width,i.height,new F6),this.onCreateGui.next(this.gui)}changeSize(t){this.gui?.setStageSize({width:t.width,height:t.height})}setDraggable(t){this.gui?.setDraggable(t)}clearGui(){this.gui=null}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();window;const z6={constructions:[],selectedConstructionId:null,selected:{owspModel:null,componentTree:null,coreAreaModel:null,selectedComponentId:null,selectedComponentNode:null,loadingComponentTree:!1,loadingCoreArea:!1},statusbarMode:[],toolbarMode:As.DEFAULT};function lu(n){return Pn((e,t)=>{let s,i=null,r=!1;i=e.subscribe(hn(t,void 0,void 0,o=>{s=Tr(n(o,lu(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function Z6(n,e){return n===e}function uu(n){n||(xc(),n=be(Ji));const e=new sn(t=>n.onDestroy(t.next.bind(t)));return t=>t.pipe(cv(e))}new class G6 extends EM{}(class H6 extends wM{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!=i&&i>0||null==i&&this.delay>0?super.requestAsyncId(e,t,i):(e.flush(this),0)}});const hu={};function Mx(n,e){if(hu[n]=(hu[n]||0)+1,"function"==typeof e)return Nv(n,(...i)=>({...e(...i),type:n}));switch(e?e._as:"empty"){case"empty":return Nv(n,()=>({type:n}));case"props":return Nv(n,i=>({...i,type:n}));default:throw new Error("Unexpected config.")}}function Nv(n,e){return Object.defineProperty(e,"type",{value:n,writable:!1})}function kv(n){return n.charAt(0).toUpperCase()+n.substring(1)}function xx(n){const{source:e,events:t}=n;return Object.keys(t).reduce((i,r)=>({...i,[i9(r)]:Mx(r9(e,r),t[r])}),{})}function i9(n){return n.trim().split(" ").map((e,t)=>0===t?function t9(n){return n.charAt(0).toLowerCase()+n.substring(1)}(e):kv(e)).join("")}function r9(n,e){return`[${n}] ${e}`}let ic=(()=>{class n extends Hi{constructor(){super({type:"@ngrx/store/init"})}next(t){if("function"==typeof t)throw new TypeError("\n        Dispatch expected an object, instead it received a function.\n        If you're using the createAction function, make sure to invoke the function\n        before dispatching the action. For example, someAction should be someAction().");if(typeof t>"u")throw new TypeError("Actions must be objects");if(typeof t.type>"u")throw new TypeError("Actions must have a type property");super.next(t)}complete(){}ngOnDestroy(){super.complete()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac})}}return n})();new ye("@ngrx/store Internal Root Guard"),new ye("@ngrx/store Internal Initial State");const Lv=new ye("@ngrx/store Initial State"),Nx=new ye("@ngrx/store Reducer Factory"),Lx=(new ye("@ngrx/store Internal Reducer Factory Provider"),new ye("@ngrx/store Initial Reducers"));function Kx(...n){return function(e){if(0===n.length)return e;const t=n[n.length-1];return n.slice(0,-1).reduceRight((r,s)=>s(r),t(e))}}new ye("@ngrx/store Internal Initial Reducers"),new ye("@ngrx/store Store Features"),new ye("@ngrx/store Internal Store Reducers"),new ye("@ngrx/store Internal Feature Reducers"),new ye("@ngrx/store Internal Feature Configs"),new ye("@ngrx/store Internal Store Features"),new ye("@ngrx/store Internal Feature Reducers Token"),new ye("@ngrx/store Feature Reducers"),new ye("@ngrx/store User Provided Meta Reducers"),new ye("@ngrx/store Meta Reducers"),new ye("@ngrx/store Internal Resolved Meta Reducers"),new ye("@ngrx/store User Runtime Checks Config"),new ye("@ngrx/store Internal User Runtime Checks Config"),new ye("@ngrx/store Internal Runtime Checks"),new ye("@ngrx/store Check if Action types are unique"),new ye("@ngrx/store Root Store Provider"),new ye("@ngrx/store Feature State Provider");class Xx extends ic{}let Ff=(()=>{class n extends Hi{get currentReducers(){return this.reducers}constructor(t,i,r,s){super(s(r,i)),this.dispatcher=t,this.initialState=i,this.reducers=r,this.reducerFactory=s}addFeature(t){this.addFeatures([t])}addFeatures(t){const i=t.reduce((r,{reducers:s,reducerFactory:o,metaReducers:a,initialState:c,key:l})=>{const u="function"==typeof s?function a9(n){const e=Array.isArray(n)&&n.length>0?Kx(...n):t=>t;return(t,i)=>(t=e(t),(r,s)=>t(r=void 0===r?i:r,s))}(a)(s,c):function Yx(n,e){return Array.isArray(e)&&e.length>0&&(n=Kx.apply(null,[...e,n])),(t,i)=>{const r=n(t);return(s,o)=>r(s=void 0===s?i:s,o)}}(o,a)(s,c);return r[l]=u,r},{});this.addReducers(i)}removeFeature(t){this.removeFeatures([t])}removeFeatures(t){this.removeReducers(t.map(i=>i.key))}addReducer(t,i){this.addReducers({[t]:i})}addReducers(t){this.reducers={...this.reducers,...t},this.updateReducers(Object.keys(t))}removeReducer(t){this.removeReducers([t])}removeReducers(t){t.forEach(i=>{this.reducers=function o9(n,e){return Object.keys(n).filter(t=>t!==e).reduce((t,i)=>Object.assign(t,{[i]:n[i]}),{})}(this.reducers,i)}),this.updateReducers(t)}updateReducers(t){this.next(this.reducerFactory(this.reducers,this.initialState)),this.dispatcher.next({type:"@ngrx/store/update-reducers",features:t})}ngOnDestroy(){this.complete()}static{this.\u0275fac=function(i){return new(i||n)(Le(Xx),Le(Lv),Le(Lx),Le(Nx))}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac})}}return n})();class Zx extends sn{}let fu=(()=>{class n extends sn{constructor(t,i,r){super(),this.actionsObserver=i,this.reducerManager=r,this.source=t,this.state=t.state}select(t,...i){return Hv.call(null,t,...i)(this)}selectSignal(t,i){return Ts(()=>t(this.state()),i)}lift(t){const i=new n(this,this.actionsObserver,this.reducerManager);return i.operator=t,i}dispatch(t){this.actionsObserver.next(t)}next(t){this.actionsObserver.next(t)}error(t){this.actionsObserver.error(t)}complete(){this.actionsObserver.complete()}addReducer(t,i){this.reducerManager.addReducer(t,i)}removeReducer(t){this.reducerManager.removeReducer(t)}static{this.\u0275fac=function(i){return new(i||n)(Le(Zx),Le(ic),Le(Ff))}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac})}}return n})();function Hv(n,e,...t){return function(r){let s;if("string"==typeof n){const o=[e,...t].filter(Boolean);s=r.pipe(function Y6(...n){const e=n.length;if(0===e)throw new Error("list of properties cannot be empty.");return ii(t=>{let i=t;for(let r=0;r<e;r++){const s=i?.[n[r]];if(!(typeof s<"u"))return;i=s}return i})}(n,...o))}else{if("function"!=typeof n)throw new TypeError(`Unexpected type '${typeof n}' in select operator, expected 'string' or 'function'`);s=r.pipe(ii(o=>n(o,e)))}return s.pipe(function X6(n,e=kr){return n=n??Z6,Pn((t,i)=>{let r,s=!0;t.subscribe(hn(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}())}}function iP(n){if(!function m9(n){return function nP(n){return"object"==typeof n&&null!==n}(n)&&!function tP(n){return Array.isArray(n)}(n)}(n))return!1;const e=Object.getPrototypeOf(n);return e===Object.prototype||null===e}function Wv(n,e){return n===e}function qv(n,e=Wv,t=Wv){let s,i=null,r=null;return{memoized:function l(){if(void 0!==s)return s.result;if(!i)return r=n.apply(null,arguments),i=arguments,r;if(!function E9(n,e,t){for(let i=0;i<n.length;i++)if(!t(n[i],e[i]))return!0;return!1}(arguments,i,e))return r;const u=n.apply(null,arguments);return i=arguments,t(r,u)?r:(r=u,u)},reset:function o(){i=null,r=null},setResult:function a(u=void 0){s={result:u}},clearResult:function c(){s=void 0}}}function Vi(...n){return function S9(n,e={stateFn:b9}){return function(...t){let i=t;if(Array.isArray(i[0])){const[u,...h]=i;i=[...u,...h]}else 1===i.length&&function D9(n){return!!n&&"object"==typeof n&&Object.values(n).every(e=>"function"==typeof e)}(i[0])&&(i=function T9(n){const e=Object.values(n),t=Object.keys(n);return[...e,(...r)=>t.reduce((s,o,a)=>({...s,[o]:r[a]}),{})]}(i[0]));const r=i.slice(0,i.length-1),s=i[i.length-1],o=r.filter(u=>u.release&&"function"==typeof u.release),a=n(function(...u){return s.apply(null,u)}),c=qv(function(u,h){return e.stateFn.apply(null,[u,r,h,a])});return Object.assign(c.memoized,{release:function l(){c.reset(),a.reset(),o.forEach(u=>u.release())},projector:a.memoized,setResult:c.setResult,clearResult:c.clearResult})}}(qv)(...n)}function b9(n,e,t,i){if(void 0===t){const s=e.map(o=>o(n));return i.memoized.apply(null,s)}const r=e.map(s=>s(n,t));return i.memoized.apply(null,[...r,t])}function sP(n){const{name:e,reducer:t,extraSelectors:i}=n,r=function C9(n){return Vi(e=>e[n],e=>e)}(e),s=function I9(n,e){const t=function A9(n){return n(void 0,{type:"@ngrx/feature/init"})}(e);return(iP(t)?Object.keys(t):[]).reduce((r,s)=>({...r,[`select${kv(s)}`]:Vi(n,o=>o?.[s])}),{})}(r,t),o={[`select${kv(e)}State`]:r,...s},a=i?i(o):{};return{name:e,reducer:t,...o,...a}}function Mn(...n){return{reducer:n.pop(),types:n.map(i=>i.type)}}function lP(n,...e){const t=new Map;for(const i of e)for(const r of i.types){const s=t.get(r);t.set(r,s?(a,c)=>i.reducer(s(a,c),c):i.reducer)}return function(i=n,r){const s=t.get(r.type);return s?s(i,r):i}}function hP(n,e,t=10){return n.pipe(lu(i=>(e&&e.handleError(i),t<=1?n:hP(n,e,t-1))))}new ye("@ngrx/effects Internal Root Guard"),new ye("@ngrx/effects User Provided Effects"),new ye("@ngrx/effects Internal Root Effects"),new ye("@ngrx/effects Internal Root Effects Instances"),new ye("@ngrx/effects Internal Feature Effects"),new ye("@ngrx/effects Internal Feature Effects Instance Groups"),new ye("@ngrx/effects Effects Error Handler",{providedIn:"root",factory:()=>hP}),Mx("@ngrx/effects/init");const mt=xx({source:"Configurator",events:{loadOwspSuccess:{_as:"props",_p:void 0},loadOwspError:{_as:"props",_p:void 0},loadOwsp:{_as:"props",_p:void 0},convertOwspToCoreArea:{_as:"props",_p:void 0},convertOwspToCoreAreaSuccess:{_as:"props",_p:void 0},convertOwspToCoreAreaError:{_as:"props",_p:void 0},convertCoreAreaToComponentTree:{_as:"props",_p:void 0},convertCoreAreaToComponentTreeSuccess:{_as:"props",_p:void 0},convertCoreAreaToComponentTreeError:{_as:"props",_p:void 0},selectComponentId:{_as:"props",_p:void 0},selectComponentTreeNode:{_as:"props",_p:void 0},updateTreeElement:{_as:"props",_p:void 0},addTreeNodeElement:{_as:"props",_p:void 0},addConstructionElement:{_as:"props",_p:void 0},removeConstructionElement:{_as:"props",_p:void 0},makeWingElement:{_as:"props",_p:void 0},addConstruction:{_as:"props",_p:void 0},selectConstruction:{_as:"props",_p:void 0},removeConstruction:{_as:"props",_p:void 0},saveEditedConstruction:{_as:"props",_p:void 0},exportConstruction:{_as:"props",_p:void 0},selectStatusbarMode:{_as:"props",_p:void 0},unselectStatusbarMode:{_as:"props",_p:void 0},setToolbarMode:{_as:"props",_p:void 0}}});const yP=sP({name:"configurator",reducer:lP(z6,Mn(mt.loadOwsp,n=>({...n})),Mn(mt.loadOwspSuccess,(n,{data:e})=>({...n,selected:{...n.selected,owspModel:e}})),Mn(mt.loadOwspError,(n,{})=>({...n})),Mn(mt.convertOwspToCoreArea,n=>({...n,selected:{...n.selected,loadingCoreArea:!0}})),Mn(mt.convertOwspToCoreAreaSuccess,(n,{data:e})=>({...n,constructions:[...n.constructions,e],selected:{...n.selected,loadingCoreArea:!1,coreAreaModel:e}})),Mn(mt.convertOwspToCoreAreaError,(n,{})=>({...n,selected:{...n.selected,loadingCoreArea:!1}})),Mn(mt.convertCoreAreaToComponentTree,(n,{})=>({...n,selected:{...n.selected,loadingComponentTree:!0}})),Mn(mt.convertCoreAreaToComponentTreeSuccess,(n,{data:e})=>({...n,selected:{...n.selected,loadingComponentTree:!1,componentTree:e}})),Mn(mt.convertCoreAreaToComponentTreeError,(n,{})=>({...n,selected:{...n.selected,loadingComponentTree:!1}})),Mn(mt.selectComponentId,(n,{id:e})=>({...n,selected:{...n.selected,selectedComponentId:e}})),Mn(mt.selectConstruction,(n,{id:e})=>({...n,selectedConstructionId:e})),Mn(mt.addConstruction,(n,{})=>({...n})),Mn(mt.selectComponentTreeNode,(n,{componentTreeNode:e})=>({...n,selected:{...n.selected,selectedComponentNode:e}})),Mn(mt.selectStatusbarMode,(n,{mode:e,payload:t})=>({...n,statusbarMode:t?n.statusbarMode.concat(e):n.statusbarMode.filter(i=>!e.includes(i))})),Mn(mt.unselectStatusbarMode,n=>({...n,statusbarMode:[]})),Mn(mt.setToolbarMode,(n,{mode:e})=>({...n,toolbarMode:n.toolbarMode===e?As.DEFAULT:e})))}),{selectConfiguratorState:ew}=yP,{selectSelected:Co}=yP;Vi(Co,n=>n?.owspModel),Vi(Co,n=>n?.coreAreaModel),Vi(Co,n=>n?.selectedComponentNode),Vi(Co,n=>n?.componentTree),Vi(Co,n=>n?.selectedComponentId),Vi(Co,n=>n?.loadingCoreArea),Vi(Co,n=>n?.loadingComponentTree),Vi(ew,n=>n?.selectedConstructionId),Vi(ew,n=>n.statusbarMode),Vi(ew,n=>n.toolbarMode);const bq={propertyPanelGroupSettings:[{name:"frame",description:"\u0420\u0430\u043c\u0430",order:1,items:[yA("width","\u0448\u0438\u0440\u0438\u043d\u0430",1),yA("height","\u0432\u044b\u0441\u043e\u0442\u0430",2)]}],componentTreeSettings:[Gl("frame","\u0420\u0430\u043c\u0430",1,"box-plot"),Gl("beam","\u0411\u0430\u043b\u043a\u0430",2),Gl("divider","\u0420\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u044c",3),Gl("wing","\u0421\u0442\u0432\u043e\u0440\u043a\u0430",4),Gl("filling","\u0417\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435",5)]},wP=xx({source:"ConfigratorSettigns",events:{updatePropertiesPanelSettings:{_as:"props",_p:void 0},updateComponentTreeSettings:{_as:"props",_p:void 0}}});sP({name:"configuratorSettings",reducer:lP(bq,Mn(wP.updatePropertiesPanelSettings,(n,{settings:e})=>({...n,propertyPanelGroupSettings:e})),Mn(wP.updateComponentTreeSettings,(n,{settings:e})=>({...n,componentTreeSettings:e})))});function Vf(n){const e=Nd(()=>n());return function Dq(n){return n?.constructor===Object}(e)?new Proxy(n,{get:(t,i)=>i in e?(function $_(n){return"function"==typeof n&&void 0!==n[Pe]}(t[i])||Object.defineProperty(t,i,{value:Ts(()=>t()[i]),configurable:!0}),Vf(t[i])):t[i]}):n}const tw=new WeakMap,ni=Symbol("STATE_SOURCE");function Wn(n,...e){n[ni].update(t=>e.reduce((i,r)=>({...i,..."function"==typeof r?r(i):r}),t)),function Iq(n){const e=function nw(n){return tw.get(n[ni])||[]}(n);for(const t of e)t(Nd(()=>EP(n)))}(n)}function EP(n){return n[ni]()}function iw(...n){const e=[...n],t="function"==typeof e[0]?{}:e.shift(),i=e;return(()=>{class s{constructor(){const a=i.reduce((m,v)=>v(m),function xq(){return{[ni]:so({}),stateSignals:{},computedSignals:{},methods:{},hooks:{}}}()),{stateSignals:c,computedSignals:l,methods:u,hooks:h}=a,d={...c,...l,...u};this[ni]=a[ni];for(const m in d)this[m]=d[m];const{onInit:p,onDestroy:f}=h;p&&p(),f&&be(Ji).onDestroy(f)}static \u0275fac=function(c){return new(c||s)};static \u0275prov=He({token:s,factory:s.\u0275fac,providedIn:t.providedIn||null})}return s})()}function rw(n){return e=>{const t=n({[ni]:e[ni],...e.stateSignals,...e.computedSignals,...e.methods});return Object.keys(t),{...e,methods:{...e.methods,...t}}}}function sw(n){return e=>{const t="function"==typeof n?n():n,i=Object.keys(t);e[ni].update(s=>({...s,...t}));const r=i.reduce((s,o)=>{const a=Ts(()=>e[ni]()[o]);return{...s,[o]:Vf(a)}},{});return{...e,stateSignals:{...e.stateSignals,...r}}}}iw({providedIn:"root"},sw({statusbarMode:[],singleTapMode:!0}),rw((n,e=be(fu))=>({toggleStatusbarMode(t){Wn(n,i=>{const r=i.statusbarMode.includes(t)?i.statusbarMode.filter(s=>s!==t):[...i.statusbarMode,t];return{...i,statusbarMode:r}}),e.dispatch(mt.selectStatusbarMode({mode:[t],payload:n.statusbarMode().includes(t)}))},clearStatusbarMode(){Wn(n,t=>({...t,statusbarMode:[]}))},toggleSingleTapMode(){Wn(n,t=>({...t,singleTapMode:!t.singleTapMode}))}}))),iw({providedIn:"root"},sw({toolbarGroupArray:[],toolbarActiveMode:As.DEFAULT,prevToolbarActiveMode:As.DEFAULT}),rw(n=>({setToolbarGroup(e){Wn(n,t=>({...t,toolbarGroupArray:e}))},clearToolbarGroup(){Wn(n,e=>({...e,toolbarGroupArray:[]}))},setActiveMode(e){Wn(n,t=>({...t,prevToolbarActiveMode:t.toolbarActiveMode,toolbarActiveMode:t.toolbarActiveMode===e?As.DEFAULT:e}))}})));const bP={metrics:[],activeMetric:null},Rq=(iw({providedIn:"root"},sw(bP),function Pq(n){return e=>{const t=n({...e.stateSignals,...e.computedSignals});return Object.keys(t),{...e,computedSignals:{...e.computedSignals,...t}}}}(({activeMetric:n})=>({activeMetricCustomSizes:Ts(()=>n()?.customSizes||[])})),rw(({metrics:n,activeMetric:e,...t},i=be(r4))=>({createMetricFromConstruction(r){const s=i.createConstructionMetrics(r);this.addMetric(s),this.setActiveMetric(s.constructionId)},addMetric(r){n().find(o=>o.constructionId===r.constructionId)?Wn(t,{metrics:n().map(o=>o.constructionId===r.constructionId?{...r,customSizes:o.customSizes}:o)}):Wn(t,{metrics:[...n(),r]})},setActiveMetric(r){n().find(o=>o.constructionId===r)?Wn(t,{activeMetric:n().find(o=>o.constructionId===r)||null}):this.addMetric({constructionId:r,customSizes:[]})},addCustomSize(r){Wn(t,s=>({...s,activeMetric:{...s.activeMetric,customSizes:[...s.activeMetric.customSizes,r]}})),this.updateMetrics()},removeCustomSizes(r){const s=e()?{...e(),customSizes:e().customSizes.filter(o=>o.id!==r)}:e();Wn(t,{activeMetric:s}),this.updateMetrics()},updateMetrics(){e()&&Wn(t,{metrics:n().map(r=>r.constructionId===e()?.constructionId?e():r)})},updateActiveMetricCustomSize(r){Wn(t,s=>({...s,activeMetric:{...s.activeMetric,customSizes:s.activeMetric?.customSizes.map(o=>o.id===r.id?r:o)||[]}})),this.updateMetrics()},updateActiveMetricsCustomSizeList(r){Wn(t,s=>({...s,activeMetric:{...s.activeMetric,customSizes:r}})),this.updateMetrics()},updateConstructionMetric(r){const s=i.createConstructionMetrics(r);this.addMetric({...s,customSizes:e()?.customSizes||[]})},removeActiveMetricCustomSize(r){Wn(t,{activeMetric:{...e(),customSizes:e().customSizes.filter(s=>s.id!==r)}}),this.updateMetrics()},resetState(){Wn(t,{...bP})}}))),["editorcontainer"]);let Nq=(()=>{class n{constructor(t,i){this.guiService=t,this.destroyRef=i,this.name="konva-container",this.editorContainerSize=new Ot,this.sizeObserver=new ResizeObserver(r=>{this.editorContainerSize.next({width:r[0].contentRect.width,height:r[0].contentRect.height})})}ngOnInit(){this.editorContainerSize.pipe(bM(100),uu(this.destroyRef)).subscribe(t=>{this.guiService.changeSize(t)})}ngAfterViewInit(){this.editorContainer?.nativeElement&&(this.sizeObserver.observe(this.editorContainer.nativeElement),this.guiService.createGui(this.editorContainer.nativeElement.id))}ngOnDestroy(){this.guiService.clearGui(),this.editorContainerSize.unsubscribe(),this.sizeObserver.unobserve(this.editorContainer?.nativeElement)}static{this.\u0275fac=function(i){return new(i||n)(rt(Ix),rt(Ji))}}static{this.\u0275cmp=zp({type:n,selectors:[["lib-winconf-construction-editor"]],viewQuery:function(i,r){if(1&i&&function dT(n,e,t){nC(n,e,t)}(Rq,5),2&i){let s;(function fT(n){const e=ee(),t=st(),i=ug();lh(i+1);const r=G_(t,i);if(n.dirty&&function GR(n){return!(4&~n[Ue])}(e)===!(2&~r.metadata.flags)){if(null===r.matches)n.reset([]);else{const s=sC(e,i);n.reset(s,RE),n.notifyOnChanges()}return!0}return!1})(s=pT())&&(r.editorContainer=s.first)}},inputs:{name:"name"},standalone:!0,features:[Pm],decls:2,vars:1,consts:[["editorcontainer",""],[1,"konva-container",3,"id"]],template:function(i,r){1&i&&hd(0,"div",1,0),2&i&&Cl("id",r.name)},styles:[".konva-container[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0})}}return n})();const kq=(n,e)=>({primary:n,secondary:e});function Lq(n,e){if(1&n){const t=function MD(){return ee()}();Tl(0,"button",2),wm("click",function(){return function H0(n){return Ze.lFrame.contextLView=n,n[Vt]}(t),function G0(n){return Ze.lFrame.contextLView=null,n}(bm().toggleDrawingType())}),Tl(1,"span",3),function CT(n,e=""){const t=ee(),i=st(),r=n+Fe,s=i.firstCreatePass?eo(i,r,1,e,null):i.data[r],o=DT(i,t,s,e,n);t[r]=o,jc()&&Fh(i,t,o,s),Zi(s,!1)}(2),ud()()}if(2&n){const t=bm();Cl("ngClass",zT(2,kq,t.isDrawingButtonActive(),!t.isDrawingButtonActive())),l_(2),Dm("space_dashboard")}}let Fq=(()=>{class n{constructor(t,i,r,s){this.constructionService=t,this.converterService=i,this.guiService=r,this.destroyRef=s,this.construction=so(null),this.gui=so(null),this.drawingType=so(Or.SOLID),this.drawing=Ts(()=>this.gui()?V6[this.drawingType()](this.gui()):null),this.isDrawingButtonEnabled=Ts(()=>!!this.drawing()&&!!this.construction()),this.isDrawingButtonActive=Ts(()=>this.drawingType()===Or.SOLID),this.onParseModel=new Ot,this.onParseModel.pipe(uu(this.destroyRef),Zd(o=>this.constructionService.parseConstruction(o).pipe(ii(a=>this.converterService.convertOWSP(a).konvaConstruction),lu(a=>function Jv(...n){return Ly(n,dA(n))}(a))))).subscribe(o=>{this.construction.set(o)}),function l1(n,e){Qn("NgSignals"),!e?.injector&&xc();const t=e?.injector??be(kn),i=!0!==e?.manualCleanup?t.get(Ji):null,r=new Nz(t.get(Pz),n,typeof Zone>"u"?null:Zone.current,i,t,e?.allowSignalWrites??!1),s=t.get(qm,null,{optional:!0});return s&&8&s._lView[Ue]?(s._lView[th]??=[]).push(r.watcher.notify):r.watcher.notify(),r}(()=>{this.gui()&&this.construction()&&this.drawing()&&(this.drawing()?.clearDrawingLine(),this.drawing()?.clearAllDividers(),this.drawing()?.clearAreas(),this.drawing()?.drawConstruction(this.construction()))})}ngOnInit(){this.guiService.onCreateGui.pipe(uu(this.destroyRef)).subscribe(t=>{this.gui.set(t)})}ngOnChanges(t){t.model&&this.model&&this.onParseModel.next(this.model)}toggleDrawingType(){this.drawing()&&this.construction()&&this.drawingType.update(t=>t===Or.SOLID?Or.WIRE:Or.SOLID)}static{this.\u0275fac=function(i){return new(i||n)(rt(ov),rt(mf),rt(Ix),rt(Ji))}}static{this.\u0275cmp=zp({type:n,selectors:[["lib-winconf-component"]],inputs:{model:"model"},standalone:!0,features:[kc,Pm],decls:2,vars:1,consts:[[1,"lib-winconf-construction-editor"],["class","fill-button",3,"ngClass","click",4,"ngIf"],[1,"fill-button",3,"click","ngClass"],[1,"material-icons"]],template:function(i,r){1&i&&(hd(0,"lib-winconf-construction-editor",0),X_(1,Lq,3,5,"button",1)),2&i&&(l_(),Cl("ngIf",r.isDrawingButtonEnabled()))},dependencies:[my,w1,S1,Nq],styles:['@import"https://fonts.googleapis.com/icon?family=Material+Icons";html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{width:100%;height:100%;margin:0}[_nghost-%COMP%]{box-sizing:border-box;display:block;height:100%;width:100%;position:relative;border:solid 3px #d1d5db}[_nghost-%COMP%]   .lib-winconf-construction-editor[_ngcontent-%COMP%]{position:absolute;inset:0}[_nghost-%COMP%]   .fill-button[_ngcontent-%COMP%]{position:absolute;top:2rem;right:2rem;cursor:pointer;font-size:1rem;line-height:1;border-radius:100px;outline:0;box-shadow:0 0 1px #00000073;transition:all .3s cubic-bezier(.645,.045,.355,1),box-shadow .1s cubic-bezier(.645,.045,.355,1);-webkit-user-select:none;user-select:none;padding:10px 12px;color:#000;background-color:#fff;border:1px solid #d9d9d9}[_nghost-%COMP%]   .fill-button.primary[_ngcontent-%COMP%]{background-color:#1890ff;border-color:#1890ff;color:#fff}[_nghost-%COMP%]   .fill-button.primary[_ngcontent-%COMP%]:hover{background-color:#40a9ff}[_nghost-%COMP%]   .fill-button.secondary[_ngcontent-%COMP%]:hover{color:#40a9ff;border-color:#40a9ff}[_nghost-%COMP%]   .fill-button[_ngcontent-%COMP%]:active{box-shadow:0 0 4px #00000073}'],changeDetection:0})}}return n})();var Qe=function(n){return n[n.State=0]="State",n[n.Transition=1]="Transition",n[n.Sequence=2]="Sequence",n[n.Group=3]="Group",n[n.Animate=4]="Animate",n[n.Keyframes=5]="Keyframes",n[n.Style=6]="Style",n[n.Trigger=7]="Trigger",n[n.Reference=8]="Reference",n[n.AnimateChild=9]="AnimateChild",n[n.AnimateRef=10]="AnimateRef",n[n.Query=11]="Query",n[n.Stagger=12]="Stagger",n}(Qe||{});const os="*";function SP(n){return{type:Qe.Style,styles:n,offset:null}}class pu{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class CP{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function DP(n){return new oe(3e3,!1)}function ks(n){switch(n.length){case 0:return new pu;case 1:return n[0];default:return new CP(n)}}function TP(n,e,t=new Map,i=new Map){const r=[],s=[];let o=-1,a=null;if(e.forEach(c=>{const l=c.get("offset"),u=l==o,h=u&&a||new Map;c.forEach((d,p)=>{let f=p,m=d;if("offset"!==p)switch(f=n.normalizePropertyName(f,r),m){case"!":m=t.get(p);break;case os:m=i.get(p);break;default:m=n.normalizeStyleValue(p,f,m,r)}h.set(f,m)}),u||s.push(h),a=h,o=l}),r.length)throw function h7(){return new oe(3502,!1)}();return s}function aw(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&cw(t,"start",n)));break;case"done":n.onDone(()=>i(t&&cw(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&cw(t,"destroy",n)))}}function cw(n,e,t){const s=lw(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),o=n._data;return null!=o&&(s._data=o),s}function lw(n,e,t,i,r="",s=0,o){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function Ti(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function IP(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}const S7=typeof document>"u"?null:document.documentElement;function uw(n){const e=n.parentNode||n.host||null;return e===S7?null:e}let Do=null,AP=!1;function MP(n,e){for(;e;){if(e===n)return!0;e=uw(e)}return!1}function xP(n,e,t){if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]}let hw=(()=>{class n{validateStyleProperty(t){return function D7(n){Do||(Do=function T7(){return typeof document<"u"?document.body:null}()||{},AP=!!Do.style&&"WebkitAppearance"in Do.style);let e=!0;return Do.style&&!function C7(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Do.style,!e&&AP&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Do.style)),e}(t)}containsElement(t,i){return MP(t,i)}getParentElement(t){return uw(t)}query(t,i,r){return xP(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],c){return new pu(r,s)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac})}}return n})();class dw{static{this.NOOP=new hw}}class fw{}const A7=1e3,pw="ng-enter",zf="ng-leave",Uf="ng-trigger",Hf=".ng-trigger",OP="ng-animating",gw=".ng-animating";function as(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:_w(parseFloat(e[1]),e[2])}function _w(n,e){return"s"===e?n*A7:n}function Gf(n,e,t){return n.hasOwnProperty("duration")?n:function x7(n,e,t){let r,s=0,o="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(DP()),{duration:0,delay:0,easing:""};r=_w(parseFloat(a[1]),a[2]);const c=a[3];null!=c&&(s=_w(parseFloat(c),a[4]));const l=a[5];l&&(o=l)}else r=n;if(!t){let a=!1,c=e.length;r<0&&(e.push(function Hq(){return new oe(3100,!1)}()),a=!0),s<0&&(e.push(function Gq(){return new oe(3101,!1)}()),a=!0),a&&e.splice(c,0,DP())}return{duration:r,delay:s,easing:o}}(n,e,t)}function Rr(n,e,t){e.forEach((i,r)=>{const s=yw(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i})}function To(n,e){e.forEach((t,i)=>{const r=yw(i);n.style[r]=""})}function gu(n){return Array.isArray(n)?1==n.length?n[0]:function Bq(n,e=null){return{type:Qe.Sequence,steps:n,options:e}}(n):n}const mw=new RegExp("{{\\s*(.+?)\\s*}}","g");function NP(n){let e=[];if("string"==typeof n){let t;for(;t=mw.exec(n);)e.push(t[1]);mw.lastIndex=0}return e}function _u(n,e,t){const i=`${n}`,r=i.replace(mw,(s,o)=>{let a=e[o];return null==a&&(t.push(function Wq(){return new oe(3003,!1)}()),a=""),a.toString()});return r==i?n:r}const R7=/-+([a-z0-9])/g;function yw(n){return n.replace(R7,(...e)=>e[1].toUpperCase())}function Ii(n,e,t){switch(e.type){case Qe.Trigger:return n.visitTrigger(e,t);case Qe.State:return n.visitState(e,t);case Qe.Transition:return n.visitTransition(e,t);case Qe.Sequence:return n.visitSequence(e,t);case Qe.Group:return n.visitGroup(e,t);case Qe.Animate:return n.visitAnimate(e,t);case Qe.Keyframes:return n.visitKeyframes(e,t);case Qe.Style:return n.visitStyle(e,t);case Qe.Reference:return n.visitReference(e,t);case Qe.AnimateChild:return n.visitAnimateChild(e,t);case Qe.AnimateRef:return n.visitAnimateRef(e,t);case Qe.Query:return n.visitQuery(e,t);case Qe.Stagger:return n.visitStagger(e,t);default:throw function qq(){return new oe(3004,!1)}()}}function vw(n,e){return window.getComputedStyle(n)[e]}const L7=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class kP extends fw{normalizePropertyName(e,t){return yw(e)}normalizeStyleValue(e,t,i,r){let s="";const o=i.toString().trim();if(L7.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function Kq(){return new oe(3005,!1)}())}return o+s}}const $f="*";const Wf=new Set(["true","1"]),qf=new Set(["false","0"]);function LP(n,e){const t=Wf.has(n)||qf.has(n),i=Wf.has(e)||qf.has(e);return(r,s)=>{let o=n==$f||n==r,a=e==$f||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?Wf.has(n):qf.has(n)),!a&&i&&"boolean"==typeof s&&(a=s?Wf.has(e):qf.has(e)),o&&a}}const V7=new RegExp("s*:selfs*,?","g");function ww(n,e,t,i){return new z7(n).build(e,t,i)}class z7{constructor(e){this._driver=e}build(e,t,i){const r=new G7(t);return this._resetContextStyleTimingState(r),Ii(this,gu(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function Yq(){return new oe(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),a.type==Qe.State){const c=a,l=c.name;l.toString().split(/\s*,\s*/).forEach(u=>{c.name=u,s.push(this.visitState(c,t))}),c.name=l}else if(a.type==Qe.Transition){const c=this.visitTransition(a,t);i+=c.queryCount,r+=c.depCount,o.push(c)}else t.errors.push(function Xq(){return new oe(3007,!1)}())}),{type:Qe.Trigger,name:e.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(c=>{NP(c).forEach(l=>{o.hasOwnProperty(l)||s.add(l)})})}),s.size&&t.errors.push(function Zq(){return new oe(3008,!1)}(0,s.values()))}return{type:Qe.State,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=Ii(this,gu(e.animation),t),r=function F7(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function B7(n,e,t){if(":"==n[0]){const c=function j7(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function a7(){return new oe(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof c)return void e.push(c);n=c}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function o7(){return new oe(3015,!1)}()),e;const r=i[1],s=i[2],o=i[3];e.push(LP(r,o)),"<"==s[0]&&(r!=$f||o!=$f)&&e.push(LP(o,r))}(i,t,e)):t.push(n),t}(e.expr,t.errors);return{type:Qe.Transition,matchers:r,animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Io(e.options)}}visitSequence(e,t){return{type:Qe.Sequence,steps:e.steps.map(i=>Ii(this,i,t)),options:Io(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=i;const a=Ii(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:Qe.Group,steps:s,options:Io(e.options)}}visitAnimate(e,t){const i=function W7(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return Ew(Gf(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=Ew(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=Gf(t,e);return Ew(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:SP({});if(s.type==Qe.Keyframes)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const l={};i.easing&&(l.easing=i.easing),o=SP(l)}t.currentTime+=i.duration+i.delay;const c=this.visitStyle(o,t);c.isEmptyStep=a,r=c}return t.currentAnimateTimings=null,{type:Qe.Animate,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of r)"string"==typeof a?a===os?i.push(a):t.errors.push(new oe(3002,!1)):i.push(new Map(Object.entries(a)));let s=!1,o=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let c of a.values())if(c.toString().indexOf("{{")>=0){s=!0;break}}),{type:Qe.Style,styles:i,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,c)=>{const l=t.collectedStyles.get(t.currentQuerySelector),u=l.get(c);let h=!0;u&&(s!=r&&s>=u.startTime&&r<=u.endTime&&(t.errors.push(function Jq(){return new oe(3010,!1)}()),h=!1),s=u.startTime),h&&l.set(c,{startTime:s,endTime:r}),t.options&&function O7(n,e,t){const i=e.params||{},r=NP(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function $q(){return new oe(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:Qe.Keyframes,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function e7(){return new oe(3011,!1)}()),i;let s=0;const o=[];let a=!1,c=!1,l=0;const u=e.steps.map(C=>{const I=this._makeStyleAst(C,t);let L=null!=I.offset?I.offset:function $7(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(I.styles),H=0;return null!=L&&(s++,H=I.offset=L),c=c||H<0||H>1,a=a||H<l,l=H,o.push(H),I});c&&t.errors.push(function t7(){return new oe(3012,!1)}()),a&&t.errors.push(function n7(){return new oe(3200,!1)}());const h=e.steps.length;let d=0;s>0&&s<h?t.errors.push(function i7(){return new oe(3202,!1)}()):0==s&&(d=1/(h-1));const p=h-1,f=t.currentTime,m=t.currentAnimateTimings,v=m.duration;return u.forEach((C,I)=>{const L=d>0?I==p?1:d*I:o[I],H=L*v;t.currentTime=f+m.delay+H,m.duration=H,this._validateStyleAst(C,t),C.offset=L,i.styles.push(C)}),i}visitReference(e,t){return{type:Qe.Reference,animation:Ii(this,gu(e.animation),t),options:Io(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:Qe.AnimateChild,options:Io(e.options)}}visitAnimateRef(e,t){return{type:Qe.AnimateRef,animation:this.visitReference(e.animation,t),options:Io(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function U7(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(V7,"")),n=n.replace(/@\*/g,Hf).replace(/@\w+/g,t=>Hf+"-"+t.slice(1)).replace(/:animating/g,gw),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,Ti(t.collectedStyles,t.currentQuerySelector,new Map);const a=Ii(this,gu(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:Qe.Query,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:Io(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function r7(){return new oe(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:Gf(e.timings,t.errors,!0);return{type:Qe.Stagger,animation:Ii(this,gu(e.animation),t),timings:i,options:null}}}class G7{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Io(n){return n?(n={...n}).params&&(n.params=function H7(n){return n?{...n}:null}(n.params)):n={},n}function Ew(n,e,t){return{duration:n,delay:e,easing:t}}function bw(n,e,t,i,r,s,o=null,a=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class Kf{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const Y7=new RegExp(":enter","g"),Z7=new RegExp(":leave","g");function Sw(n,e,t,i,r,s=new Map,o=new Map,a,c,l=[]){return(new Q7).buildKeyframes(n,e,t,i,r,s,o,a,c,l)}class Q7{buildKeyframes(e,t,i,r,s,o,a,c,l,u=[]){l=l||new Kf;const h=new Cw(e,t,l,r,s,u,[]);h.options=c;const d=c.delay?as(c.delay):0;h.currentTimeline.delayNextStep(d),h.currentTimeline.setStyles([o],null,h.errors,c),Ii(this,i,h);const p=h.timelines.filter(f=>f.containsAnimation());if(p.length&&a.size){let f;for(let m=p.length-1;m>=0;m--){const v=p[m];if(v.element===t){f=v;break}}f&&!f.allowOnlyTimelineStyles()&&f.setStyles([a],null,h.errors,c)}return p.length?p.map(f=>f.buildKeyframes()):[bw(t,[],[],[],0,d,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const s=r?.delay;if(s){const o="number"==typeof s?s:as(_u(s,r?.params??{},t.errors));i.delayNextStep(o)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const o=null!=i.duration?as(i.duration):null,a=null!=i.delay?as(i.delay):null;return 0!==o&&e.forEach(c=>{const l=t.appendInstructionToTimeline(c,o,a);s=Math.max(s,l.duration+l.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),Ii(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){r.previousNode.type==Qe.Style&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Yf);const o=as(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>Ii(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?as(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),Ii(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return Gf(t.params?_u(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;s.type==Qe.Keyframes?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,a=t.createSubContext().currentTimeline;a.easing=i.easing,e.styles.forEach(c=>{a.forwardTime((c.offset||0)*s),a.setStyles(c.styles,c.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?as(r.delay):0;s&&(t.previousNode.type===Qe.Style||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Yf);let o=i;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let c=null;a.forEach((l,u)=>{t.currentQueryIndex=u;const h=t.createSubContext(e.options,l);s&&h.delayNextStep(s),l===t.element&&(c=h.currentTimeline),Ii(this,e.animation,h),h.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,h.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),c&&(t.currentTimeline.mergeTimelineCollectedStyles(c),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let c=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":c=a-c;break;case"full":c=i.currentStaggerTime}const u=t.currentTimeline;c&&u.delayNextStep(c);const h=u.currentTime;Ii(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-h+(r.startTime-i.currentTimeline.startTime)}}const Yf={};class Cw{constructor(e,t,i,r,s,o,a,c){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Yf,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new Xf(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=as(i.duration)),null!=i.delay&&(r.delay=as(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=_u(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new Cw(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=Yf,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new J7(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(Y7,"."+this._enterClassName)).replace(Z7,"."+this._leaveClassName);let l=this._driver.query(this.element,e,1!=i);0!==i&&(l=i<0?l.slice(l.length+i,l.length):l.slice(0,i)),a.push(...l)}return!s&&0==a.length&&o.push(function s7(){return new oe(3014,!1)}()),a}}class Xf{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new Xf(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||os),this._currentKeyframe.set(t,os);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function eK(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i??=e.keys();for(let s of i)t.set(s,os)}else for(let[s,o]of r)t.set(s,o)}),t}(e,this._globalTimelineStyles);for(let[a,c]of o){const l=_u(c,s,i);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??os),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,c)=>{const l=new Map([...this._backFill,...a]);l.forEach((u,h)=>{"!"===u?e.add(h):u===os&&t.add(h)}),i||l.set("offset",c/this.duration),r.push(l)});const s=[...e.values()],o=[...t.values()];if(i){const a=r[0],c=new Map(a);a.set("offset",0),c.set("offset",1),r=[a,c]}return bw(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class J7 extends Xf{constructor(e,t,i,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=i+t,a=t/o,c=new Map(e[0]);c.set("offset",0),s.push(c);const l=new Map(e[0]);l.set("offset",jP(a)),s.push(l);const u=e.length-1;for(let h=1;h<=u;h++){let d=new Map(e[h]);const p=d.get("offset");d.set("offset",jP((t+p*i)/o)),s.push(d)}i=o,t=0,r="",e=s}return bw(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function jP(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}function VP(n,e,t,i,r,s,o,a,c,l,u,h,d){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:c,preStyleProps:l,postStyleProps:u,totalTime:h,errors:d}}const Dw={};class zP{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function tK(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,o,a,c,l,u){const h=[],d=this.ast.options&&this.ast.options.params||Dw,f=this.buildStyles(i,a&&a.params||Dw,h),m=c&&c.params||Dw,v=this.buildStyles(r,m,h),C=new Set,I=new Map,L=new Map,H="void"===r,ne={params:UP(m,d),delay:this.ast.options?.delay},se=u?[]:Sw(e,t,this.ast.animation,s,o,f,v,ne,l,h);let ce=0;return se.forEach(pe=>{ce=Math.max(pe.duration+pe.delay,ce)}),h.length?VP(t,this._triggerName,i,r,H,f,v,[],[],I,L,ce,h):(se.forEach(pe=>{const De=pe.element,Me=Ti(I,De,new Set);pe.preStyleProps.forEach(Ke=>Me.add(Ke));const Ve=Ti(L,De,new Set);pe.postStyleProps.forEach(Ke=>Ve.add(Ke)),De!==t&&C.add(De)}),VP(t,this._triggerName,i,r,H,f,v,se,[...C.values()],I,L,ce))}}function UP(n,e){const t={...e};return Object.entries(n).forEach(([i,r])=>{null!=r&&(t[i]=r)}),t}class nK{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=UP(e,this.defaultParams);return this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=_u(o,r,t));const c=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,c,o,t),i.set(a,o)})}),i}}class rK{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new nK(r.style,r.options&&r.options.params||{},i))}),HP(this.states,"true","1"),HP(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new zP(e,r,this.states))}),this.fallbackTransition=function sK(n,e){return new zP(n,{type:Qe.Transition,animation:{type:Qe.Sequence,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(o=>o.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function HP(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const oK=new Kf;class aK{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],s=ww(this._driver,t,i,[]);if(i.length)throw function d7(){return new oe(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=TP(this._normalizer,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=Sw(this._driver,t,s,pw,zf,new Map,new Map,i,oK,r),o.forEach(u=>{const h=Ti(a,u.element,new Map);u.postStyleProps.forEach(d=>h.set(d,null))})):(r.push(function f7(){return new oe(3300,!1)}()),o=[]),r.length)throw function p7(){return new oe(3504,!1)}();a.forEach((u,h)=>{u.forEach((d,p)=>{u.set(p,this._driver.computeStyle(h,p,os))})});const l=ks(o.map(u=>{const h=a.get(u.element);return this._buildPlayer(u,new Map,h)}));return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function g7(){return new oe(3301,!1)}();return t}listen(e,t,i,r){const s=lw(t,"","","");return aw(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const GP="ng-animate-queued",Tw="ng-animate-disabled",dK=[],$P={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},fK={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ar="__ng_removed";class Iw{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function mK(n){return n??null}(i?e.value:e),i){const{value:s,...o}=e;this.options=o}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const mu="void",Aw=new Iw(mu);class pK{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,zi(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function _7(){return new oe(3302,!1)}();if(null==i||0==i.length)throw function m7(){return new oe(3303,!1)}();if(!function yK(n){return"start"==n||"done"==n}(i))throw function y7(){return new oe(3400,!1)}();const s=Ti(this._elementListeners,e,[]),o={name:t,phase:i,callback:r};s.push(o);const a=Ti(this._engine.statesByElement,e,new Map);return a.has(t)||(zi(e,Uf),zi(e,Uf+"-"+t),a.set(t,Aw)),()=>{this._engine.afterFlush(()=>{const c=s.indexOf(o);c>=0&&s.splice(c,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function v7(){return new oe(3401,!1)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),o=new Mw(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(zi(e,Uf),zi(e,Uf+"-"+t),this._engine.statesByElement.set(e,a=new Map));let c=a.get(t);const l=new Iw(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&c&&l.absorbOptions(c.options),a.set(t,l),c||(c=Aw),l.value!==mu&&c.value===l.value){if(!function EK(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(c.params,l.params)){const m=[],v=s.matchStyles(c.value,c.params,m),C=s.matchStyles(l.value,l.params,m);m.length?this._engine.reportError(m):this._engine.afterFlush(()=>{To(e,v),Rr(e,C)})}return}const d=Ti(this._engine.playersByElement,e,[]);d.forEach(m=>{m.namespaceId==this.id&&m.triggerName==t&&m.queued&&m.destroy()});let p=s.matchTransition(c.value,l.value,e,l.params),f=!1;if(!p){if(!r)return;p=s.fallbackTransition,f=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:p,fromState:c,toState:l,player:o,isFallbackTransition:f}),f||(zi(e,GP),o.onStart(()=>{rc(e,GP)})),o.onDone(()=>{let m=this.players.indexOf(o);m>=0&&this.players.splice(m,1);const v=this._engine.playersByElement.get(e);if(v){let C=v.indexOf(o);C>=0&&v.splice(C,1)}}),this.players.push(o),d.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,Hf,!0);i.forEach(r=>{if(r[ar])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((c,l)=>{if(o.set(l,c.value),this._triggers.has(l)){const u=this.trigger(e,l,mu,r);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),i&&ks(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const c=this._triggers.get(o).fallbackTransition,l=i.get(o)||Aw,u=new Iw(mu),h=new Mw(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:c,fromState:l,toState:u,player:h,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[ar];(!s||s===$P)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){zi(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==i.triggerName){const c=lw(s,i.triggerName,i.fromState.value,i.toState.value);c._data=e,aw(i.player,a.phase,c,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class gK{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new pK(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const c=r.get(a);if(c){const l=i.indexOf(c);i.splice(l+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(e);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(Zf(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!Zf(t))return;const s=t[ar];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),zi(e,Tw)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),rc(e,Tw))}removeNode(e,t,i){if(Zf(t)){const r=e?this._fetchNamespace(e):null;r?r.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i);const s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[ar]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return Zf(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,Hf,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,gw,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return ks(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[ar];if(t&&t.setForRemoval){if(e[ar]=$P,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(Tw)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)zi(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?ks(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function w7(){return new oe(3402,!1)}()}_flushAnimations(e,t){const i=new Kf,r=[],s=new Map,o=[],a=new Map,c=new Map,l=new Map,u=new Set;this.disabledNodes.forEach(ue=>{u.add(ue);const Ee=this.driver.query(ue,".ng-animate-queued",!0);for(let Ae=0;Ae<Ee.length;Ae++)u.add(Ee[Ae])});const h=this.bodyNode,d=Array.from(this.statesByElement.keys()),p=KP(d,this.collectedEnterElements),f=new Map;let m=0;p.forEach((ue,Ee)=>{const Ae=pw+m++;f.set(Ee,Ae),ue.forEach(tt=>zi(tt,Ae))});const v=[],C=new Set,I=new Set;for(let ue=0;ue<this.collectedLeaveElements.length;ue++){const Ee=this.collectedLeaveElements[ue],Ae=Ee[ar];Ae&&Ae.setForRemoval&&(v.push(Ee),C.add(Ee),Ae.hasAnimation?this.driver.query(Ee,".ng-star-inserted",!0).forEach(tt=>C.add(tt)):I.add(Ee))}const L=new Map,H=KP(d,Array.from(C));H.forEach((ue,Ee)=>{const Ae=zf+m++;L.set(Ee,Ae),ue.forEach(tt=>zi(tt,Ae))}),e.push(()=>{p.forEach((ue,Ee)=>{const Ae=f.get(Ee);ue.forEach(tt=>rc(tt,Ae))}),H.forEach((ue,Ee)=>{const Ae=L.get(Ee);ue.forEach(tt=>rc(tt,Ae))}),v.forEach(ue=>{this.processLeaveNode(ue)})});const ne=[],se=[];for(let ue=this._namespaceList.length-1;ue>=0;ue--)this._namespaceList[ue].drainQueuedTransitions(t).forEach(Ae=>{const tt=Ae.player,Ge=Ae.element;if(ne.push(tt),this.collectedEnterElements.length){const qn=Ge[ar];if(qn&&qn.setForMove){if(qn.previousTriggersValues&&qn.previousTriggersValues.has(Ae.triggerName)){const Ao=qn.previousTriggersValues.get(Ae.triggerName),Ui=this.statesByElement.get(Ae.element);if(Ui&&Ui.has(Ae.triggerName)){const Jf=Ui.get(Ae.triggerName);Jf.value=Ao,Ui.set(Ae.triggerName,Jf)}}return void tt.destroy()}}const gt=!h||!this.driver.containsElement(h,Ge),Nt=L.get(Ge),Bn=f.get(Ge),yt=this._buildInstruction(Ae,i,Bn,Nt,gt);if(yt.errors&&yt.errors.length)return void se.push(yt);if(gt)return tt.onStart(()=>To(Ge,yt.fromStyles)),tt.onDestroy(()=>Rr(Ge,yt.toStyles)),void r.push(tt);if(Ae.isFallbackTransition)return tt.onStart(()=>To(Ge,yt.fromStyles)),tt.onDestroy(()=>Rr(Ge,yt.toStyles)),void r.push(tt);const iO=[];yt.timelines.forEach(qn=>{qn.stretchStartingKeyframe=!0,this.disabledNodes.has(qn.element)||iO.push(qn)}),yt.timelines=iO,i.append(Ge,yt.timelines),o.push({instruction:yt,player:tt,element:Ge}),yt.queriedElements.forEach(qn=>Ti(a,qn,[]).push(tt)),yt.preStyleProps.forEach((qn,Ao)=>{if(qn.size){let Ui=c.get(Ao);Ui||c.set(Ao,Ui=new Set),qn.forEach((Jf,Ow)=>Ui.add(Ow))}}),yt.postStyleProps.forEach((qn,Ao)=>{let Ui=l.get(Ao);Ui||l.set(Ao,Ui=new Set),qn.forEach((Jf,Ow)=>Ui.add(Ow))})});if(se.length){const ue=[];se.forEach(Ee=>{ue.push(function E7(){return new oe(3505,!1)}())}),ne.forEach(Ee=>Ee.destroy()),this.reportError(ue)}const ce=new Map,pe=new Map;o.forEach(ue=>{const Ee=ue.element;i.has(Ee)&&(pe.set(Ee,Ee),this._beforeAnimationBuild(ue.player.namespaceId,ue.instruction,ce))}),r.forEach(ue=>{const Ee=ue.element;this._getPreviousPlayers(Ee,!1,ue.namespaceId,ue.triggerName,null).forEach(tt=>{Ti(ce,Ee,[]).push(tt),tt.destroy()})});const De=v.filter(ue=>XP(ue,c,l)),Me=new Map;qP(Me,this.driver,I,l,os).forEach(ue=>{XP(ue,c,l)&&De.push(ue)});const Ke=new Map;p.forEach((ue,Ee)=>{qP(Ke,this.driver,new Set(ue),c,"!")}),De.forEach(ue=>{const Ee=Me.get(ue),Ae=Ke.get(ue);Me.set(ue,new Map([...Ee?.entries()??[],...Ae?.entries()??[]]))});const ze=[],ht=[],pt={};o.forEach(ue=>{const{element:Ee,player:Ae,instruction:tt}=ue;if(i.has(Ee)){if(u.has(Ee))return Ae.onDestroy(()=>Rr(Ee,tt.toStyles)),Ae.disabled=!0,Ae.overrideTotalTime(tt.totalTime),void r.push(Ae);let Ge=pt;if(pe.size>1){let Nt=Ee;const Bn=[];for(;Nt=Nt.parentNode;){const yt=pe.get(Nt);if(yt){Ge=yt;break}Bn.push(Nt)}Bn.forEach(yt=>pe.set(yt,Ge))}const gt=this._buildAnimation(Ae.namespaceId,tt,ce,s,Ke,Me);if(Ae.setRealPlayer(gt),Ge===pt)ze.push(Ae);else{const Nt=this.playersByElement.get(Ge);Nt&&Nt.length&&(Ae.parentPlayer=ks(Nt)),r.push(Ae)}}else To(Ee,tt.fromStyles),Ae.onDestroy(()=>Rr(Ee,tt.toStyles)),ht.push(Ae),u.has(Ee)&&r.push(Ae)}),ht.forEach(ue=>{const Ee=s.get(ue.element);if(Ee&&Ee.length){const Ae=ks(Ee);ue.setRealPlayer(Ae)}}),r.forEach(ue=>{ue.parentPlayer?ue.syncPlayerEvents(ue.parentPlayer):ue.destroy()});for(let ue=0;ue<v.length;ue++){const Ee=v[ue],Ae=Ee[ar];if(rc(Ee,zf),Ae&&Ae.hasAnimation)continue;let tt=[];if(a.size){let gt=a.get(Ee);gt&&gt.length&&tt.push(...gt);let Nt=this.driver.query(Ee,gw,!0);for(let Bn=0;Bn<Nt.length;Bn++){let yt=a.get(Nt[Bn]);yt&&yt.length&&tt.push(...yt)}}const Ge=tt.filter(gt=>!gt.destroyed);Ge.length?vK(this,Ee,Ge):this.processLeaveNode(Ee)}return v.length=0,ze.forEach(ue=>{this.players.push(ue),ue.onDone(()=>{ue.destroy();const Ee=this.players.indexOf(ue);this.players.splice(Ee,1)}),ue.play()}),ze}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const c=!s||s==mu;a.forEach(l=>{l.queued||!c&&l.triggerName!=r||o.push(l)})}}return(i||r)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,i){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const c of t.timelines){const l=c.element,u=l!==s,h=Ti(i,l,[]);this._getPreviousPlayers(l,u,o,a,t.toState).forEach(p=>{const f=p.getRealPlayer();f.beforeDestroy&&f.beforeDestroy(),p.destroy(),h.push(p)})}To(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,o){const a=t.triggerName,c=t.element,l=[],u=new Set,h=new Set,d=t.timelines.map(f=>{const m=f.element;u.add(m);const v=m[ar];if(v&&v.removedBeforeQueried)return new pu(f.duration,f.delay);const C=m!==c,I=function wK(n){const e=[];return YP(n,e),e}((i.get(m)||dK).map(ce=>ce.getRealPlayer())).filter(ce=>!!ce.element&&ce.element===m),L=s.get(m),H=o.get(m),ne=TP(this._normalizer,f.keyframes,L,H),se=this._buildPlayer(f,ne,I);if(f.subTimeline&&r&&h.add(m),C){const ce=new Mw(e,a,m);ce.setRealPlayer(se),l.push(ce)}return se});l.forEach(f=>{Ti(this.playersByQueriedElement,f.element,[]).push(f),f.onDone(()=>function _K(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,f.element,f))}),u.forEach(f=>zi(f,OP));const p=ks(d);return p.onDestroy(()=>{u.forEach(f=>rc(f,OP)),Rr(c,t.toStyles)}),h.forEach(f=>{Ti(r,f,[]).push(p)}),p}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new pu(e.duration,e.delay)}}class Mw{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new pu,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>aw(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Ti(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Zf(n){return n&&1===n.nodeType}function WP(n,e){const t=n.style.display;return n.style.display=e??"none",t}function qP(n,e,t,i,r){const s=[];t.forEach(c=>s.push(WP(c)));const o=[];i.forEach((c,l)=>{const u=new Map;c.forEach(h=>{const d=e.computeStyle(l,h,r);u.set(h,d),(!d||0==d.length)&&(l[ar]=fK,o.push(l))}),n.set(l,u)});let a=0;return t.forEach(c=>WP(c,s[a++])),o}function KP(n,e){const t=new Map;if(n.forEach(a=>t.set(a,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(a){if(!a)return 1;let c=s.get(a);if(c)return c;const l=a.parentNode;return c=t.has(l)?l:r.has(l)?1:o(l),s.set(a,c),c}return e.forEach(a=>{const c=o(a);1!==c&&t.get(c).push(a)}),t}function zi(n,e){n.classList?.add(e)}function rc(n,e){n.classList?.remove(e)}function vK(n,e,t){ks(t).onDone(()=>n.processLeaveNode(e))}function YP(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof CP?YP(i.players,e):e.push(i)}}function XP(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class yu{constructor(e,t,i){this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new gK(e.body,t,i),this._timelineEngine=new aK(e.body,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,i,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const c=[],u=ww(this._driver,s,c,[]);if(c.length)throw function u7(){return new oe(3404,!1)}();a=function iK(n,e,t){return new rK(n,e,t)}(r,u,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i){this._transitionEngine.removeNode(e,t,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,o]=IP(i);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[o,a]=IP(i);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}class vu{static{this.initialStylesByElement=new WeakMap}constructor(e,t,i){this._element=e,this._startStyles=t,this._endStyles=i,this._state=0;let r=vu.initialStylesByElement.get(e);r||vu.initialStylesByElement.set(e,r=new Map),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&Rr(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Rr(this._element,this._initialStyles),this._endStyles&&(Rr(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(vu.initialStylesByElement.delete(this._element),this._startStyles&&(To(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(To(this._element,this._endStyles),this._endStyles=null),Rr(this._element,this._initialStyles),this._state=3)}}function xw(n){let e=null;return n.forEach((t,i)=>{(function SK(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class ZP{constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;const t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:vw(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class QP{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}containsElement(e,t){return MP(e,t)}getParentElement(e){return uw(e)}query(e,t,i){return xP(e,t,i)}computeStyle(e,t,i){return vw(e,t)}animate(e,t,i,r,s,o=[]){const c={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(c.easing=s);const l=new Map,u=o.filter(p=>p instanceof ZP);(function N7(n,e){return 0===n||0===e})(i,r)&&u.forEach(p=>{p.currentSnapshot.forEach((f,m)=>l.set(m,f))});let h=function P7(n){return n.length?n[0]instanceof Map?n:n.map(e=>new Map(Object.entries(e))):[]}(t).map(p=>new Map(p));h=function k7(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((s,o)=>{i.has(o)||r.push(o),i.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(a=>o.set(a,vw(n,a)))}}return e}(e,h,l);const d=function bK(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=xw(e[0]),e.length>1&&(i=xw(e[e.length-1]))):e instanceof Map&&(t=xw(e)),t||i?new vu(n,t,i):null}(e,h);return new ZP(e,h,c,d)}}const JP="@.disabled";class eO{constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.parentNode(t)&&this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==JP?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class CK extends eO{constructor(e,t,i,r,s){super(t,i,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==JP?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function DK(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function TK(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(e,t,i)}}class IK{constructor(e,t,i){this.delegate=e,this.engine=t,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,t.onRemovalComplete=(r,s)=>{s?.removeChild(null,r)}}createRenderer(e,t){const r=this.delegate.createRenderer(e,t);if(!e||!t?.data?.animation){const l=this._rendererCache;let u=l.get(r);return u||(u=new eO("",r,this.engine,()=>l.delete(r)),l.set(r,u)),u}const s=t.id,o=t.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);const a=l=>{Array.isArray(l)?l.forEach(a):this.engine.registerTrigger(s,o,e,l.name,l)};return t.data.animation.forEach(a),new CK(this,o,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,i){if(e>=0&&e<this._microtaskId)return void this._zone.run(()=>t(i));const r=this._animationCallbacksBuffer;0==r.length&&queueMicrotask(()=>{this._zone.run(()=>{r.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),r.push([t,i])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}const tO=[{provide:fw,useFactory:function MK(){return new kP}},{provide:yu,useClass:(()=>{class n extends yu{constructor(t,i,r){super(t,i,r)}ngOnDestroy(){this.flush()}static{this.\u0275fac=function(i){return new(i||n)(Le(Yr),Le(dw),Le(fw))}}static{this.\u0275prov=He({token:n,factory:n.\u0275fac})}}return n})()},{provide:Yh,useFactory:function xK(n,e,t){return new IK(n,e,t)},deps:[Ty,yu,Ct]}],Pw=[{provide:dw,useFactory:()=>new QP},{provide:eb,useValue:"BrowserAnimations"},...tO],nO=[{provide:dw,useClass:hw},{provide:eb,useValue:"NoopAnimations"},...tO];let PK=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?nO:Pw}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Mc({type:n})}static{this.\u0275inj=Ho({providers:Pw,imports:[ZH]})}}return n})();(function $H(n){return uz(function $1(n){return{appProviders:[...q1,...n?.providers??[]],platformProviders:YH}}(n))})({providers:[function IV(){return Qn("NgZoneless"),function Xu(n){return{\u0275providers:n}}([{provide:ya,useExisting:Ll},{provide:Ct,useClass:Tg},{provide:fl,useValue:!0},{provide:R_,useValue:!1},[]])}(),y0(PK,my,rv,sv,ov,mf)]}).then(n=>{customElements.define("configurator-component",function n$(n,e){const t=function YG(n,e){return e.get(va).resolveComponentFactory(n).inputs}(n,e.injector),i=e.strategyFactory||new JG(n,e.injector),r=function KG(n){const e={};return n.forEach(({propName:t,templateName:i,transform:r})=>{e[function HG(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}(i)]=[t,r]}),e}(t);class s extends t${static{this.observedAttributes=Object.keys(r)}get ngElementStrategy(){if(!this._ngElementStrategy){const a=this._ngElementStrategy=i.create(this.injector||e.injector);t.forEach(({propName:c,transform:l})=>{if(!this.hasOwnProperty(c))return;const u=this[c];delete this[c],a.setInputValue(c,u,l)})}return this._ngElementStrategy}constructor(a){super(),this.injector=a}attributeChangedCallback(a,c,l,u){const[h,d]=r[a];this.ngElementStrategy.setInputValue(h,l,d)}connectedCallback(){let a=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),a=!0),this.ngElementStrategy.connect(this),a||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(a=>{const c=new CustomEvent(a.name,{detail:a.value});this.dispatchEvent(c)})}}return t.forEach(({propName:o,transform:a})=>{Object.defineProperty(s.prototype,o,{get(){return this.ngElementStrategy.getInputValue(o)},set(c){this.ngElementStrategy.setInputValue(o,c,a)},configurable:!0,enumerable:!0})}),s}(Fq,{injector:n.injector}))})}},Tt=>{Tt(Tt.s=501)}]);